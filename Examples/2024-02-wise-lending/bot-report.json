{
  "reportUid": "ot5w4GxBtnB",
  "labels": [
    {
      "name": "QA (Quality Assurance)",
      "color": "1D76DB"
    }
  ],
  "comment": null,
  "footnote": null,
  "findings": [
    {
      "severity": "Gas",
      "title": "`abi.encode()` is less efficient than `abi.encodepacked()`",
      "description": "See for more information: https://github.com/ConnorBlockchain/Solidity-Encode-Gas-Comparison ",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n41: abi.encode(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L41"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n226: abi.encode(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L226"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Activate the optimizer",
      "description": "Before deploying your contract, activate the optimizer when compiling using “solc --optimize --bin sourceFile.sol”. By default, the optimizer will optimize the contract assuming it is called 200 times across its lifetime. If you want the initial contract deployment to be cheaper and the later function executions to be more expensive, set it to “ --optimize-runs=1”. Conversely, if you expect many transactions and do not care for higher deployment cost and output size, set “--optimize-runs” to a high number.\n\n```\nmodule.exports = {\n\tsolidity: {\n\t\tversion: \"0.8.19\",\n\t\tsettings: {\n\t\t\toptimizer: {\n\t\t\t\tenabled: true,\n\t\t\t\truns: 1000,\n\t\t\t},\n\t\t},\n\t},\n};\n```\nKindly visit the following site for further information:\n\nhttps://docs.soliditylang.org/en/v0.8.19/using-the-compiler.html#using-the-commandline-compiler\n\nHere is one particular example of instance on opcode comparison that delineates the gas saving mechanism:\n\n```\nfor !=0 before optimization\nPUSH1 0x00\nDUP2\nEQ\nISZERO\nPUSH1 [cont offset]\nJUMPI\n\nafter optimization\nDUP1\nPUSH1 [revert offset]\nJUMPI\n```",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "All in-scope contracts",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Consider activating `via-ir` for deploying",
      "description": "The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions.\n\nYou can enable it on the command line using `--via-ir` or with the option `{\"viaIR\": true}`.\n\nThis will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command\n\nMore on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "All in-scope contracts",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "`address(this)` can be stored in `state variable` that will ultimately cost less, than every time calculating this, specifically when it used multiple times in a `contract`",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n286: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L286"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n84: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L84"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n677: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L677"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n479: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L479"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n625: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L625"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1193: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1193"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1233: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1233"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n659: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L659"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n139: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L139"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n167: _receiver: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L167"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n279: recipient: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L279"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n444: _receiver: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L444"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n112: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L112"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n89: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L89"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n145: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L145"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n187: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L187"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n265: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L265"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n400: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L400"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n540: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L540"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n588: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L588"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n50: return _getPositionData(address(this)).expiry;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n58: return _getPositionData(address(this)).amount;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n18: if (address(this).balance < _amount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n67: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n178: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L178"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n202: if (address(this).balance < _amount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L202"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n135: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n256: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L256"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n329: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L329"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n408: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L408"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n454: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L454"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n528: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L528"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n586: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L586"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n626: IERC20(tokenToSend).balanceOf(address(this))\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L626"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "`<array>.length` Should Not Be Looked Up In Every Loop Of A For-loop",
      "description": "The overheads outlined below are PER LOOP, excluding the first loop\n\nstorage arrays incur a Gwarmaccess (100 gas)\nmemory arrays use MLOAD (3 gas)\ncalldata arrays use CALLDATALOAD (3 gas)\n\nCaching the length changes each of these to a DUP<N> (3 gas), and gets rid of the extra DUP<N> needed to store the stack offset",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Avoid repeating computations",
      "description": "The following instances show only the first instance of the repeated computations.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n43: _product / _pseudo\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n490: product / _underlyingLpAssetsCurrent\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L490"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n122: _decimalsWETH - decimals\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L122"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Avoid updating storage when the value hasn't changed",
      "description": "If the old value is equal to the new value, not re-storing the value will avoid a Gsreset (2900 gas), potentially at the expense of a Gcoldsload (2100 gas) or a Gwarmaccess (100 gas)",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n125: function setVerifiedIsolationPool(\n        address _isolationPool,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n126: function setVerifiedIsolationPool(\n        address _isolationPool,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n319: function setBaseURI(\n        string memory _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L319"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n320: function setBaseURI(\n        string memory _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n328: function setBaseExtension(\n        string memory _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n329: function setBaseExtension(\n        string memory _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1386: function setRegistrationIsolationPool(\n        uint256 _nftId,\n        bool _registerState\n    )\n        external\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1387: function setRegistrationIsolationPool(\n        uint256 _nftId,\n        bool _registerState\n    )\n        external\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n424: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyFeeManager\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n425: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyFeeManager\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n33: function setLastUpdateGlobal(\n        uint256 _time\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n34: function setLastUpdateGlobal(\n        uint256 _time\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n42: function setRoundData(\n        uint80 _roundId,\n        uint256 _updateTime\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n43: function setRoundData(\n        uint80 _roundId,\n        uint256 _updateTime\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n52: function setGlobalAggregatorRoundId(\n        uint80 _aggregatorRoundId\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n53: function setGlobalAggregatorRoundId(\n        uint80 _aggregatorRoundId\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n49: function setRepayBadDebtIncentive(\n        uint256 _percent\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n50: function setRepayBadDebtIncentive(\n        uint256 _percent\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n66: function setAaveFlag(\n        address _poolToken,\n        address _underlyingToken\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L66"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n67: function setAaveFlag(\n        address _poolToken,\n        address _underlyingToken\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n82: function setAaveFlagBulk(\n        address[] calldata _poolTokens,\n        address[] calldata _underlyingTokens\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L82"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n83: function setAaveFlagBulk(\n        address[] calldata _poolTokens,\n        address[] calldata _underlyingTokens\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n108: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n109: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n514: function setBadDebtUserLiquidation(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n515: function setBadDebtUserLiquidation(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L515"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n63: function changeMinDeposit(\n        uint256 _newMinDeposit\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n64: function changeMinDeposit(\n        uint256 _newMinDeposit\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L64"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n321: function changeExchangeIncentive(\n        uint256 _newExchangeIncentive\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n322: function changeExchangeIncentive(\n        uint256 _newExchangeIncentive\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L322"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n334: function changeMintFee(\n        address _pendleMarket,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n335: function changeMintFee(\n        address _pendleMarket,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n592: function changeMintFee(\n        uint256 _newFee\n    )\n        external\n        onlyController\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n593: function changeMintFee(\n        uint256 _newFee\n    )\n        external\n        onlyController\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n51: function setFarmContract(\n        address _farmContract\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n52: function setFarmContract(\n        address _farmContract\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n161: function setBaseURI(\n        string calldata _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n162: function setBaseURI(\n        string calldata _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n170: function setBaseExtension(\n        string calldata _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n171: function setBaseExtension(\n        string calldata _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n85: function setLiquidationSettings(\n        uint256 _baseReward,\n        uint256 _baseRewardFarm,\n        uint256 _newMaxFeeETH,\n        uint256 _newMaxFeeFarmETH\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L85"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n86: function setLiquidationSettings(\n        uint256 _baseReward,\n        uint256 _baseRewardFarm,\n        uint256 _newMaxFeeETH,\n        uint256 _newMaxFeeFarmETH\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n980: function setBlacklistToken(\n        address _tokenAddress,\n        bool _state\n    )\n        external\n        onlyMaster()\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n981: function setBlacklistToken(\n        address _tokenAddress,\n        bool _state\n    )\n        external\n        onlyMaster()\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n995: function setSecurityWorker(\n        address _entitiy,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L995"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n996: function setSecurityWorker(\n        address _entitiy,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1111: function changeMinDepositValue(\n        uint256 _newMinDepositValue\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1112: function changeMinDepositValue(\n        uint256 _newMinDepositValue\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n44: function setAaveTokenAddress(\n        address _underlyingAsset,\n        address _aaveToken\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n45: function setAaveTokenAddress(\n        address _underlyingAsset,\n        address _aaveToken\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n105: function setWiseSecurity(\n        address _securityAddress\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n106: function setWiseSecurity(\n        address _securityAddress\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Avoid zero transfer to save gas",
      "description": "In Solidity, unnecessary operations can waste gas. For example, a transfer function without a zero amount check uses gas even if called with a zero amount, since the contract state remains unchanged. Implementing a zero amount check avoids these unnecessary function calls, saving gas and improving efficiency.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n607: payable(_to).transfer(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L607"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Call `msg.sender` directly instead of caching them",
      "description": "In the instance below, instead of caching `msg.sender` and incurring unnecessary stack manipulation, we can call `msg.sender` directly.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n695: address caller = msg.sender;\n\nfunction claimFeesBeneficial(\n        address _feeToken,\n        uint256 _amount\n    )\n        external\n    {\n        address caller = msg.sender;\n\n        if (totalBadDebtETH > 0) {\n            revert ExistingBadDebt();\n        }\n\n        if (allowedTokens[caller][_feeToken] == false) {\n            revert NotAllowed();\n        }\n\n        _decreaseFeeTokens(\n            _feeToken,\n            _amount\n        );\n\n        _safeTransfer(\n            _feeToken,\n            caller,\n            _amount\n        );\n\n        emit ClaimedFeesBeneficial(\n            caller,\n            _feeToken,\n            _amount,\n            block.timestamp\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L695"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Gas savings can be achieved by changing the model for assigning value to the structure",
      "description": "Here's an example to illustrate this:\n```solidity\n\tstruct MyStruct {\n\t    uint256 a;\n\t    uint256 b;\n\t    uint256 c;\n\t}\n\n\tfunction assignValuesToStruct(uint256 _a, uint256 _b, uint256 _c) public {\n\t    MyStruct memory myStruct = MyStruct(_a, _b, _c);\n\t    // Do something with myStruct\n\t}\n```\nIn this example, we have a simple MyStruct data structure with three uint256 fields. The assignValuesToStruct function takes three input parameters _a, _b, and _c, and assigns them to the corresponding fields in a new myStruct variable. This is done using the struct constructor syntax, which creates a new instance of the MyStruct struct with the specified field values.\n\nThe following approach can be more efficient than assigning values to the struct fields:\n```solidity\n\tfunction assignValuesToStruct(uint256 _a, uint256 _b, uint256 _c) public {\n\t    MyStruct memory myStruct;\n\t    myStruct.a = _a;\n\t    myStruct.b = _b;\n\t    myStruct.c = _c;\n\t    // Do something with myStruct\n\t}\n```\nBy changing the pattern of assigning value to the structure, gas savings of `~130` per instance are achieved. In addition, this use will provide significant savings in distribution costs.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n239: algorithmData[_params.poolToken] = AlgorithmEntry({\n            bestPole: startValuePole,\n            maxValue: 0,\n            previousValue: 0,\n            increasePole: false\n        });\n\n208: globalPoolData[_params.poolToken] = GlobalPoolEntry({\n            totalPool: 0,\n            utilization: 0,\n            totalBareToken: 0,\n            poolFee: 20 * PRECISION_FACTOR_E16\n        });\n\n247: lendingPoolData[_params.poolToken] = LendingPoolEntry({\n            pseudoTotalPool: GHOST_AMOUNT,\n            totalDepositShares: GHOST_AMOUNT,\n            collateralFactor: _params.poolCollFactor\n        });\n\n231: borrowPoolData[_params.poolToken] = BorrowPoolEntry({\n            allowBorrow: _params.allowBorrow,\n            pseudoTotalBorrowAmount: GHOST_AMOUNT,\n            totalBorrowShares: GHOST_AMOUNT,\n            borrowRate: 0\n        });\n\n254: timestampsPoolData[_params.poolToken] = TimestampsPoolEntry({\n            timeStamp: block.timestamp,\n            timeStampScaling: block.timestamp,\n            initialTimeStamp: block.timestamp\n        });\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L247",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L239",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L208",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L231",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L254"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n186: uniTwapPoolInfo[_tokenAddress] = UniTwapPoolInfo({\n            oracle: _oracle,\n            isUniPool: _isUniPool\n        });\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L186"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Comparing to constant boolean",
      "description": "There is no need to verify that `== true` or `== false` when the variable checked upon is a boolean as well.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n223: if (verifiedIsolationPool[_poolAddress] == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L223"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n244: if (positionLocked[_nftId] == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L244"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n265: if (positionLocked[_nftIdLiquidator] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L265"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n627: if (hashMap[hashData] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L627"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1165: if (_checkLendingDataEmpty(_nftId, _poolToken) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1165"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n36: if (parametersLocked[_poolToken] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L36"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n161: if (_exists(tokenId) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n76: if (_onBehalf == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L76"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n200: if (_byPassCase(_caller) == true) {\n\n204: if (positionLocked[_nftId] == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L204",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L200"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n246: if (WISE_ORACLE.chainLinkIsDead(_poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L246"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n282: if (POSITION_NFT.isOwner(_nftId, _caller) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L282"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n306: if (state == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L306"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n397: if (_onBehalf == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L397"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n592: if (userLendingData[_nftId][_receiveTokens].unCollateralized == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L592"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n87: if (powerFarmCheck == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L87"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n290: if (_aboveThreshold(_poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L290"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1527: if (_onBehalf == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1527"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n354: if (sendingProgress == true) {\n\n358: if (_sendingProgressAaveHub() == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L354",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L358"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n400: if (verifiedIsolationPool[_sender] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L400"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n104: if (increaseCardinalityRequired == true) {\n\n108: if (oldestObservationSatisfied == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L104",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n109: if (increaseCardinalityRequired == true) {\n\n113: if (oldestObservationSatisfied == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L109",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L113"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n90: if (increaseCardinalityRequired == true) {\n\n94: if (oldestObservationSatisfied == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L94",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L90"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n261: if (isAaveToken[tokenAddress] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L261"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n418: if (poolTokenAdded[_poolToken] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L418"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n449: if (poolTokenAdded[_poolToken] == false) {\n\n473: if (found == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L449",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L473"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n650: if (isAaveToken[_poolToken] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L650"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n701: if (allowedTokens[caller][_feeToken] == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L701"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n127: if (isAave[_nftId] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L127"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n203: if (_notBelowMinDepositAmount(leveragedAmount) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L203"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n365: if (isShutdown == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L365"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n67: if (allowEnter == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n215: if (_ethBack == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L215"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n333: if (_isAave == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L333"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n520: if (_checkDebtRatio(_nftId) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L520"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n538: if (_isAave == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L538"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n571: if (_checkDebtRatio(_nftId) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L571"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n39: if (sendingProgress == true) {\n\n43: if (WISE_LENDING.sendingProgress() == true) {\n\n47: if (AAVE_HUB.sendingProgressAaveHub() == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L39",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L43",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n291: if (_checkDebtRatio(wiseLendingNFT) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L291"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n304: if (_compareHashes(_pendleMarket, rewardTokens) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L304"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n396: if (_fromInside == false) {\n\n396: if (_fromInside == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L396",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L396"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n456: if (IS_ETH_MAIN == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L456"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n154: if (_overWritten == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n699: if (PENDLE_MARKET.isExpired() == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L699"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n31: if (success == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n33: if (success == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n45: if (_checkFunctionExistence(address(tokenAggregator)) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n117: if (uniTwapPoolInfoStruct.isUniPool == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L117"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n270: if (_chainLinkIsDead(ETH_USD_PLACEHOLDER) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L270"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n526: if (IS_ARBITRUM_CHAIN == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L526"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n76: if (chainLinkIsDead(_tokenAddress) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L76"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n451: if (sequencerIsDead() == true) {\n\n475: if (state == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L451",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L475"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n246: if (_checkBlacklisted(_poolToken) == true) {\n\n255: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {\n\n259: if (WISE_LENDING.positionLocked(_nftId) == true) {\n\n263: if (_isUncollateralized(_nftId, _poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L246",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L263",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L259",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L255"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n284: if (_checkBlacklisted(_poolToken) == true) {\n\n293: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {\n\n297: if (WISE_LENDING.positionLocked(_nftId) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L293",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L284",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L297"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n323: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {\n\n327: if (WISE_LENDING.positionLocked(_nftId) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L327",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L323"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n343: if (checkHeartbeat(_poolAddress) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L343"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n367: if (_checkBlacklisted(_poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L367"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n671: if (checkHeartbeat(token) == false) {\n\n675: if (wasBlacklisted[token] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L675",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L671"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n716: if (_checkBlacklisted(token) == true) {\n\n716: if (_checkBlacklisted(token) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L716",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L716"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n792: if (_isUncollateralized(_nftId, _poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L792"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n842: if (_isUncollateralized(_nftId, _poolToken) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L842"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1014: if (securityWorker[msg.sender] == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1014"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n206: if (_isUncollateralized(_nftId, _poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L206"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n263: if (_isUncollateralized(_nftId, _poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L263"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n678: if (WISE_LENDING.borrowPoolData(_poolAddress).allowBorrow == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L678"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n707: if (WISE_LENDING.positionLocked(_nftId) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L707"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n801: if (_getState(_nftId, _powerFarm) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L801"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1086: if (_checkBlacklisted(_poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1086"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1102: if (_success == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1102"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n38: if (sendingProgressAaveHub == true) {\n\n42: if (WISE_LENDING.sendingProgress() == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L42",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L38"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n70: if (POSITION_NFT.isOwner(_nftId, msg.sender) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L70"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n214: if (success == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L214"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Consider using solady's 'FixedPointMathLib'",
      "description": "Using Solady's 'FixedPointMathLib' for multiplication or division operations in Solidity can lead to significant gas savings. This library is designed to optimize fixed-point arithmetic operations, which are common in financial calculations involving tokens or currencies. By implementing more efficient algorithms and assembly optimizations, 'FixedPointMathLib' minimizes the computational resources required for these operations. \n\nFor contracts that frequently perform such calculations, integrating this library can reduce transaction costs, thereby enhancing overall performance and cost-effectiveness. However, developers must ensure compatibility with their existing codebase and thoroughly test for accuracy and expected behavior to avoid any unintended consequences.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n893: : totalSharesUser * MAX_LIQUIDATION_50 / PRECISION_FACTOR_E18;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L893"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Setting the `constructor` to `payable`",
      "description": "Saves ~13 gas per instance",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n57: constructor(\n        address _master\n    )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n25: constructor(\n        string memory _name,\n        string memory _symbol,\n        string memory _baseURI\n    )\n        ERC721(\n            _name,\n            _symbol\n        )\n        OwnableMaster(\n            msg.sender\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n116: constructor(\n        address _master,\n        address _wiseOracleHubAddress,\n        address _nftContract\n    )\n        WiseLendingDeclaration(\n            _master,\n            _wiseOracleHubAddress,\n            _nftContract\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L116"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n105: constructor(\n        address _master,\n        address _wiseOracleHub,\n        address _nftContract\n    )\n        OwnableMaster(\n            _master\n        )\n        WrapperHelper(\n            IWiseOracleHub(\n                _wiseOracleHub\n            ).WETH_ADDRESS()\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L105"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n22: constructor()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L22"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n21: constructor(\n        address _pendleLpOracle,\n        address _pendleChild\n    )\n        CustomOracleSetup()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n32: constructor(\n        address _pendleMarketAddress,\n        IPriceFeed _priceFeedChainLinkEth,\n        IOraclePendle _oraclePendlePt,\n        string memory _oracleName,\n        uint32 _twapDuration\n    )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n24: constructor(\n        address _pendleMarketAddress,\n        IPriceFeed _priceFeedChainLinkUsd,\n        IPriceFeed _priceFeedChainLinkEthUsd,\n        IOraclePendle _oraclePendlePt,\n        string memory _oracleName,\n        uint32 _twapDuration\n    )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n24: constructor(\n        address _pendleMarketAddress,\n        IPriceFeed _priceFeedChainLinkEth,\n        IOraclePendle _oraclePendlePt,\n        string memory _oracleName,\n        uint32 _twapDuration\n    )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n33: constructor(\n        address _master,\n        address _aaveAddress,\n        address _wiseLendingAddress,\n        address _oracleHubAddress,\n        address _wiseSecurityAddress,\n        address _positionNFTAddress\n    )\n        OwnableMaster(\n            _master\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n27: constructor(\n        address _master,\n        address _aaveAddress,\n        address _wiseLendingAddress,\n        address _oracleHubAddress,\n        address _wiseSecurityAddress,\n        address _positionNFTAddress\n    )\n        DeclarationsFeeManager(\n            _master,\n            _aaveAddress,\n            _wiseLendingAddress,\n            _oracleHubAddress,\n            _wiseSecurityAddress,\n            _positionNFTAddress\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L27"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n159: constructor(\n        address _wiseLendingAddress,\n        address _pendleChilTokenAddress,\n        address _pendleRouter,\n        address _entryAsset,\n        address _pendleSy,\n        address _underlyingMarket,\n        address _routerStatic,\n        address _dexAddress,\n        uint256 _collateralFactor\n    )\n        WrapperHelper(\n            IWiseLending(\n                _wiseLendingAddress\n            ).WETH_ADDRESS()\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L159"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n31: constructor(\n        address _wiseLendingAddress,\n        address _pendleChilTokenAddress,\n        address _pendleRouter,\n        address _entryAsset,\n        address _pendleSy,\n        address _underlyingMarket,\n        address _routerStatic,\n        address _dexAddress,\n        uint256 _collateralFactor,\n        address _powerFarmNFTs\n    )\n        OwnableMaster(\n            msg.sender\n        )\n        MinterReserver(\n            _powerFarmNFTs\n        )\n        PendlePowerFarmDeclarations(\n            _wiseLendingAddress,\n            _pendleChilTokenAddress,\n            _pendleRouter,\n            _entryAsset,\n            _pendleSy,\n            _underlyingMarket,\n            _routerStatic,\n            _dexAddress,\n            _collateralFactor\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n12: constructor(\n        address _vePendle,\n        address _pendleToken,\n        address _voterContract,\n        address _voterRewardsClaimerAddress,\n        address _wiseOracleHub\n    )\n        PendlePowerFarmControllerBase(\n            _vePendle,\n            _pendleToken,\n            _voterContract,\n            _voterRewardsClaimerAddress,\n            _wiseOracleHub\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n79: constructor(\n        address _vePendle,\n        address _pendleToken,\n        address _voterContract,\n        address _voterRewardsClaimerAddress,\n        address _wiseOracleHub\n    )\n        OwnableMaster(\n            msg.sender\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L79"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n16: constructor(\n        address _pendlePowerFarmController\n    )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L16"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n55: constructor(\n        address _powerFarmNFTs\n    )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L55"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n38: constructor(\n        string memory _name,\n        string memory _symbol\n    )\n        ERC721(\n            _name,\n            _symbol\n        )\n        OwnableMaster(\n            msg.sender\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L38"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n11: constructor(\n        address _wethAddress\n    )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n45: constructor(\n        address _wethAddress,\n        address _ethPriceFeed,\n        address _uniswapV3Factory\n    )\n        OwnableMaster(\n            msg.sender\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n33: constructor(\n        address _wethAddrss,\n        address _ethPricingFeed,\n        address _uniswapFactoryV3\n    )\n        Declarations(\n            _wethAddrss,\n            _ethPricingFeed,\n            _uniswapFactoryV3\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n42: constructor(\n        address _master,\n        address _wiseLendingAddress,\n        address _aaveHubAddress\n    )\n        WiseSecurityDeclarations(\n            _master,\n            _wiseLendingAddress,\n            _aaveHubAddress\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L42"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n52: constructor(\n        address _master,\n        address _wiseLendingAddress,\n        address _aaveHubAddress\n    )\n        OwnableMaster(\n            _master\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n27: constructor(\n        address _master,\n        address _aaveAddress,\n        address _lendingAddress\n    )\n        Declarations(\n            _master,\n            _aaveAddress,\n            _lendingAddress\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L27"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n43: constructor(\n        address _master,\n        address _aaveAddress,\n        address _lendingAddress\n    )\n        OwnableMaster(\n            _master\n        )\n        WrapperHelper(\n            IWiseLending(\n                _lendingAddress\n            ).WETH_ADDRESS()\n        )\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L43"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Counting down in `for` statements is more gas efficient",
      "description": "Counting down is more gas efficient than counting up because neither we are making zero variable to non-zero variable and also we will get gas refund in the last transaction when making non-zero to zero variable.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Divisions which do not divide by -X cannot overflow or overflow so such operations can be unchecked to save gas",
      "description": "Make such found divisions are unchecked when ensured it is safe to do so",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n301: return (_maxPole - _minPole) / NORMALISATION_FACTOR;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L301"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n312: return (_maxPole + _minPole) / 2;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L312"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use shift Right instead of division if possible to save gas",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n285: return PRECISION_FACTOR_E18 / 2\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L285"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n286: + (PRECISION_FACTOR_E36 / 4\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L286"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n312: return (_maxPole + _minPole) / 2;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L312"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n170: uint256 internal constant MIN_BORROW_SHARE_PRICE = 5 * PRECISION_FACTOR_E18\n        / 10;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n122: ) / 10 ** (_decimalsWETH - decimals(_tokenAddress));\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n110: * latestResolver(_tokenAddress)\n                / 10 ** decimals(_tokenAddress)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L110"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n112: / 10 ** (tokenDecimals - _decimalsETH)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L112"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n115: * latestResolver(_tokenAddress)\n                / 10 ** decimals(_tokenAddress);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L115"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n135: * getETHPriceInUSD()\n            / 10 ** _decimalsUSD;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n161: * latestResolver(_tokenAddress)\n                / 10 ** decimals(_tokenAddress)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n163: / 10 ** (tokenDecimals - _decimalsETH)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L163"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n166: * latestResolver(_tokenAddress)\n                / 10 ** decimals(_tokenAddress);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L166"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n190: / latestResolver(_tokenAddress)\n                / 10 ** (_decimalsETH - tokenDecimals);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L190"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n350: / latestResolver(_tokenAddress)\n                / 10 ** (_decimalsETH - tokenDecimals);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L350"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Empty Blocks Should Be Removed Or Emit Something",
      "description": "The code should be refactored such that they no longer exist, or the block should do something useful, such as emitting an event or reverting. If the contract is meant to be extended, the contract should be abstract and the function signatures be added without any default implementation. If the block is an empty if-statement block to avoid doing subsequent checks in the else-if/else conditions, the else-if/else conditions should be nested under the negation of the if-statement, because they involve different classes of checks, which may lead to the introduction of errors when the code is later modified (if(x){}else if(y){...}else{...} => if(!x){if(y){...}else{...}})",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n52: {}\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L52"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Using `delete` statement can save gas",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n228: reservedKeys[msg.sender] = 0;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L228"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n268: childInfo.reservedForCompound[i] = 0;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L268"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n459: reservedPendleForLocking = 0;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L459"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n256: rewardsOutsideArray[i] = 0;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L256"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n418: secondsAgo[1] = 0;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L418"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n600: i = 0;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L600"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n732: i = 0;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L732"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "`++i` Costs Less Gas Than `i++`, Especially When It’s Used In For-loops (`--i`/`i--` Too)",
      "description": "Saves 6 gas per loop",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use `assembly` to write address storage values",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n63: master = _master;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L63"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n80: proposedMaster = _proposedOwner;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L80"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n81: feeManager = _feeManagerContract;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L81"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n40: PENDLE_MARKET_ADDRESS = _pendleMarketAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L40"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n32: PENDLE_MARKET_ADDRESS = _pendleMarketAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n87: incentiveMaster = _master;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L87"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n204: ENTRY_ASSET = _entryAsset;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L204"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n205: PENDLE_CHILD = _pendleChilTokenAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L205"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n712: PENDLE_POWER_FARM_CONTROLLER = _pendleController;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L712"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n713: UNDERLYING_PENDLE_MARKET = _underlyingPendleMarket;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L713"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n20: PENDLE_POWER_FARM_CONTROLLER = _pendlePowerFarmController;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L20"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n58: farmContract = _farmContract;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n54: WETH_ADDRESS = _wethAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L54"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n75: AAVE_HUB = _aaveHubAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L75"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use hardcoded address instead `address(this)`",
      "description": "Instead of using `address(this)`, it is more gas-efficient to pre-calculate and use the hardcoded `address`. Foundry's script.sol and solmate's `LibRlp.sol` contracts can help achieve this.\n\nReferences: \nhttps://book.getfoundry.sh/reference/forge-std/compute-create-address \n\nhttps://twitter.com/transmissions11/status/1518507047943245824",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n286: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L286"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n84: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L84"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n677: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L677"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n479: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L479"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n625: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L625"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1193: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1193"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1233: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1233"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n659: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L659"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n139: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L139"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n167: _receiver: address(this),\n\n167: _receiver: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L167",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L167"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n279: recipient: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L279"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n444: _receiver: address(this),\n\n444: _receiver: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L444",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L444"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n112: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L112"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n89: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L89"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n145: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L145"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n187: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L187"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n265: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L265"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n400: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L400"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n540: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L540"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n588: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L588"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n50: return _getPositionData(address(this)).expiry;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n58: return _getPositionData(address(this)).amount;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n18: if (address(this).balance < _amount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n67: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n178: address(this)\n\n178: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L178",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L178"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n202: if (address(this).balance < _amount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L202"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n135: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n256: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L256"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n329: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L329"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n408: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L408"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n454: address(this),\n\n454: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L454",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L454"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n528: address(this)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L528"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n586: address(this),\n\n586: address(this),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L586",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L586"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n626: IERC20(tokenToSend).balanceOf(address(this))\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L626"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Hash using `assembly` instead of solidity",
      "description": "Saves about ~80 gas\n\n```solidity\nfunction solidityHash(uint256 a, uint256 b) public view {\n    //unoptimized\n    keccak256(abi.encodePacked(a, b));\n}\n```\nGas Test: 313\n\n```solidity\nfunction assemblyHash(uint256 a, uint256 b) public view {\n    //optimized\n    assembly {\n        mstore(0x00, a)\n        mstore(0x20, b)\n        let hashedVal := keccak256(0x00, 0x40)\n    }\n} \n```\nGas Test: 231",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n655: return keccak256(\n            abi.encodePacked(\n                _nftId,\n                _poolToken\n            )\n        );\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L655"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n225: return keccak256(\n            abi.encode(\n                rewardTokensToCompare\n            )\n        ) == keccak256(\n            abi.encode(\n                pendleChildCompoundInfo[_pendleMarket].rewardTokens\n            )\n        );\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L225"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n65: bytes32 salt = keccak256(\n            abi.encodePacked(\n                _underlyingPendleMarket\n            )\n        );\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L65"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Increments can be `unchecked` to save gas",
      "description": "Using `unchecked` increments can save gas by bypassing the built-in overflow checks. This can save [30-40 gas](https://gist.github.com/hrkrshnn/ee8fabd532058307229d65dcd5836ddc#the-increment-in-for-loop-post-condition-can-be-made-unchecked) **per iteration**. So it is recommended to use `unchecked` increments when overflow is not possible.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n386: length++;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L386"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n236: ++availableNFTCount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L236"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n67: return ++totalReserved;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n135: totalMinted++;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n228: length++;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L228"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "It Costs More Gas To Initialize Variables To Zero Than To Let The Default Of Zero Be Applied",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "`internal` functions only called once can be inlined to save gas",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n93: function _cashoutAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L93"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n135: function _preparationsWithdraw\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n217: function _onlyIsolationPool\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L217"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n232: function _validateIsolationPoolLiquidation\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L232"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n258: function _checkLiquidatorNft\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L258"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n278: function _getBalance\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L278"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n298: function _cleanUp\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L298"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n372: function _preparePool\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L372"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n391: function _preparationTokens\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L391"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n454: function _curveSecurityChecks\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L454"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n584: function _increasePositionLendingDeposit\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L584"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n599: function _decreaseLendingShares\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L599"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n614: function _addPositionTokenData\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L614"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n752: function _corePayback\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L752"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n851: function _calculateNewBorrowRate\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L851"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n877: function _newBorrowRate\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L877"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n896: function _aboveThreshold\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L896"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n911: function _scalingAlgorithm\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L911"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1155: function _removeEmptyLendingData\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1155"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1184: function _updatePoolStorage\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1184"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n371: function _toString\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L371"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n44: function _coreWithdrawToken\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n106: function _handleDeposit\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L106"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n271: function _checkAllowDeposit\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L271"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n349: function _coreBorrowTokens\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L349"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n625: function _coreLiquidation\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L625"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n192: function _checkHealthState\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L192"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n25: function _validateParameter\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n188: function _setMaxValue\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L188"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n197: function _setBestPole\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L197"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n206: function _setIncreasePole\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L206"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n215: function _setPole\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L215"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n224: function _increaseTotalPool\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L224"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n233: function _decreaseTotalPool\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L233"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n242: function _increaseTotalDepositShares\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L242"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n251: function _decreaseTotalDepositShares\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L251"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n260: function _increasePseudoTotalBorrowAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L260"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n269: function _decreasePseudoTotalBorrowAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L269"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n278: function _increaseTotalBorrowShares\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L278"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n287: function _decreaseTotalBorrowShares\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L287"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n296: function _increasePseudoTotalPool\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L296"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n305: function _decreasePseudoTotalPool\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L305"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n314: function _setTimeStamp\n\n323: function _setTimeStamp\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L314",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L323"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n323: function _setTimeStampScaling\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L323"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n332: function _increaseTotalBareToken\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L332"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n341: function _decreaseTotalBareToken\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L341"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n350: function _checkReentrancy\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L350"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n371: function _decreasePositionMappingValue\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L371"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n382: function _increaseMappingValue\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L382"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n393: function _byPassCase\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L393"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n407: function _increaseTotalAndPseudoTotalPool\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L407"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n434: function _checkOwnerPosition\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L434"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n447: function _validateNonZero\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L447"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n458: function _validateZero\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L458"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n122: function _getLpToAssetRateWrapper\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n15: function _prepareBorrows\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L15"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n47: function _prepareCollaterals\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n77: function _setBadDebtPosition\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L77"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n89: function _increaseTotalBadDebt\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L89"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n121: function _eraseBadDebtUser\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L121"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n195: function _increaseFeeTokens\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L195"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n208: function _decreaseFeeTokens\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L208"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n220: function _setAllowedTokens\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L220"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n230: function _setAaveFlag\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L230"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n292: function _distributeIncentives\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n383: function _checkValue\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L383"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n119: function _manuallyPaybackShares\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L119"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n157: function _manuallyWithdrawShares\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L157"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n185: function _openPosition\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L185"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n230: function _closingPosition\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L230"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n274: function _registrationFarm\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L274"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n361: function _isActive\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L361"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n15: function _executeBalancerFlashLoan\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L15"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n232: function _getEthBack\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L232"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n293: function _swapStETHintoETH\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L293"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n326: function _paybackExactShares\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L326"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n383: function _closingRouteETH\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L383"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n414: function _logicOpenPosition\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L414"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n531: function _borrowExactAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L531"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n560: function _coreLiquidation\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L560"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n92: function _getPositionBorrowTokenAmount\n\n111: function _getPositionBorrowTokenAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L92",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L111"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n111: function _getPositionBorrowTokenAmountAave\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L111"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n136: function _getPositionLendingShares\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L136"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n153: function _getPostionCollateralTokenAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L153"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n258: function _getEthInTokens\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L258"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n289: function _getApproxNetAPY\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L289"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n344: function _getNewBorrowRate\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L344"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n389: function _checkDebtRatio\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L389"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n416: function _notBelowMinDepositAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L416"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n9: function _findIndex\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n32: function _calcExpiry\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n45: function _getExpiry\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n53: function _getLockAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n73: function _getAmountToSend\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n133: function _checkFeed\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L133"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n144: function _getRewardTokens\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L144"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n156: function _getUserReward\n\n173: function _getUserReward\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L173",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L156"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n173: function _getUserRewardIndex\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L173"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n189: function _getTokensInETH\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L189"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n203: function _getTokensFromETH\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L203"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n217: function _compareHashes\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L217"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n236: function _setRewardTokens\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L236"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n132: function _overWriteCheck\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L132"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n140: function _triggerIndexUpdate\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L140"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n149: function _wrapOverWrites\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L149"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n218: function _calculateRewardsClaimedOutside\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L218"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n347: function _increaseCardinalityNext\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L347"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n422: function _applyMintFee\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L422"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n63: function _incrementReserved\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L63"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n70: function _getNextReserveKey\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L70"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n77: function _reserveKey\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L77"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n115: function _mintKeyForUser\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L115"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n213: function _toString\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L213"
          ]
        },
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n13: function _safeApprove\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n12: function _callOptionalReturn\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n12: function _sendValue\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n13: function _safeTransfer\n\n34: function _safeTransfer\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L34",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n34: function _safeTransferFrom\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n24: function _wrapETH\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n38: function _unwrapETH\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L38"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n12: function _addOracle\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n32: function _addAggregator\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n60: function _checkFunctionExistence\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L60"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n87: function _compareMinMax\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L87"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n131: function _validateAnswer\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L131"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n179: function _writeUniTwapPoolInfoStruct\n\n195: function _writeUniTwapPoolInfoStruct\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L179",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L195"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n195: function _writeUniTwapPoolInfoStructDerivative\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L195"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n216: function _getRelativeDifference\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L216"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n235: function _compareDifference\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L235"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n246: function _getChainlinkAnswer\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L246"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n283: function _getPool\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L283"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n303: function _validateTokenAddress\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L303"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n324: function _validatePoolAddress\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L324"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n344: function _validatePriceFeed\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L344"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n359: function _validateTwapOracle\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L359"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n374: function _getTwapPrice\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L374"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n460: function _getTwapDerivatePrice\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L460"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n507: function _recalibrate\n\n592: function _recalibrate\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L592",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L507"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n556: function _chainLinkIsDead\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L556"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n592: function _recalibratePreview\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L592"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n658: function _getIterationCount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L658"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n118: function _setLiquidationSettings\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L118"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n145: function _overallETHCollateralsWeighted\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L145"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n246: function _getCollateralOfTokenETHUpdated\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L246"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n470: function _checkBlacklisted\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L470"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n486: function _overallETHBorrow\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L486"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n530: function _getUpdatedPseudoBorrow\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L530"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n554: function _getUpdatedPseudoPool\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L554"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n610: function _getETHBorrowUpdated\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L610"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n701: function _checkPositionLocked\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L701"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n794: function _checkHealthState\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L794"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n806: function _getState\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L806"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1029: function _getPossibleWithdrawAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1029"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1057: function _setPoolState\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1057"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1096: function _checkSuccess\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1096"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n23: function _validToken\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L23"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n34: function _nonReentrantCheck\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n47: function _reservePosition\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n56: function _wrapDepositExactAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L56"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n83: function _wrapWithdrawExactAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n113: function _wrapWithdrawExactShares\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L113"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n141: function _wrapBorrowExactAmount\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L141"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n165: function _wrapAaveReturnValueDeposit\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L165"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n196: function _sendValue\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L196"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n219: function _getInfoPayback\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L219"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n81: function _checkOwner\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L81"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n93: function _checkPositionLocked\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L93"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Multiple accesses of a mapping/array should use a local variable cache",
      "description": "Caching a mapping's value in a local storage or calldata variable when the value is accessed multiple times saves ~42 gas per access due to not having to perform the same offset calculation every time. Help the Optimizer by saving a storage variable's reference instead of repeatedly fetching it\n\nTo help the optimizer,declare a storage type variable and use it instead of repeatedly fetching the reference in a map or an array. As an example, instead of repeatedly calling `someMap[someIndex]`, save its reference like this: `SomeStruct storage someStruct = someMap[someIndex]` and use it.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n27: lendingPoolData[_poolToken].totalDepositShares * _amount,\n\n28: lendingPoolData[_poolToken].pseudoTotalPool,\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L27-L28"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n65: borrowPoolData[_poolToken].totalBorrowShares * _amount,\n\n66: borrowPoolData[_poolToken].pseudoTotalBorrowAmount,\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L65-L66"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n102: * lendingPoolData[_poolToken].pseudoTotalPool\n\n361: * lendingPoolData[_poolToken].pseudoTotalPool\n\n103: / lendingPoolData[_poolToken].totalDepositShares - 1;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L361",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L102",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L103"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n123: * borrowPoolData[_poolToken].pseudoTotalBorrowAmount;\n\n125: uint256 totalBorrowShares = borrowPoolData[_poolToken].totalBorrowShares;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L125",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L123"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n170: uint256 totalPool = globalPoolData[_poolToken].totalPool;\n\n311: uint256 totalPool = globalPoolData[_poolToken].totalPool;\n\n312: uint256 bareToken = globalPoolData[_poolToken].totalBareToken;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L170",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L311",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L312"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n507: uint256 bareIncrease = borrowPoolData[_poolToken].borrowRate\n\n123: * borrowPoolData[_poolToken].pseudoTotalBorrowAmount\n\n509: * borrowPoolData[_poolToken].pseudoTotalBorrowAmount\n\n510: + bufferIncrease[_poolToken];\n\n513: bufferIncrease[_poolToken] = bareIncrease;\n\n551: * lendingPoolData[_poolToken].totalDepositShares\n\n552: / (lendingPoolData[_poolToken].pseudoTotalPool - feeAmount);\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L509",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L510",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L552",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L551",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L513",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L507",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L123"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n627: if (hashMap[hashData] == true) {\n\n631: hashMap[hashData] = true;\n\n633: userTokenData[_nftId].push(\n\n637: if (userTokenData[_nftId].length > MAX_TOTAL_TOKEN_NUMBER) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L627",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L631",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L633",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L637"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n856: uint256 pole = borrowRatesData[_poolToken].pole;\n\n863: borrowRatesData[_poolToken].multiplicativeFactor\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L856",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L863"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1130: uint256 minValue = borrowRatesData[_poolToken].minPole;\n\n1132: uint256 delta = borrowRatesData[_poolToken].deltaPole\n\n1135: uint256 sub = borrowRatesData[_poolToken].pole > delta\n\n1136: ? borrowRatesData[_poolToken].pole - delta\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1136",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1130",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1132",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1135"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n36: if (parametersLocked[_poolToken] == true) {\n\n40: parametersLocked[_poolToken] = _isFinal;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L36",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L40"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n170: timestampsPoolData[_params.poolToken].timeStamp,\n\n254: timestampsPoolData[_params.poolToken] = TimestampsPoolEntry({\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L254",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n117: if (reserved[_user] > 0) {\n\n118: return reserved[_user];\n\n122: reserved[_user] = reservedId;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L117",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L122",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L118"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n299: tokenIds[i] = tokenOfOwnerByIndex(\n\n310: tokenIds[i] = reservedId;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L310",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L299"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n552: if (pureCollateralAmount[_nftId][_receiveTokens] > 0) {\n\n561: uint256 userShares = userLendingData[_nftId][_receiveTokens].shares;\n\n562: uint256 pureCollateral = pureCollateralAmount[_nftId][_receiveTokens];\n\n592: if (userLendingData[_nftId][_receiveTokens].unCollateralized == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L562",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L552",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L561",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L592"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n175: uint256 borrowSharePrice = borrowPoolData[_poolToken].pseudoTotalBorrowAmount\n\n177: / borrowPoolData[_poolToken].totalBorrowShares;\n\n185: lendingPoolData[_poolToken].pseudoTotalPool\n\n187: / lendingPoolData[_poolToken].totalDepositShares,\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L185",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L187",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L175",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L177"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n148: _newFees[i]\n\n153: _newFees[i]\n\n158: _newFees[i]\n\n94: _poolTokens[i],\n\n152: _poolTokens[i],\n\n157: _poolTokens[i],\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L153",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L148",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L157",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L94",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L152",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L158"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n418: if (poolTokenAdded[_poolToken] == true) {\n\n400: poolTokenAdded[_poolToken] = true;\n\n426: poolTokenAdded[_poolToken] = true;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L426",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L400",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L418"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n449: if (poolTokenAdded[_poolToken] == false) {\n\n476: poolTokenAdded[_poolToken] = false;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L449",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L476"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n348: uint256 reduceUSD = usdEquivalent < incentiveUSD[_incentiveOwner]\n\n350: : incentiveUSD[_incentiveOwner];\n\n354: incentiveUSD[_incentiveOwner] -= usdEquivalent;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L348",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L350",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L354"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n81: uint256 totalDebtBalancer = _flashloanAmounts[0]\n\n111: _flashloanAmounts[0] + initialAmount,\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L81",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L111"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n575: address paybackToken = isAave[_nftId] == true\n\n584: uint256 cutoffShares = isAave[_nftId] == true\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L584",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L575"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n227: if (reservedKeys[msg.sender] == _keyId) {\n\n228: reservedKeys[msg.sender] = 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L227-L228"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n262: farmingKeys[_keyId],\n\n268: farmingKeys[_keyId],\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L268",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L262"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n71: if (childInfo.reservedForCompound[index] < _rewardAmount) {\n\n83: childInfo.reservedForCompound[index] -= _rewardAmount;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L71",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n220: if (pendleChildAddress[_pendleMarket] > ZERO_ADDRESS) {\n\n231: pendleChildAddress[_pendleMarket] = pendleChild;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L220",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L231"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n238: rewardTokens[i],\n\n248: rewardTokens[i],\n\n255: if (lastIndex[i] == 0 && index > 0) {\n\n256: rewardsOutsideArray[i] = 0;\n\n267: rewardsOutsideArray[i] = 0;\n\n266: if (index == lastIndex[i]) {\n\n275: - lastIndex[i];\n\n283: rewardsOutsideArray[i] = scaleNecessary\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L275",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L266",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L267",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L256",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L255",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L248",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L238",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L283"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n84: if (reservedKeys[_userAddress] > 0) {\n\n90: reservedKeys[_userAddress] = keyId;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L90",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L84"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n141: tokenIds[i] = tokenOfOwnerByIndex(\n\n152: tokenIds[i] = reservedId;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L141",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L152"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n19: if (priceFeed[_tokenAddress] > ZERO_FEED) {\n\n23: priceFeed[_tokenAddress] = _priceFeedAddress;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L19",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L23"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n41: if (tokenAggregatorFromTokenAddress[_tokenAddress] > ZERO_AGGREGATOR) {\n\n154: if (tokenAggregatorFromTokenAddress[_tokenAddress] > ZERO_AGGREGATOR) {\n\n57: tokenAggregatorFromTokenAddress[_tokenAddress] = tokenAggregator;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L57",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L41",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n41: if (tokenAggregatorFromTokenAddress[_tokenAddress] > ZERO_AGGREGATOR) {\n\n154: if (tokenAggregatorFromTokenAddress[_tokenAddress] > ZERO_AGGREGATOR) {\n\n156: tokenAggregatorFromTokenAddress[_tokenAddress],\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L41",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L154",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L156"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n566: if (heartBeat[_tokenAddress] == 0) {\n\n584: return upd > heartBeat[_tokenAddress];\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L566",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L584"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n269: address[2] calldata _uniPools,\n\n270: address[2] calldata _token0Array,\n\n271: address[2] calldata _token1Array,\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L269-L271"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n464: underlyingFeedTokens[_tokenAddress][i]\n\n468: underlyingFeedTokens[_tokenAddress][i]\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L464",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L468"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n150: curveSwapInfoData[_poolToken] = _curveSwapStructData;\n\n153: address curvePool = curveSwapInfoData[_poolToken].curvePool;\n\n199: address curvePool = curveSwapInfoData[_poolToken].curvePool;\n\n168: address curveMetaPool = curveSwapInfoData[_poolToken].curveMetaPool;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L150",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L153",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L199",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L168"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n153: address curvePool = curveSwapInfoData[_poolToken].curvePool;\n\n199: address curvePool = curveSwapInfoData[_poolToken].curvePool;\n\n209: curveSwapInfoData[_poolToken].swapBytesPool\n\n216: address curveMeta = curveSwapInfoData[_poolToken].curveMetaPool;\n\n226: curveSwapInfoData[_poolToken].swapBytesMeta\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L153",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L199",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L209",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L216",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L226"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n670: if (aaveTokenAddress[_underlyingAsset] > ZERO_ADDRESS) {\n\n674: aaveTokenAddress[_underlyingAsset] = _aaveToken;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L674",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L670"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Multiple Address Mappings Can Be Combined Into A Single Mapping Of An Address To A Struct, Where Appropriate",
      "description": "Saves a storage slot for the mapping. Depending on the circumstances and sizes of types, can avoid a Gsset (20000 gas) per mapping combined. Reads and subsequent writes can also be cheaper when a function requires both values and they both fit in the same storage slot.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n20: mapping(address => uint256) public reserved;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L20"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n21: mapping(address => bool) public reserveRole;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n267: mapping(address => uint256) internal bufferIncrease;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L267"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n268: mapping(address => uint256) public maxDepositValueToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L268"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n273: mapping(uint256 => mapping(address => uint256)) public userBorrowShares;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L273"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n274: mapping(uint256 => mapping(address => uint256)) public pureCollateralAmount;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L274"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n275: mapping(uint256 => mapping(address => LendingEntry)) public userLendingData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L275"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n278: mapping(address => BorrowRatesEntry) public borrowRatesData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L278"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n279: mapping(address => AlgorithmEntry) public algorithmData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L279"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n280: mapping(address => GlobalPoolEntry) public globalPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L280"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n281: mapping(address => LendingPoolEntry) public lendingPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L281"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n282: mapping(address => BorrowPoolEntry) public borrowPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L282"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n283: mapping(address => TimestampsPoolEntry) public timestampsPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L283"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n287: mapping(address => bool) internal parametersLocked;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n288: mapping(address => bool) public verifiedIsolationPool;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n372: mapping(uint256 => mapping(address => uint256)) storage userMapping,\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L372"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n383: mapping(uint256 => mapping(address => uint256)) storage userMapping,\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L383"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n143: mapping(address => uint256) public feeTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L143"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n146: mapping(address => uint256) public incentiveUSD;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n149: mapping(address => bool) public poolTokenAdded;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n152: mapping(address => bool) public isAaveToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n155: mapping(address => address) public underlyingToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L155"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n158: mapping(address => mapping(address => bool)) public allowedTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n161: mapping(address => mapping(address => uint256)) public gatheredIncentiveToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n58: mapping(address => address) public pendleChildAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n59: mapping(address => CompoundStruct) pendleChildCompoundInfo;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L59"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n139: mapping(address => uint8) _tokenDecimals;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L139"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n142: mapping(address => IPriceFeed) public priceFeed;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L142"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n145: mapping(address => uint256) public heartBeat;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L145"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n148: mapping(address => IAggregator) public tokenAggregatorFromTokenAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L148"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n151: mapping(address => address[]) public underlyingFeedTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L151"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n154: mapping(address => UniTwapPoolInfo) public uniTwapPoolInfo;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n157: mapping(address => DerivativePartnerInfo) public derivativePartnerTwap;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L157"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n238: mapping(address => bool) public wasBlacklisted;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n241: mapping(address => CurveSwapStructData) public curveSwapInfoData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L241"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n244: mapping(address => CurveSwapStructToken) public curveSwapInfoToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L244"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n247: mapping(address => bool) public securityWorker;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Multiplication/division By Two Should Use Bit Shifting",
      "description": "<x> * 2 is equivalent to <x> << 1 and <x> / 2 is the same as <x> >> 1. The MUL and DIV opcodes cost 5 gas, whereas SHL and SHR only cost 3 gas",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n285: return PRECISION_FACTOR_E18 / 2\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L285"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n312: return (_maxPole + _minPole) / 2;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L312"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use shift Left instead of multiplication if possible to save gas",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n113: : _tokenAmount\n                * 10 ** (_decimalsETH - tokenDecimals)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L113"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n164: : _tokenAmount\n                * 10 ** (_decimalsETH - tokenDecimals)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L164"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n184: ? _usdValue\n                * 10 ** (tokenDecimals - _decimalsETH)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L184"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n186: * 10 ** decimals(_tokenAddress)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L186"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n188: : _usdValue\n                * 10 ** decimals(_tokenAddress)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L188"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n208: _usdValue\n                * 10 ** _decimalsUSD\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L208"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n344: ? _ethAmount\n                * 10 ** (tokenDecimals - _decimalsETH)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L344"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n346: * 10 ** decimals(_tokenAddress)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L346"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n348: : _ethAmount\n                * 10 ** decimals(_tokenAddress)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L348"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Operator `>=`/`<=` costs less gas than operator `>`/`<`",
      "description": "The compiler uses opcodes `GT` and `ISZERO` for code that uses `>`, but only requires `LT` for `>=`. A similar behavior applies for `>`, which uses opcodes `LT` and `ISZERO`, but only requires `GT` for `<=`. It can [save **3 gas**](https://gist.github.com/IllIllI000/3dc79d25acccfa16dee4e83ffdc6ffde) for each.\nIt should be converted to the `<=`/`>=` equivalent when comparing against integer literals.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n328: if (difference > allowedDifference) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L328"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n428: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L428"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n481: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L481"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n512: if (bareIncrease < PRECISION_FACTOR_YEAR) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L512"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n637: if (userTokenData[_nftId].length > MAX_TOTAL_TOKEN_NUMBER) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L637"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n693: while (i < length) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L693"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n995: return _shareValue < THRESHOLD_RESET_RESONANCE_FACTOR\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L995"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1051: _shareValues < THRESHOLD_SWITCH_DIRECTION\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1051"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n108: if (_maximumDeposit > 0) {\n\n112: if (_collateralFactor > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L108",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L112"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n268: if (fetchBalance > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L268"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n77: if (feeManager > ZERO_ADDRESS) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L77"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n203: if (nftId > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L203"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n288: if (reservedId > 0) {\n\n298: while (i < ownerTokenCount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L298",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L288"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n564: if (pureCollateral > 0 && userShares > 0) {\n\n572: if (potentialPureExtraCashout > 0 && potentialPureExtraCashout <= pureCollateral) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L572",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L564"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1122: if (msg.value > maxPaybackAmount) {\n\n1147: if (refundAmount > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1147",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1122"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n32: if (_parameterValue > _parameterLimit) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n464: if (_value > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L464"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n92: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L92"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n145: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L145"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n257: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L257"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n453: while (i < len) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L453"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n548: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L548"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n581: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L581"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n609: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L609"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n697: if (totalBadDebtETH > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L697"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n904: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L904"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n25: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n57: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n151: if (currentBorrowETH < currentCollateralBareETH) {\n\n179: newBadDebt > currentBadDebt\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L151",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L179"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n389: if (_value < PRECISION_FACTOR_E16) {\n\n393: if (_value > PRECISION_FACTOR_E18) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L389",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L393"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n194: if (_leverage > MAX_LEVERAGE) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L194"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n107: if (initialAmount > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L107"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n211: if (ethValueAfter < ethValueBefore) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L211"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n504: if (ethValueAfter < ethValueBefore) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L504"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n592: if (_shareAmountToPay > cutoffShares) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L592"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n103: if (positionBorrowShares > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L103"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n122: if (positionBorrowSharesAave > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n186: if (borrowShares > 0) {\n\n198: if (borrowSharesAave > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L186",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L198"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n301: if (_leverage < PRECISION_FACTOR_E18) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L301"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n359: if (totalPool > pseudoPool) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L359"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n194: if (balance < totalAssets + 1) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L194"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n258: while (i < rewardTokensLength) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L258"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n388: if (_amount > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L388"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n511: while (i < length) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L511"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n555: while (i < length) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L555"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n628: while (i < len) {\n\n635: if (weightSum > PRECISION_FACTOR_E18) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L628",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L635"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n278: while (i < length) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L278"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n20: while (i < len) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L20"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n85: if (sendingValue < PRECISION_FACTOR_E10) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L85"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n107: if (sharePricenNow < _sharePriceBefore) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L107"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n127: if (_sharePriceNow > maximum) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L127"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n204: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L204"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n236: while (i < l) {\n\n242: if (userReward.accrued > 0) {\n\n255: if (lastIndex[i] == 0 && index > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L242",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L255",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L236"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n352: if (storageMarket.observationCardinalityNext < MAX_CARDINALITY) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L352"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n399: if (totalLpAssetsToDistribute < ONE_WEEK) {\n\n409: if (additonalAssets > totalLpAssetsToDistribute) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L399",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L409"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n598: if (_newFee > MAX_MINT_FEE) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L598"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n619: if (_shares > balanceOf(msg.sender)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L619"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n663: if (shares > balanceOf(msg.sender)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L663"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n130: if (reservedId > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L130"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n37: && token.code.length > 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L37"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n18: if (address(this).balance < _amount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n53: if (uniTwapPoolInfoStruct.oracle > ZERO_ADDRESS) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n97: if (_answer > maxAnswer || _answer < minAnswer) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L97"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n144: if (uniTwapPoolInfoStruct.oracle > ZERO_ADDRESS) {\n\n161: if (fetchTwapValue > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n224: if (_answerUint256 > _fetchTwapValue) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L224"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n241: if (_relativeDifference > ALLOWED_DIFFERENCE) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L241"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n365: if (uniTwapPoolInfo[_tokenAddress].oracle > ZERO_ADDRESS) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L365"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n439: if (tickCumulativesDelta < 0 && (tickCumulativesDelta % twapPeriodInt56 != 0)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L439"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n584: return upd > heartBeat[_tokenAddress];\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L584"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n612: if (iterationCount < MIN_ITERATION_COUNT) {\n\n625: while (i < iterationCount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L612",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L625"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n108: return _decimalsETH < tokenDecimals\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n159: return _decimalsETH < tokenDecimals\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L159"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n183: return _decimalsETH < tokenDecimals\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L183"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n295: while (i < length) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L295"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n343: return _decimalsETH < tokenDecimals\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L343"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n390: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L390"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n461: while (i < length) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L461"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n509: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L509"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n419: if (totalBorrow < bareCollateral) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L419"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n464: while (i < len) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L464"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n521: while (i < len) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L521"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n580: while (i < lenBorrow) {\n\n602: while (i < lenDeposit) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L602",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L580"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n660: while (i < len) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L660"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n709: while (i < lenDeposit) {\n\n734: while (i < lenBorrow) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L709",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L734"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n788: if (expectedMaxAmount > maxAmountPool) {\n\n804: if (possibelWithdraw > expectedMaxAmount) {\n\n814: if (withdrawAmount > maxAmountPool) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L788",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L814",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L804"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n856: if (tokenAmount > maxSolelyAmount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L856"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n896: if (tokenAmount > maxPoolAmount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L896"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n126: if (_baseReward > LIQUIDATION_INCENTIVE_MAX) {\n\n130: if (_baseReward < LIQUIDATION_INCENTIVE_MIN) {\n\n136: if (_baseRewardFarm > LIQUIDATION_INCENTIVE_POWERFARM_MAX) {\n\n140: if (_baseRewardFarm < LIQUIDATION_INCENTIVE_MIN) {\n\n154: if (_newMaxFeeETH > maxFee) {\n\n158: if (_newMaxFeeETH < minFee) {\n\n172: if (_newMaxFeeFarmETH > maxFeeFarm) {\n\n176: if (_newMaxFeeFarmETH < minFeeFarm) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L140",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L136",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L130",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L126",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L176",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L158",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L172",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n32: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n79: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L79"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n121: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L121"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n160: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L160"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n372: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L372"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n408: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L408"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n444: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L444"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n501: while (i < l) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L501"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n749: return feeETH < _maxFeeETH\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L749"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n866: if (_borrowETHTotal < _weightedCollateralETH) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L866"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1065: while(i < len) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1065"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n202: if (address(this).balance < _amount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L202"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n230: if (_ethSent > _maxPaybackAmount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L230"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n537: if (ethRefundAmount > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L537"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Optimize names to save gas",
      "description": "Contracts most called functions could simply save gas by function ordering via Method ID. Calling a function at runtime will be cheaper if the function is positioned earlier in the order (has a relatively lower Method ID) because 22 gas are added to the cost of a function for every position that came before it. The caller can save on gas if you prioritize most called functions. \n\nSee more <a href=\"https://medium.com/joyso/solidity-how-does-function-name-affect-gas-consumption-in-smart-contract-47d270d8ac92\">here</a>",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "All in-scope contracts",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "+ <y>` For State Variables",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n591: userLendingData[_nftId][_poolToken].shares += _shares;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L591"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n606: userLendingData[_nftId][_poolToken].shares -= _shares;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L606"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n230: globalPoolData[_poolToken].totalPool += _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L230"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n239: globalPoolData[_poolToken].totalPool -= _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L239"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n248: lendingPoolData[_poolToken].totalDepositShares += _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L248"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n257: lendingPoolData[_poolToken].totalDepositShares -= _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L257"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n266: borrowPoolData[_poolToken].pseudoTotalBorrowAmount += _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L266"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n275: borrowPoolData[_poolToken].pseudoTotalBorrowAmount -= _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L275"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n284: borrowPoolData[_poolToken].totalBorrowShares += _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L284"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n293: borrowPoolData[_poolToken].totalBorrowShares -= _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L293"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n302: lendingPoolData[_poolToken].pseudoTotalPool += _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L302"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n311: lendingPoolData[_poolToken].pseudoTotalPool -= _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L311"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n338: globalPoolData[_poolToken].totalBareToken += _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L338"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n347: globalPoolData[_poolToken].totalBareToken -= _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L347"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n379: userMapping[_nftId][_poolToken] -= _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L379"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n390: userMapping[_nftId][_poolToken] += _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L390"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n220: incentiveUSD[incentiveOwnerA] += _value;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L220"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n238: incentiveUSD[incentiveOwnerB] += _value;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L238"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n94: totalBadDebtETH += _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L94"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n110: totalBadDebtETH -= _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L110"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n201: feeTokens[_feeToken] += _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L201"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n214: feeTokens[_feeToken] -= _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L214"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n354: incentiveUSD[_incentiveOwner] -= usdEquivalent;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L354"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n358: _underlyingToken] += incentiveAmount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L358"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n83: childInfo.reservedForCompound[index] -= _rewardAmount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n140: reservedPendleForLocking += tokenAmountSend;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L140"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n418: reservedPendleForLocking -= _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L418"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n512: childInfo.reservedForCompound[i] += _amounts[i];\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L512"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n630: weightSum += _weights[i];\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L630"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n343: underlyingLpAssetsCurrent += additonalAssets;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L343"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n344: totalLpAssetsToDistribute -= additonalAssets;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L344"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n512: totalLpAssetsToDistribute += _amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L512"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n577: underlyingLpAssetsCurrent += _underlyingLpAssetAmount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L577"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n628: underlyingLpAssetsCurrent -= tokenAmount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L628"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n672: underlyingLpAssetsCurrent -= _underlyingLpAssetAmount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L672"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n484: overallETH += ethValue;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L484"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n541: overallETH += ethValue;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L541"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n614: totalETHSupply += ethValue;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L614"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n48: unweightedAmount += amount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L48"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Structs can be packed into fewer storage slots by editing time variables",
      "description": "The following structs contain time variables that are unlikely to ever reach max `uint256` then it is possible to set them as `uint32`, saving gas slots. Max value of `uint32` is equal to Year 2016, which is more than enough.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n232: struct TimestampsPoolEntry {\n        uint256 timeStamp;\n        uint256 timeStampScaling;\n        uint256 initialTimeStamp;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L232"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Using `private` rather than `public` for constants, saves gas",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n18: uint256 public immutable FEE_MANAGER_NFT;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n165: address public immutable WETH_ADDRESS;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L165"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n180: IPositionNFTs public immutable POSITION_NFT;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L180"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n183: IWiseOracleHub public immutable WISE_ORACLE;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L183"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n58: address public immutable PENDLE_MARKET_ADDRESS;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n59: IPendleMarket public immutable PENDLE_MARKET;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L59"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n62: IPendleSy public immutable PENDLE_SY;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L62"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n63: IPriceFeed public immutable FEED_ASSET;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L63"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n64: IOraclePendle public immutable ORACLE_PENDLE_PT;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L64"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n73: uint32 public immutable TWAP_DURATION;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n50: IPriceFeed public immutable USD_FEED_ASSET;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n53: IPriceFeed public immutable ETH_FEED_ASSET;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n56: IOraclePendle public immutable ORACLE_PENDLE_PT;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L56"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n59: uint256 public immutable POW_USD_FEED;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L59"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n62: uint256 public immutable POW_ETH_USD_FEED;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L62"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n71: uint32 public immutable TWAP_DURATION;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L71"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n44: address public immutable PENDLE_MARKET_ADDRESS;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n47: IPriceFeed public immutable FEED_ASSET;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n48: IOraclePendle public immutable ORACLE_PENDLE_PT;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L48"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n57: uint32 public immutable DURATION;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n100: IAave public immutable AAVE;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L100"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n103: IWiseLending public immutable WISE_LENDING;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L103"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n106: IPositionNFTs public immutable POSITION_NFTS;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L106"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n109: IWiseSecurity public immutable WISE_SECURITY;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n112: IWiseOracleHub public immutable ORACLE_HUB;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L112"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n164: uint256 public immutable FEE_MANAGER_NFT;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L164"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n172: uint256 public constant INCENTIVE_PORTION = 5 * PRECISION_FACTOR_E15;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L172"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n54: address public immutable aaveTokenAddresses;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L54"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n55: address public immutable borrowTokenAddresses;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L55"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n57: address public immutable ENTRY_ASSET;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n58: address public immutable PENDLE_CHILD;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n66: IAave public immutable AAVE;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L66"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n67: IAaveHub public immutable AAVE_HUB;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n68: IWiseLending public immutable WISE_LENDING;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L68"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n69: IWiseOracleHub public immutable ORACLE_HUB;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L69"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n70: IWiseSecurity public immutable WISE_SECURITY;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L70"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n71: IBalancerVault public immutable BALANCER_VAULT;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L71"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n72: IPositionNFTs public immutable POSITION_NFT;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L72"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n73: IStETH public immutable ST_ETH;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n74: ICurve public immutable CURVE;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L74"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n75: IUniswapV3 public immutable UNISWAP_V3_ROUTER;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L75"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n77: IPendleSy public immutable PENDLE_SY;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L77"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n78: IPendleRouter public immutable PENDLE_ROUTER;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L78"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n79: IPendleMarket public immutable PENDLE_MARKET;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L79"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n80: IPendleRouterStatic public immutable PENDLE_ROUTER_STATIC;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L80"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n10: PendlePowerFarmTokenFactory public immutable PENDLE_POWER_FARM_TOKEN_FACTORY;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n13: address public immutable IMPLEMENTATION_TARGET;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n14: address public immutable PENDLE_POWER_FARM_CONTROLLER;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n76: address public immutable WETH_ADDRESS;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L76"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n79: address public constant SEQUENCER_ADDRESS = 0xFdB631F5EE196F0ed6FAa767959853A9F217697D;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L79"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n82: address public immutable ETH_USD_PLACEHOLDER;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L82"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n88: IPriceFeed public immutable ETH_PRICE_FEED;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L88"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n91: IPriceFeed public immutable SEQUENCER;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L91"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n94: IUniswapV3Factory public immutable UNI_V3_FACTORY;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L94"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n185: uint256 public constant BORROW_PERCENTAGE_CAP = 95 * PRECISION_FACTOR_E16;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L185"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n186: address public immutable AAVE_HUB;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L186"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n191: IFeeManager public immutable FEE_MANAGER;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L191"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n194: IWiseLending public immutable WISE_LENDING;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L194"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n197: IPositionNFTs public immutable POSITION_NFTS;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L197"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n200: IWiseOracleHub public immutable WISE_ORACLE;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L200"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n203: IWiseLiquidation public immutable WISE_LIQUIDATION;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L203"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Redundant state variable getters",
      "description": "Getters for public state variables are automatically generated so there is no need to code them manually and waste gas.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n400: return totalLpAssetsToDistribute;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L400"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "The result of a function call should be cached rather than re-calling the function",
      "description": "External calls are expensive. Results of external function calls should be cached rather than call them multiple times. Consider caching the following:",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n374: syncAllSupply();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L374"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n479: syncAllSupply();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L479"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Shorten the array rather than copying to a new one",
      "description": "When shortening an array in Solidity, it creates a new shorter array and copies the elements over. This wastes gas by duplicating\nstorage.\n\nUse inline assembly to shorten the array in place by changing its length slot, avoiding the need to copy elements to a new\narray.\n\nShortening a length-n array avoids ~n SSTORE operations to copy elements. Benchmarking shows savings of 5000-15000 gas depending\non original length.\n\n```solidity\nfunction shorten(uint[] storage array, uint newLen) internal {\n\n  assembly {\n    sstore(array_slot, newLen)\n  }\n\n}\n\n// Rather than:\nfunction shorten(uint[] storage array, uint newLen) internal {\n\n  uint[] memory newArray = new uint[](newLen);\n\n  for(uint i = 0; i < newLen; i++) {\n    newArray[i] = array[i];\n  }\n\n  delete array;\n  array = newArray;\n\n}\n```\n\nUsing inline assembly allows shortening arrays without copying elements to a new storage slot, providing significant gas\nsavings.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n292: uint256[] memory tokenIds = new uint256[](\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1373: address[] memory tokens = new address[](1);\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1373"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n27: IERC20[] memory tokens = new IERC20[](1);\n\n28: uint256[] memory amount = new uint256[](1);\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L27-L28"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n231: uint256[] memory rewardsOutsideArray = new uint256[](l);\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L231"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n134: uint256[] memory tokenIds = new uint256[](\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L134"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n413: uint32[] memory secondsAgo = new uint32[](\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L413"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "State variables can be packed into fewer storage slots",
      "description": "If variables occupying the same slot are both written the same function or by the constructor, avoids a separate Gsset (20000 gas). Reads of the variables can also be cheaper",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {\n\n    string public baseURI;\n    string public baseExtension;\n\n    address public feeManager;\n    uint256 public totalReserved;\n    uint256 public immutable FEE_MANAGER_NFT;\n\n    mapping(address => uint256) public reserved;\n    mapping(address => bool) public reserveRole;\n\n    bool public reservePublicBlocked;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n5: contract CustomOracleSetup {\n\n    address public master;\n    uint256 public lastUpdateGlobal;\n\n    uint80 public globalRoundId;\n\n    mapping(uint80 => uint256) public timeStampByRoundId;\n\n    modifier onlyOwner() {\n        require(\n            msg.sender == master,\n            \"CustomOracleSetup: NOT_MASTER\"\n        );\n        _;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {\n\n    // Pendle - LP token address\n    address public UNDERLYING_PENDLE_MARKET;\n    address public PENDLE_POWER_FARM_CONTROLLER;\n\n    // Total balance of LPs backing at current compound distribution\n    uint256 public underlyingLpAssetsCurrent;\n\n    // Lp assets from compound left to distribute\n    uint256 public totalLpAssetsToDistribute;\n\n    // Interface Object for underlying Market\n    IPendleMarket public PENDLE_MARKET;\n\n    // InterfaceObject for pendle Sy\n    IPendleSy public PENDLE_SY;\n\n    // Interface for Pendle Controller\n    IPendleController public PENDLE_CONTROLLER;\n\n    // Max cardinality of Pendle Market\n    uint16 public MAX_CARDINALITY;\n\n    uint256 public mintFee;\n    uint256 public lastInteraction;\n\n    uint256 private constant ONE_WEEK = 7 days;\n    uint256 internal constant ONE_YEAR = 365 days;\n    uint256 private constant MAX_MINT_FEE = 10000;\n\n    uint256 private constant PRECISION_FACTOR_E6 = 1E6;\n    uint256 private constant PRECISION_FACTOR_E18 = 1E18;\n    uint256 internal constant PRECISION_FACTOR_E36 = PRECISION_FACTOR_E18 * PRECISION_FACTOR_E18;\n    uint256 internal constant PRECISION_FACTOR_YEAR = PRECISION_FACTOR_E18 * ONE_YEAR;\n\n    uint256 private INITIAL_TIME_STAMP;\n\n    uint256 internal constant RESTRICTION_FACTOR = 10\n        * PRECISION_FACTOR_E36\n        / PRECISION_FACTOR_YEAR;\n\n    modifier onlyController() {\n        _onlyController();\n        _;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {\n\n    IAave internal immutable AAVE;\n\n    bool public sendingProgressAaveHub;\n\n    uint16 internal constant REF_CODE = 0;\n\n    IWiseLending immutable public WISE_LENDING;\n    IPositionNFTs immutable public POSITION_NFT;\n\n    IWiseSecurity public WISE_SECURITY;\n\n    address immutable public WETH_ADDRESS;\n    address immutable public AAVE_ADDRESS;\n\n    uint256 internal constant PRECISION_FACTOR_E9 = 1E9;\n    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;\n    uint256 internal constant MAX_AMOUNT = type(uint256).max;\n\n    mapping(address => address) public aaveTokenAddress;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "State variables that are used multiple times in a function should be cached in stack variables",
      "description": "When performing multiple operations on a state variable in a function, it is recommended to cache it first. Either multiple reads or multiple writes to a state variable can save gas by caching it on the stack.\nCaching of a state variable replaces each Gwarmaccess (100 gas) with a much cheaper stack read. Other less obvious fixes/optimizations include having local memory caches of state variable structs, or having local caches of state variable contracts/addresses.\n*Saves 100 gas per instance*.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n/// @audit Affected state variables: feeManager\n\n72: function forwardFeeManagerNFT(\n        address _feeManagerContract\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L72"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n/// @audit Affected state variables: WISE_SECURITY\n\n141: function setSecurity(\n        address _wiseSecurity\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n/// @audit Affected state variables: pendleChildToken\n\n35: function latestAnswer()\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n/// @audit Affected state variables: totalLpAssetsToDistribute\n\n386: function previewDistribution()\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L386"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n/// @audit Affected state variables: underlyingLpAssetsCurrent\n\n479: function previewBurnShares(\n        uint256 _underlyingAssetAmount,\n        uint256 _underlyingLpAssetsCurrent\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L479"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n/// @audit Affected state variables: PENDLE_POWER_FARM_CONTROLLER\n\n530: function depositExactAmount(\n        uint256 _underlyingLpAssetAmount\n    )\n        external\n        syncSupply\n        returns (\n            uint256,\n            uint256\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L530"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n/// @audit Affected state variables: PENDLE_MARKET\n\n683: function initialize(\n        address _underlyingPendleMarket,\n        address _pendleController,\n        string memory _tokenName,\n        string memory _symbolName,\n        uint16 _maxCardinality\n    )\n        external\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L683"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n/// @audit Affected state variables: farmContract\n\n52: function setFarmContract(\n        address _farmContract\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Structs can be packed into fewer storage slots",
      "description": "Each slot saved can avoid an extra Gsset (20000 gas) for the first setting of the struct. Subsequent reads as well as writes have smaller gas savings",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n238: struct CoreLiquidationStruct {\n        uint256 nftId;\n        uint256 nftIdLiquidator;\n        address caller;\n        address tokenToPayback;\n        address tokenToRecieve;\n        uint256 paybackAmount;\n        uint256 shareAmountToPay;\n        uint256 maxFeeETH;\n        uint256 baseRewardLiquidation;\n        address[] lendTokens;\n        address[] borrowTokens;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L238"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Superfluous event fields",
      "description": "`block.number` and `block.timestamp` are added to the event information by default, so adding them manually will waste additional gas.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n35: event FundsDeposited(\n        address indexed sender,\n        uint256 indexed nftId,\n        address indexed token,\n        uint256 amount,\n        uint256 shares,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n44: event FundsSolelyDeposited(\n        address indexed sender,\n        uint256 indexed nftId,\n        address indexed token,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n52: event FundsWithdrawn(\n        address indexed sender,\n        uint256 indexed nftId,\n        address indexed token,\n        uint256 amount,\n        uint256 shares,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n61: event FundsWithdrawnOnBehalf(\n        address indexed sender,\n        uint256 indexed nftId,\n        address indexed token,\n        uint256 amount,\n        uint256 shares,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L61"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n70: event FundsSolelyWithdrawn(\n        address indexed sender,\n        uint256 indexed nftId,\n        address indexed token,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L70"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n78: event FundsBorrowed(\n        address indexed borrower,\n        uint256 indexed nftId,\n        address indexed token,\n        uint256 amount,\n        uint256 shares,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L78"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n87: event FundsBorrowedOnBehalf(\n        address indexed sender,\n        uint256 indexed nftId,\n        address indexed token,\n        uint256 amount,\n        uint256 shares,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L87"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n96: event FundsReturned(\n        address indexed sender,\n        address indexed token,\n        uint256 indexed nftId,\n        uint256 totalPayment,\n        uint256 totalPaymentShares,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L96"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n7: event ClaimedFeesWiseBulk(\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n11: event PoolTokenRemoved(\n        address indexed poolToken,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n16: event PoolTokenAdded(\n        address indexed poolToken,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L16"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n21: event IncentiveOwnerBChanged(\n        address indexed newIncentiveOwnerB,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n26: event IncentiveOwnerAChanged(\n        address indexed newIncentiveOwnerA,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n31: event ClaimedOwnershipIncentiveMaster(\n        address indexed newIncentiveMaster,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n36: event IncentiveMasterProposed(\n        address indexed proposedIncentiveMaster,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L36"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n41: event PoolFeeChanged(\n        address indexed poolToken,\n        uint256 indexed newPoolFee,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L41"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n47: event ClaimedIncentives(\n        address indexed sender,\n        address indexed token,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n54: event ClaimedIncentivesBulk(\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L54"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n58: event IncentiveIncreasedB(\n        uint256 indexed amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n63: event IncentiveIncreasedA(\n        uint256 indexed amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L63"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n68: event BadDebtIncreasedLiquidation(\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L68"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n73: event TotalBadDebtIncreased(\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n78: event TotalBadDebtDecreased(\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L78"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n83: event SetBadDebtPosition(\n        uint256 indexed nftId,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n89: event UpdateBadDebtPosition(\n        uint256 indexed nftId,\n        uint256 newAmount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L89"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n95: event SetBeneficial(\n        address indexed user,\n        address[] token,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L95"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n101: event RevokeBeneficial(\n        address indexed user,\n        address[] token,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L101"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n107: event ClaimedFeesWise(\n        address indexed token,\n        uint256 indexed amount,\n        uint256 indexed timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L107"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n113: event ClaimedFeesBeneficial(\n        address indexed user,\n        address indexed token,\n        uint256 amount,\n        uint256 indexed timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L113"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n120: event PayedBackBadDebt(\n        uint256 indexed nftId,\n        address indexed sender,\n        address indexed paybackToken,\n        address receivingToken,\n        uint256 paybackAmount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L120"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n129: event PayedBackBadDebtFree(\n        uint256 indexed nftId,\n        address indexed sender,\n        address indexed paybackToken,\n        uint256  paybackAmount,\n        uint256 timestampp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L129"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n110: event FarmEntry(\n        uint256 indexed keyId,\n        uint256 indexed wiseLendingNFT,\n        uint256 indexed leverage,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L110"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n118: event FarmExit(\n        uint256 indexed keyId,\n        uint256 indexed wiseLendingNFT,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L118"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n125: event FarmStatus(\n        bool indexed state,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n130: event ManualPaybackShares(\n        uint256 indexed keyId,\n        uint256 indexed wiseLendingNFT,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L130"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n137: event ManualWithdrawShares(\n        uint256 indexed keyId,\n        uint256 indexed wiseLendingNFT,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L137"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n144: event MinDepositChange(\n        uint256 minDepositEthAmount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L144"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n154: event RegistrationFarm(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n157: event ExchangeLpFeesForPendle(\n        address indexed _pendleMarket,\n        uint256 _pendleChildShares,\n        uint256 _tokenAmountSend,\n        uint256 _withdrawnAmount\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L157"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n179: event LockPendle(\n        uint256 _amount,\n        uint128 _expiry,\n        uint256 _newVeBalance,\n        bool _fromInside,\n        bool _sameExpiry,\n        uint256 _timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L179"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n188: event ClaimArb(\n        uint256 _accrued,\n        bytes32[] _proof,\n        uint256 _timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L188"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n194: event IncreaseReservedForCompound(\n        address indexed _pendleMarket,\n        uint256[] _amounts\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L194"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n199: event ClaimVoteRewards(\n        uint256 _amount,\n        bytes32[] _merkleProof,\n        uint256 _timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L199"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n205: event WithdrawLock(\n        uint256 _amount,\n        uint256 _timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L205"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n47: event SecurityShutdown(\n        address indexed caller,\n        uint256 indexed timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n7: event SetAaveTokenAddress(\n        address underlyingAsset,\n        address aaveToken,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n13: event IsDepositAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n18: event IsWithdrawAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n23: event IsBorrowAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L23"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n28: event IsPaybackAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L28"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n33: event IsSolelyDepositAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n38: event IsSolelyWithdrawAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Usage of `uints`/`ints` smaller than 32 bytes (256 bits) incurs overhead",
      "description": "When using elements that are smaller than 32 bytes, your contract's gas usage may be higher. This is because the EVM operates on 32 bytes at a time. Therefore, if the element is smaller than that, the EVM must use more operations in order to reduce the size of the element from 32 bytes to the desired size.\n\nhttps://docs.soliditylang.org/en/v0.8.23/internals/layout_in_storage.html\nEach operation involving a `uint8` costs an extra 22-28 gas (depending on whether the other operand is also a variable of type `uint8`) as compared to ones involving `uint256`, due to the compiler having to clear the higher bits of the memory word before operating on the `uint8`, as well as the associated stack operations of doing so. Use a larger size then downcast where needed",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n690: uint8 i;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L690"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n10: uint80 public globalRoundId;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n73: uint32 public immutable TWAP_DURATION;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n71: uint32 public immutable TWAP_DURATION;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L71"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n57: uint32 public immutable DURATION;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n37: uint128[] lastIndex;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L37"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n47: uint16 public MAX_CARDINALITY;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n234: uint128 index;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L234"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n85: uint8 internal immutable _decimalsWETH;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L85"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "`unchecked {}` can be used on the division of two `uints` in order to save gas",
      "description": "Make such found divisions are unchecked when ensured it is safe to do so.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n472: uint256 cashoutShares = product / PRECISION_FACTOR_E18 + 1;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L472"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "`++i`/`i++` Should Be `unchecked{++i}`/`unchecked{i++}` When It Is Not Possible For Them To Overflow, As Is The Case When Used In For- And While-loops",
      "description": "The unchecked keyword is new in solidity version 0.8.0, so this only applies to that version or higher, which these instances are. This saves 30-40 gas PER LOOP",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n71: function setAaveTokenAddressBulk(\n        address[] calldata _underlyingAssets,\n        address[] calldata _aaveTokens\n    )\n        external\n        onlyMaster\n    {\n        for (uint256 i = 0; i < _underlyingAssets.length; i++) {\n            _setAaveTokenAddress(\n                _underlyingAssets[i],\n                _aaveTokens[i]\n            );\n        }\n    }\n\n    \n    receive()\n        external\n        payable\n    {\n        if (msg.sender == WETH_ADDRESS) {\n            return;\n        }\n\n        _sendValue(\n            master,\n            msg.value\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Add `unchecked /{/}` for subtractions where the operands cannot underflow",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n44: : _product / _pseudo - 1;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n103: / lendingPoolData[_poolToken].totalDepositShares - 1;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L103"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n552: / (lendingPoolData[_poolToken].pseudoTotalPool - feeAmount);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L552"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n691: uint256 endPosition = length - 1;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L691"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n860: * (pole - utilization);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L860"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n301: return (_maxPole - _minPole) / NORMALISATION_FACTOR;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L301"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n446: uint256 lastEntry = len - 1;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L446"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n180: ? _increaseTotalBadDebt(newBadDebt - currentBadDebt)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L180"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n181: : _decreaseTotalBadDebt(currentBadDebt - newBadDebt);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L181"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n322: return _amount - reduceAmount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L322"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n325: * (_leverage - PRECISION_FACTOR_E18)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L325"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n332: : leveragedNegativeAPY - leveragedPositivAPY;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L332"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n364: * (totalPool - _borrowAmount)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L364"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n377: * (pole - newUtilization);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L377"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n82: * (PRECISION_FACTOR_E6 - exchangeIncentive)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L82"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n407: * (block.timestamp - lastInteraction);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L407"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n430: * (PRECISION_FACTOR_E6 - mintFee)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L430"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n582: : block.timestamp - upd;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L582"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n112: / 10 ** (tokenDecimals - _decimalsETH)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L112"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n114: * 10 ** (_decimalsETH - tokenDecimals)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L114"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n163: / 10 ** (tokenDecimals - _decimalsETH)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L163"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n165: * 10 ** (_decimalsETH - tokenDecimals)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L165"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n185: * 10 ** (tokenDecimals - _decimalsETH)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L185"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n191: / 10 ** (_decimalsETH - tokenDecimals);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L191"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n345: * 10 ** (tokenDecimals - _decimalsETH)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L345"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n351: / 10 ** (_decimalsETH - tokenDecimals);\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L351"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n625: netAPY = (ethValueGain - ethValueDebt)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L625"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n631: netAPY = (ethValueDebt - ethValueGain)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L631"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n812: withdrawAmount = withdrawAmount - _solelyWithdrawAmount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L812"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n848: tokenAmount = tokenAmount - _poolWithdrawAmount;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L848"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n659: * (PRECISION_FACTOR_E18 - utilization)\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L659"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use assembly to check for `address(0)`",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n691: if (address(PENDLE_MARKET) != address(0)) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L691"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use assembly in place of abi.decode to extract calldata values more efficiently",
      "description": "Instead of using `abi.decode` we can use assembly to decode our desired `calldata` values directly. This will allow us to avoid decoding `calldata` values that we will not use. we can use assembly to decode our desired `calldata` values directly. This will allow us to avoid decoding `calldata` values that we will not use",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n93: ) = abi.decode(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L93"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n26: bool results = returndata.length == 0 || abi.decode(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L26"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use assembly to validate `msg.sender`",
      "description": "We can use assembly to efficiently validate msg.sender with the least amount of opcodes necessary. ",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n25: if (msg.sender == master) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n41: if (msg.sender == proposedMaster) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L41"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n261: if (msg.sender != AAVE_HUB_ADDRESS) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L261"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n18: if (msg.sender == address(FEE_MANAGER)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n195: if (msg.sender == incentiveMaster) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L195"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n206: if (msg.sender == address(WISE_SECURITY)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L206"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n217: if (msg.sender == address(WISE_LENDING)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L217"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n197: if (msg.sender != proposedIncentiveMaster) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L197"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n320: if (msg.sender != incentiveOwnerA) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L320"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n357: if (msg.sender != incentiveOwnerB) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L357"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n77: if (msg.sender != BALANCER_ADDRESS) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L77"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n251: if (msg.sender != pendleChildAddress[_pendleMarket]) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L251"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n76: if (msg.sender != PENDLE_POWER_FARM_CONTROLLER) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L76"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n514: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L514"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n635: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L635"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n44: if (msg.sender != PENDLE_POWER_FARM_CONTROLLER) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n35: if (msg.sender == address(WISE_LENDING)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n87: if (msg.sender == WETH_ADDRESS) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L87"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use do while loops instead of for loops",
      "description": "A do while loop will cost less gas since the condition is not being checked for the first iteration.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n109: function walletOfOwner\n\nfor (i; i < ownerTokenCount;) {\n            tokenIds[i] = tokenOfOwnerByIndex(\n                _owner,\n                i\n            );\n\n            unchecked {\n                ++i;\n            }\nfor (i; i < ownerTokenCount;) {\n            tokenIds[i] = tokenOfOwnerByIndex(\n                _owner,\n                i\n            );\n\n            unchecked {\n                ++i;\n            }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L109-L110"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n243: function _prepareCollaterals\n\nfor (i; i < l;) {\n\n            address currentAddress = WISE_LENDING.getPositionLendingTokenByIndex(\n                _nftId,\n                i\n            );\n\n            unchecked {\n                ++i;\n            }\nfor (i; i < l;) {\n\n            address currentAddress = WISE_LENDING.getPositionLendingTokenByIndex(\n                _nftId,\n                i\n            );\n\n            unchecked {\n                ++i;\n            }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L243-L244"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n279: function _prepareBorrows\n\nfor (i; i < l;) {\n\n            address currentAddress = WISE_LENDING.getPositionBorrowTokenByIndex(\n                _nftId,\n                i\n            );\n\n            unchecked {\n                ++i;\n            }\nfor (i; i < l;) {\n\n            address currentAddress = WISE_LENDING.getPositionBorrowTokenByIndex(\n                _nftId,\n                i\n            );\n\n            unchecked {\n                ++i;\n            }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L279-L280"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n64: function setAaveTokenAddressBulk\n\nfor (uint256 i = 0; i < _underlyingAssets.length; i++) {\n            _setAaveTokenAddress(\n                _underlyingAssets[i],\n                _aaveTokens[i]\n            );\n        }\nfor (uint256 i = 0; i < _underlyingAssets.length; i++) {\n            _setAaveTokenAddress(\n                _underlyingAssets[i],\n                _aaveTokens[i]\n            );\n        }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L64-L65"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use `!= 0` or `== 0` for unsigned integer comparison",
      "description": "For uint comparison in `require()` statements prior to solidity 0.8.13, it is cheaper to use `!= 0` or `== 0` instead of `> 0` or `<= 0` for unsigned integer comparison in.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n108: if (_maximumDeposit > 0) {\n\n112: if (_collateralFactor > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L112",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n268: if (fetchBalance > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L268"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n203: if (nftId > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L203"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n288: if (reservedId > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L288"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n564: if (pureCollateral > 0 && userShares > 0) {\n\n572: if (potentialPureExtraCashout > 0 && potentialPureExtraCashout <= pureCollateral) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L564",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L572"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1147: if (refundAmount > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1147"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n464: if (_value > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L464"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n697: if (totalBadDebtETH > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L697"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n107: if (initialAmount > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L107"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n103: if (positionBorrowShares > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L103"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n122: if (positionBorrowSharesAave > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n186: if (borrowShares > 0) {\n\n198: if (borrowSharesAave > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L186",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L198"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n388: if (_amount > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L388"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n242: if (userReward.accrued > 0) {\n\n255: if (lastIndex[i] == 0 && index > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L255",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L242"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n130: if (reservedId > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L130"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n37: && token.code.length > 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L37"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n161: if (fetchTwapValue > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n439: if (tickCumulativesDelta < 0 && (tickCumulativesDelta % twapPeriodInt56 != 0)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L439"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n537: if (ethRefundAmount > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L537"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "A modifier used only once and not being inherited should be inlined to save gas",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n34: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n110: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L110"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n25: CustomOracleSetup()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n41: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L41"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n170: WrapperHelper(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n43: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n86: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n46: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L46"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n57: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n48: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L48"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use v5.0.0 OpenZeppelin contracts",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: package.json\n\n        \"@openzeppelin/contracts\": \"^4.9.3\"\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/package.json#L82"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use mappings instead of arrays",
      "description": "Arrays are useful when you need to maintain an ordered list of data that can be iterated over, but they have a higher gas cost for read and write operations, especially when the size of the array is large. This is because Solidity needs to iterate over the entire array to perform certain operations, such as finding a specific element or deleting an element. Mappings, on the other hand, are useful when you need to store and access data based on a key, rather than an index. Mappings have a lower gas cost for read and write operations, especially when the size of the mapping is large, since Solidity can perform these operations based on the key directly, without needing to iterate over the entire data structure.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n123: address[] public poolTokenAddresses;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L123"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n61: address[] public activePendleMarkets;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L61"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use nested `if` and avoid multiple check combinations",
      "description": "Using nested `if`, is cheaper than using `&&` multiple check combinations. There are more advantages, such as easier to read code and better coverage reports.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n564: if (pureCollateral > 0 && userShares > 0) {\n\n572: if (potentialPureExtraCashout > 0 && potentialPureExtraCashout <= pureCollateral) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L564",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L572"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n255: if (lastIndex[i] == 0 && index > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L255"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n315: if (_tokenAddress != _token0 && _tokenAddress != _token1) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L315"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n439: if (tickCumulativesDelta < 0 && (tickCumulativesDelta % twapPeriodInt56 != 0)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L439"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use of Custom Errors Instead of String",
      "description": "To save some gas the use of custom errors leads to cheaper deploy time cost and run time cost. The run time cost is only relevant when the revert condition is met.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n        require(\n            _exists(_tokenId) == true,\n            \"PositionNFTs: WRONG_TOKEN\"\n        );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L348"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n        require(\n            msg.sender == master,\n            \"CustomOracleSetup: NOT_MASTER\"\n        );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L15"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n        require(\n            msg.sender == farmContract,\n            \"PowerFarmsNFTs: INVALID_FARM\"\n        );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n        require(\n            _exists(_tokenId) == true,\n            \"PowerFarmsNFTs: WRONG_TOKEN\"\n        );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L31"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Use `uint256(1)`/`uint256(2)` instead for `true` and `false` boolean states",
      "description": "If you don't use boolean for storage you will avoid Gwarmaccess 100 gas. In addition, state changes of boolean from `true` to `false` can cost up to ~20000 gas rather than `uint256(2)` to `uint256(1)` that would cost significantly less.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n617: mapping(bytes32 => bool) storage hashMap,\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L617"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n631: hashMap[hashData] = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L631"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n745: ] = false;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L745"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n806: ] = false;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L806"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n21: mapping(address => bool) public reserveRole;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n68: reservePublicBlocked = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L68"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n88: powerFarmCheck = false;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L88"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n342: userLendingData[_nftId][_poolToken].unCollateralized = false;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L342"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n369: userLendingData[_nftId][_poolToken].unCollateralized = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L369"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n286: mapping(uint256 => bool) public positionLocked;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L286"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n287: mapping(address => bool) internal parametersLocked;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n288: mapping(address => bool) public verifiedIsolationPool;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n291: mapping(bytes32 => bool) internal hashMapPositionBorrow;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L291"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n292: mapping(bytes32 => bool) internal hashMapPositionLending;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n149: mapping(address => bool) public poolTokenAdded;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n152: mapping(address => bool) public isAaveToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n158: mapping(address => mapping(address => bool)) public allowedTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n400: poolTokenAdded[_poolToken] = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L400"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n426: poolTokenAdded[_poolToken] = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L426"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n464: found = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L464"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n476: poolTokenAdded[_poolToken] = false;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L476"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n236: isAaveToken[_poolToken] = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L236"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n108: mapping(uint256 => bool) public isAave;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n35: allowEnter = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n71: allowEnter = false;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L71"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n22: sendingProgress = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L22"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n31: sendingProgress = false;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n69: securityWorker[_master] = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L69"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n238: mapping(address => bool) public wasBlacklisted;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n247: mapping(address => bool) public securityWorker;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n206: sendingProgressAaveHub = true;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L206"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n212: sendingProgressAaveHub = false;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L212"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Using XOR (^) and AND (&) bitwise equivalents for gas optimizations",
      "description": "Given 4 variables a, b, c and d represented as such:\n\n    0 0 0 0 0 1 1 0 <- a\n    0 1 1 0 0 1 1 0 <- b\n    0 0 0 0 0 0 0 0 <- c\n    1 1 1 1 1 1 1 1 <- d\n\nTo have a == b means that every 0 and 1 match on both variables. Meaning that a XOR (operator ^) would evaluate to 0 ((a ^ b) == 0), as it excludes by definition any equalities.Now, if a != b, this means that there’s at least somewhere a 1 and a 0 not matching between a and b, making (a ^ b) != 0.Both formulas are logically equivalent and using the XOR bitwise operator costs actually the same amount of gas.However, it is much cheaper to use the bitwise OR operator (|) than comparing the truthy or falsy values.These are logically equivalent too, as the OR bitwise operator (|) would result in a 1 somewhere if any value is not 0 between the XOR (^) statements, meaning if any XOR (^) statement verifies that its arguments are different.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n42: return _maxSharePrice == true\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L42"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n269: if (_nftIdLiquidator == _nftId) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L269"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n436: if (currentAddress == _poolToken) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L436"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n542: if (feeAmount == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L542"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n554: if (feeShares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L554"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n681: if (length == 1) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L681"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n695: if (i == endPosition) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L695"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n716: isLending == true\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L716"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n838: return userLendingData[_nftId][_poolToken].shares == 0\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L838"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1161: if (_nftId == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1161"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n25: if (msg.sender == master) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n41: if (msg.sender == proposedMaster) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L41"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n60: if (_master == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L60"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n76: if (_proposedOwner == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L76"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n174: if (_params.poolToken == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L174"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n230: if (_nftId == FEE_MANAGER_NFT) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L230"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n231: return feeManager == _owner;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L231"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n355: if (bytes(currentBaseURI).length == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L355"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n378: if (_tokenId == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L378"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n76: if (_onBehalf == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L76"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n278: if (_caller == AAVE_HUB_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L278"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n306: if (state == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L306"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n397: if (_onBehalf == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L397"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n588: if (userShares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L588"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n592: if (userLendingData[_nftId][_receiveTokens].unCollateralized == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L592"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n87: if (powerFarmCheck == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L87"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1527: if (_onBehalf == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1527"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n18: if (msg.sender == address(FEE_MANAGER)) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n354: if (sendingProgress == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L354"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n453: if (_value == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L453"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n104: if (increaseCardinalityRequired == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L104"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n108: if (oldestObservationSatisfied == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n109: if (increaseCardinalityRequired == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n113: if (oldestObservationSatisfied == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L113"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n90: if (increaseCardinalityRequired == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L90"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n94: if (oldestObservationSatisfied == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L94"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n195: if (msg.sender == incentiveMaster) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L195"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n206: if (msg.sender == address(WISE_SECURITY)) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L206"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n217: if (msg.sender == address(WISE_LENDING)) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L217"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n179: if (_proposedIncentiveMaster == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L179"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n291: if (amount == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L291"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n324: if (_newOwner == incentiveOwnerA) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L324"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n328: if (_newOwner == incentiveOwnerB) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L328"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n361: if (_newOwner == incentiveOwnerA) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L361"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n365: if (_newOwner == incentiveOwnerB) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L365"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n473: if (found == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L473"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n640: if (shares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L640"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n663: if (totalBadDebtETH == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L663"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n352: if (reduceUSD == usdEquivalent) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L352"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n72: if (borrowShares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L72"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n80: if (totalCollateral == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L80"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n238: uint256 borrowShares = _isAave == false\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L238"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n246: uint256 borrowTokenAmount = _isAave == false\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L246"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n279: if (block.chainid == ETH_CHAIN_ID) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L279"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n287: if (block.chainid == ARB_CHAIN_ID) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L287"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n365: if (isShutdown == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L365"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n67: if (allowEnter == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n73: if (_flashloanToken.length == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n174: address tokenOut = block.chainid == 1\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L174"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n174: block.chainid == 1\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L174"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n215: if (_ethBack == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L215"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n239: if (block.chainid == ETH_CHAIN_ID) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L239"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n246: if (block.chainid == ARB_CHAIN_ID) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L246"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n333: if (_isAave == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L333"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n427: if (block.chainid == ARB_CHAIN_ID) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L427"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n538: if (_isAave == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L538"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n39: if (sendingProgress == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L39"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n213: if (borrowTokenAmountAave == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L213"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n330: uint256 netAPY = isPositive == true\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L330"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n404: if (borrowShares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L404"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n189: if (availableNFTCount == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L189"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n124: if (_pendleChildShares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L124"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n182: if (childMarket == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L182"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n345: if (child == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L345"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n396: if (_fromInside == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L396"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n456: if (IS_ETH_MAIN == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L456"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n265: if (child == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L265"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n154: if (_overWritten == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n266: if (index == lastIndex[i]) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L266"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n339: if (additonalAssets == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L339"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n391: if (totalLpAssetsToDistribute == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L391"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n395: if (block.timestamp == lastInteraction) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L395"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n489: return product % _underlyingLpAssetsCurrent == 0\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L489"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n508: if (_amount == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L508"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n514: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L514"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n539: if (_underlyingLpAssetAmount == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L539"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n548: if (shares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L548"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n559: if (feeShares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L559"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n563: if (reducedShares == feeShares) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L563"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n615: if (_shares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L615"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n635: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L635"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n654: if (_underlyingLpAssetAmount == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L654"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n122: if (_keyId == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n57: if (farmContract == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n197: if (bytes(currentBaseURI).length == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L197"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n220: if (_tokenId == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L220"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n26: bool results = returndata.length == 0 || abi.decode(\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n31: if (success == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n33: if (success == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n74: if (size == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L74"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n117: if (uniTwapPoolInfoStruct.isUniPool == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L117"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n311: if (_tokenAddress == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L311"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n331: if (_pool == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L331"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n526: if (IS_ARBITRUM_CHAIN == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L526"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n537: if (answer == 1) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L537"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n151: if (_tokenAddress == WETH_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L151"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n335: if (_tokenAddress == WETH_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L335"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n455: if (length == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L455"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n475: if (state == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L475"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n35: if (msg.sender == address(WISE_LENDING)) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n70: if (overallCollateral == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L70"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n170: if (curveMetaPool == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n201: if (curvePool == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L201"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n218: if (curveMeta == ZERO_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L218"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n453: if (len == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L453"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n510: if (len == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L510"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n652: if (len == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L652"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n924: if (currentTotalBorrowShares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L924"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n961: if (currentTotalLendingShares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L961"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1100: if (minDepositEthValue == ONE_WEI) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1100"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1117: if (_newMinDepositValue == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1117"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n146: uint256 maxFee = IS_ETH_MAINNET == true\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n150: uint256 minFee = IS_ETH_MAINNET == true\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L150"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n164: uint256 maxFeeFarm = IS_ETH_MAINNET == true\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L164"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n168: uint256 minFeeFarm = IS_ETH_MAINNET == true\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L168"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n295: if (lendingShares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L295"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n624: if (borrowShares == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L624"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n678: if (WISE_LENDING.borrowPoolData(_poolAddress).allowBorrow == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L678"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n818: if (borrowAmount == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L818"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n822: uint256 overallCollateral = _powerFarm == true\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L822"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1010: if (pseudoTotalPool == 0) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1010"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1102: if (_success == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1102"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n38: if (sendingProgressAaveHub == true) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L38"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n214: if (success == false) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L214"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n265: if (currentAddress == _poolToken) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L265"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n301: if (currentAddress == _poolToken) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L301"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n87: if (msg.sender == WETH_ADDRESS) {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L87"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Using assembly to check for zero can save gas",
      "description": "Using assembly to check for zero can save gas by allowing more direct access to the evm and reducing some of the overhead associated with high-level operations in solidity.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n542: if (feeAmount == 0) {\n\n554: if (feeShares == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L554",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L542"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1161: if (_nftId == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1161"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n355: if (bytes(currentBaseURI).length == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L355"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n378: if (_tokenId == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L378"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n588: if (userShares == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L588"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n453: if (_value == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L453"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n291: if (amount == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L291"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n640: if (shares == 0) {\n\n663: if (totalBadDebtETH == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L663",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L640"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n746: if (badDebtPosition[_nftId] == 0) {\n\n753: if (WISE_LENDING.getTotalDepositShares(_receivingToken) == 0) {\n\n757: if (WISE_LENDING.getTotalDepositShares(_paybackToken) == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L746",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L757",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L753"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n828: if (badDebtPosition[_nftId] == 0) {\n\n832: if (WISE_LENDING.getTotalDepositShares(_paybackToken) == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L832",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L828"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n72: if (borrowShares == 0) {\n\n80: if (totalCollateral == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L80",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L72"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n73: if (_flashloanToken.length == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n213: if (borrowTokenAmountAave == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L213"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n404: if (borrowShares == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L404"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n189: if (availableNFTCount == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L189"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n124: if (_pendleChildShares == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L124"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n255: if (lastIndex[i] == 0 && index > 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L255"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n339: if (additonalAssets == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L339"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n391: if (totalLpAssetsToDistribute == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L391"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n508: if (_amount == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L508"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n539: if (_underlyingLpAssetAmount == 0) {\n\n548: if (shares == 0) {\n\n559: if (feeShares == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L559",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L539",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L548"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n615: if (_shares == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L615"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n654: if (_underlyingLpAssetAmount == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L654"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n122: if (_keyId == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n197: if (bytes(currentBaseURI).length == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L197"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n220: if (_tokenId == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L220"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n74: if (size == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L74"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n439: if (tickCumulativesDelta < 0 && (tickCumulativesDelta % twapPeriodInt56 != 0)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L439"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n566: if (heartBeat[_tokenAddress] == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L566"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n455: if (length == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L455"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n70: if (overallCollateral == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L70"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n267: if (WISE_LENDING.getPositionBorrowTokenLength(_nftId) == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L267"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n453: if (len == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L453"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n510: if (len == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L510"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n652: if (len == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L652"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n924: if (currentTotalBorrowShares == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L924"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n961: if (currentTotalLendingShares == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L961"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1117: if (_newMinDepositValue == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1117"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n210: if (WISE_LENDING.getPositionLendingShares(_nftId, _poolToken) == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L210"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n295: if (lendingShares == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L295"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n624: if (borrowShares == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L624"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n818: if (borrowAmount == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L818"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1010: if (pseudoTotalPool == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1010"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n29: if (WISE_LENDING.getTotalDepositShares(_poolToken) == 0) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L29"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Using Bools For Storage Incurs Overhead",
      "description": "Booleans are more expensive than uint256 or any type that takes up a full word because each write operation emits an extra SLOAD to first read the slot's contents, replace the bits taken up by the boolean, and then write back. This is the compiler's defense against contract upgrades and pointer aliasing, and it cannot be disabled.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n21: mapping(address => bool) public reserveRole;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n23: bool public reservePublicBlocked;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L23"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n286: mapping(uint256 => bool) public positionLocked;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L286"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n287: mapping(address => bool) internal parametersLocked;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n288: mapping(address => bool) public verifiedIsolationPool;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n291: mapping(bytes32 => bool) internal hashMapPositionBorrow;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L291"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n292: mapping(bytes32 => bool) internal hashMapPositionLending;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n149: mapping(address => bool) public poolTokenAdded;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n152: mapping(address => bool) public isAaveToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n158: mapping(address => mapping(address => bool)) public allowedTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n43: bool public isShutdown;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n46: bool public allowEnter;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L46"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n108: mapping(uint256 => bool) public isAave;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n10: bool public sendingProgress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n238: mapping(address => bool) public wasBlacklisted;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n247: mapping(address => bool) public securityWorker;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n25: bool public sendingProgressAaveHub;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L25"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Using `++X/`--X` instead of `X++`/`X--` can save gas",
      "description": "It can save 5 gas for each execution / per iteration.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n208: totalReserved--;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L208"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n386: length++;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L386"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n206: availableNFTCount--\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L206"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n135: totalMinted++;\n\n136: totalReserved--;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L135-L136"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n228: length++;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L228"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n440: tick--;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L440"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Using `this` to access functions results in an external call, wasting gas",
      "description": "External calls have an overhead of **100 gas**, which can be avoided by not referencing the function using `this`. Contracts [are allowed](https://docs.soliditylang.org/en/latest/contracts.html#function-overriding) to override their parents' functions and change the visibility from `external` to `public`, so make this change if it's required in order to call the function internally.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n50: return _getPositionData(address(this)).expiry;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n58: return _getPositionData(address(this)).amount;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n176: return this.onERC721Received.selector;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L176"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n18: if (address(this).balance < _amount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n202: if (address(this).balance < _amount) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L202"
          ]
        }
      ]
    },
    {
      "severity": "Gas",
      "title": "Write direct outcome, instead of performing mathematical operations",
      "description": "Write direct outcome instead ofperforming mathematical operations saves some gas",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n185: uint256 public constant BORROW_PERCENTAGE_CAP = 95 * PRECISION_FACTOR_E16;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L185"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Addition/multiplication in `unchecked` block is unsafe",
      "description": "The additions/multiplications may silently overflow because they're in `unchecked` blocks with no preceding value checks, which may lead to unexpected results",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n321: totalPool + bareToken\n            );\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L321"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Governance functions should be controlled by time locks",
      "description": "Governance functions (such as upgrading contracts, setting critical parameters) should be controlled using time locks to introduce a delay between a proposal and its execution. This gives users time to exit before a potentially dangerous or malicious operation is applied.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n25: function setParamsLASA(\n        address _poolToken,\n        uint256 _poolMulFactor,\n        uint256 _upperBoundMaxRate,\n        uint256 _lowerBoundMaxRate,\n        bool _steppingDirection,\n        bool _isFinal\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n26: function setParamsLASA(\n        address _poolToken,\n        uint256 _poolMulFactor,\n        uint256 _upperBoundMaxRate,\n        uint256 _lowerBoundMaxRate,\n        bool _steppingDirection,\n        bool _isFinal\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n100: function setPoolParameters(\n        address _poolToken,\n        uint256 _collateralFactor,\n        uint256 _maximumDeposit\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L100"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n101: function setPoolParameters(\n        address _poolToken,\n        uint256 _collateralFactor,\n        uint256 _maximumDeposit\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L101"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n125: function setVerifiedIsolationPool(\n        address _isolationPool,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n126: function setVerifiedIsolationPool(\n        address _isolationPool,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n319: function setBaseURI(\n        string memory _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L319"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n320: function setBaseURI(\n        string memory _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n328: function setBaseExtension(\n        string memory _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n329: function setBaseExtension(\n        string memory _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1386: function setRegistrationIsolationPool(\n        uint256 _nftId,\n        bool _registerState\n    )\n        external\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1387: function setRegistrationIsolationPool(\n        uint256 _nftId,\n        bool _registerState\n    )\n        external\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n140: function setSecurity(\n        address _wiseSecurity\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L140"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n141: function setSecurity(\n        address _wiseSecurity\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n424: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyFeeManager\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n425: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyFeeManager\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n33: function setLastUpdateGlobal(\n        uint256 _time\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n34: function setLastUpdateGlobal(\n        uint256 _time\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n42: function setRoundData(\n        uint80 _roundId,\n        uint256 _updateTime\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n43: function setRoundData(\n        uint80 _roundId,\n        uint256 _updateTime\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n52: function setGlobalAggregatorRoundId(\n        uint80 _aggregatorRoundId\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n53: function setGlobalAggregatorRoundId(\n        uint80 _aggregatorRoundId\n    )\n        external\n        onlyOwner\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n49: function setRepayBadDebtIncentive(\n        uint256 _percent\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n50: function setRepayBadDebtIncentive(\n        uint256 _percent\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n66: function setAaveFlag(\n        address _poolToken,\n        address _underlyingToken\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L66"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n67: function setAaveFlag(\n        address _poolToken,\n        address _underlyingToken\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n82: function setAaveFlagBulk(\n        address[] calldata _poolTokens,\n        address[] calldata _underlyingTokens\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L82"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n83: function setAaveFlagBulk(\n        address[] calldata _poolTokens,\n        address[] calldata _underlyingTokens\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n108: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n109: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n135: function setPoolFeeBulk(\n        address[] calldata _poolTokens,\n        uint256[] calldata _newFees\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n136: function setPoolFeeBulk(\n        address[] calldata _poolTokens,\n        uint256[] calldata _newFees\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L136"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n315: function changeIncentiveUSDA(\n        address _newOwner\n    )\n        external\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L315"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n316: function changeIncentiveUSDA(\n        address _newOwner\n    )\n        external\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L316"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n352: function changeIncentiveUSDB(\n        address _newOwner\n    )\n        external\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L352"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n353: function changeIncentiveUSDB(\n        address _newOwner\n    )\n        external\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L353"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n514: function setBadDebtUserLiquidation(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n515: function setBadDebtUserLiquidation(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L515"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n538: function setBeneficial(\n        address _user,\n        address[] calldata _feeTokens\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L538"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n539: function setBeneficial(\n        address _user,\n        address[] calldata _feeTokens\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L539"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n63: function changeMinDeposit(\n        uint256 _newMinDeposit\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n64: function changeMinDeposit(\n        uint256 _newMinDeposit\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L64"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n321: function changeExchangeIncentive(\n        uint256 _newExchangeIncentive\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n322: function changeExchangeIncentive(\n        uint256 _newExchangeIncentive\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L322"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n334: function changeMintFee(\n        address _pendleMarket,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n335: function changeMintFee(\n        address _pendleMarket,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n592: function changeMintFee(\n        uint256 _newFee\n    )\n        external\n        onlyController\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n593: function changeMintFee(\n        uint256 _newFee\n    )\n        external\n        onlyController\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n51: function setFarmContract(\n        address _farmContract\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n52: function setFarmContract(\n        address _farmContract\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n161: function setBaseURI(\n        string calldata _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n162: function setBaseURI(\n        string calldata _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n170: function setBaseExtension(\n        string calldata _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n171: function setBaseExtension(\n        string calldata _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n85: function setLiquidationSettings(\n        uint256 _baseReward,\n        uint256 _baseRewardFarm,\n        uint256 _newMaxFeeETH,\n        uint256 _newMaxFeeFarmETH\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L85"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n86: function setLiquidationSettings(\n        uint256 _baseReward,\n        uint256 _baseRewardFarm,\n        uint256 _newMaxFeeETH,\n        uint256 _newMaxFeeFarmETH\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n980: function setBlacklistToken(\n        address _tokenAddress,\n        bool _state\n    )\n        external\n        onlyMaster()\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n981: function setBlacklistToken(\n        address _tokenAddress,\n        bool _state\n    )\n        external\n        onlyMaster()\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n995: function setSecurityWorker(\n        address _entitiy,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L995"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n996: function setSecurityWorker(\n        address _entitiy,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1111: function changeMinDepositValue(\n        uint256 _newMinDepositValue\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1112: function changeMinDepositValue(\n        uint256 _newMinDepositValue\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n44: function setAaveTokenAddress(\n        address _underlyingAsset,\n        address _aaveToken\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n45: function setAaveTokenAddress(\n        address _underlyingAsset,\n        address _aaveToken\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n64: function setAaveTokenAddressBulk(\n        address[] calldata _underlyingAssets,\n        address[] calldata _aaveTokens\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L64"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n65: function setAaveTokenAddressBulk(\n        address[] calldata _underlyingAssets,\n        address[] calldata _aaveTokens\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L65"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n105: function setWiseSecurity(\n        address _securityAddress\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n106: function setWiseSecurity(\n        address _securityAddress\n    )\n        external\n        onlyMaster\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "IERC20 `approve()` Is Deprecated",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n197: POSITION_NFT.approve(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L197"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Consider checking that transfer to `address(this)` is disabled",
      "description": "Functions allowing users to specify the receiving address should check whether the referenced address is not `address(this)`. This would prevent tokens to remain lock inside the contract due to an incorrect `transfer` or `mint`.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n193: function _mintPositionForUser(\n        address _user\n    )\n        internal\n        returns (uint256)\n    {\n        uint256 nftId = reserved[\n            _user\n        ];\n\n        if (nftId > 0) {\n            delete reserved[\n                _user\n            ];\n\n            totalReserved--;\n\n        } else {\n            nftId = getNextExpectedId();\n        }\n\n        _mint(\n            _user,\n            nftId\n        );\n\n        return nftId;\n    }\n194: function _mintPositionForUser(\n        address _user\n    )\n        internal\n        returns (uint256)\n    {\n        uint256 nftId = reserved[\n            _user\n        ];\n\n        if (nftId > 0) {\n            delete reserved[\n                _user\n            ];\n\n            totalReserved--;\n\n        } else {\n            nftId = getNextExpectedId();\n        }\n\n        _mint(\n            _user,\n            nftId\n        );\n\n        return nftId;\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L193-L194"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n428: function _withdrawPureCollateralLiquidation(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _percentLiquidation\n    )\n        private\n        returns (uint256 transferAmount)\n    {\n        uint256 product = _percentLiquidation\n            * pureCollateralAmount[_nftId][_poolToken];\n\n        transferAmount = product / PRECISION_FACTOR_E18;\n\n        _decreasePositionMappingValue(\n            pureCollateralAmount,\n            _nftId,\n            _poolToken,\n            transferAmount\n        );\n\n        _decreaseTotalBareToken(\n            _poolToken,\n            transferAmount\n        );\n    }\n429: function _withdrawPureCollateralLiquidation(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _percentLiquidation\n    )\n        private\n        returns (uint256 transferAmount)\n    {\n        uint256 product = _percentLiquidation\n            * pureCollateralAmount[_nftId][_poolToken];\n\n        transferAmount = product / PRECISION_FACTOR_E18;\n\n        _decreasePositionMappingValue(\n            pureCollateralAmount,\n            _nftId,\n            _poolToken,\n            transferAmount\n        );\n\n        _decreaseTotalBareToken(\n            _poolToken,\n            transferAmount\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L428-L429"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n66: function mintKey(\n        address _keyOwner,\n        uint256 _keyId\n    )\n        external\n        onlyFarmContract\n    {\n        _mint(\n            _keyOwner,\n            _keyId\n        );\n    }\n67: function mintKey(\n        address _keyOwner,\n        uint256 _keyId\n    )\n        external\n        onlyFarmContract\n    {\n        _mint(\n            _keyOwner,\n            _keyId\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L66-L67"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Owner can renounce Ownership",
      "description": "Typically, the contract's owner is the account that deploys the contract. As a result, the owner is able to perform certain privileged activities. The OpenZeppelin's `Ownable` is used in this project contract implements `renounceOwnership`. This can represent a certain risk if the ownership is renounced for any other reason than by design. Renouncing ownership will leave the contract without an owner, thereby removing any functionality that is only available to the owner.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n9: contract OwnableMaster {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {\n\n34: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n31: OwnableMaster,\n\n110: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L110",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n31: contract DeclarationsFeeManager is FeeManagerEvents, OwnableMaster {\n\n41: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L41",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n15: contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {\n\n43: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L15",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n31: OwnableMaster,\n\n86: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L31",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {\n\n46: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L46"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n33: abstract contract Declarations is OwnableMaster {\n\n50: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L50",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n45: contract WiseSecurityDeclarations is OwnableMaster {\n\n57: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L45",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {\n\n48: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L48",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Consider implementing two-step procedure for updating protocol addresses",
      "description": "A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must 'accept' the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the 'set' functions ensure that the recipient is of the right interface type.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n26: function setParamsLASA(\n        address _poolToken,\n        uint256 _poolMulFactor,\n        uint256 _upperBoundMaxRate,\n        uint256 _lowerBoundMaxRate,\n        bool _steppingDirection,\n        bool _isFinal\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n101: function setPoolParameters(\n        address _poolToken,\n        uint256 _collateralFactor,\n        uint256 _maximumDeposit\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L101"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n126: function setVerifiedIsolationPool(\n        address _isolationPool,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n141: function setSecurity(\n        address _wiseSecurity\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n425: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyFeeManager\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n109: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n316: function changeIncentiveUSDA(\n        address _newOwner\n    )\n        external\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L316"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n353: function changeIncentiveUSDB(\n        address _newOwner\n    )\n        external\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L353"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n539: function setBeneficial(\n        address _user,\n        address[] calldata _feeTokens\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L539"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n335: function changeMintFee(\n        address _pendleMarket,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n52: function setFarmContract(\n        address _farmContract\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n981: function setBlacklistToken(\n        address _tokenAddress,\n        bool _state\n    )\n        external\n        onlyMaster()\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n996: function setSecurityWorker(\n        address _entitiy,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n106: function setWiseSecurity(\n        address _securityAddress\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Consider the case where `totalsupply` is 0",
      "description": "Consider the case where `totalsupply` is 0. When `totalsupply` is 0, it should return 0 directly, because there will be an error of dividing by 0.\n\n#### <ins>Impact</ins>\n\nThis would cause the affected functions to revert and as a result can lead to potential loss.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n331: / totalSupply();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L331"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n475: / totalSupply();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L475"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n626: / totalETHSupply;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L626"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Do not allow fees to be set to `100%`",
      "description": "It is recommended from a risk perspective to disallow setting 100% fees at all. A reasonable fee maximum should be checked for instead.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n\nfunction setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyFeeManager\n    {\n        globalPoolData[_poolToken].poolFee = _newFee;\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424-L425"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "`decimals()` not part of ERC20 standard",
      "description": "`decimals()` is not part of the official ERC20 standard and might fail for tokens that do not implement it. While in practice it is very unlikely, as usually most of the tokens implement it, this should still be considered as a potential issue.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n44: if (FEED_ASSET.decimals()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n38: POW_USD_FEED = 10 ** USD_FEED_ASSET.decimals()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L38"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n39: POW_ETH_USD_FEED = 10 ** ETH_FEED_ASSET.decimals()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L39"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n35: POW_FEED = 10 ** FEED_ASSET.decimals()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n724: _decimals = PENDLE_SY.decimals()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L724"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n58: ).decimals()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n27: ).decimals()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L27"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n457: return priceFeed[_tokenAddress].decimals()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L457"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "External call recipient may consume all transaction gas",
      "description": "There is no limit specified on the amount of gas used, so the recipient can use up all of the transaction's gas, causing it to revert. Use `addr.call{gas: <amount>}(\"\")` or [this](https://github.com/nomad-xyz/ExcessivelySafeCall) library instead.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n22: ) = token.call(\n            data\n        );\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L22"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n27: ) = payable(_recipient).call{\n            value: _amount\n        }(\"\");\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L27"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n78: (bool success, ) = _tokenAggregator.call(\n            abi.encodeWithSignature(\n                \"maxAnswer()\"\n            )\n        );\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L78"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n208: ) = curvePool.call{value: 0} (\n            curveSwapInfoData[_poolToken].swapBytesPool\n        );\n\n225: ) = curveMeta.call{value: 0} (\n            curveSwapInfoData[_poolToken].swapBytesMeta\n        );\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L225",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L208"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n208: (bool success, ) = payable(_recipient).call{\n            value: _amount\n        }(\"\");\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L208"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "External calls in an un-bounded `for-`loop may result in a DOS",
      "description": "Consider limiting the number of iterations in `for-`loops that make external calls",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n140: for (i; i < ownerTokenCount;) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L140"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "`forceApprove` should be used instead of `approve`",
      "description": "In order to prevent front running, `forceApprove`  should be used in place of `approve` where possible ",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n197: POSITION_NFT.approve(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L197"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Functions which set address state variables should have zero address checks",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n232: function _setAaveFlag: address _underlyingToken\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L232"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n52: function setFarmContract: address _farmContract\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n666: function _setAaveTokenAddress: address _aaveToken\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L666"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Init functions are susceptible to front-running",
      "description": "The `initialize()` functions below are not called by another contract atomically after the contract is deployed, so it's possible for a malicious user to call `initialize()` which, if it's noticed in time, would require the project to re-deploy the contract in order to properly initialize. Consider creating a factory contract, which will `new` and `initialize()` each contract atomically.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\nfunction initialize(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L682"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Initialization function lacks parameter validation",
      "description": "Initialization functions play a critical role in contracts by setting important initial states when the contract is first deployed before the system starts. The parameters passed to the initialization functions directly affect the behavior of the contract / protocol. If incorrect parameters are provided, the system may fail to run, behave abnormally, be unstable, or lack security. Therefore, it's crucial to carefully check each parameter in the initialization functions. If an exception is found, the transaction should be rolled back.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n682: function initialize(\n        address _underlyingPendleMarket,\n        address _pendleController,\n        string memory _tokenName,\n        string memory _symbolName,\n        uint16 _maxCardinality\n    )\n        external\n    {\n        if (address(PENDLE_MARKET) != address(0)) {\n            revert AlreadyInitialized();\n        }\n\n        PENDLE_MARKET = IPendleMarket(\n            _underlyingPendleMarket\n        );\n\n        if (PENDLE_MARKET.isExpired() == true) {\n            revert MarketExpired();\n        }\n\n        PENDLE_CONTROLLER = IPendleController(\n            _pendleController\n        );\n\n        MAX_CARDINALITY = _maxCardinality;\n\n        _name = _tokenName;\n        _symbol = _symbolName;\n\n        PENDLE_POWER_FARM_CONTROLLER = _pendleController;\n        UNDERLYING_PENDLE_MARKET = _underlyingPendleMarket;\n\n        (\n            address pendleSyAddress,\n            ,\n        ) = PENDLE_MARKET.readTokens();\n\n        PENDLE_SY = IPendleSy(\n            pendleSyAddress\n        );\n\n        _decimals = PENDLE_SY.decimals();\n\n        lastInteraction = block.timestamp;\n\n        _totalSupply = 1;\n        underlyingLpAssetsCurrent = 1;\n        mintFee = 3000;\n        INITIAL_TIME_STAMP = block.timestamp;\n    }\n}\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L683"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Lack of index element validation in function",
      "description": "There's no validation to check whether the index element provided as an argument actually exists in the call. This omission could lead to unintended behavior if an element that does not exist in the call is passed to the function.\n\nThe function should validate that the provided index element exists in the call before proceeding.\n\nWithout this validation, the function could cause unintended behaviour as it will call an non-existing index element. This could lead to inconsistencies in data and potentially affect the integrity of the call structure.\n\nA validation can be added such as:\n```solidity\n\nrequire(structName[elementIndex] < size, \"Element Index does not exist in the structName\");\n\n```",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n311: uint256 totalPool = globalPoolData[_poolToken].totalPool;\n\n312: uint256 bareToken = globalPoolData[_poolToken].totalBareToken;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L311-L312"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n507: uint256 bareIncrease = borrowPoolData[_poolToken].borrowRate\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L507"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n856: uint256 pole = borrowRatesData[_poolToken].pole;\n\n857: uint256 utilization = globalPoolData[_poolToken].utilization;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L856-L857"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1130: uint256 minValue = borrowRatesData[_poolToken].minPole;\n\n1132: uint256 delta = borrowRatesData[_poolToken].deltaPole\n\n1135: uint256 sub = borrowRatesData[_poolToken].pole > delta\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1135",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1132",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1130"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n479: uint256 totalPoolToken = globalPoolData[_poolToken].totalPool;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L479"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1096: uint256 maxBorrowShares = userBorrowShares[_nftId][WETH_ADDRESS];\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1096"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n289: uint256 amount = gatheredIncentiveToken[msg.sender][_feeToken];\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L289"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n348: uint256 reduceUSD = usdEquivalent < incentiveUSD[_incentiveOwner]\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L348"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n575: address paybackToken = isAave[_nftId] == true\n\n584: uint256 cutoffShares = isAave[_nftId] == true\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L584",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L575"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n153: address curvePool = curveSwapInfoData[_poolToken].curvePool;\n\n168: address curveMetaPool = curveSwapInfoData[_poolToken].curveMetaPool;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L153",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L168"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n199: address curvePool = curveSwapInfoData[_poolToken].curvePool;\n\n216: address curveMeta = curveSwapInfoData[_poolToken].curveMetaPool;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L216",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L199"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Possible rounding issue",
      "description": "Division by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n866: / baseDivider;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L866"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n301: return (_maxPole - _minPole) / NORMALISATION_FACTOR;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L301"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n177: / borrowPoolData[_poolToken].totalBorrowShares;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L177"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n341: / WISE_LENDING.globalPoolData(_poolToken).poolFee;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L341"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n86: / totalCollateral;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n382: / baseDivider;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L382"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n462: / _underlyingLpAssetsCurrent;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L462"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n491: : product / _underlyingLpAssetsCurrent + 1;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L491"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n227: / _fetchTwapValue;\n\n232: / _answerUint256;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L232",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L227"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n76: / overallCollateral;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L76"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n310: / currentTotalLendingShares;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L310"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n639: / currentTotalBorrowShares;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L639"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n785: return numerator / denominator + 1;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L785"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1040: / BORROW_PERCENTAGE_CAP;\n\n1044: / WISE_LENDING.lendingPoolData(_poolToken).collateralFactor;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1044",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1040"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Minting tokens to the zero address should be avoided",
      "description": "The core function `mint` is used by users to mint an option position by providing token1 as collateral and borrowing the max amount of liquidity. `Address(0)` check is missing in both this function and the internal function `_mint`, which is triggered to mint the tokens to the to address. Consider applying a check in the function to ensure tokens aren't minted to the zero address.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n\nfunction mintPositionForUser(\n        address _user\n    )\n        external\n        returns (uint256)\n    {\n        if (isApprovedForAll(\n                _user,\n                msg.sender\n            ) == false\n        ) {\n            revert NotPermitted();\n        }\n\n        return _mintPositionForUser(\n            _user\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L174-L175"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n\nfunction approveMint(\n        address _spender,\n        uint256 _nftId\n    )\n        external\n    {\n        if (reserved[msg.sender] == _nftId) {\n            approve(\n                _spender,\n                _mintPositionForUser(\n                    msg.sender\n                )\n            );\n\n            return;\n        }\n\n        approve(\n            _spender,\n            _nftId\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L245-L246"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n\nfunction depositExactAmountETHMint()\n        external\n        payable\n        syncPool(WETH_ADDRESS)\n        returns (uint256)\n    {\n        return _depositExactAmountETH(\n            _reservePosition()\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L426"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n\nfunction depositExactAmountMint(\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        returns (uint256)\n    {\n        return depositExactAmount(\n            _reservePosition(),\n            _poolToken,\n            _amount\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L442-L443"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n\nfunction solelyDepositETHMint()\n        external\n        payable\n    {\n        solelyDepositETH(\n            _reservePosition()\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L493"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n\nfunction solelyDepositMint(\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n    {\n        solelyDeposit(\n            _reservePosition(),\n            _poolToken,\n            _amount\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L581-L582"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n\nfunction changeMintFee(\n        address _pendleMarket,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n        address child = pendleChildAddress[\n            _pendleMarket\n        ];\n\n        if (child == ZERO_ADDRESS) {\n            revert WrongAddress();\n        }\n\n        IPendlePowerFarmToken(\n            child\n        ).changeMintFee(\n            _newFee\n        );\n\n        emit ChangeMintFee(\n            _pendleMarket,\n            _newFee\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334-L335"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n\nfunction changeMintFee(\n        uint256 _newFee\n    )\n        external\n        onlyController\n    {\n        if (_newFee > MAX_MINT_FEE) {\n            revert FeeTooHigh();\n        }\n\n        mintFee = _newFee;\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592-L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n\nfunction mintReserved()\n        external\n        returns (uint256)\n    {\n        return _mintKeyForUser(\n            reservedKeys[\n                msg.sender\n            ],\n            msg.sender\n        );\n    }\n\n    event ERC721Received(\n        address operator,\n        address from,\n        uint256 tokenId,\n        bytes _data\n    );\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L141"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n\nfunction mintKey(\n        address _keyOwner,\n        uint256 _keyId\n    )\n        external\n        onlyFarmContract\n    {\n        _mint(\n            _keyOwner,\n            _keyId\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L66-L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n\nfunction depositExactAmountMint(\n        address _underlyingAsset,\n        uint256 _amount\n    )\n        external\n        returns (uint256)\n    {\n        return depositExactAmount(\n            _reservePosition(),\n            _underlyingAsset,\n            _amount\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L103-L104"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n\nfunction depositExactAmountETHMint()\n        external\n        payable\n        returns (uint256)\n    {\n        return depositExactAmountETH(\n            _reservePosition()\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L158"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "The Contract Should `approve(0)` First",
      "description": "Some tokens (like USDT L199) do not work when changing the allowance from an existing non-zero allowance value. They must first be approved by zero and then the actual allowance must be approved.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n197: POSITION_NFT.approve(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L197"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Constructor is missing zero address check",
      "description": "In Solidity, constructors often take address parameters to initialize important components of a contract, such as owner or linked contracts. However, without a check, there's a risk that an address parameter could be mistakenly set to the zero address (0x0). This could occur due to a mistake or oversight during contract deployment. A zero address in a crucial role can cause serious issues, as it cannot perform actions like a normal address, and any funds sent to it are irretrievable. Therefore, it's crucial to include a zero address check in constructors to prevent such potential problems. If a zero address is detected, the constructor should revert the transaction.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n32: constructor: address _pendleMarketAddress\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n24: constructor: address _pendleMarketAddress\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n24: constructor: address _pendleMarketAddress\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n159: constructor: address _pendleChilTokenAddress\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L159"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n79: constructor: address _vePendle\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L79"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n16: constructor: address _pendlePowerFarmController\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L16"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n45: constructor: address _wethAddress\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L45"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Cap state variables at reasonable values",
      "description": "Consider adding maximum value checks to ensure that state variables cannot be set to values that may excessively harm users.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n\nfunction setParamsLASA(\n        address _poolToken,\n        uint256 _poolMulFactor,\n        uint256 _upperBoundMaxRate,\n        uint256 _lowerBoundMaxRate,\n        bool _steppingDirection,\n        bool _isFinal\n    )\n        external\n        onlyMaster\n    {\n        if (parametersLocked[_poolToken] == true) {\n            revert InvalidAction();\n        }\n\n        parametersLocked[_poolToken] = _isFinal;\n\n        AlgorithmEntry storage algoData = algorithmData[\n            _poolToken\n        ];\n\n        algoData.increasePole = _steppingDirection;\n\n        _validateParameter(\n            _upperBoundMaxRate,\n            UPPER_BOUND_MAX_RATE\n        );\n\n        _validateParameter(\n            _lowerBoundMaxRate,\n            LOWER_BOUND_MAX_RATE\n        );\n\n        _validateParameter(\n            _lowerBoundMaxRate,\n            _upperBoundMaxRate\n        );\n\n        uint256 staticMinPole = _getPoleValue(\n            _poolMulFactor,\n            _upperBoundMaxRate\n        );\n\n        uint256 staticMaxPole = _getPoleValue(\n            _poolMulFactor,\n            _lowerBoundMaxRate\n        );\n\n        uint256 staticDeltaPole = _getDeltaPole(\n            staticMaxPole,\n            staticMinPole\n        );\n\n        uint256 startValuePole = _getStartValue(\n            staticMaxPole,\n            staticMinPole\n        );\n\n        _validateParameter(\n            _poolMulFactor,\n            PRECISION_FACTOR_E18\n        );\n\n        borrowRatesData[_poolToken] = BorrowRatesEntry(\n            startValuePole,\n            staticDeltaPole,\n            staticMinPole,\n            staticMaxPole,\n            _poolMulFactor\n        );\n\n        algoData.bestPole = startValuePole;\n        algoData.maxValue = lendingPoolData[_poolToken].totalDepositShares;\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25-L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n\nfunction setPoolParameters(\n        address _poolToken,\n        uint256 _collateralFactor,\n        uint256 _maximumDeposit\n    )\n        external\n        onlyMaster\n    {\n        if (_maximumDeposit > 0) {\n            maxDepositValueToken[_poolToken] = _maximumDeposit;\n        }\n\n        if (_collateralFactor > 0) {\n            lendingPoolData[_poolToken].collateralFactor = _collateralFactor;\n        }\n\n        _validateParameter(\n            _collateralFactor,\n            PRECISION_FACTOR_E18\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L100-L101"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n\nfunction setRegistrationIsolationPool(\n        uint256 _nftId,\n        bool _registerState\n    )\n        external\n    {\n        _onlyIsolationPool(\n            msg.sender\n        );\n\n        _validateZero(\n            WISE_SECURITY.overallETHCollateralsBare(_nftId)\n        );\n\n        _validateZero(\n            WISE_SECURITY.overallETHBorrowBare(_nftId)\n        );\n\n        positionLocked[_nftId] = _registerState;\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386-L1387"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n\nfunction setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyFeeManager\n    {\n        globalPoolData[_poolToken].poolFee = _newFee;\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424-L425"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n\nfunction setLastUpdateGlobal(\n        uint256 _time\n    )\n        external\n        onlyOwner\n    {\n        lastUpdateGlobal = _time;\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33-L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n\nfunction setRoundData(\n        uint80 _roundId,\n        uint256 _updateTime\n    )\n        external\n        onlyOwner\n    {\n        timeStampByRoundId[_roundId] = _updateTime;\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42-L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n\nfunction setRepayBadDebtIncentive(\n        uint256 _percent\n    )\n        external\n        onlyMaster\n    {\n        _checkValue(\n            _percent\n        );\n\n        paybackIncentive = _percent;\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49-L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n\nfunction setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n        _checkValue(\n            _newFee\n        );\n\n        WISE_LENDING.setPoolFee(\n            _poolToken,\n            _newFee\n        );\n\n        emit PoolFeeChanged(\n            _poolToken,\n            _newFee,\n            block.timestamp\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108-L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n\nfunction setPoolFeeBulk(\n        address[] calldata _poolTokens,\n        uint256[] calldata _newFees\n    )\n        external\n        onlyMaster\n    {\n        uint256 i;\n        uint256 l = _poolTokens.length;\n\n        while (i < l) {\n\n            _checkValue(\n                _newFees[i]\n            );\n\n            WISE_LENDING.setPoolFee(\n                _poolTokens[i],\n                _newFees[i]\n            );\n\n            emit PoolFeeChanged(\n                _poolTokens[i],\n                _newFees[i],\n                block.timestamp\n            );\n\n            unchecked {\n                ++i;\n            }\n        }\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L135-L136"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n\nfunction setBadDebtUserLiquidation(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n        _setBadDebtPosition(\n            _nftId,\n            _amount\n        );\n\n        emit SetBadDebtPosition(\n            _nftId,\n            _amount,\n            block.timestamp\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514-L515"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n\nfunction changeMinDeposit(\n        uint256 _newMinDeposit\n    )\n        external\n        onlyMaster\n    {\n        minDepositEthAmount = _newMinDeposit;\n\n        emit MinDepositChange(\n            _newMinDeposit,\n            block.timestamp\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63-L64"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n\nfunction changeExchangeIncentive(\n        uint256 _newExchangeIncentive\n    )\n        external\n        onlyMaster\n    {\n        exchangeIncentive = _newExchangeIncentive;\n\n        emit ChangeExchangeIncentive(\n            _newExchangeIncentive\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321-L322"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n\nfunction changeMintFee(\n        address _pendleMarket,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n        address child = pendleChildAddress[\n            _pendleMarket\n        ];\n\n        if (child == ZERO_ADDRESS) {\n            revert WrongAddress();\n        }\n\n        IPendlePowerFarmToken(\n            child\n        ).changeMintFee(\n            _newFee\n        );\n\n        emit ChangeMintFee(\n            _pendleMarket,\n            _newFee\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334-L335"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n\nfunction changeMintFee(\n        uint256 _newFee\n    )\n        external\n        onlyController\n    {\n        if (_newFee > MAX_MINT_FEE) {\n            revert FeeTooHigh();\n        }\n\n        mintFee = _newFee;\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592-L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n\nfunction changeMinDepositValue(\n        uint256 _newMinDepositValue\n    )\n        external\n        onlyMaster\n    {\n        if (_newMinDepositValue == 0) {\n            revert NoValue();\n        }\n\n        minDepositEthValue = _newMinDepositValue;\n    }\n}\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111-L1112"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Missing Checks for Address(0x0)",
      "description": "Lack of zero-address validation on address parameters may lead to transaction reverts, waste gas, require resubmission of transactions and may even force contract redeployments in certain cases within the protocol.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n72: function forwardFeeManagerNFT: address _feeManagerContract\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L72"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1253: function liquidatePartiallyFromTokens: address _paybackToken\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1253"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1254: function liquidatePartiallyFromTokens: address _receiveToken\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1254"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1317: function coreLiquidationIsolationPools: address _caller\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1317"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1318: function coreLiquidationIsolationPools: address _paybackToken\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1318"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1319: function coreLiquidationIsolationPools: address _receiveToken\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1319"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1368: function syncManually: address _poolToken\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1368"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n629: function claimWiseFees: address _poolToken\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L629"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n232: function _setAaveFlag: address _underlyingToken\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L232"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n683: function initialize: address _underlyingPendleMarket\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L683"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n684: function initialize: address _pendleController\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L684"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n52: function setFarmContract: address _farmContract\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n13: function _callOptionalReturn: address token\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n14: function _addOracle: IPriceFeed _priceFeedAddress\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n61: function _checkFunctionExistence: address _tokenAggregator\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L61"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n666: function _setAaveTokenAddress: address _aaveToken\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L666"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Protect your NFT from copying in POW forks",
      "description": "Ethereum has performed the long-awaited \"merge\" that will dramatically reduce the environmental impact of the network\n\nThere may be forked versions of Ethereum, which could cause confusion and lead to scams as duplicated NFT assets enter the market.\n\nIf the Ethereum Merge, which took place in September 2022, results in the Blockchain splitting into two Blockchains due to the 'THE DAO' attack in 2016, this could result in duplication of immutable tokens (NFTs).\n\nIn any case, duplicate NFTs will exist due to the ETH proof-of-work chain and other potential forks, and there’s likely to be some level of confusion around which assets are 'official' or 'authentic.'\n\nEven so, there could be a frenzy for these copies, as NFT owners attempt to flip the proof-of-work versions of their valuable tokens.\n\nAs ETHPOW and any other forks spin off of the Ethereum mainnet, they will yield duplicate versions of Ethereum’s NFTs. An NFT is simply a blockchain token, and it can work as a deed of ownership to digital items like artwork and collectibles. A forked Ethereum chain will thus have duplicated deeds that point to the same tokenURI\n\nAbout Merge Replay Attack: https://twitter.com/elerium115/status/1558471934924431363?s=20&t=RRheaYJwo-GmSnePwofgag",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n340: function tokenURI(\n\n341: function tokenURI(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L340-L341"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n182: function tokenURI(\n\n183: function tokenURI(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L182-L183"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Contracts are designed to receive ETH but do not implement function for withdrawal",
      "description": "The following contracts can receive ETH but can not withdraw, ETH is occasionally sent by users will be stuck in those contracts.\nThis functionality also applies to baseTokens resulting in locked tokens and loss of funds.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n21: receive()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n125: receive()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L125"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "`safeTransfer` function does not check for contract existence",
      "description": "According to the implementation of the of the library's safeTransfer function, the contract existences are not checked. It is possible that a token becomes non-existent in the future; for instance, if some bugs are found for the output token, it is possible that the output token will be destroyed through calling its selfdestruct function after migrating its data to another contract for fixing these bugs. When this happens, such output token becomes non-existent but calling the swap function to swap for it does not revert. As a result, the user can lose tokens ",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n13: function _safeTransfer(\n        address _token,\n        address _to,\n        uint256 _value\n    )\n        internal\n    {\n        _callOptionalReturn(\n            _token,\n            abi.encodeWithSelector(\n                IERC20.transfer.selector,\n                _to,\n                _value\n            )\n        );\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n34: function _safeTransferFrom(\n        address _token,\n        address _from,\n        address _to,\n        uint256 _value\n    )\n        internal\n    {\n        _callOptionalReturn(\n            _token,\n            abi.encodeWithSelector(\n                IERC20.transferFrom.selector,\n                _from,\n                _to,\n                _value\n            )\n        );\n    }\n}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L34"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "`tokenURI()` does not follow EIP-721",
      "description": "The <a href=\"https://eips.ethereum.org/EIPS/eip-721\">EIP</a> states that `tokenURI()` \"Throws if `_tokenId` is not a valid NFT\", which the code below does not do. If the NFT has not yet been minted, `tokenURI()` should revert",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n341: function tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n        require(\n            _exists(_tokenId) == true,\n            \"PositionNFTs: WRONG_TOKEN\"\n        );\n\n        string memory currentBaseURI = baseURI;\n\n        if (bytes(currentBaseURI).length == 0) {\n            return \"\";\n        }\n\n        return string(\n            abi.encodePacked(\n                currentBaseURI,\n                _toString(_tokenId),\n                baseExtension\n            )\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L341"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n183: function tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n        require(\n            _exists(_tokenId) == true,\n            \"PowerFarmsNFTs: WRONG_TOKEN\"\n        );\n\n        string memory currentBaseURI = baseURI;\n\n        if (bytes(currentBaseURI).length == 0) {\n            return \"\";\n        }\n\n        return string(\n            abi.encodePacked(\n                currentBaseURI,\n                _toString(_tokenId),\n                baseExtension\n            )\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L183"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "Usage of `payable.transfer` can lead to loss of funds",
      "description": "The funds that are to be sent can be lost. The issues with `transfer()` and `send()` are outlined <a href=\"https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/\">here</a>:\nThe `transfer()` call requires that the recipient to be either an EOA account, or a contract that has a `payable` callback. For the contract case, the `transfer()` call only provides 2300 gas for the contract to complete its operations. This means the following cases can cause the transfer to fail:\n\n- The contract does not have a `payable` callback\n- The contract's `payable` callback spends more than 2300 gas (which is only enough to emit something)\n- The contract is called through a proxy which itself uses up the 2300 gas Use OpenZeppelin's `Address.sendValue()` instead",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n607: payable(_to).transfer(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L607"
          ]
        }
      ]
    },
    {
      "severity": "Low",
      "title": "A year is not always 365 days",
      "description": "On leap years, the number of days is 366, so calculations during those years will return the wrong value",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n300: uint256 internal constant ONE_YEAR = 365 days;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L300"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n53: uint256 internal constant ONE_YEAR = 365 days;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n210: uint256 internal constant ONE_YEAR = 365 days;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L210"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "The call `abi.encodeWithSelector` is not type safe",
      "description": "The call `abi.encodeCall` should be used instead. Note `abi.encodeCall` is only safe from typographical errors in solidity versions 0.8.13 and above",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n22: abi.encodeWithSelector(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L22"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n22: abi.encodeWithSelector(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L22"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n44: abi.encodeWithSelector(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L44"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Add inline comments for unnamed variables in function declarations",
      "description": "Unnamed variables in function declarations can confuse developers. To enhance clarity, add inline comments next to each unnamed variable. E.g address, -> address /* to */,",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n667: function _removePositionData(\n        uint256 _nftId,\n        address _poolToken,\n        function(uint256) view returns (uint256) _getPositionTokenLength,\n        function(uint256, uint256) view returns (address) _getPositionTokenByIndex,\n        function(uint256, address) internal _deleteLastPositionData,\n        bool isLending\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L668"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1184: function _updatePoolStorage(\n        address _poolToken,\n        uint256 _amount,\n        uint256 _shares,\n        function(address, uint256) functionAmountA,\n        function(address, uint256) functionAmountB,\n        function(address, uint256) functionSharesA\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1185"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "`address` shouldn't be hard-coded",
      "description": "It is often better to declare `address`es as `immutable`, and assign them via constructor arguments. This allows the code to remain the same across deployments on different networks, and avoids recompilation when addresses need to change.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n14: address internal constant ZERO_ADDRESS = address(0x0);\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n30: master = address(0x0);\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n86: address internal constant BALANCER_ADDRESS = 0xBA12222222228d8Ba445958a75a0704d566BF2C8;\n\n92: address internal constant ST_ETH_ADDRESS = 0xae7ab96520DE3A18E5e111B5EaAb095312D7fE84;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L92",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n74: address internal constant ARB_REWARDS_ADDRESS = 0x23a102e78D1FF1645a3666691495174764a5FCAF;\n\n75: address internal constant ARB_TOKEN_ADDRESS = 0x912CE59144191C1204E64559FE8253a0e49E6548;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L74-L75"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n11: address internal constant ZERO_ADDRESS = address(0x0);\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n79: address public constant SEQUENCER_ADDRESS = 0xFdB631F5EE196F0ed6FAa767959853A9F217697D;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L79"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Array lengths not checked",
      "description": "If the length of the arrays are not required to be of the same length, user operations may not be fully executed",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n\nfunction _curveSecurityChecks(\n        address[] memory _lendTokens,\n        address[] memory _borrowTokens\n    )\n        internal\n    {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L454-L455"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n\nfunction setAaveFlagBulk(\n        address[] calldata _poolTokens,\n        address[] calldata _underlyingTokens\n    )\n        external\n        onlyMaster\n    {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L82-L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n\nfunction setPoolFeeBulk(\n        address[] calldata _poolTokens,\n        uint256[] calldata _newFees\n    )\n        external\n        onlyMaster\n    {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L135-L136"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n\nfunction addOracleBulk(\n        address[] calldata _tokenAddresses,\n        IPriceFeed[] calldata _priceFeedAddresses,\n        address[][] calldata _underlyingFeedTokens\n    )\n        external\n        onlyMaster\n    {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L379-L380"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n\nfunction setAaveTokenAddressBulk(\n        address[] calldata _underlyingAssets,\n        address[] calldata _aaveTokens\n    )\n        external\n        onlyMaster\n    {\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L64-L65"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Assembly block creates dirty bits",
      "description": "Manipulating data directly at the free memory pointer location without subsequently adjusting the pointer can lead to unwanted data remnants, or \"dirty bits\", in that memory spot. This can cause challenges for the Solidity optimizer, making it difficult to determine if memory cleaning is required before reuse, potentially resulting in less efficient optimization. To mitigate this issue, it's advised to always update the free memory pointer following any data write operation. Furthermore, using the `assembly (\"memory-safe\") { ... }` annotation will clearly indicate to the optimizer the sections of your code that are memory-safe, improving code efficiency and reducing the potential for errors.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n56: function _clone(\n        address _underlyingPendleMarket,\n        string memory _tokenName,\n        string memory _symbolName,\n        uint16 _maxCardinality\n    )\n        private\n        returns (address pendlePowerFarmTokenAddress)\n    {\n\n\t\t...\n\n\t\tassembly {\n\n            let clone := mload(0x40)\n\n            mstore(\n                clone,\n                0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000\n            )\n\n            mstore(\n                add(clone, 0x14),\n                targetBytes\n            )\n\n            mstore(\n                add(clone, 0x28),\n                0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000\n            )\n\n            pendlePowerFarmTokenAddress := create2(\n                0,\n                clone,\n                0x37,\n                salt\n            )\n        }\n\n\t\t...\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L57"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Avoid mutating function parameters",
      "description": "Function parameters in Solidity are passed by value, meaning they are essentially local copies. Mutating them can lead to confusion and errors because the changes don't persist outside the function. By keeping function parameters immutable, you ensure clarity in code behavior, preventing unintended side-effects. If you need to modify a value based on a parameter, use a local variable inside the function, leaving the original parameter unaltered. By adhering to this practice, you maintain a clear distinction between input data and the internal processing logic, improving code readability and reducing the potential for bugs.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n414: function _logicOpenPosition(\n        bool _isAave,\n        uint256 _nftId,\n        uint256 _depositAmount, // @audit <--- \n        uint256 _totalDebtBalancer,\n        uint256 _allowedSpread\n    )\n        internal\n    {\n        uint256 reverseAllowedSpread = 2\n            * PRECISION_FACTOR_E18\n            - _allowedSpread;\n\n        if (block.chainid == ARB_CHAIN_ID) {\n\n            _depositAmount = _getTokensUniV3(\n                _depositAmount,\n                _getEthInTokens(\n                        ENTRY_ASSET,\n                        _depositAmount\n                    )\n                * reverseAllowedSpread\n                / PRECISION_FACTOR_E18,\n                WETH_ADDRESS,\n                ENTRY_ASSET\n            );\n        }\n\n        uint256 syReceived = PENDLE_SY.deposit(\n            {\n                _receiver: address(this),\n                _tokenIn: ENTRY_ASSET,\n                _amountTokenToDeposit: _depositAmount,\n                _minSharesOut: PENDLE_SY.previewDeposit(\n                    ENTRY_ASSET,\n                    _depositAmount\n                )\n            }\n        );\n\n        (   ,\n            uint256 netPtFromSwap,\n            ,\n            ,\n            ,\n        ) = PENDLE_ROUTER_STATIC.addLiquiditySingleSyStatic(\n            address(PENDLE_MARKET),\n            syReceived\n        );\n\n        (\n            uint256 netLpOut\n            ,\n        ) = PENDLE_ROUTER.addLiquiditySingleSy(\n            {\n                _receiver: address(this),\n                _market: address(PENDLE_MARKET),\n                _netSyIn: syReceived,\n                _minLpOut: 0,\n                _guessPtReceivedFromSy: ApproxParams(\n                    {\n                        guessMin: netPtFromSwap - 100,\n                        guessMax: netPtFromSwap + 100,\n                        guessOffchain: 0,\n                        maxIteration: 50,\n                        eps: 1e15\n                    }\n                )\n            }\n        );\n\n        uint256 ethValueBefore = _getTokensInETH(\n            ENTRY_ASSET,\n            _depositAmount\n        );\n\n        (\n            uint256 receivedShares\n            ,\n        ) = IPendleChild(PENDLE_CHILD).depositExactAmount(\n            netLpOut\n        );\n\n        uint256 ethValueAfter = _getTokensInETH(\n            PENDLE_CHILD,\n            receivedShares\n        )\n            * _allowedSpread\n            / PRECISION_FACTOR_E18;\n\n        if (ethValueAfter < ethValueBefore) {\n            revert TooMuchValueLost();\n        }\n\n        WISE_LENDING.depositExactAmount(\n            _nftId,\n            PENDLE_CHILD,\n            receivedShares\n        );\n\n        _borrowExactAmount(\n            _isAave,\n            _nftId,\n            _totalDebtBalancer\n        );\n\n        if (_checkDebtRatio(_nftId) == false) {\n            revert DebtRatioTooHigh();\n        }\n\n        _safeTransfer(\n            WETH_ADDRESS,\n            BALANCER_ADDRESS,\n            _totalDebtBalancer\n        );\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L415"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Avoid the use of sensitive terms",
      "description": "Use <a href=\"https://www.zdnet.com/article/mysql-drops-master-slave-and-blacklist-whitelist-terminology/\">alternative variants</a>, e.g. allowlist/denylist instead of whitelist/blacklist",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n246: if (_checkBlacklisted(_poolToken) == true) {\n\n284: if (_checkBlacklisted(_poolToken) == true) {\n\n367: if (_checkBlacklisted(_poolToken) == true) {\n\n675: if (wasBlacklisted[token] == true) {\n\n693: * locked due to blacklisted token.\n\n695: function positionBlackListToken(\n\n716: if (_checkBlacklisted(token) == true) {\n\n741: if (_checkBlacklisted(token) == true) {\n\n976: * @dev Set function for blacklisting token.\n\n980: function setBlacklistToken(\n\n987: wasBlacklisted[_tokenAddress] = _state;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L716",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L246",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L284",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L367",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L675",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L693",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L695",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L741",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L976",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L987"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n21: error TokenBlackListed();\n\n33: error Blacklisted();\n\n237: // Mapping pool token to blacklist bool\n\n238: mapping(address => bool) public wasBlacklisted;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L21",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L33",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L237"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n357: * No heartbeat or blacklisted checks are\n\n391: * No blacklisted check is included\n\n468: * and blacklisted checks.\n\n470: function _checkBlacklisted(\n\n477: return wasBlacklisted[_poolToken] == true;\n\n1067: wasBlacklisted[\n\n1078: * @dev Wrapper for {_checkBlacklisted}.\n\n1086: if (_checkBlacklisted(_poolToken) == true) {\n\n1087: revert TokenBlackListed();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L468",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L391",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L357",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1067",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L477",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L470",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1087",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1086",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1078"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "No need for `== true` or `== false` checks",
      "description": "There is no need to verify that `== true` or `== false` when the variable checked upon is a boolean as well.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n223: if (verifiedIsolationPool[_poolAddress] == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L223"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n244: if (positionLocked[_nftId] == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L244"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n265: if (positionLocked[_nftIdLiquidator] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L265"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n627: if (hashMap[hashData] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L627"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1165: if (_checkLendingDataEmpty(_nftId, _poolToken) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1165"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n36: if (parametersLocked[_poolToken] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L36"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n161: if (_exists(tokenId) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n76: if (_onBehalf == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L76"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n200: if (_byPassCase(_caller) == true) {\n\n204: if (positionLocked[_nftId] == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L200",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L204"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n246: if (WISE_ORACLE.chainLinkIsDead(_poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L246"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n282: if (POSITION_NFT.isOwner(_nftId, _caller) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L282"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n306: if (state == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L306"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n397: if (_onBehalf == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L397"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n592: if (userLendingData[_nftId][_receiveTokens].unCollateralized == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L592"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n87: if (powerFarmCheck == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L87"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n290: if (_aboveThreshold(_poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L290"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1527: if (_onBehalf == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1527"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n354: if (sendingProgress == true) {\n\n358: if (_sendingProgressAaveHub() == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L354",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L358"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n400: if (verifiedIsolationPool[_sender] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L400"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n104: if (increaseCardinalityRequired == true) {\n\n108: if (oldestObservationSatisfied == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L104",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n109: if (increaseCardinalityRequired == true) {\n\n113: if (oldestObservationSatisfied == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L113",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n90: if (increaseCardinalityRequired == true) {\n\n94: if (oldestObservationSatisfied == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L94",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L90"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n261: if (isAaveToken[tokenAddress] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L261"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n418: if (poolTokenAdded[_poolToken] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L418"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n449: if (poolTokenAdded[_poolToken] == false) {\n\n473: if (found == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L473",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L449"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n650: if (isAaveToken[_poolToken] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L650"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n701: if (allowedTokens[caller][_feeToken] == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L701"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n127: if (isAave[_nftId] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L127"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n203: if (_notBelowMinDepositAmount(leveragedAmount) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L203"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n365: if (isShutdown == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L365"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n67: if (allowEnter == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n215: if (_ethBack == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L215"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n333: if (_isAave == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L333"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n520: if (_checkDebtRatio(_nftId) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L520"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n538: if (_isAave == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L538"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n571: if (_checkDebtRatio(_nftId) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L571"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n39: if (sendingProgress == true) {\n\n43: if (WISE_LENDING.sendingProgress() == true) {\n\n47: if (AAVE_HUB.sendingProgressAaveHub() == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L43",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L39"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n291: if (_checkDebtRatio(wiseLendingNFT) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L291"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n304: if (_compareHashes(_pendleMarket, rewardTokens) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L304"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n396: if (_fromInside == false) {\n\n396: if (_fromInside == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L396",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L396"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n456: if (IS_ETH_MAIN == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L456"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n154: if (_overWritten == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n699: if (PENDLE_MARKET.isExpired() == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L699"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n31: if (success == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n33: if (success == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n45: if (_checkFunctionExistence(address(tokenAggregator)) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n117: if (uniTwapPoolInfoStruct.isUniPool == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L117"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n270: if (_chainLinkIsDead(ETH_USD_PLACEHOLDER) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L270"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n526: if (IS_ARBITRUM_CHAIN == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L526"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n76: if (chainLinkIsDead(_tokenAddress) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L76"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n451: if (sequencerIsDead() == true) {\n\n475: if (state == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L475",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L451"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n246: if (_checkBlacklisted(_poolToken) == true) {\n\n255: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {\n\n259: if (WISE_LENDING.positionLocked(_nftId) == true) {\n\n263: if (_isUncollateralized(_nftId, _poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L259",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L255",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L246",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L263"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n284: if (_checkBlacklisted(_poolToken) == true) {\n\n293: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {\n\n297: if (WISE_LENDING.positionLocked(_nftId) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L293",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L297",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L284"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n323: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {\n\n327: if (WISE_LENDING.positionLocked(_nftId) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L327",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L323"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n343: if (checkHeartbeat(_poolAddress) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L343"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n367: if (_checkBlacklisted(_poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L367"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n671: if (checkHeartbeat(token) == false) {\n\n675: if (wasBlacklisted[token] == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L671",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L675"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n716: if (_checkBlacklisted(token) == true) {\n\n716: if (_checkBlacklisted(token) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L716",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L716"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n792: if (_isUncollateralized(_nftId, _poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L792"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n842: if (_isUncollateralized(_nftId, _poolToken) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L842"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1014: if (securityWorker[msg.sender] == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1014"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n206: if (_isUncollateralized(_nftId, _poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L206"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n263: if (_isUncollateralized(_nftId, _poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L263"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n678: if (WISE_LENDING.borrowPoolData(_poolAddress).allowBorrow == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L678"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n707: if (WISE_LENDING.positionLocked(_nftId) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L707"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n801: if (_getState(_nftId, _powerFarm) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L801"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1086: if (_checkBlacklisted(_poolToken) == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1086"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1102: if (_success == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1102"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n38: if (sendingProgressAaveHub == true) {\n\n42: if (WISE_LENDING.sendingProgress() == true) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L38",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L42"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n70: if (POSITION_NFT.isOwner(_nftId, msg.sender) == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L70"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n214: if (success == false) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L214"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Condition will not revert when `block.timestamp` is `==` to the compared variable",
      "description": "The condition does not revert when block.timestamp is equal to the compared `>` or `<` variable. For example, if there is a check for `block.timestamp > expireTime` then there should be a check for cases where `block.timestamp` is `==` to `expireTime`\n ",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n475: if (_getExpiry() > block.timestamp) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L475"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Consider adding a deny-list",
      "description": "Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Consider adding formal verification proofs",
      "description": "Formal verification is the act of proving or disproving the correctness of intended algorithms underlying a system with respect to a certain formal specification/property/invariant, using formal methods of mathematics.\n\nSome tools that are currently available to perform these tests on smart contracts are [SMTChecker](https://docs.soliditylang.org/en/latest/smtchecker.html) and [Certora Prover](https://www.certora.com/).\n\nThere are 6 instances:\n\n- [*DestinationBridge.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/bridge/DestinationBridge.sol)\n\n- [*SourceBridge.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/bridge/SourceBridge.sol)\n\n- [*IRWADynamicOracle.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/rwaOracles/IRWADynamicOracle.sol)\n\n- [*RWADynamicOracle.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/rwaOracles/RWADynamicOracle.sol)\n\n- [*rUSDY.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/usdy/rUSDY.sol)\n\n- [*rUSDYFactory.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/usdy/rUSDYFactory.sol)",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "All in-scope contracts",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Consider emitting an event at the end of the constructor",
      "description": "This will allow users to easily exactly pinpoint when and by whom a contract was constructed",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n22: constructor() {\n        master = msg.sender;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L22"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Consider making contracts `Upgradeable`",
      "description": "This allows for bugs to be fixed in production, at the expense of significantly increasing centralization.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n7: abstract contract MainHelper is WiseLowLevelHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n292: * sent token are inside the contract for the pool with\n     * {_poolToken}. If this is the case it adds those token\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n9: contract OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n8: abstract contract PoolManager is WiseCore {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n8: abstract contract WiseCore is MainHelper, TransferHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n43: contract WiseLending is PoolManager {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n30: contract WiseLendingDeclaration is\n    OwnableMaster,\n    WrapperHelper,\n    SendValueHelper\n{\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n179: // NFT contract interface for positions\n    IPositionNFTs public immutable POSITION_NFT;\n\n    // OraceHub interface\n    IWiseOracleHub public immutable WISE_ORACLE;\n\n    // check if it is a powerfarm\n    bool internal powerFarmCheck;\n\n    uint256 internal constant GHOST_AMOUNT = 1E3;\n\n    // Structs ------------------------------------------\n\n    struct LendingEntry {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L179"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n7: abstract contract WiseLowLevelHelper is WiseLendingDeclaration {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n5: contract CustomOracleSetup {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n13: contract PendleChildLpOracle is CustomOracleSetup  {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n10: * @dev PriceFeed contract for Lp-Token with USD\n * chainLink feed to get a feed measured in ETH.\n * Takes chainLink oracle value and multiplies it\n * with the corresponding TWAP and other chainLink oracles.\n */\n\nimport \"../InterfaceHub/IPendle.sol\";\nimport \"../InterfaceHub/IPriceFeed.sol\";\nimport \"../InterfaceHub/IOraclePendle.sol\";\nimport {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n28: contract PendleLpOracle {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L28"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n10: * @dev Pricefeed contract for PtToken with USD\n * chainLink feed to get a feed measured in ETH.\n * Takes chainLink oracle value and multiplies it with\n * the corresponding TWAP and other chainLink oracles\n */\n\nimport \"../InterfaceHub/IPriceFeed.sol\";\nimport \"../InterfaceHub/IOraclePendle.sol\";\n\nerror CardinalityNotSatisfied();\nerror OldestObservationNotSatisfied();\n\ncontract PtOracleDerivative {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n10: * @dev PriceFeed contract for Pt-Token with USD\n * chainLink feed to get a feed measured in ETH.\n * Takes chainLink oracle value and multiplies it\n * with the corresponding TWAP and other chainLink oracles.\n */\n\nimport \"../InterfaceHub/IPriceFeed.sol\";\nimport \"../InterfaceHub/IOraclePendle.sol\";\n\nerror CardinalityNotSatisfied();\nerror OldestObservationNotSatisfied();\n\ncontract PtOraclePure {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n31: contract DeclarationsFeeManager is FeeManagerEvents, OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n99: // Interface aave V3 contract\n    IAave public immutable AAVE;\n\n    // Interface wiseLending contract\n    IWiseLending public immutable WISE_LENDING;\n\n    // Interface position NFT contract\n    IPositionNFTs public immutable POSITION_NFTS;\n\n    // Interface wiseSecurity contract\n    IWiseSecurity public immutable WISE_SECURITY;\n\n    // Interface wise oracleHub contract\n    IWiseOracleHub public immutable ORACLE_HUB;\n\n    // ---- Variables ----\n\n    // Global total bad debt variable\n    uint256 public totalBadDebtETH;\n\n    // Incentive percentage for paying back bad debt\n    uint256 public paybackIncentive;\n\n    // Array of pool tokens in wiseLending\n    address[] public poolTokenAddresses;\n\n    // Address of incentive master\n    address public incentiveMaster;\n\n    // Proposed incentive master (for changing)\n    address public proposedIncentiveMaster;\n\n    // Address of incentive owner A\n    address public incentiveOwnerA;\n\n    // Address of incentive owner B\n    address public incentiveOwnerB;\n\n    // ---- Mappings ----\n\n    // Bad debt of a specific position\n    mapping(uint256 => uint256) public badDebtPosition;\n\n    // Amount of fee token inside feeManager\n    mapping(address => uint256) public feeTokens;\n\n    // Open incetive amount for incentiveOwner in ETH\n    mapping(address => uint256) public incentiveUSD;\n\n    // Flag that specific token is already added\n    mapping(address => bool) public poolTokenAdded;\n\n    // Flag for token being aToken\n    mapping(address => bool) public isAaveToken;\n\n    // Getting underlying token of aave aToken\n    mapping(address => address) public underlyingToken;\n\n    // Showing which token are allowed to claim for beneficial address\n    mapping(address => mapping(address => bool)) public allowedTokens;\n\n    // Gives claimable token amount for incentiveOwner per token\n    mapping(address => mapping(address => uint256)) public gatheredIncentiveToken;\n\n    // Position NFT id of the feeManager\n    uint256 public immutable FEE_MANAGER_NFT;\n\n    // Precision factors for computations\n    uint256 internal constant PRECISION_FACTOR_E15 = 1E15;\n    uint256 internal constant PRECISION_FACTOR_E16 = 1E16;\n    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;\n\n    // Base portion from gathered fees for incentiveOwners (0.5%)\n    uint256 public constant INCENTIVE_PORTION = 5 * PRECISION_FACTOR_E15;\n\n    // ---- Modifier ----\n\n    modifier onlyWiseSecurity() {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L99"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n14: * @dev Purpose of this contract is to organize fee distribution from wiseLending.\n * The feeManager aquires fee token in form of shares from each pool and can call them\n * with \"claimWiseFees()\" for each pool.\n *\n * Furthermore, this contracts has two different incentive\n * structures which can be used to bootstrap the WISE ecosystem (beneficial and incnetiveOwner roles).\n *\n * Additionally, this contract keeps track of the bad debt of each postion and has a simple mechanism\n * to pay them back via incentives. The incentive amount is funded by the gathered fees.\n */\n\ncontract FeeManager is FeeManagerHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n491: * wiseLending. Only callable by wiseSecurity contract\n     * during liquidation.\n     */\n    function increaseTotalBadDebtLiquidation(\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L491"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n512: * Only callable by wiseSecurity contract during liquidation.\n     */\n    function setBadDebtUserLiquidation(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L512"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n5: contract FeeManagerEvents {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n8: abstract contract FeeManagerHelper is DeclarationsFeeManager, TransferHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n7: abstract contract PendlePowerFarm is PendlePowerFarmLeverageLogic {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n36: contract PendlePowerFarmDeclarations is\n    WrapperHelper,\n    TransferHelper,\n    ApprovalHelper,\n    SendValueHelper\n{\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L36"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n51: // Adjustable by admin of the contract\n    uint256 public minDepositEthAmount;\n\n    address public immutable aaveTokenAddresses;\n    address public immutable borrowTokenAddresses;\n\n    address public immutable ENTRY_ASSET;\n    address public immutable PENDLE_CHILD;\n\n    // RESTRICTION VALUES\n\n    uint256 internal constant MAX_COLLATERAL_FACTOR = 95 * PRECISION_FACTOR_E16;\n\n    // Interfaces\n\n    IAave public immutable AAVE;\n    IAaveHub public immutable AAVE_HUB;\n    IWiseLending public immutable WISE_LENDING;\n    IWiseOracleHub public immutable ORACLE_HUB;\n    IWiseSecurity public immutable WISE_SECURITY;\n    IBalancerVault public immutable BALANCER_VAULT;\n    IPositionNFTs public immutable POSITION_NFT;\n    IStETH public immutable ST_ETH;\n    ICurve public immutable CURVE;\n    IUniswapV3 public immutable UNISWAP_V3_ROUTER;\n\n    IPendleSy public immutable PENDLE_SY;\n    IPendleRouter public immutable PENDLE_ROUTER;\n    IPendleMarket public immutable PENDLE_MARKET;\n    IPendleRouterStatic public immutable PENDLE_ROUTER_STATIC;\n\n    address internal immutable WETH_ADDRESS;\n\n    address immutable AAVE_ADDRESS;\n\n    address internal constant BALANCER_ADDRESS = 0xBA12222222228d8Ba445958a75a0704d566BF2C8;\n\n    address immutable AAVE_HUB_ADDRESS;\n\n    address immutable AAVE_WETH_ADDRESS;\n\n    address internal constant ST_ETH_ADDRESS = 0xae7ab96520DE3A18E5e111B5EaAb095312D7fE84;\n\n    // Uniswap fee for arbitrum\n    uint24 internal constant UNISWAP_V3_FEE = 100;\n\n    // Math constant for computations\n    uint256 internal constant MAX_AMOUNT = type(uint256).max;\n    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;\n    uint256 internal constant PRECISION_FACTOR_E16 = 1E16;\n    uint256 internal constant MAX_LEVERAGE = 15 * PRECISION_FACTOR_E18;\n    uint256 internal constant FIVTY_PERCENT = 0.5 ether;\n\n    uint256 internal constant ETH_CHAIN_ID = 1;\n    uint256 internal constant ARB_CHAIN_ID = 42161;\n\n    // Mapping of {keyNFT} to type of pool\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L51"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n7: abstract contract PendlePowerFarmLeverageLogic is\n    PendlePowerFarmMathLogic,\n    IFlashLoanRecipient\n{\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n7: abstract contract PendlePowerFarmMathLogic is PendlePowerFarmDeclarations {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n15: contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L15"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n8: contract PendlePowerFarmController is PendlePowerFarmControllerHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n30: contract PendlePowerFarmControllerBase is\n    OwnableMaster,\n    TransferHelper,\n    ApprovalHelper\n{\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n7: abstract contract PendlePowerFarmControllerHelper is PendlePowerFarmControllerBase {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n9: contract PendlePowerFarmTokenFactory {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n10: contract MinterReserver {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n7: contract ApprovalHelper is CallOptionalReturn {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n7: contract CallOptionalReturn {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n8: contract SendValueHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n7: contract TransferHelper is CallOptionalReturn {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n7: contract WrapperHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n33: abstract contract Declarations is OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n7: abstract contract OracleHelper is Declarations {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n15: * The master address is owned by a timelock contract which itself is secured by a\n * multisig. Only the master can add new price feed <-> address pairs to the contract.\n *\n * One advantage is the linking of price feeds to their underlying token address.\n * Therefore, users can get the current ETH value of a token by just knowing the token\n * address when calling {latestResolver}. It takes the answer from {latestRoundData}\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L15"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n31: contract WiseOracleHub is OracleHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n15: * @dev WiseSecurity is a core contract for wiseLending including most of\n * the performed security checks for withdraws, borrows, paybacks and liquidations.\n * It also has several read only functions providing UI data for a better user\n * experiencne.\n *\n */\n\nerror NotWiseLendingSecurity();\n\ncontract WiseSecurity is WiseSecurityHelper, ApprovalHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L15"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n45: contract WiseSecurityDeclarations is OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n7: abstract contract WiseSecurityHelper is WiseSecurityDeclarations {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n5: contract AaveEvents {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n7: abstract contract AaveHelper is Declarations {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n16: * @dev Purpose of this contract is to optimize capital efficency by using\n * aave pools. Not borrowed funds are deposited into correspoding aave pools\n * to earn supply APY.\n *\n * The aToken are holded by the wiseLending contract but the accounting\n * is managed by the position NFTs. This is possible due to the included\n * onBehlaf functionallity inside wiseLending.\n */\n\ncontract AaveHub is AaveHelper, TransferHelper, ApprovalHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L16"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Consider using named mappings",
      "description": "Consider moving to solidity version 0.8.18 or later, and using <a href='https://ethereum.stackexchange.com/a/145555'>named mappings</a> to make it easier to understand the purpose of each mapping",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n20: mapping(address => uint256) public reserved;\n\n21: mapping(address => bool) public reserveRole;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L20-L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n267: mapping(address => uint256) internal bufferIncrease;\n\n268: mapping(address => uint256) public maxDepositValueToken;\n\n270: mapping(uint256 => address[]) public positionLendTokenData;\n\n271: mapping(uint256 => address[]) public positionBorrowTokenData;\n\n273: mapping(uint256 => mapping(address => uint256)) public userBorrowShares;\n\n274: mapping(uint256 => mapping(address => uint256)) public pureCollateralAmount;\n\n275: mapping(uint256 => mapping(address => LendingEntry)) public userLendingData;\n\n278: mapping(address => BorrowRatesEntry) public borrowRatesData;\n\n279: mapping(address => AlgorithmEntry) public algorithmData;\n\n280: mapping(address => GlobalPoolEntry) public globalPoolData;\n\n281: mapping(address => LendingPoolEntry) public lendingPoolData;\n\n282: mapping(address => BorrowPoolEntry) public borrowPoolData;\n\n283: mapping(address => TimestampsPoolEntry) public timestampsPoolData;\n\n286: mapping(uint256 => bool) public positionLocked;\n\n287: mapping(address => bool) internal parametersLocked;\n\n288: mapping(address => bool) public verifiedIsolationPool;\n\n291: mapping(bytes32 => bool) internal hashMapPositionBorrow;\n\n292: mapping(bytes32 => bool) internal hashMapPositionLending;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L291",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L273",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L274",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L275",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L278",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L279",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L280",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L281",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L282",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L283",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L286",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L292",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L267",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L268",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L270",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L271"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n12: mapping(uint80 => uint256) public timeStampByRoundId;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n140: mapping(uint256 => uint256) public badDebtPosition;\n\n143: mapping(address => uint256) public feeTokens;\n\n146: mapping(address => uint256) public incentiveUSD;\n\n149: mapping(address => bool) public poolTokenAdded;\n\n152: mapping(address => bool) public isAaveToken;\n\n155: mapping(address => address) public underlyingToken;\n\n158: mapping(address => mapping(address => bool)) public allowedTokens;\n\n161: mapping(address => mapping(address => uint256)) public gatheredIncentiveToken;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L161",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L155",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L143",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L140",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n108: mapping(uint256 => bool) public isAave;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n58: mapping(address => address) public pendleChildAddress;\n\n59: mapping(address => CompoundStruct) pendleChildCompoundInfo;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L58-L59"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n24: mapping(uint256 => uint256) public farmingKeys;\n\n27: mapping(address => uint256) public reservedKeys;\n\n30: mapping(uint256 => uint256) public availableNFTs;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L27",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L24",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n139: mapping(address => uint8) _tokenDecimals;\n\n142: mapping(address => IPriceFeed) public priceFeed;\n\n145: mapping(address => uint256) public heartBeat;\n\n148: mapping(address => IAggregator) public tokenAggregatorFromTokenAddress;\n\n151: mapping(address => address[]) public underlyingFeedTokens;\n\n154: mapping(address => UniTwapPoolInfo) public uniTwapPoolInfo;\n\n157: mapping(address => DerivativePartnerInfo) public derivativePartnerTwap;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L145",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L148",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L157",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L154",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L151",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L139",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L142"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n238: mapping(address => bool) public wasBlacklisted;\n\n241: mapping(address => CurveSwapStructData) public curveSwapInfoData;\n\n244: mapping(address => CurveSwapStructToken) public curveSwapInfoToken;\n\n247: mapping(address => bool) public securityWorker;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L244",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L241",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n41: mapping(address => address) public aaveTokenAddress;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L41"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Constant redefined elsewhere",
      "description": "Consider defining in only one contract so that values cannot become out of sync when only one location is updated. A <a href=\"https://medium.com/coinmonks/gas-cost-of-solidity-library-functions-dbe0cedd4678\">cheap way</a> to store constants in a single location is to create an `internal constant` in a `library`. If the variable is a local cache of another contract's value, consider making the cache variable internal or private, which will require external users to query the contract with the source of truth, so that callers don't get out of sync.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n18: uint256 public immutable FEE_MANAGER_NFT;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n165: address public immutable WETH_ADDRESS;\n\n180: IPositionNFTs public immutable POSITION_NFT;\n\n183: IWiseOracleHub public immutable WISE_ORACLE;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L180",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L165",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L183"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n58: address public immutable PENDLE_MARKET_ADDRESS;\n\n59: IPendleMarket public immutable PENDLE_MARKET;\n\n62: IPendleSy public immutable PENDLE_SY;\n\n63: IPriceFeed public immutable FEED_ASSET;\n\n64: IOraclePendle public immutable ORACLE_PENDLE_PT;\n\n73: uint32 public immutable TWAP_DURATION;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L63",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L73",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L58",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L59",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L62",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L64"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n56: IOraclePendle public immutable ORACLE_PENDLE_PT;\n\n71: uint32 public immutable TWAP_DURATION;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L71",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L56"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n44: address public immutable PENDLE_MARKET_ADDRESS;\n\n47: IPriceFeed public immutable FEED_ASSET;\n\n48: IOraclePendle public immutable ORACLE_PENDLE_PT;\n\n57: uint32 public immutable DURATION;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L48",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L57",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L44",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n100: IAave public immutable AAVE;\n\n103: IWiseLending public immutable WISE_LENDING;\n\n106: IPositionNFTs public immutable POSITION_NFTS;\n\n109: IWiseSecurity public immutable WISE_SECURITY;\n\n112: IWiseOracleHub public immutable ORACLE_HUB;\n\n164: uint256 public immutable FEE_MANAGER_NFT;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L112",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L164",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L103",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L100",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L106",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n66: IAave public immutable AAVE;\n\n67: IAaveHub public immutable AAVE_HUB;\n\n68: IWiseLending public immutable WISE_LENDING;\n\n69: IWiseOracleHub public immutable ORACLE_HUB;\n\n70: IWiseSecurity public immutable WISE_SECURITY;\n\n72: IPositionNFTs public immutable POSITION_NFT;\n\n77: IPendleSy public immutable PENDLE_SY;\n\n79: IPendleMarket public immutable PENDLE_MARKET;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L72",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L66",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L67",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L68",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L69",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L70",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L77",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L79"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n14: address public immutable PENDLE_POWER_FARM_CONTROLLER;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n76: address public immutable WETH_ADDRESS;\n\n79: address public constant SEQUENCER_ADDRESS = 0xFdB631F5EE196F0ed6FAa767959853A9F217697D;\n\n82: address public immutable ETH_USD_PLACEHOLDER;\n\n88: IPriceFeed public immutable ETH_PRICE_FEED;\n\n91: IPriceFeed public immutable SEQUENCER;\n\n94: IUniswapV3Factory public immutable UNI_V3_FACTORY;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L91",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L82",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L88",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L76",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L79",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L94"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n186: address public immutable AAVE_HUB;\n\n191: IFeeManager public immutable FEE_MANAGER;\n\n194: IWiseLending public immutable WISE_LENDING;\n\n197: IPositionNFTs public immutable POSITION_NFTS;\n\n200: IWiseOracleHub public immutable WISE_ORACLE;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L197",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L194",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L191",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L186",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L200"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Constants Should Be Defined Rather Than Using Magic Numbers",
      "description": "Even <a href=\"https://github.com/code-423n4/2022-05-opensea-seaport/blob/9d7ce4d08bf3c3010304a0476a785c70c0e90ae7/contracts/lib/TokenTransferrer.sol#L35-L39\">assembly</a> can benefit from using readable constants instead of hex/numeric literals",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n387: j /= 10;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L387"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n400: 48 + (j % 10)\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L400"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n479: eps: 1e15\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L479"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n229: j /= 10;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L229"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Constants in comparisons should appear on the left side",
      "description": "Putting constants on the left side of a comparison operator like `==` or `<` is a best practice known as \"Yoda conditions\", which can help prevent accidental assignment instead of comparison. In some programming languages, if a variable is mistakenly put on the left with a single `=` instead of `==`, it assigns the constant's value to the variable without any compiler error. However, doing this with the constant on the left would generate an error, as constants cannot be assigned values. Although Solidity's static typing system prevents accidental assignments within conditionals, adopting this practice enhances code readability and consistency, especially when developers are working across multiple languages that support this convention.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n542: if (feeAmount == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L542"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n554: if (feeShares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L554"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n681: if (length == 1) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L681"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n838: return userLendingData[_nftId][_poolToken].shares == 0\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L838"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1161: if (_nftId == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1161"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n355: if (bytes(currentBaseURI).length == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L355"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n378: if (_tokenId == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L378"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n588: if (userShares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L588"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n453: if (_value == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L453"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n291: if (amount == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L291"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n640: if (shares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L640"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n663: if (totalBadDebtETH == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L663"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n72: if (borrowShares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L72"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n80: if (totalCollateral == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L80"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n73: if (_flashloanToken.length == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n174: address tokenOut = block.chainid == 1\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L174"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n174: block.chainid == 1\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L174"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n213: if (borrowTokenAmountAave == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L213"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n404: if (borrowShares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L404"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n189: if (availableNFTCount == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L189"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n124: if (_pendleChildShares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L124"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n339: if (additonalAssets == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L339"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n391: if (totalLpAssetsToDistribute == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L391"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n489: return product % _underlyingLpAssetsCurrent == 0\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L489"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n508: if (_amount == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L508"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n539: if (_underlyingLpAssetAmount == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L539"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n548: if (shares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L548"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n559: if (feeShares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L559"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n615: if (_shares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L615"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n654: if (_underlyingLpAssetAmount == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L654"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n122: if (_keyId == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n197: if (bytes(currentBaseURI).length == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L197"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n220: if (_tokenId == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L220"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n26: bool results = returndata.length == 0 || abi.decode(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n74: if (size == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L74"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n537: if (answer == 1) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L537"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n455: if (length == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L455"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n70: if (overallCollateral == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L70"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n453: if (len == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L453"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n510: if (len == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L510"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n652: if (len == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L652"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n924: if (currentTotalBorrowShares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L924"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n961: if (currentTotalLendingShares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L961"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1117: if (_newMinDepositValue == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1117"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n295: if (lendingShares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L295"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n624: if (borrowShares == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L624"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n818: if (borrowAmount == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L818"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1010: if (pseudoTotalPool == 0) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1010"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Constructor declarations should have NatSpec descriptions",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n57: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n25: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n116: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L116"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n105: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L105"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n22: constructor() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L22"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n21: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n32: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n24: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n24: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n33: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n27: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L27"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n159: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L159"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n31: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n12: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n79: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L79"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n16: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L16"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n55: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L55"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n38: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L38"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n11: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n45: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n33: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n42: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L42"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n52: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n27: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L27"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n43: constructor(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L43"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Contract declarations should have NatSpec `@author` annotations",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: \n\nMainHelper.sol\n\nMainHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nOwnableMaster.sol\n\nOwnableMaster.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPoolManager.sol\n\nPoolManager.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPositionNFTs.sol\n\nPositionNFTs.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseCore.sol\n\nWiseCore.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseLendingDeclaration.sol\n\nWiseLendingDeclaration.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseLowLevelHelper.sol\n\nWiseLowLevelHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nCustomOracleSetup.sol\n\nDerivativeOracles/CustomOracleSetup.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendleChildLpOracle.sol\n\nDerivativeOracles/PendleChildLpOracle.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarationsFeeManager.sol\n\nFeeManager/DeclarationsFeeManager.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nFeeManagerEvents.sol\n\nFeeManager/FeeManagerEvents.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nFeeManagerHelper.sol\n\nFeeManager/FeeManagerHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarm.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerFarm.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmDeclarations.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmLeverageLogic.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmMathLogic.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmController.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmControllerBase.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmControllerHelper.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmToken.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmTokenFactory.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nMinterReserver.sol\n\nPowerFarms/PowerFarmNFTs/MinterReserver.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nApprovalHelper.sol\n\nTransferHub/ApprovalHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nCallOptionalReturn.sol\n\nTransferHub/CallOptionalReturn.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nSendValueHelper.sol\n\nTransferHub/SendValueHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nTransferHelper.sol\n\nTransferHub/TransferHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWrapperHelper.sol\n\nTransferHub/WrapperHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarations.sol\n\nWiseOracleHub/Declarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nOracleHelper.sol\n\nWiseOracleHub/OracleHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseSecurityDeclarations.sol\n\nWiseSecurity/WiseSecurityDeclarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseSecurityHelper.sol\n\nWiseSecurity/WiseSecurityHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nAaveEvents.sol\n\nWrapperHub/AaveEvents.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nAaveHelper.sol\n\nWrapperHub/AaveHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarations.sol\n\nWrapperHub/Declarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Contracts should have NatSpec `@dev` tags",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n7: abstract contract MainHelper is WiseLowLevelHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n8: abstract contract PoolManager is WiseCore {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n8: abstract contract WiseCore is MainHelper, TransferHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n43: contract WiseLending is PoolManager {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n7: abstract contract WiseLowLevelHelper is WiseLendingDeclaration {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n13: contract PendleChildLpOracle is CustomOracleSetup  {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n31: contract DeclarationsFeeManager is FeeManagerEvents, OwnableMaster {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n25: contract FeeManager is FeeManagerHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n8: abstract contract FeeManagerHelper is DeclarationsFeeManager, TransferHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n7: abstract contract PendlePowerFarm is PendlePowerFarmLeverageLogic {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n7: abstract contract PendlePowerFarmMathLogic is PendlePowerFarmDeclarations {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n15: contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L15"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n8: contract PendlePowerFarmController is PendlePowerFarmControllerHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n7: abstract contract PendlePowerFarmControllerHelper is PendlePowerFarmControllerBase {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n7: contract ApprovalHelper is CallOptionalReturn {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n7: contract TransferHelper is CallOptionalReturn {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n33: abstract contract Declarations is OwnableMaster {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n7: abstract contract OracleHelper is Declarations {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n31: contract WiseOracleHub is OracleHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n24: contract WiseSecurity is WiseSecurityHelper, ApprovalHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n45: contract WiseSecurityDeclarations is OwnableMaster {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n7: abstract contract WiseSecurityHelper is WiseSecurityDeclarations {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n7: abstract contract AaveHelper is Declarations {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n25: contract AaveHub is AaveHelper, TransferHelper, ApprovalHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Contract declarations should have NatSpec `@title` annotations",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: \n\nMainHelper.sol\n\nMainHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nOwnableMaster.sol\n\nOwnableMaster.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPoolManager.sol\n\nPoolManager.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPositionNFTs.sol\n\nPositionNFTs.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseCore.sol\n\nWiseCore.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseLending.sol\n\nWiseLending.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseLendingDeclaration.sol\n\nWiseLendingDeclaration.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseLowLevelHelper.sol\n\nWiseLowLevelHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nCustomOracleSetup.sol\n\nDerivativeOracles/CustomOracleSetup.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendleChildLpOracle.sol\n\nDerivativeOracles/PendleChildLpOracle.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendleLpOracle.sol\n\nDerivativeOracles/PendleLpOracle.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPtOracleDerivative.sol\n\nDerivativeOracles/PtOracleDerivative.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPtOraclePure.sol\n\nDerivativeOracles/PtOraclePure.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarationsFeeManager.sol\n\nFeeManager/DeclarationsFeeManager.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nFeeManager.sol\n\nFeeManager/FeeManager.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nFeeManagerEvents.sol\n\nFeeManager/FeeManagerEvents.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nFeeManagerHelper.sol\n\nFeeManager/FeeManagerHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarm.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerFarm.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmDeclarations.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmLeverageLogic.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmMathLogic.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerManager.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerManager.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmController.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmControllerBase.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmControllerHelper.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmToken.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmTokenFactory.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nMinterReserver.sol\n\nPowerFarms/PowerFarmNFTs/MinterReserver.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPowerFarmNFTs.sol\n\nPowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nApprovalHelper.sol\n\nTransferHub/ApprovalHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nCallOptionalReturn.sol\n\nTransferHub/CallOptionalReturn.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nSendValueHelper.sol\n\nTransferHub/SendValueHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nTransferHelper.sol\n\nTransferHub/TransferHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWrapperHelper.sol\n\nTransferHub/WrapperHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarations.sol\n\nWiseOracleHub/Declarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nOracleHelper.sol\n\nWiseOracleHub/OracleHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseOracleHub.sol\n\nWiseOracleHub/WiseOracleHub.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseSecurity.sol\n\nWiseSecurity/WiseSecurity.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseSecurityDeclarations.sol\n\nWiseSecurity/WiseSecurityDeclarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseSecurityHelper.sol\n\nWiseSecurity/WiseSecurityHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nAaveEvents.sol\n\nWrapperHub/AaveEvents.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nAaveHelper.sol\n\nWrapperHub/AaveHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nAaveHub.sol\n\nWrapperHub/AaveHub.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarations.sol\n\nWrapperHub/Declarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Contract does not follow the Solidity style guide's suggested layout ordering",
      "description": "The <a href=\"https://docs.soliditylang.org/en/v0.8.20/style-guide.html#order-of-layout\">style guide</a> says that, within a contract, the ordering should be 1) Type declarations, 2) State variables, 3) Events, 4) Errors 5) Modifiers, and 6) Functions, but the contract(s) below do not follow this ordering",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: \n\nOwnableMaster.sol\n\nOwnableMaster.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseLending.sol\n\nWiseLending.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseLendingDeclaration.sol\n\nWiseLendingDeclaration.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendleLpOracle.sol\n\nDerivativeOracles/PendleLpOracle.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPtOracleDerivative.sol\n\nDerivativeOracles/PtOracleDerivative.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPtOraclePure.sol\n\nDerivativeOracles/PtOraclePure.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarationsFeeManager.sol\n\nFeeManager/DeclarationsFeeManager.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmDeclarations.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmControllerBase.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmToken.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmTokenFactory.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nMinterReserver.sol\n\nPowerFarms/PowerFarmNFTs/MinterReserver.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarations.sol\n\nWiseOracleHub/Declarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseSecurityDeclarations.sol\n\nWiseSecurity/WiseSecurityDeclarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarations.sol\n\nWrapperHub/Declarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Contracts with only unimplemented functions can be labeled as abstract",
      "description": "In Solidity, a contract that's not meant to be deployed on its own but is intended to be inherited by other contracts should be marked `abstract`. This ensures that developers recognize the contract's incomplete or intended-to-be-extended nature. If a contract has unimplemented functions or is designed with the intention that another contract should extend its functionality, it should be explicitly labeled as `abstract`. \nThis helps prevent inadvertent deployments and clearly communicates the contract's purpose to other developers. Resolution: Review the contract, and if it's not supposed to function standalone, mark it as `abstract` to make the intention clear.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n9: contract OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n43: contract WiseLending is PoolManager {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n30: contract WiseLendingDeclaration is\n    OwnableMaster,\n    WrapperHelper,\n    SendValueHelper\n{\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n5: contract CustomOracleSetup {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n13: contract PendleChildLpOracle is CustomOracleSetup  {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n28: contract PendleLpOracle {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L28"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n22: contract PtOracleDerivative {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L22"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n22: contract PtOraclePure {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L22"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n31: contract DeclarationsFeeManager is FeeManagerEvents, OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n25: contract FeeManager is FeeManagerHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n5: contract FeeManagerEvents {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n36: contract PendlePowerFarmDeclarations is\n    WrapperHelper,\n    TransferHelper,\n    ApprovalHelper,\n    SendValueHelper\n{\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L36"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n15: contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L15"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n30: contract PendlePowerFarmControllerBase is\n    OwnableMaster,\n    TransferHelper,\n    ApprovalHelper\n{\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n10: contract MinterReserver {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n7: contract ApprovalHelper is CallOptionalReturn {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n7: contract CallOptionalReturn {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n8: contract SendValueHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n7: contract TransferHelper is CallOptionalReturn {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n7: contract WrapperHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n24: contract WiseSecurity is WiseSecurityHelper, ApprovalHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L24"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n45: contract WiseSecurityDeclarations is OwnableMaster {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n5: contract AaveEvents {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n25: contract AaveHub is AaveHelper, TransferHelper, ApprovalHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Critical Changes Should Use Two-step Procedure",
      "description": "The critical procedures should be two step process.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n25: function setParamsLASA(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n26: function setParamsLASA(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n100: function setPoolParameters(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L100"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n101: function setPoolParameters(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L101"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n125: function setVerifiedIsolationPool(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n126: function setVerifiedIsolationPool(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n319: function setBaseURI(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L319"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n320: function setBaseURI(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n328: function setBaseExtension(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n329: function setBaseExtension(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1386: function setRegistrationIsolationPool(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1387: function setRegistrationIsolationPool(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n140: function setSecurity(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L140"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n141: function setSecurity(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n424: function setPoolFee(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n425: function setPoolFee(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n33: function setLastUpdateGlobal(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n34: function setLastUpdateGlobal(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n42: function setRoundData(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n43: function setRoundData(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n52: function setGlobalAggregatorRoundId(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n53: function setGlobalAggregatorRoundId(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n49: function setRepayBadDebtIncentive(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n50: function setRepayBadDebtIncentive(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n66: function setAaveFlag(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L66"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n67: function setAaveFlag(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n82: function setAaveFlagBulk(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L82"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n83: function setAaveFlagBulk(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n108: function setPoolFee(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n109: function setPoolFee(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n135: function setPoolFeeBulk(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n136: function setPoolFeeBulk(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L136"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n315: function changeIncentiveUSDA(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L315"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n316: function changeIncentiveUSDA(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L316"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n352: function changeIncentiveUSDB(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L352"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n353: function changeIncentiveUSDB(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L353"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n514: function setBadDebtUserLiquidation(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n515: function setBadDebtUserLiquidation(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L515"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n538: function setBeneficial(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L538"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n539: function setBeneficial(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L539"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n63: function changeMinDeposit(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n64: function changeMinDeposit(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L64"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n321: function changeExchangeIncentive(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n322: function changeExchangeIncentive(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L322"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n334: function changeMintFee(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n335: function changeMintFee(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n592: function changeMintFee(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n593: function changeMintFee(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n51: function setFarmContract(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n52: function setFarmContract(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n161: function setBaseURI(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n162: function setBaseURI(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n170: function setBaseExtension(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n171: function setBaseExtension(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n85: function setLiquidationSettings(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L85"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n86: function setLiquidationSettings(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n980: function setBlacklistToken(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n981: function setBlacklistToken(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n995: function setSecurityWorker(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L995"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n996: function setSecurityWorker(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1111: function changeMinDepositValue(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1112: function changeMinDepositValue(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n44: function setAaveTokenAddress(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n45: function setAaveTokenAddress(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n64: function setAaveTokenAddressBulk(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L64"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n65: function setAaveTokenAddressBulk(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L65"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n105: function setWiseSecurity(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n106: function setWiseSecurity(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Custom error has no error details",
      "description": "Consider adding parameters to the error to indicate which user or values caused the failure",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n5: error NoValue();\n\n6: error NotMaster();\n\n7: error NotProposed();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L5-L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n9: error NotPermitted();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n16: error DeadOracle();\n\n17: error NotPowerFarm();\n\n18: error InvalidAction();\n\n19: error InvalidCaller();\n\n20: error PositionLocked();\n\n21: error LiquidatorIsInPowerFarm();\n\n22: error PositionHasCollateral();\n\n23: error PositionHasBorrow();\n\n24: error InvalidAddress();\n\n25: error InvalidLiquidator();\n\n26: error ValueIsZero();\n\n27: error ValueNotZero();\n\n28: error TooManyTokens();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L16-L28"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n24: error InvalidDecimals();\n\n25: error CardinalityNotSatisfied();\n\n26: error OldestObservationNotSatisfied();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L24-L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n19: error CardinalityNotSatisfied();\n\n20: error OldestObservationNotSatisfied();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L19-L20"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n19: error CardinalityNotSatisfied();\n\n20: error OldestObservationNotSatisfied();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L19-L20"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n16: error NotWiseLiquidation();\n\n17: error AlreadySet();\n\n18: error ExistingBadDebt();\n\n19: error NotWiseLending();\n\n20: error NotIncentiveMaster();\n\n21: error PoolAlreadyAdded();\n\n22: error TooHighValue();\n\n23: error TooLowValue();\n\n24: error NotAllowed();\n\n25: error PoolNotPresent();\n\n26: error ZeroAddress();\n\n27: error NoIncentive();\n\n28: error Reentered();\n\n29: error PoolNotActive();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L16-L29"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n23: error Deactivated();\n\n24: error InvalidParam();\n\n25: error AccessDenied();\n\n26: error LeverageTooHigh();\n\n27: error DebtRatioTooLow();\n\n28: error NotBalancerVault();\n\n29: error DebtRatioTooHigh();\n\n30: error ResultsInBadDebt();\n\n31: error TooMuchValueLost();\n\n32: error CollateralFactorTooHigh();\n\n33: error TooMuchShares();\n\n34: error WrongChainId();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L23-L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n16: error NotAllowed();\n\n17: error AlreadySet();\n\n18: error NotExpired();\n\n19: error LockTimeTooShort();\n\n20: error ZeroShares();\n\n21: error ValueTooSmall();\n\n22: error InvalidLength();\n\n23: error InvalidWeightSum();\n\n24: error WrongAddress();\n\n25: error NothingToSkim();\n\n26: error NotFound();\n\n27: error NotEnoughCompound();\n\n28: error NotArbitrum();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L16-L28"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n12: error MarketExpired();\n\n13: error NotController();\n\n14: error ZeroFee();\n\n15: error TooMuchFee();\n\n16: error NotEnoughLpAssetsTransferred();\n\n17: error InsufficientShares();\n\n18: error ZeroAmount();\n\n19: error FeeTooHigh();\n\n20: error NotEnoughShares();\n\n21: error InvalidSharePriceGrowth();\n\n22: error InvalidSharePrice();\n\n23: error AlreadyInitialized();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L12-L23"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n7: error DeployForbidden();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n7: error InvalidKey();\n\n8: error AlreadyReserved();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L7-L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n5: error AmountTooSmall();\n\n6: error SendValueFailed();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L5-L6"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n14: error OracleIsDead();\n\n15: error OraclesDeviate();\n\n16: error OracleAlreadySet();\n\n17: error ChainLinkOracleNotSet();\n\n23: error HeartBeatNotSet();\n\n24: error PoolDoesNotExist();\n\n25: error PoolAddressMismatch();\n\n26: error TokenAddressMismatch();\n\n27: error TwapOracleAlreadySet();\n\n28: error ZeroAddressNotAllowed();\n\n29: error FunctionDoesntExist();\n\n30: error AggregatorNotNecessary();\n\n31: error AggregatorAlreadySet();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L31",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L14",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L15",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L16",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L17",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L23",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L24",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L25",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L26",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L27",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L28",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L29",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n22: error NotWiseLendingSecurity();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L22"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n19: error NotAllowedEntity();\n\n20: error ChainlinkDead();\n\n21: error TokenBlackListed();\n\n22: error NotAllowedWiseSecurity();\n\n23: error PositionLockedWiseSecurity();\n\n24: error ResultsInBadDebt();\n\n25: error NotEnoughCollateral();\n\n26: error NotAllowedToBorrow();\n\n27: error OpenBorrowPosition();\n\n28: error NonVerifiedPool();\n\n29: error NotOwner();\n\n30: error LiquidationDenied();\n\n31: error TooManyShares();\n\n32: error NotRegistered();\n\n33: error Blacklisted();\n\n34: error SecuritySwapFailed();\n\n35: error BaseRewardTooHigh();\n\n36: error BaseRewardTooLow();\n\n37: error BaseRewardFarmTooHigh();\n\n38: error BaseRewardFarmTooLow();\n\n39: error MaxFeeEthTooHigh();\n\n40: error MaxFeeEthTooLow();\n\n41: error MaxFeeFarmEthTooHigh();\n\n42: error MaxFeeFarmEthTooLow();\n\n43: error DepositAmountTooSmall();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L19-L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n15: error AlreadySet();\n\n16: error InvalidValue();\n\n17: error InvalidAction();\n\n18: error FailedInnerCall();\n\n19: error InvalidToken();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L15-L19"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Custom errors should be used rather than `revert()`/`require()`",
      "description": "Custom errors are available from solidity version 0.8.4. Custom errors are more easily processed in try-catch blocks, and are easier to re-use and maintain.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n348: require(\n            _exists(_tokenId) == true,\n            \"PositionNFTs: WRONG_TOKEN\"\n        );\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L348"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n190: require(\n            _exists(_tokenId) == true,\n            \"PowerFarmsNFTs: WRONG_TOKEN\"\n        );\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L190"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Declare interfaces on separate files",
      "description": "Interfaces should be declared on a separate file and not on the same file where the contract resides in.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n14: interface IFarmContract {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L14"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Default `address(0)` can be returned",
      "description": "Allowing a function in Solidity to return the default address (address(0)) can be problematic as it can represent uninitialized or invalid addresses. If such an address is utilized in transfer operations or other sensitive actions, it could lead to loss of funds or unpredicted behavior. It's prudent to include checks in your functions to prevent the return of the zero address, enhancing contract security.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n408: return tokens;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L408"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n162: return ZERO_ADDRESS;\n\n165: return getApproved(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L165",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n26: return (\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n152: return positionLendTokenData[_nftId][_index];\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L152"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n173: return positionBorrowTokenData[_nftId][_index];\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L173"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n891: return poolTokenAddresses[_index];\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L891"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n122: return pendleChildCompoundInfo[_pendleMarket].rewardTokens;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n151: return IPendleMarket(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L151"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n48: return _clone(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L48"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n292: return UNI_V3_FACTORY.getPool(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n717: return (\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L717"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Defined named returns not used within function",
      "description": "Such instances can be replaced with unnamed returns",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n356: return \"\";\n\n359: return string(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L359",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L356"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n379: return \"0\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L379"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n596: return _withdrawOrAllocateSharesLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L596"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n69: return (\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L69"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n95: return (\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L95"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n162: return (\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n157: return (\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L157"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n136: return (\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L136"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n747: return (\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L747"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n829: return 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L829"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n257: return ORACLE_HUB.getTokensFromETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L257"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n105: return _coreLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L105"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n317: return IPendleChild(PENDLE_CHILD).withdrawExactShares(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L317"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n68: return PENDLE_LOCK.positionData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L68"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n165: return IPendleMarket(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L165"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n380: return PENDLE_MARKET.userReward(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L380"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n198: return \"\";\n\n201: return string(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L201",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L198"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n221: return \"0\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L221"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n292: return UNI_V3_FACTORY.getPool(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n452: return true;\n\n456: return _chainLinkIsDead(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L452",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L456"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n252: return true;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L252"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n290: return true;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L290"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n324: return true;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L324"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Dependence on external protocols",
      "description": "External protocols should be monitored as such dependencies may introduce vulnerabilities if a vulnerability is found /introduced in the external protocol",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n16: import \"../../InterfaceHub/IUniswapV3.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L16"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n9: import \"./Libraries/IUniswapV3Factory.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L9"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Do not cache immutable variables",
      "description": "Instead of caching immutable variables, using them directly can make code more consistent and less prone to errors.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n146: uint256 maxFee = IS_ETH_MAINNET == true // @audit Cached immutable IS_ETH_MAINNET\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n150: uint256 minFee = IS_ETH_MAINNET == true // @audit Cached immutable IS_ETH_MAINNET\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L150"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n164: uint256 maxFeeFarm = IS_ETH_MAINNET == true // @audit Cached immutable IS_ETH_MAINNET\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L164"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n168: uint256 minFeeFarm = IS_ETH_MAINNET == true // @audit Cached immutable IS_ETH_MAINNET\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L168"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Don't use assembly for `create2`",
      "description": "Using assembly for `create2` is error-prone and harder to read than higher-level Solidity. With the evolution of the Solidity language, a more abstracted and clear syntax for salted contract creation, which leverages the `create2` opcode, has been introduced. Instead of manually managing assembly code, developers are encouraged to use the modern syntax, ensuring better readability, maintainability, and reduced chances of mistakes.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n94: assembly {\n\n            let clone := mload(0x40)\n\n            mstore(\n                clone,\n                0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000\n            )\n\n            mstore(\n                add(clone, 0x14),\n                targetBytes\n            )\n\n            mstore(\n                add(clone, 0x28),\n                0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000\n            )\n\n            pendlePowerFarmTokenAddress := create2(\n                0,\n                clone,\n                0x37,\n                salt\n            )\n        }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L94"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Complex casting",
      "description": "Consider whether the number of casts is really necessary, or whether using a different type would be more appropriate. Alternatively, add comments to explain in detail why the casts are necessary, and any implicit reasons why the cast does not introduce an overflow.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n157: int192(uint192(answer))\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L157"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Empty `bytes` check is missing",
      "description": "To avoid mistakenly accepting empty `bytes` as a valid value, consider to check for empty `bytes`. This helps ensure that empty `bytes` are not treated as valid inputs, preventing potential issues.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n614: function _addPositionTokenData(\n        uint256 _nftId,\n        address _poolToken,\n        mapping(bytes32 => bool) storage hashMap,\n        mapping(uint256 => address[]) storage userTokenData\n    )\n        internal\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L614"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n59: function receiveFlashLoan(\n        IERC20[] memory _flashloanToken,\n        uint256[] memory _flashloanAmounts,\n        uint256[] memory _feeAmounts,\n        bytes memory _userData\n    )\n        external\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L59"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n431: function claimArb(\n        uint256 _accrued,\n        bytes32[] calldata _proof\n    )\n        external\n        onlyArbitrum\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L431"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n581: function claimVoteRewards(\n        uint256 _amount,\n        bytes32[] calldata _merkleProof\n    )\n        external\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L581"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n160: function onERC721Received(\n        address _operator,\n        address _from,\n        uint256 _tokenId,\n        bytes calldata _data\n    )\n        external\n        returns (bytes4)\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L160"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n12: function _callOptionalReturn(\n        address token,\n        bytes memory data\n    )\n        internal\n        returns (bool call)\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L12"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Enable IR-based code generation",
      "description": "The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions.\nYou can enable it on the command line using `--via-ir` or with the option `{\"viaIR\": true}`.\nThis will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command\nMore on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "All in-scope contracts",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Enum values should be used in place of constant array indexes",
      "description": "Create a commented enum value to use in place of constant array indexes, this makes the code far easier to understand",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1374: tokens[0] = _poolToken;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1374"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n32: tokens[0] = IERC20(flashAsset);\n\n33: amount[0] = _flashAmount;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L32-L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n81: uint256 totalDebtBalancer = _flashloanAmounts[0]\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L81"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n417: secondsAgo[0] = TWAP_PERIOD;\n\n418: secondsAgo[1] = 0;\n\n431: int56 tickCumulativesDelta = tickCumulatives[1]\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L418",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L431",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L417"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "`Event` declarations should have NatSpec descriptions",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n48: event MasterProposed(\n\n53: event RenouncedOwnership(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L53",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L48"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n35: event FundsDeposited(\n\n44: event FundsSolelyDeposited(\n\n52: event FundsWithdrawn(\n\n61: event FundsWithdrawnOnBehalf(\n\n70: event FundsSolelyWithdrawn(\n\n78: event FundsBorrowed(\n\n87: event FundsBorrowedOnBehalf(\n\n96: event FundsReturned(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L35",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L96",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L87",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L78",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L70",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L61",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L52",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n7: event ClaimedFeesWiseBulk(\n\n11: event PoolTokenRemoved(\n\n16: event PoolTokenAdded(\n\n21: event IncentiveOwnerBChanged(\n\n26: event IncentiveOwnerAChanged(\n\n31: event ClaimedOwnershipIncentiveMaster(\n\n36: event IncentiveMasterProposed(\n\n41: event PoolFeeChanged(\n\n47: event ClaimedIncentives(\n\n54: event ClaimedIncentivesBulk(\n\n58: event IncentiveIncreasedB(\n\n63: event IncentiveIncreasedA(\n\n68: event BadDebtIncreasedLiquidation(\n\n73: event TotalBadDebtIncreased(\n\n78: event TotalBadDebtDecreased(\n\n83: event SetBadDebtPosition(\n\n89: event UpdateBadDebtPosition(\n\n95: event SetBeneficial(\n\n101: event RevokeBeneficial(\n\n107: event ClaimedFeesWise(\n\n113: event ClaimedFeesBeneficial(\n\n120: event PayedBackBadDebt(\n\n129: event PayedBackBadDebtFree(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L83",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L129",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L120",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L113",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L107",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L101",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L95",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L54",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L58",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L63",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L68",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L73",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L78",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L89",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L16",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L21",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L26",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L31",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L36",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L41"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n110: event FarmEntry(\n\n118: event FarmExit(\n\n125: event FarmStatus(\n\n130: event ManualPaybackShares(\n\n137: event ManualWithdrawShares(\n\n144: event MinDepositChange(\n\n149: event ETHReceived(\n\n154: event RegistrationFarm(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L110",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L118",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L125",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L130",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L137",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L149",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n135: event ETHReceived(\n\n140: event ChangeExchangeIncentive(\n\n144: event WithdrawLp(\n\n150: event ExchangeRewardsForCompounding(\n\n157: event ExchangeLpFeesForPendle(\n\n164: event AddPendleMarket(\n\n169: event UpdateRewardTokens(\n\n174: event ChangeMintFee(\n\n179: event LockPendle(\n\n188: event ClaimArb(\n\n194: event IncreaseReservedForCompound(\n\n199: event ClaimVoteRewards(\n\n205: event WithdrawLock(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L135",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L140",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L150",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L157",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L164",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L169",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L174",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L179",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L188",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L194",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L199",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L205"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n153: event ERC721Received(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L153"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n47: event SecurityShutdown(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n7: event SetAaveTokenAddress(\n\n13: event IsDepositAave(\n\n18: event IsWithdrawAave(\n\n23: event IsBorrowAave(\n\n28: event IsPaybackAave(\n\n33: event IsSolelyDepositAave(\n\n38: event IsSolelyWithdrawAave(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L28",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L23",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L18",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L13"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Event Is Missing Indexed Fields",
      "description": "Index event fields make the field more quickly accessible [to off-chain tools](https://ethereum.stackexchange.com/questions/40396/can-somebody-please-explain-the-concept-of-event-indexing) that parse events. This is especially useful when it comes to filtering based on an address. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Where applicable, each `event` should use three `indexed` fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three applicable fields, all of the applicable fields should be indexed.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent PoolTokenRemoved(\n        address indexed poolToken,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent PoolTokenAdded(\n        address indexed poolToken,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L16"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent IncentiveOwnerBChanged(\n        address indexed newIncentiveOwnerB,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent IncentiveOwnerAChanged(\n        address indexed newIncentiveOwnerA,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent ClaimedOwnershipIncentiveMaster(\n        address indexed newIncentiveMaster,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent IncentiveMasterProposed(\n        address indexed proposedIncentiveMaster,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L36"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent PoolFeeChanged(\n        address indexed poolToken,\n        uint256 indexed newPoolFee,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L41"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent ClaimedIncentives(\n        address indexed sender,\n        address indexed token,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent IncentiveIncreasedB(\n        uint256 indexed amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent IncentiveIncreasedA(\n        uint256 indexed amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L63"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent BadDebtIncreasedLiquidation(\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L68"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent TotalBadDebtIncreased(\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent TotalBadDebtDecreased(\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L78"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent SetBadDebtPosition(\n        uint256 indexed nftId,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent UpdateBadDebtPosition(\n        uint256 indexed nftId,\n        uint256 newAmount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L89"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent SetBeneficial(\n        address indexed user,\n        address[] token,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L95"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\nevent RevokeBeneficial(\n        address indexed user,\n        address[] token,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L101"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\nevent FarmExit(\n        uint256 indexed keyId,\n        uint256 indexed wiseLendingNFT,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L118"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\nevent FarmStatus(\n        bool indexed state,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\nevent ManualPaybackShares(\n        uint256 indexed keyId,\n        uint256 indexed wiseLendingNFT,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L130"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\nevent ManualWithdrawShares(\n        uint256 indexed keyId,\n        uint256 indexed wiseLendingNFT,\n        uint256 amount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L137"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\nevent MinDepositChange(\n        uint256 minDepositEthAmount,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L144"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\nevent ETHReceived(\n        uint256 amount,\n        address from\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L149"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\nevent RegistrationFarm(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent ETHReceived(\n        uint256 _amount,\n        address _sender\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent WithdrawLp(\n        address indexed _pendleMarket,\n        address indexed _to,\n        uint256 _amount\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L144"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent ExchangeRewardsForCompounding(\n        address indexed _pendleMarket,\n        address indexed _rewardToken,\n        uint256 _rewardAmount,\n        uint256 _sendingAmount\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L150"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent ExchangeLpFeesForPendle(\n        address indexed _pendleMarket,\n        uint256 _pendleChildShares,\n        uint256 _tokenAmountSend,\n        uint256 _withdrawnAmount\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L157"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent UpdateRewardTokens(\n        address indexed _pendleMarket,\n        address[] _rewardTokens\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L169"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent ChangeMintFee(\n        address indexed _pendleMarket,\n        uint256 _newFee\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L174"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent LockPendle(\n        uint256 _amount,\n        uint128 _expiry,\n        uint256 _newVeBalance,\n        bool _fromInside,\n        bool _sameExpiry,\n        uint256 _timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L179"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent ClaimArb(\n        uint256 _accrued,\n        bytes32[] _proof,\n        uint256 _timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L188"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent IncreaseReservedForCompound(\n        address indexed _pendleMarket,\n        uint256[] _amounts\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L194"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent ClaimVoteRewards(\n        uint256 _amount,\n        bytes32[] _merkleProof,\n        uint256 _timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L199"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nevent WithdrawLock(\n        uint256 _amount,\n        uint256 _timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L205"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\nevent ERC721Received(\n        address operator,\n        address from,\n        uint256 tokenId,\n        bytes _data\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L153"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\nevent SetAaveTokenAddress(\n        address underlyingAsset,\n        address aaveToken,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\nevent IsDepositAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\nevent IsWithdrawAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\nevent IsBorrowAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L23"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\nevent IsPaybackAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L28"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\nevent IsSolelyDepositAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\nevent IsSolelyWithdrawAave(\n        uint256 nftId,\n        uint256 timestamp\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Events should be emitted before external calls",
      "description": "Ensure that events follow the best practice of check-effects-interaction, and are emitted before external calls.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n478: emit PoolTokenRemoved(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L478"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n801: emit PayedBackBadDebt(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L801"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n852: emit PayedBackBadDebtFree(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L852"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n284: emit RegistrationFarm(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L284"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n246: emit FarmExit(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L246"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n593: emit ClaimVoteRewards(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n544: emit IsPaybackAave(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L544"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n603: emit IsPaybackAave(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L603"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Expressions for constant values should use `immutable` rather than `constant`",
      "description": "While it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n14: address internal constant ZERO_ADDRESS = address(0x0);\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n11: address internal constant ZERO_ADDRESS = address(0x0);\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n124: IPriceFeed internal constant ZERO_FEED = IPriceFeed(\n        address(0x0)\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L124"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n129: IAggregator internal constant ZERO_AGGREGATOR = IAggregator(\n        address(0x0)\n    );\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L129"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "For extended 'using-for' usage, use the latest pragma version ",
      "description": "Solidity versions of 0.8.13 or above can make use of enhanced using-for notation within contracts.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n10: using Babylonian for uint256;\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L10"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "File is missing NatSpec",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: \n\nWiseLendingDeclaration.sol\n\nWiseLendingDeclaration.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseLowLevelHelper.sol\n\nWiseLowLevelHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nCustomOracleSetup.sol\n\nDerivativeOracles/CustomOracleSetup.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendleChildLpOracle.sol\n\nDerivativeOracles/PendleChildLpOracle.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarationsFeeManager.sol\n\nFeeManager/DeclarationsFeeManager.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nFeeManagerEvents.sol\n\nFeeManager/FeeManagerEvents.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmDeclarations.sol\n\nPowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmControllerBase.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmControllerHelper.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nPendlePowerFarmTokenFactory.sol\n\nPowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nMinterReserver.sol\n\nPowerFarms/PowerFarmNFTs/MinterReserver.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nSendValueHelper.sol\n\nTransferHub/SendValueHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarations.sol\n\nWiseOracleHub/Declarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nWiseSecurityDeclarations.sol\n\nWiseSecurity/WiseSecurityDeclarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nAaveEvents.sol\n\nWrapperHub/AaveEvents.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nAaveHelper.sol\n\nWrapperHub/AaveHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L0-L0"
          ]
        },
        {
          "content": "```solidity\n\nFile: \n\nDeclarations.sol\n\nWrapperHub/Declarations.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Function names should differ to make the code more readable",
      "description": "In Solidity, while function overriding allows for functions with the same name to coexist, it is advisable to avoid this practice to enhance code readability and maintainability. Having multiple functions with the same name, even with different parameters or in inherited contracts, can cause confusion and increase the likelihood of errors during development, testing, and debugging. Using distinct and descriptive function names not only clarifies the purpose and behavior of each function, but also helps prevent unintended function calls or incorrect overriding. By adopting a clear and consistent naming convention, developers can create more comprehensible and maintainable smart contracts.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n103: function renounceOwnership(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L103"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n222: function isOwner(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L223"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n271: function walletOfOwner(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L272"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n319: function setBaseURI(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n328: function setBaseExtension(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n340: function tokenURI(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L341"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n371: function _toString(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L372"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n193: function _checkPositionLocked(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L194"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n625: function _coreLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L626"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n165: function _getSharePrice(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L166"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n192: function _checkHealthState(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L193"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n388: function depositExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L389"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n426: function depositExactAmountETHMint(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L426"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n442: function depositExactAmountMint(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L443"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n460: function depositExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L461"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n636: function withdrawExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L637"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n675: function withdrawExactSharesETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L676"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n714: function withdrawExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L715"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n902: function withdrawExactShares(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L903"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n975: function borrowExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L976"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1016: function borrowExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1017"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1088: function paybackExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1089"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1161: function paybackExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1162"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1204: function paybackExactShares(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1205"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1588: function _reservePosition(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1588"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n134: function getTimeStamp(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n350: function _checkReentrancy(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L350"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n424: function setPoolFee(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n26: function renounceOwnership(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n61: function getTimeStamp(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L61"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n35: function latestAnswer(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n47: function decimals(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n55: function latestRoundData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L55"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n83: function latestAnswer(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n139: function decimals(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L139"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n151: function latestRoundData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L151"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n81: function latestAnswer(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L81"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n134: function decimals(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L134"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n146: function latestRoundData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n68: function latestAnswer(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L68"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n113: function decimals(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L113"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n125: function latestRoundData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n213: function _onlyWiseLending(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L213"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n108: function setPoolFee(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n15: function _prepareBorrows(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L16"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n47: function _prepareCollaterals(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L48"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n57: function getLiveDebtRatio(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n560: function _coreLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L561"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n35: function _checkReentrancy(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n244: function _getTokensInETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L245"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n334: function changeMintFee(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n256: function _syncSupply(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L257"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n156: function _getUserReward(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L157"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n189: function _getTokensInETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L190"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n325: function _getSharePrice(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L325"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n334: function _syncSupply(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L334"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n372: function _getUserReward(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L373"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n529: function depositExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L530"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n592: function changeMintFee(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n608: function withdrawExactShares(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L609"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n647: function withdrawExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L648"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n96: function isOwner(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L97"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n109: function walletOfOwner(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L110"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n161: function setBaseURI(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n170: function setBaseExtension(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n182: function tokenURI(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L183"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n213: function _toString(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L214"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n12: function _sendValue(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n450: function decimals(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L451"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n31: function _onlyWiseLending(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n59: function getLiveDebtRatio(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L60"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n701: function _checkPositionLocked(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L702"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n794: function _checkHealthState(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L795"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n999: function getLendingRate(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1000"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n47: function _reservePosition(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n196: function _sendValue(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L197"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n243: function _prepareCollaterals(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L244"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n279: function _prepareBorrows(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L280"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n103: function depositExactAmountMint(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L104"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n122: function depositExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L123"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n158: function depositExactAmountETHMint(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L158"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n172: function depositExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L173"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n202: function withdrawExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L203"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n238: function withdrawExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L239"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n281: function withdrawExactShares(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L282"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n314: function withdrawExactSharesETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L315"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n357: function borrowExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L358"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n393: function borrowExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L394"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n433: function paybackExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L434"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n482: function paybackExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L483"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n556: function paybackExactShares(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L557"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n635: function getLendingRate(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L636"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n81: function _checkOwner(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L82"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n93: function _checkPositionLocked(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L94"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n105: function setWiseSecurity(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Function must not be longer than 50 lines",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n500: function _updatePseudoTotalAmounts(\n\n501: function _updatePseudoTotalAmounts(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L500-L501"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n667: function _removePositionData(\n\n668: function _removePositionData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L667-L668"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n25: function setParamsLASA(\n\n26: function setParamsLASA(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25-L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n164: function _createPool(\n\n165: function _createPool(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L164-L165"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n44: function _coreWithdrawToken(\n\n45: function _coreWithdrawToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L44-L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n106: function _handleDeposit(\n\n107: function _handleDeposit(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L106-L107"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n349: function _coreBorrowTokens(\n\n350: function _coreBorrowTokens(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L349-L350"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n460: function _withdrawOrAllocateSharesLiquidation(\n\n461: function _withdrawOrAllocateSharesLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L460-L461"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n543: function _calculateReceiveAmount(\n\n544: function _calculateReceiveAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L543-L544"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n625: function _coreLiquidation(\n\n626: function _coreLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L625-L626"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1088: function paybackExactAmountETH(\n\n1089: function paybackExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1088-L1089"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1250: function liquidatePartiallyFromTokens(\n\n1251: function liquidatePartiallyFromTokens(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1250-L1251"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n140: function setSecurity(\n\n141: function setSecurity(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L140-L141"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n257: function _onlyAaveHub(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L257"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n628: function claimWiseFees(\n\n629: function claimWiseFees(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L628-L629"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n730: function paybackBadDebtForToken(\n\n731: function paybackBadDebtForToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L730-L731"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n134: function _updateUserBadDebt(\n\n135: function _updateUserBadDebt(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L134-L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n274: function _doApprovals(\n\n275: function _doApprovals(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L274-L275"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n59: function receiveFlashLoan(\n\n60: function receiveFlashLoan(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L59-L60"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n134: function _logicClosePosition(\n\n135: function _logicClosePosition(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L134-L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n414: function _logicOpenPosition(\n\n415: function _logicOpenPosition(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L414-L415"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n53: function exchangeRewardsForCompoundingWithIncentive(\n\n54: function exchangeRewardsForCompoundingWithIncentive(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L53-L54"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n113: function exchangeLpFeesForPendleWithIncentive(\n\n114: function exchangeLpFeesForPendleWithIncentive(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L113-L114"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n211: function addPendleMarket(\n\n212: function addPendleMarket(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L211-L212"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n364: function lockPendle(\n\n365: function lockPendle(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L364-L365"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n218: function _calculateRewardsClaimedOutside(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L218"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n529: function depositExactAmount(\n\n530: function depositExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L529-L530"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n56: function _clone(\n\n57: function _clone(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L56-L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n592: function _recalibratePreview(\n\n593: function _recalibratePreview(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L592-L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n266: function addTwapOracleDerivative(\n\n267: function addTwapOracleDerivative(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L266-L267"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n556: function overallNetAPY(\n\n557: function overallNetAPY(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L556-L557"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n695: function positionBlackListToken(\n\n696: function positionBlackListToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L695-L696"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n764: function maximumWithdrawToken(\n\n765: function maximumWithdrawToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L764-L765"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n118: function _setLiquidationSettings(\n\n119: function _setLiquidationSettings(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L118-L119"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n482: function paybackExactAmountETH(\n\n483: function paybackExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L482-L483"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Functions that alter state should emit events containing both the old and the new value",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n25: function setParamsLASA(\n        address _poolToken,\n        uint256 _poolMulFactor,\n        uint256 _upperBoundMaxRate,\n        uint256 _lowerBoundMaxRate,\n        bool _steppingDirection,\n        bool _isFinal\n    )\n        external\n        onlyMaster\n    {\n        if (parametersLocked[_poolToken] == true) {\n            revert InvalidAction();\n        }\n\n        parametersLocked[_poolToken] = _isFinal;\n\n        AlgorithmEntry storage algoData = algorithmData[\n            _poolToken\n        ];\n\n        algoData.increasePole = _steppingDirection;\n\n        _validateParameter(\n            _upperBoundMaxRate,\n            UPPER_BOUND_MAX_RATE\n        );\n\n        _validateParameter(\n            _lowerBoundMaxRate,\n            LOWER_BOUND_MAX_RATE\n        );\n\n        _validateParameter(\n            _lowerBoundMaxRate,\n            _upperBoundMaxRate\n        );\n\n        uint256 staticMinPole = _getPoleValue(\n            _poolMulFactor,\n            _upperBoundMaxRate\n        );\n\n        uint256 staticMaxPole = _getPoleValue(\n            _poolMulFactor,\n            _lowerBoundMaxRate\n        );\n\n        uint256 staticDeltaPole = _getDeltaPole(\n            staticMaxPole,\n            staticMinPole\n        );\n\n        uint256 startValuePole = _getStartValue(\n            staticMaxPole,\n            staticMinPole\n        );\n\n        _validateParameter(\n            _poolMulFactor,\n            PRECISION_FACTOR_E18\n        );\n\n        borrowRatesData[_poolToken] = BorrowRatesEntry(\n            startValuePole,\n            staticDeltaPole,\n            staticMinPole,\n            staticMaxPole,\n            _poolMulFactor\n        );\n\n        algoData.bestPole = startValuePole;\n        algoData.maxValue = lendingPoolData[_poolToken].totalDepositShares;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n100: function setPoolParameters(\n        address _poolToken,\n        uint256 _collateralFactor,\n        uint256 _maximumDeposit\n    )\n        external\n        onlyMaster\n    {\n        if (_maximumDeposit > 0) {\n            maxDepositValueToken[_poolToken] = _maximumDeposit;\n        }\n\n        if (_collateralFactor > 0) {\n            lendingPoolData[_poolToken].collateralFactor = _collateralFactor;\n        }\n\n        _validateParameter(\n            _collateralFactor,\n            PRECISION_FACTOR_E18\n        );\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L101"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n125: function setVerifiedIsolationPool(\n        address _isolationPool,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n        verifiedIsolationPool[_isolationPool] = _state;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n319: function setBaseURI(\n        string memory _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n        baseURI = _newBaseURI;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n328: function setBaseExtension(\n        string memory _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n        baseExtension = _newBaseExtension;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1386: function setRegistrationIsolationPool(\n        uint256 _nftId,\n        bool _registerState\n    )\n        external\n    {\n        _onlyIsolationPool(\n            msg.sender\n        );\n\n        _validateZero(\n            WISE_SECURITY.overallETHCollateralsBare(_nftId)\n        );\n\n        _validateZero(\n            WISE_SECURITY.overallETHBorrowBare(_nftId)\n        );\n\n        positionLocked[_nftId] = _registerState;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n140: function setSecurity(\n        address _wiseSecurity\n    )\n        external\n        onlyMaster\n    {\n        if (address(WISE_SECURITY) > ZERO_ADDRESS) {\n            revert InvalidAction();\n        }\n\n        WISE_SECURITY = IWiseSecurity(\n            _wiseSecurity\n        );\n\n        FEE_MANAGER = IFeeManagerLight(\n            WISE_SECURITY.FEE_MANAGER()\n        );\n\n        AAVE_HUB_ADDRESS = WISE_SECURITY.AAVE_HUB();\n    }\n\n    \n    address internal AAVE_HUB_ADDRESS;\n\n    \n    address public immutable WETH_ADDRESS;\n\n    \n    uint256 immutable FEE_MANAGER_NFT;\n\n    uint256 internal constant MIN_BORROW_SHARE_PRICE = 5 * PRECISION_FACTOR_E18\n        / 10;\n\n    \n    IWiseSecurity public WISE_SECURITY;\n\n    \n    IFeeManagerLight internal FEE_MANAGER;\n\n    \n    IPositionNFTs public immutable POSITION_NFT;\n\n    \n    IWiseOracleHub public immutable WISE_ORACLE;\n\n    \n    bool internal powerFarmCheck;\n\n    uint256 internal constant GHOST_AMOUNT = 1E3;\n\n    \n\n    struct LendingEntry {\n        bool unCollateralized;\n        uint256 shares;\n    }\n\n    struct BorrowRatesEntry {\n        uint256 pole;\n        uint256 deltaPole;\n        uint256 minPole;\n        uint256 maxPole;\n        uint256 multiplicativeFactor;\n    }\n\n    struct AlgorithmEntry {\n        bool increasePole;\n        uint256 bestPole;\n        uint256 maxValue;\n        uint256 previousValue;\n    }\n\n    struct GlobalPoolEntry {\n        uint256 totalPool;\n        uint256 utilization;\n        uint256 totalBareToken;\n        uint256 poolFee;\n    }\n\n    struct LendingPoolEntry {\n        uint256 pseudoTotalPool;\n        uint256 totalDepositShares;\n        uint256 collateralFactor;\n    }\n\n    struct BorrowPoolEntry {\n        bool allowBorrow;\n        uint256 pseudoTotalBorrowAmount;\n        uint256 totalBorrowShares;\n        uint256 borrowRate;\n    }\n\n    struct TimestampsPoolEntry {\n        uint256 timeStamp;\n        uint256 timeStampScaling;\n        uint256 initialTimeStamp;\n    }\n\n    struct CoreLiquidationStruct {\n        uint256 nftId;\n        uint256 nftIdLiquidator;\n        address caller;\n        address tokenToPayback;\n        address tokenToRecieve;\n        uint256 paybackAmount;\n        uint256 shareAmountToPay;\n        uint256 maxFeeETH;\n        uint256 baseRewardLiquidation;\n        address[] lendTokens;\n        address[] borrowTokens;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n424: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyFeeManager\n    {\n        globalPoolData[_poolToken].poolFee = _newFee;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n33: function setLastUpdateGlobal(\n        uint256 _time\n    )\n        external\n        onlyOwner\n    {\n        lastUpdateGlobal = _time;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n42: function setRoundData(\n        uint80 _roundId,\n        uint256 _updateTime\n    )\n        external\n        onlyOwner\n    {\n        timeStampByRoundId[_roundId] = _updateTime;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n52: function setGlobalAggregatorRoundId(\n        uint80 _aggregatorRoundId\n    )\n        external\n        onlyOwner\n    {\n        globalRoundId = _aggregatorRoundId;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n49: function setRepayBadDebtIncentive(\n        uint256 _percent\n    )\n        external\n        onlyMaster\n    {\n        _checkValue(\n            _percent\n        );\n\n        paybackIncentive = _percent;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n82: function setAaveFlagBulk(\n        address[] calldata _poolTokens,\n        address[] calldata _underlyingTokens\n    )\n        external\n        onlyMaster\n    {\n        uint256 i;\n        uint256 l = _poolTokens.length;\n\n        while (i < l) {\n            _setAaveFlag(\n                _poolTokens[i],\n                _underlyingTokens[i]\n            );\n\n            unchecked {\n                ++i;\n            }\n        }\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n592: function changeMintFee(\n        uint256 _newFee\n    )\n        external\n        onlyController\n    {\n        if (_newFee > MAX_MINT_FEE) {\n            revert FeeTooHigh();\n        }\n\n        mintFee = _newFee;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n51: function setFarmContract(\n        address _farmContract\n    )\n        external\n        onlyMaster\n    {\n        if (farmContract == ZERO_ADDRESS) {\n            farmContract = _farmContract;\n        }\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n161: function setBaseURI(\n        string calldata _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n        baseURI = _newBaseURI;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n170: function setBaseExtension(\n        string calldata _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n        baseExtension = _newBaseExtension;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n980: function setBlacklistToken(\n        address _tokenAddress,\n        bool _state\n    )\n        external\n        onlyMaster()\n    {\n        wasBlacklisted[_tokenAddress] = _state;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n995: function setSecurityWorker(\n        address _entitiy,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n        securityWorker[_entitiy] = _state;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1111: function changeMinDepositValue(\n        uint256 _newMinDepositValue\n    )\n        external\n        onlyMaster\n    {\n        if (_newMinDepositValue == 0) {\n            revert NoValue();\n        }\n\n        minDepositEthValue = _newMinDepositValue;\n    }\n}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n64: function setAaveTokenAddressBulk(\n        address[] calldata _underlyingAssets,\n        address[] calldata _aaveTokens\n    )\n        external\n        onlyMaster\n    {\n        for (uint256 i = 0; i < _underlyingAssets.length; i++) {\n            _setAaveTokenAddress(\n                _underlyingAssets[i],\n                _aaveTokens[i]\n            );\n        }\n    }\n\n    \n    receive()\n        external\n        payable\n    {\n        if (msg.sender == WETH_ADDRESS) {\n            return;\n        }\n\n        _sendValue(\n            master,\n            msg.value\n        );\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L65"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n105: function setWiseSecurity(\n        address _securityAddress\n    )\n        external\n        onlyMaster\n    {\n        if (address(WISE_SECURITY) > ZERO_ADDRESS) {\n            revert AlreadySet();\n        }\n\n        WISE_SECURITY = IWiseSecurity(\n            _securityAddress\n        );\n    }\n}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Some functions contain the same exact logic",
      "description": "These functions have the exact same code logic. Consider using a single function instead of duplicating the code, for example by using a `library`, or through inheritance.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n139: function decimals()\n        external\n        pure\n        returns (uint8)\n    {\n        return FEED_DECIMALS;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L139"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n134: function decimals()\n        external\n        pure\n        returns (uint8)\n    {\n        return FEED_DECIMALS;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L134"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n146: function latestRoundData()\n        public\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n        return (\n            roundId,\n            int256(latestAnswer()),\n            startedAt,\n            updatedAt,\n            answeredInRound\n        );\n    }\n}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n113: function decimals()\n        external\n        pure\n        returns (uint8)\n    {\n        return FEED_DECIMALS;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L113"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n125: function latestRoundData()\n        public\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n        return (\n            roundId,\n            int256(latestAnswer()),\n            startedAt,\n            updatedAt,\n            answeredInRound\n        );\n    }\n}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n245: function _getTokensInETH(\n        address _tokenAddress,\n        uint256 _tokenAmount\n    )\n        internal\n        view\n        returns (uint256)\n    {\n        return ORACLE_HUB.getTokensInETH(\n            _tokenAddress,\n            _tokenAmount\n        );\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L245"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n190: function _getTokensInETH(\n        address _tokenAddress,\n        uint256 _tokenAmount\n    )\n        internal\n        view\n        returns (uint256)\n    {\n        return ORACLE_HUB.getTokensInETH(\n            _tokenAddress,\n            _tokenAmount\n        );\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L190"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n82: function _checkOwner(\n        uint256 _nftId\n    )\n        internal\n        view\n    {\n        WISE_SECURITY.checkOwnerPosition(\n            _nftId,\n            msg.sender\n        );\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L82"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n94: function _checkPositionLocked(\n        uint256 _nftId\n    )\n        internal\n        view\n    {\n        WISE_LENDING.checkPositionLocked(\n            _nftId,\n            msg.sender\n        );\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L94"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n106: function setWiseSecurity(\n        address _securityAddress\n    )\n        external\n        onlyMaster\n    {\n        if (address(WISE_SECURITY) > ZERO_ADDRESS) {\n            revert AlreadySet();\n        }\n\n        WISE_SECURITY = IWiseSecurity(\n            _securityAddress\n        );\n    }\n}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Functions should be marked as `payable` when interacting with `ETH` like for transfering `ETH` to other contracts",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n194: function curveSecurityCheck(\n        address _poolToken\n    )\n        external\n        onlyWiseLending\n    {\n        address curvePool = curveSwapInfoData[_poolToken].curvePool;\n\n        if (curvePool == ZERO_ADDRESS) {\n            return;\n        }\n\n        (\n            bool success\n            ,\n        ) = curvePool.call{value: 0} (\n            curveSwapInfoData[_poolToken].swapBytesPool\n        );\n\n        _checkSuccess(\n            success\n        );\n\n        address curveMeta = curveSwapInfoData[_poolToken].curveMetaPool;\n\n        if (curveMeta == ZERO_ADDRESS) {\n            return;\n        }\n\n        (\n            success\n            ,\n        ) = curveMeta.call{value: 0} (\n            curveSwapInfoData[_poolToken].swapBytesMeta\n        );\n\n        _checkSuccess(\n            success\n        );\n    }\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L194"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Functions should have `@notice` tags",
      "description": "The `@notice` is used to explain to users what the function does. The compiler interprets `///` or `/**` comments [as this tag](https://docs.soliditylang.org/en/latest/natspec-format.html#tags) if one wasn't explicitly provided.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n33: function _calculateShares(\n\n93: function _cashoutAmount(\n\n258: function _checkLiquidatorNft(\n\n278: function _getBalance(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L258",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L33",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L93",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L278"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n21: function _onlyMaster()\n\n37: function _onlyProposed()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L37",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n25: function setParamsLASA(\n\n100: function setPoolParameters(\n\n135: function createPool(\n\n146: function createCurvePool(\n\n164: function _createPool(\n\n277: function _getPoleValue(\n\n293: function _getDeltaPole(\n\n304: function _getStartValue(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L164",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L100",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L135",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L146",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L277",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L293",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L304"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n54: function assignReserveRole(\n\n64: function blockReservePublic()\n\n71: function forwardFeeManagerNFT(\n\n90: function reservePosition()\n\n99: function reservePositionForUser(\n\n111: function _reservePositionForUser(\n\n130: function getNextExpectedId()\n\n193: function _mintPositionForUser(\n\n222: function isOwner(\n\n245: function approveMint(\n\n328: function setBaseExtension(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L193",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L222",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L54",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L64",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L245",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L130",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L71",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L90",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L99",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L111"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n271: function _checkAllowDeposit(\n\n604: function _calculatePotentialPureExtraCashout(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L604",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L271"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n77: function _healthStateCheck(\n\n128: function _emitFundsSolelyWithdrawn(\n\n145: function _emitFundsSolelyDeposited(\n\n192: function _checkHealthState(\n\n401: function _depositExactAmountETH(\n\n1460: function _handleWithdrawAmount(\n\n1489: function _handleSolelyWithdraw(\n\n1517: function _handleWithdrawShares(\n\n1553: function _handleBorrowExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1460",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L192",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L145",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L128",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L77",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1489",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L401",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1553",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1517"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n140: function setSecurity(\n\n257: function _onlyAaveHub()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L257",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L140"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n14: function _onlyFeeManager()\n\n25: function _validateParameter(\n\n49: function getPseudoTotalPool(\n\n59: function getTotalBareToken(\n\n69: function getPseudoTotalBorrowAmount(\n\n79: function getTotalDepositShares(\n\n89: function getTotalBorrowShares(\n\n99: function getPositionLendingShares(\n\n110: function getPositionBorrowShares(\n\n121: function getPureCollateralAmount(\n\n144: function getPositionLendingTokenByIndex(\n\n155: function getPositionLendingTokenLength(\n\n165: function getPositionBorrowTokenByIndex(\n\n176: function getPositionBorrowTokenLength(\n\n197: function _setBestPole(\n\n206: function _setIncreasePole(\n\n215: function _setPole(\n\n224: function _increaseTotalPool(\n\n233: function _decreaseTotalPool(\n\n242: function _increaseTotalDepositShares(\n\n251: function _decreaseTotalDepositShares(\n\n260: function _increasePseudoTotalBorrowAmount(\n\n269: function _decreasePseudoTotalBorrowAmount(\n\n278: function _increaseTotalBorrowShares(\n\n287: function _decreaseTotalBorrowShares(\n\n296: function _increasePseudoTotalPool(\n\n305: function _decreasePseudoTotalPool(\n\n314: function _setTimeStamp(\n\n323: function _setTimeStampScaling(\n\n332: function _increaseTotalBareToken(\n\n341: function _decreaseTotalBareToken(\n\n350: function _checkReentrancy()\n\n363: function _sendingProgressAaveHub()\n\n371: function _decreasePositionMappingValue(\n\n382: function _increaseMappingValue(\n\n393: function _byPassCase(\n\n407: function _increaseTotalAndPseudoTotalPool(\n\n424: function setPoolFee(\n\n434: function _checkOwnerPosition(\n\n447: function _validateNonZero(\n\n458: function _validateZero(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L14",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L25",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L49",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L59",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L69",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L79",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L89",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L99",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L110",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L121",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L155",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L165",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L176",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L197",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L206",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L215",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L224",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L233",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L242",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L251",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L260",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L269",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L278",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L287",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L296",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L305",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L314",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L323",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L332",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L341",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L350",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L363",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L371",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L382",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L393",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L407",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L434",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L447",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L458"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n26: function renounceOwnership()\n\n33: function setLastUpdateGlobal(\n\n42: function setRoundData(\n\n52: function setGlobalAggregatorRoundId(\n\n61: function getTimeStamp()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L26",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L61",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L52",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n35: function latestAnswer()\n\n47: function decimals()\n\n55: function latestRoundData()\n\n78: function getRoundData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L35",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L78",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L55",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n122: function _getLpToAssetRateWrapper(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n191: function _onlyIncentiveMaster()\n\n202: function _onlyWiseSecurity()\n\n213: function _onlyWiseLending()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L213",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L191",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L202"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n230: function _setAaveFlag(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L230"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n266: function doApprovals()\n\n274: function _doApprovals(\n\n361: function _isActive()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L266",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L361",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L274"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n232: function _getEthBack(\n\n264: function _getTokensUniV3(\n\n310: function _withdrawPendleLPs(\n\n326: function _paybackExactShares(\n\n531: function _borrowExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L310",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L326",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L531",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L232",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L264"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n35: function _checkReentrancy()\n\n111: function _getPositionBorrowTokenAmountAave(\n\n244: function _getTokensInETH(\n\n258: function _getEthInTokens(\n\n272: function getLeverageAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L244",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L258",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L272",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L35",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L111"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n63: function changeMinDeposit(\n\n96: function enterFarm(\n\n142: function enterFarmETH(\n\n185: function _getWiseLendingNFT()\n\n210: function exitFarm(\n\n254: function manuallyPaybackShares(\n\n274: function manuallyWithdrawShares(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L96",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L142",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L185",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L210",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L254",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L274"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n32: function withdrawLp(\n\n53: function exchangeRewardsForCompoundingWithIncentive(\n\n113: function exchangeLpFeesForPendleWithIncentive(\n\n172: function skim(\n\n211: function addPendleMarket(\n\n293: function updateRewardTokens(\n\n321: function changeExchangeIncentive(\n\n334: function changeMintFee(\n\n431: function claimArb(\n\n451: function withdrawLock()\n\n497: function increaseReservedForCompound(\n\n526: function overWriteIndex(\n\n544: function overWriteIndexAll(\n\n566: function overWriteAmounts(\n\n581: function claimVoteRewards(\n\n600: function forwardETH(\n\n612: function vote(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L544",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L581",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L600",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L612",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L451",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L497",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L526",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L566",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L32",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L53",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L113",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L172",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L211",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L293",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L431"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n236: function _onlyArbitrum()\n\n245: function _onlyChildContract(\n\n256: function _syncSupply(\n\n272: function syncAllSupply()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L236",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L245",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L256",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L272"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n9: function _findIndex(\n\n32: function _calcExpiry(\n\n45: function _getExpiry()\n\n53: function _getLockAmount()\n\n61: function _getPositionData(\n\n73: function _getAmountToSend(\n\n95: function pendleChildCompoundInfoReservedForCompound(\n\n105: function pendleChildCompoundInfoLastIndex(\n\n115: function pendleChildCompoundInfoRewardTokens(\n\n125: function activePendleMarketsLength()\n\n133: function _checkFeed(\n\n144: function _getRewardTokens(\n\n156: function _getUserReward(\n\n173: function _getUserRewardIndex(\n\n189: function _getTokensInETH(\n\n203: function _getTokensFromETH(\n\n217: function _compareHashes(\n\n236: function _setRewardTokens(\n\n245: function getExpiry()\n\n253: function getLockAmount()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L253",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L32",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L45",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L53",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L61",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L73",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L95",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L105",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L115",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L125",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L133",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L156",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L173",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L189",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L203",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L217",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L236",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L245"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n72: function _onlyController()\n\n98: function _validateSharePrice(\n\n114: function _validateSharePriceGrowth(\n\n132: function _overWriteCheck()\n\n140: function _triggerIndexUpdate()\n\n149: function _wrapOverWrites(\n\n160: function _updateRewardTokens()\n\n169: function _overWriteIndexAll()\n\n177: function _overWriteIndex(\n\n188: function _overWriteAmounts()\n\n196: function _updateRewards()\n\n218: function _calculateRewardsClaimedOutside()\n\n305: function _getBalanceLpBalanceController()\n\n315: function _getActiveBalance()\n\n325: function _getSharePrice()\n\n334: function _syncSupply()\n\n347: function _increaseCardinalityNext()\n\n359: function _withdrawLp(\n\n372: function _getUserReward(\n\n386: function previewDistribution()\n\n416: function _setLastInteraction()\n\n422: function _applyMintFee(\n\n434: function totalLpAssets()\n\n443: function previewUnderlyingLpAssets()\n\n452: function previewMintShares(\n\n465: function previewAmountWithdrawShares(\n\n478: function previewBurnShares(\n\n494: function manualSync()\n\n502: function addCompoundRewards(\n\n592: function changeMintFee(\n\n647: function withdrawExactAmount(\n\n682: function initialize(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L359",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L386",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L347",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L372",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L682",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L647",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L502",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L494",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L478",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L465",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L452",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L443",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L434",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L422",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L416",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L72",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L98",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L114",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L132",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L140",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L149",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L160",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L169",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L177",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L188",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L196",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L218",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L305",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L315",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L325",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L334"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n35: function deploy(\n\n56: function _clone(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L35",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L56"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n41: function _onlyKeyOwner(\n\n63: function _incrementReserved()\n\n70: function _getNextReserveKey()\n\n77: function _reserveKey(\n\n96: function isOwner(\n\n115: function _mintKeyForUser(\n\n141: function mintReserved()\n\n160: function onERC721Received(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L70",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L141",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L41",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L63",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L77",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L96",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L115",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L160"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n16: function reservedKeys(\n\n51: function setFarmContract(\n\n93: function checkOwner(\n\n170: function setBaseExtension(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L93",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L16",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n12: function _sendValue(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n32: function _addAggregator(\n\n60: function _checkFunctionExistence(\n\n87: function _compareMinMax(\n\n131: function _validateAnswer(\n\n216: function _getRelativeDifference(\n\n235: function _compareDifference(\n\n246: function _getChainlinkAnswer(\n\n265: function getETHPriceInUSD()\n\n394: function _getOneUnit(\n\n406: function _getAverageTick(\n\n460: function _getTwapDerivatePrice(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L246",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L394",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L406",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L460",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L32",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L235",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L265",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L60",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L87",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L131",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L216"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n85: function getTokenDecimals(\n\n403: function addAggregator(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L403",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L85"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n31: function _onlyWiseLending()\n\n1078: function checkMinDepositValue(\n\n1092: function _checkMinDepositValue(\n\n1111: function changeMinDepositValue(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1078",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1092",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n118: function _setLiquidationSettings(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L118"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n340: function _getTokensInEth(\n\n806: function _getState(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L806",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L340"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n23: function _validToken(\n\n34: function _nonReentrantCheck()\n\n47: function _reservePosition()\n\n56: function _wrapDepositExactAmount(\n\n83: function _wrapWithdrawExactAmount(\n\n113: function _wrapWithdrawExactShares(\n\n141: function _wrapBorrowExactAmount(\n\n165: function _wrapAaveReturnValueDeposit(\n\n196: function _sendValue(\n\n219: function _getInfoPayback(\n\n243: function _prepareCollaterals(\n\n279: function _prepareBorrows(\n\n315: function getAavePoolAPY(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L196",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L141",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L113",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L83",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L56",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L34",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L23",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L315",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L279",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L243",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L219",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L165"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n611: function skimAave(\n\n664: function _setAaveTokenAddress(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L664",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L611"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n81: function _checkOwner(\n\n93: function _checkPositionLocked(\n\n105: function setWiseSecurity(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L81",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L93"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "A function which defines named returns in it's declaration doesn't need to use return",
      "description": "Remove the return statement once ensuring it is safe to do so",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n379: return \"0\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L379"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n585: return receiveAmount + potentialPureExtraCashout;\n\n589: return receiveAmount;\n\n596: return _withdrawOrAllocateSharesLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L596",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L589",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L585"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n829: return 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L829"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n257: return ORACLE_HUB.getTokensFromETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L257"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n105: return _coreLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L105"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n317: return IPendleChild(PENDLE_CHILD).withdrawExactShares(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L317"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n414: return newVeBalance;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L414"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n472: return amount;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L472"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n68: return PENDLE_LOCK.positionData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L68"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n165: return IPendleMarket(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L165"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n380: return PENDLE_MARKET.userReward(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L380"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n221: return \"0\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L221"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n292: return UNI_V3_FACTORY.getPool(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n452: return true;\n\n456: return _chainLinkIsDead(\n\n480: return state;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L456",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L480",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L452"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n252: return true;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L252"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n290: return true;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L290"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n324: return true;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L324"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n207: return ethCollateral;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L207"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n264: return ethCollateral;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L264"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Function writing that does not comply with the Solidity Style Guide",
      "description": "Order of Functions; ordering helps readers identify which functions they can call and to find the constructor and fallback definitions easier. But there are contracts in the project that do not comply with this.\n\nhttps://docs.soliditylang.org/en/v0.8.23/style-guide.html\n\nFunctions should be grouped according to their visibility and ordered:\n- constructor\n- receive function (if exists)\n- fallback function (if exists)\n- external\n- public\n- internal\n- private\n- within a grouping, place the view and pure functions last",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: \n\nWiseSecurityHelper.sol\n\nWiseSecurity/WiseSecurityHelper.sol\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Large or complicated code bases should implement fuzzing tests",
      "description": "Large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts, should implement <a href=\"https://medium.com/coinmonks/smart-contract-fuzzing-d9b88e0b0a05\">fuzzing tests</a>. Fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and fuzzers, with properly and extensively-written invariants, can close this testing gap significantly.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "Various in-scope contract files",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Use `delete` to Clear Variables",
      "description": "`delete a` assigns the initial value for the type to `a`. i.e. for integers it is equivalent to `a = 0`, but it can also be used on arrays, where it assigns a dynamic array of length zero or a static array of the same length with all elements reset. For structs, it assigns a struct with all members reset. Similarly, it can also be used to set an address to zero address. It has no effect on whole mappings though (as the keys of mappings may be arbitrary and are generally unknown). However, individual keys and what they map to can be deleted: If `a` is a mapping, then `delete a[x]` will delete the value stored at `x`.\n\nThe `delete` key better conveys the intention and is also more idiomatic. Consider replacing assignments of zero with `delete` statements.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n228: reservedKeys[msg.sender] = 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L228"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n268: childInfo.reservedForCompound[i] = 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L268"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n459: reservedPendleForLocking = 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L459"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n256: rewardsOutsideArray[i] = 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L256"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n418: secondsAgo[1] = 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L418"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n600: i = 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L600"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n732: i = 0;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L732"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "`if`-statement can be converted to a ternary",
      "description": "The code can be made more compact while also increasing readability by converting the following `if`-statements to ternaries (e.g. `foo += (x > y) ? a : b`)",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n203: if (nftId > 0) {\n            delete reserved[\n                _user\n            ];\n\n            totalReserved--;\n\n        } else {\n            nftId = getNextExpectedId();\n        }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L203"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n76: if (_onBehalf == true) {\n            emit FundsWithdrawnOnBehalf(\n                _caller,\n                _nftId,\n                _poolToken,\n                _amount,\n                _shares,\n                block.timestamp\n            );\n        } else {\n            emit FundsWithdrawn(\n                _caller,\n                _nftId,\n                _poolToken,\n                _amount,\n                _shares,\n                block.timestamp\n            );\n        }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L76"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n397: if (_onBehalf == true) {\n            emit FundsBorrowedOnBehalf(\n                _caller,\n                _nftId,\n                _poolToken,\n                _amount,\n                _shares,\n                block.timestamp\n            );\n        } else {\n            emit FundsBorrowed(\n                _caller,\n                _nftId,\n                _poolToken,\n                _amount,\n                _shares,\n                block.timestamp\n            );\n        }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L397"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n227: if (reservedKeys[msg.sender] == _keyId) {\n            reservedKeys[msg.sender] = 0;\n        } else {\n            FARMS_NFTS.burnKey(\n                _keyId\n            );\n        }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L227"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Immutables can be named using the same convention",
      "description": "Immutables should be in uppercase per naming convention.\nAs shown below, some immutables are named using capital letters and underscores while some are not. For a better code quality, please consider naming these immutables using the same naming convention.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n54: address public immutable aaveTokenAddresses;\n\n55: address public immutable borrowTokenAddresses;\n\n57: address public immutable ENTRY_ASSET;\n\n58: address public immutable PENDLE_CHILD;\n\n66: IAave public immutable AAVE;\n\n67: IAaveHub public immutable AAVE_HUB;\n\n68: IWiseLending public immutable WISE_LENDING;\n\n69: IWiseOracleHub public immutable ORACLE_HUB;\n\n70: IWiseSecurity public immutable WISE_SECURITY;\n\n71: IBalancerVault public immutable BALANCER_VAULT;\n\n72: IPositionNFTs public immutable POSITION_NFT;\n\n73: IStETH public immutable ST_ETH;\n\n74: ICurve public immutable CURVE;\n\n75: IUniswapV3 public immutable UNISWAP_V3_ROUTER;\n\n77: IPendleSy public immutable PENDLE_SY;\n\n78: IPendleRouter public immutable PENDLE_ROUTER;\n\n79: IPendleMarket public immutable PENDLE_MARKET;\n\n80: IPendleRouterStatic public immutable PENDLE_ROUTER_STATIC;\n\n82: address internal immutable WETH_ADDRESS;\n\n84: address immutable AAVE_ADDRESS;\n\n88: address immutable AAVE_HUB_ADDRESS;\n\n90: address immutable AAVE_WETH_ADDRESS;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L74",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L58",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L66",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L67",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L68",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L69",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L70",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L71",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L72",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L73",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L75",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L77",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L78",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L79",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L80",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L82",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L84",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L88",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L90",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L54",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L55",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n76: address public immutable WETH_ADDRESS;\n\n82: address public immutable ETH_USD_PLACEHOLDER;\n\n85: uint8 internal immutable _decimalsWETH;\n\n88: IPriceFeed public immutable ETH_PRICE_FEED;\n\n91: IPriceFeed public immutable SEQUENCER;\n\n94: IUniswapV3Factory public immutable UNI_V3_FACTORY;\n\n133: bool internal immutable IS_ARBITRUM_CHAIN;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L91",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L94",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L133",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L88",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L76",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L82",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L85"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Imports can be grouped together",
      "description": "Consider importing OZ first, then all interfaces, then all utils.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n5: import \"./OwnableMaster.sol\";\n\n7: import \"./InterfaceHub/IAaveHubLite.sol\";\n\n8: import \"./InterfaceHub/IPositionNFTs.sol\";\n\n9: import \"./InterfaceHub/IWiseSecurity.sol\";\n\n10: import \"./InterfaceHub/IWiseOracleHub.sol\";\n\n11: import \"./InterfaceHub/IFeeManagerLight.sol\";\n\n13: import \"./TransferHub/WrapperHelper.sol\";\n\n14: import \"./TransferHub/SendValueHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L14",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L8",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n3: import \"./CustomOracleSetup.sol\";\n\n5: import \"../InterfaceHub/IPendle.sol\";\n\n6: import \"../InterfaceHub/IPriceFeed.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L3",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L6"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n5: import \"../../OwnableMaster.sol\";\n\n7: import \"../../TransferHub/TransferHelper.sol\";\n\n8: import \"../../TransferHub/ApprovalHelper.sol\";\n\n10: import \"../../InterfaceHub/IPendle.sol\";\n\n11: import \"../../InterfaceHub/IArbRewardsClaimer.sol\";\n\n12: import \"../../InterfaceHub/IWiseOracleHub.sol\";\n\n13: import \"../../InterfaceHub/IPendlePowerFarmToken.sol\";\n\n14: import \"../../InterfaceHub/IPendlePowerFarmTokenFactory.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L8",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L12",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n5: import \"./SimpleERC20Clone.sol\";\n\n7: import \"../../InterfaceHub/IPendle.sol\";\n\n8: import \"../../InterfaceHub/IPendleController.sol\";\n\n10: import \"../../TransferHub/TransferHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n11: import \"../../OwnableMaster.sol\";\n\n12: import \"@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L11-L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n5: import \"./AaveEvents.sol\";\n\n7: import \"../InterfaceHub/IAave.sol\";\n\n8: import \"../InterfaceHub/IWiseLending.sol\";\n\n9: import \"../InterfaceHub/IWiseSecurity.sol\";\n\n10: import \"../InterfaceHub/IPositionNFTs.sol\";\n\n12: import \"../OwnableMaster.sol\";\n\n13: import \"../TransferHub/WrapperHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L8",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L12"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Incorrect withdraw declaration",
      "description": "In Solidity, it's essential for clarity and interoperability to correctly specify return types in function declarations. If the `withdraw` function is expected to return a `bool` to indicate success or failure, its omission could lead to ambiguity or unexpected behavior when interacting with or calling this function from other contracts or off-chain systems. Missing return values can mislead developers and potentially lead to contract integrations built on incorrect assumptions. To resolve this, the function declaration for `withdraw` should be modified to explicitly include the `bool` return type, ensuring clarity and correctness in contract interactions.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n428: function _withdrawPureCollateralLiquidation(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _percentLiquidation\n    )\n        private\n        returns (uint256 transferAmount)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L429"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n460: function _withdrawOrAllocateSharesLiquidation(\n        uint256 _nftId,\n        uint256 _nftIdLiquidator,\n        address _poolToken,\n        uint256 _percentWishCollateral\n    )\n        private\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L461"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n636: function withdrawExactAmountETH(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L637"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n675: function withdrawExactSharesETH(\n        uint256 _nftId,\n        uint256 _shares\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L676"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n714: function withdrawExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _withdrawAmount\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L715"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n859: function withdrawOnBehalfExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _withdrawAmount\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L860"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n902: function withdrawExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L903"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n939: function withdrawOnBehalfExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L940"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n310: function _withdrawPendleLPs(\n        uint256 _nftId,\n        uint256 _lendingShares\n    )\n        private\n        returns (uint256 withdrawnLpsAmount)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L311"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n32: function withdrawLp(\n        address _pendleMarket,\n        address _to,\n        uint256 _amount\n    )\n        external\n        onlyChildContract(_pendleMarket)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n451: function withdrawLock()\n        external\n        onlyMaster\n        returns (uint256 amount)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L451"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n359: function _withdrawLp(\n        address _to,\n        uint256 _amount\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L360"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n608: function withdrawExactShares(\n        uint256 _shares\n    )\n        external\n        syncSupply\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L609"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n647: function withdrawExactAmount(\n        uint256 _underlyingLpAssetAmount\n    )\n        external\n        syncSupply\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L648"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n202: function withdrawExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _withdrawAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L203"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n238: function withdrawExactAmountETH(\n        uint256 _nftId,\n        uint256 _withdrawAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L239"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n281: function withdrawExactShares(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _shareAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L282"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n314: function withdrawExactSharesETH(\n        uint256 _nftId,\n        uint256 _shareAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L315"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "No need to initialize uints to zero",
      "description": "There is no need to initialize `uint` variables to zero as their default value is `0`",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Initial value check is missing in Set Functions",
      "description": "A check regarding whether the current value and the new value are the same should be added",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n125: function setVerifiedIsolationPool(\n        address _isolationPool,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n        verifiedIsolationPool[_isolationPool] = _state;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n126: function setVerifiedIsolationPool(\n        address _isolationPool,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n        verifiedIsolationPool[_isolationPool] = _state;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n319: function setBaseURI(\n        string memory _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n        baseURI = _newBaseURI;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L319"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n320: function setBaseURI(\n        string memory _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n        baseURI = _newBaseURI;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n328: function setBaseExtension(\n        string memory _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n        baseExtension = _newBaseExtension;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n329: function setBaseExtension(\n        string memory _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n        baseExtension = _newBaseExtension;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1386: function setRegistrationIsolationPool(\n        uint256 _nftId,\n        bool _registerState\n    )\n        external\n    {\n        _onlyIsolationPool(\n            msg.sender\n        );\n\n        _validateZero(\n            WISE_SECURITY.overallETHCollateralsBare(_nftId)\n        );\n\n        _validateZero(\n            WISE_SECURITY.overallETHBorrowBare(_nftId)\n        );\n\n        positionLocked[_nftId] = _registerState;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1387: function setRegistrationIsolationPool(\n        uint256 _nftId,\n        bool _registerState\n    )\n        external\n    {\n        _onlyIsolationPool(\n            msg.sender\n        );\n\n        _validateZero(\n            WISE_SECURITY.overallETHCollateralsBare(_nftId)\n        );\n\n        _validateZero(\n            WISE_SECURITY.overallETHBorrowBare(_nftId)\n        );\n\n        positionLocked[_nftId] = _registerState;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n424: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyFeeManager\n    {\n        globalPoolData[_poolToken].poolFee = _newFee;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n425: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyFeeManager\n    {\n        globalPoolData[_poolToken].poolFee = _newFee;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n33: function setLastUpdateGlobal(\n        uint256 _time\n    )\n        external\n        onlyOwner\n    {\n        lastUpdateGlobal = _time;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n34: function setLastUpdateGlobal(\n        uint256 _time\n    )\n        external\n        onlyOwner\n    {\n        lastUpdateGlobal = _time;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n42: function setRoundData(\n        uint80 _roundId,\n        uint256 _updateTime\n    )\n        external\n        onlyOwner\n    {\n        timeStampByRoundId[_roundId] = _updateTime;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n43: function setRoundData(\n        uint80 _roundId,\n        uint256 _updateTime\n    )\n        external\n        onlyOwner\n    {\n        timeStampByRoundId[_roundId] = _updateTime;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n49: function setRepayBadDebtIncentive(\n        uint256 _percent\n    )\n        external\n        onlyMaster\n    {\n        _checkValue(\n            _percent\n        );\n\n        paybackIncentive = _percent;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n50: function setRepayBadDebtIncentive(\n        uint256 _percent\n    )\n        external\n        onlyMaster\n    {\n        _checkValue(\n            _percent\n        );\n\n        paybackIncentive = _percent;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n66: function setAaveFlag(\n        address _poolToken,\n        address _underlyingToken\n    )\n        external\n        onlyMaster\n    {\n        _setAaveFlag(\n            _poolToken,\n            _underlyingToken\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L66"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n67: function setAaveFlag(\n        address _poolToken,\n        address _underlyingToken\n    )\n        external\n        onlyMaster\n    {\n        _setAaveFlag(\n            _poolToken,\n            _underlyingToken\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L67"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n82: function setAaveFlagBulk(\n        address[] calldata _poolTokens,\n        address[] calldata _underlyingTokens\n    )\n        external\n        onlyMaster\n    {\n        uint256 i;\n        uint256 l = _poolTokens.length;\n\n        while (i < l) {\n            _setAaveFlag(\n                _poolTokens[i],\n                _underlyingTokens[i]\n            );\n\n            unchecked {\n                ++i;\n            }\n        }\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L82"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n83: function setAaveFlagBulk(\n        address[] calldata _poolTokens,\n        address[] calldata _underlyingTokens\n    )\n        external\n        onlyMaster\n    {\n        uint256 i;\n        uint256 l = _poolTokens.length;\n\n        while (i < l) {\n            _setAaveFlag(\n                _poolTokens[i],\n                _underlyingTokens[i]\n            );\n\n            unchecked {\n                ++i;\n            }\n        }\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n108: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n        _checkValue(\n            _newFee\n        );\n\n        WISE_LENDING.setPoolFee(\n            _poolToken,\n            _newFee\n        );\n\n        emit PoolFeeChanged(\n            _poolToken,\n            _newFee,\n            block.timestamp\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n109: function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n        _checkValue(\n            _newFee\n        );\n\n        WISE_LENDING.setPoolFee(\n            _poolToken,\n            _newFee\n        );\n\n        emit PoolFeeChanged(\n            _poolToken,\n            _newFee,\n            block.timestamp\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n514: function setBadDebtUserLiquidation(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n        _setBadDebtPosition(\n            _nftId,\n            _amount\n        );\n\n        emit SetBadDebtPosition(\n            _nftId,\n            _amount,\n            block.timestamp\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n515: function setBadDebtUserLiquidation(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n        _setBadDebtPosition(\n            _nftId,\n            _amount\n        );\n\n        emit SetBadDebtPosition(\n            _nftId,\n            _amount,\n            block.timestamp\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L515"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n63: function changeMinDeposit(\n        uint256 _newMinDeposit\n    )\n        external\n        onlyMaster\n    {\n        minDepositEthAmount = _newMinDeposit;\n\n        emit MinDepositChange(\n            _newMinDeposit,\n            block.timestamp\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n64: function changeMinDeposit(\n        uint256 _newMinDeposit\n    )\n        external\n        onlyMaster\n    {\n        minDepositEthAmount = _newMinDeposit;\n\n        emit MinDepositChange(\n            _newMinDeposit,\n            block.timestamp\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L64"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n321: function changeExchangeIncentive(\n        uint256 _newExchangeIncentive\n    )\n        external\n        onlyMaster\n    {\n        exchangeIncentive = _newExchangeIncentive;\n\n        emit ChangeExchangeIncentive(\n            _newExchangeIncentive\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n322: function changeExchangeIncentive(\n        uint256 _newExchangeIncentive\n    )\n        external\n        onlyMaster\n    {\n        exchangeIncentive = _newExchangeIncentive;\n\n        emit ChangeExchangeIncentive(\n            _newExchangeIncentive\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L322"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n334: function changeMintFee(\n        address _pendleMarket,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n        address child = pendleChildAddress[\n            _pendleMarket\n        ];\n\n        if (child == ZERO_ADDRESS) {\n            revert WrongAddress();\n        }\n\n        IPendlePowerFarmToken(\n            child\n        ).changeMintFee(\n            _newFee\n        );\n\n        emit ChangeMintFee(\n            _pendleMarket,\n            _newFee\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n335: function changeMintFee(\n        address _pendleMarket,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n        address child = pendleChildAddress[\n            _pendleMarket\n        ];\n\n        if (child == ZERO_ADDRESS) {\n            revert WrongAddress();\n        }\n\n        IPendlePowerFarmToken(\n            child\n        ).changeMintFee(\n            _newFee\n        );\n\n        emit ChangeMintFee(\n            _pendleMarket,\n            _newFee\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n592: function changeMintFee(\n        uint256 _newFee\n    )\n        external\n        onlyController\n    {\n        if (_newFee > MAX_MINT_FEE) {\n            revert FeeTooHigh();\n        }\n\n        mintFee = _newFee;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n593: function changeMintFee(\n        uint256 _newFee\n    )\n        external\n        onlyController\n    {\n        if (_newFee > MAX_MINT_FEE) {\n            revert FeeTooHigh();\n        }\n\n        mintFee = _newFee;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n51: function setFarmContract(\n        address _farmContract\n    )\n        external\n        onlyMaster\n    {\n        if (farmContract == ZERO_ADDRESS) {\n            farmContract = _farmContract;\n        }\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n52: function setFarmContract(\n        address _farmContract\n    )\n        external\n        onlyMaster\n    {\n        if (farmContract == ZERO_ADDRESS) {\n            farmContract = _farmContract;\n        }\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n161: function setBaseURI(\n        string calldata _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n        baseURI = _newBaseURI;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n162: function setBaseURI(\n        string calldata _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n        baseURI = _newBaseURI;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n170: function setBaseExtension(\n        string calldata _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n        baseExtension = _newBaseExtension;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n171: function setBaseExtension(\n        string calldata _newBaseExtension\n    )\n        external\n        onlyMaster\n    {\n        baseExtension = _newBaseExtension;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n85: function setLiquidationSettings(\n        uint256 _baseReward,\n        uint256 _baseRewardFarm,\n        uint256 _newMaxFeeETH,\n        uint256 _newMaxFeeFarmETH\n    )\n        external\n        onlyMaster\n    {\n        _setLiquidationSettings(\n            _baseReward,\n            _baseRewardFarm,\n            _newMaxFeeETH,\n            _newMaxFeeFarmETH\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L85"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n86: function setLiquidationSettings(\n        uint256 _baseReward,\n        uint256 _baseRewardFarm,\n        uint256 _newMaxFeeETH,\n        uint256 _newMaxFeeFarmETH\n    )\n        external\n        onlyMaster\n    {\n        _setLiquidationSettings(\n            _baseReward,\n            _baseRewardFarm,\n            _newMaxFeeETH,\n            _newMaxFeeFarmETH\n        );\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n980: function setBlacklistToken(\n        address _tokenAddress,\n        bool _state\n    )\n        external\n        onlyMaster()\n    {\n        wasBlacklisted[_tokenAddress] = _state;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n981: function setBlacklistToken(\n        address _tokenAddress,\n        bool _state\n    )\n        external\n        onlyMaster()\n    {\n        wasBlacklisted[_tokenAddress] = _state;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n995: function setSecurityWorker(\n        address _entitiy,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n        securityWorker[_entitiy] = _state;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L995"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n996: function setSecurityWorker(\n        address _entitiy,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n        securityWorker[_entitiy] = _state;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1111: function changeMinDepositValue(\n        uint256 _newMinDepositValue\n    )\n        external\n        onlyMaster\n    {\n        if (_newMinDepositValue == 0) {\n            revert NoValue();\n        }\n\n        minDepositEthValue = _newMinDepositValue;\n    }\n}\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1112: function changeMinDepositValue(\n        uint256 _newMinDepositValue\n    )\n        external\n        onlyMaster\n    {\n        if (_newMinDepositValue == 0) {\n            revert NoValue();\n        }\n\n        minDepositEthValue = _newMinDepositValue;\n    }\n}\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n44: function setAaveTokenAddress(\n        address _underlyingAsset,\n        address _aaveToken\n    )\n        external\n        onlyMaster\n    {\n        _setAaveTokenAddress(\n            _underlyingAsset,\n            _aaveToken\n        );\n\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L44"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n45: function setAaveTokenAddress(\n        address _underlyingAsset,\n        address _aaveToken\n    )\n        external\n        onlyMaster\n    {\n        _setAaveTokenAddress(\n            _underlyingAsset,\n            _aaveToken\n        );\n\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n105: function setWiseSecurity(\n        address _securityAddress\n    )\n        external\n        onlyMaster\n    {\n        if (address(WISE_SECURITY) > ZERO_ADDRESS) {\n            revert AlreadySet();\n        }\n\n        WISE_SECURITY = IWiseSecurity(\n            _securityAddress\n        );\n    }\n}\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n106: function setWiseSecurity(\n        address _securityAddress\n    )\n        external\n        onlyMaster\n    {\n        if (address(WISE_SECURITY) > ZERO_ADDRESS) {\n            revert AlreadySet();\n        }\n\n        WISE_SECURITY = IWiseSecurity(\n            _securityAddress\n        );\n    }\n}\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Contracts should have full test coverage",
      "description": "While a code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "All in-scope contracts",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Interface imports should be declared first",
      "description": "Amend the ordering of imports to import interfaces first followed by other imports",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n7: import \"./InterfaceHub/IAaveHubLite.sol\";\n\n8: import \"./InterfaceHub/IPositionNFTs.sol\";\n\n9: import \"./InterfaceHub/IWiseSecurity.sol\";\n\n10: import \"./InterfaceHub/IWiseOracleHub.sol\";\n\n11: import \"./InterfaceHub/IFeeManagerLight.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L7-L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n5: import \"../InterfaceHub/IPendle.sol\";\n\n6: import \"../InterfaceHub/IPriceFeed.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L5-L6"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n10: import \"../../InterfaceHub/IPendle.sol\";\n\n11: import \"../../InterfaceHub/IArbRewardsClaimer.sol\";\n\n12: import \"../../InterfaceHub/IWiseOracleHub.sol\";\n\n13: import \"../../InterfaceHub/IPendlePowerFarmToken.sol\";\n\n14: import \"../../InterfaceHub/IPendlePowerFarmTokenFactory.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L10-L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n7: import \"../../InterfaceHub/IPendle.sol\";\n\n8: import \"../../InterfaceHub/IPendleController.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L7-L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n7: import \"../InterfaceHub/IAave.sol\";\n\n8: import \"../InterfaceHub/IWiseLending.sol\";\n\n9: import \"../InterfaceHub/IWiseSecurity.sol\";\n\n10: import \"../InterfaceHub/IPositionNFTs.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L7-L10"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Invalid NatSpec comment style",
      "description": "NatSpec must begin with `///`, or use `/* ... */` syntax",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n563: // @TODO: Add a check for TWAP comparison on 2.5%\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L563"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n95: // @TODO: Delete later, keep for backward compatibility\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L95"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n170: // @TODO: Delete later, keep for backward compatibility\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L170"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "It is best practice to use linear inheritance",
      "description": "In Solidity, complex inheritance structures can obfuscate code understanding, introducing potential security risks. Multiple inheritance, especially with overlapping function names or state variables, can cause unintentional overrides or ambiguous behavior. \n\nResolution: Strive for linear and simple inheritance chains. Avoid diamond or circular inheritance patterns. Clearly document the purpose and relationships of base contracts, ensuring that overrides are intentional. Tools like Remix or Hardhat can visualize inheritance chains, assisting in verification. Keeping inheritance streamlined aids in better code readability, reduces potential errors, and ensures smoother audits and upgrades.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n25: contract FeeManager is FeeManagerHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n7: abstract contract PendlePowerFarm is PendlePowerFarmLeverageLogic {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n8: contract PendlePowerFarmController is PendlePowerFarmControllerHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n24: contract WiseSecurity is WiseSecurityHelper, ApprovalHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L24"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Lack Of brace spacing",
      "description": "Lack of brace spacing in coding refers to the absence of spaces around braces, which can hinder code readability. In Solidity, as in many programming languages, spacing can enhance the visual distinction between different parts of the code, making it easier to follow. A lack of spacing can lead to a dense, confusing appearance. The resolution to this issue is to follow a consistent style guide that defines rules for brace spacing. By including spaces around braces, such as `{ statement }` instead of `{statement}`, developers can ensure that the code is more legible and maintainable, especially in larger codebases.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n208: ) = curvePool.call{value: 0} (\n\n225: ) = curveMeta.call{value: 0} (\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L225",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L208"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Assembly blocks should have extensive comments",
      "description": "Assembly blocks are take a lot more time to audit than normal Solidity code, and often have gotchas and side-effects that the Solidity versions of the same code do not. Consider adding more comments explaining what is being done in every step of the assembly code",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n56: function _clone(\n        address _underlyingPendleMarket,\n        string memory _tokenName,\n        string memory _symbolName,\n        uint16 _maxCardinality\n    )\n        private\n        returns (address pendlePowerFarmTokenAddress)\n    {\n        bytes32 salt = keccak256(\n            abi.encodePacked(\n                _underlyingPendleMarket\n            )\n        );\n\n        bytes20 targetBytes = bytes20(\n            IMPLEMENTATION_TARGET\n        );\n\n        assembly {\n\n            let clone := mload(0x40)\n\n            mstore(\n                clone,\n                0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000\n            )\n\n            mstore(\n                add(clone, 0x14),\n                targetBytes\n            )\n\n            mstore(\n                add(clone, 0x28),\n                0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000\n            )\n\n            pendlePowerFarmTokenAddress := create2(\n                0,\n                clone,\n                0x37,\n                salt\n            )\n        }\n\n        PendlePowerFarmToken(pendlePowerFarmTokenAddress).initialize(\n            _underlyingPendleMarket,\n            PENDLE_POWER_FARM_CONTROLLER,\n            _tokenName,\n            _symbolName,\n            _maxCardinality\n        );\n    }\n}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L56"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n60: function _checkFunctionExistence(\n        address _tokenAggregator\n    )\n        internal\n        returns (bool)\n    {\n        uint256 size;\n\n        assembly {\n            size := extcodesize(\n                _tokenAggregator\n            )\n        }\n\n        if (size == 0) {\n            return false;\n        }\n\n        (bool success, ) = _tokenAggregator.call(\n            abi.encodeWithSignature(\n                \"maxAnswer()\"\n            )\n        );\n\n        return success;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L60"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Large or complicated code bases should implement invariant tests",
      "description": "This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts. Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "All in-scope contracts",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Long functions should be refactored into multiple, smaller, functions",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n298: function _cleanUp(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L299"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n500: function _updatePseudoTotalAmounts(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L501"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n667: function _removePositionData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L668"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n25: function setParamsLASA(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n164: function _createPool(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L165"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n44: function _coreWithdrawToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n106: function _handleDeposit(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L107"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n349: function _coreBorrowTokens(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L350"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n460: function _withdrawOrAllocateSharesLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L461"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n543: function _calculateReceiveAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L544"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n625: function _coreLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L626"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1088: function paybackExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1089"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1250: function liquidatePartiallyFromTokens(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1251"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1314: function coreLiquidationIsolationPools(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1315"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n140: function setSecurity(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n257: function _onlyAaveHub(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L257"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n81: function latestAnswer(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L81"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n438: function removePoolTokenManual(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L439"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n628: function claimWiseFees(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L629"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n730: function paybackBadDebtForToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L731"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n816: function paybackBadDebtNoReward(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L817"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n134: function _updateUserBadDebt(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n330: function _gatherIncentives(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L331"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n230: function _closingPosition(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L231"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n274: function _doApprovals(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L275"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n59: function receiveFlashLoan(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L60"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n134: function _logicClosePosition(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L135"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n414: function _logicOpenPosition(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L415"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n560: function _coreLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L561"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n174: function getPositionBorrowETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L175"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n289: function _getApproxNetAPY(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L290"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n53: function exchangeRewardsForCompoundingWithIncentive(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L54"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n113: function exchangeLpFeesForPendleWithIncentive(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L114"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n211: function addPendleMarket(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L212"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n364: function lockPendle(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L365"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n218: function _calculateRewardsClaimedOutside(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L218"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n529: function depositExactAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L530"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n682: function initialize(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L683"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n56: function _clone(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n131: function _validateAnswer(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L132"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n460: function _getTwapDerivatePrice(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L461"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n592: function _recalibratePreview(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n266: function addTwapOracleDerivative(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L267"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n142: function prepareCurvePools(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L143"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n442: function overallLendingAPY(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L443"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n499: function overallBorrowAPY(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L500"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n556: function overallNetAPY(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L557"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n641: function safeLimitPosition(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L642"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n695: function positionBlackListToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L696"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n764: function maximumWithdrawToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L765"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n118: function _setLiquidationSettings(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L119"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n482: function paybackExactAmountETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L483"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n556: function paybackExactShares(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L557"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Make use of Solidity's `using` keyword",
      "description": "The directive `using A for B` can be used to attach functions (`A`) as operators to user-defined value types or as member functions to any type (`B`). The member functions receive the object they are called on as their first parameter (like the `self` variable in Python). The operator functions receive operands as parameters.  Doing so improves readability, makes debugging easier, and promotes modularity and reusability in the code.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n116: IFarmContract farm = IFarmContract(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L116"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n124: IPriceFeed internal constant ZERO_FEED = IPriceFeed(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L124"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n129: IAggregator internal constant ZERO_AGGREGATOR = IAggregator(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L129"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n37: IAggregator tokenAggregator = IAggregator(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L37"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n173: IERC20 token = IERC20(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L173"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Missing Contract-existence Checks Before Low-level Calls",
      "description": "Low-level calls return success if there is no code present at the specified address. ",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n676: _data.caller,\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L676"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1267: data.caller = msg.sender;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1267"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1333: data.caller = _caller;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1333"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n27: ) = payable(_recipient).call{\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L27"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n78: (bool success, ) = _tokenAggregator.call(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L78"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n208: ) = curvePool.call{value: 0} (\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L208"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n225: ) = curveMeta.call{value: 0} (\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L225"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n208: (bool success, ) = payable(_recipient).call{\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L208"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Missing event for critical parameter change",
      "description": "When changing state variables events are not emitted. Emitting events allows monitoring activities with off-chain monitoring tools.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n25: function setParamsLASA(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n100: function setPoolParameters(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L101"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n125: function setVerifiedIsolationPool(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n319: function setBaseURI(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n328: function setBaseExtension(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1386: function setRegistrationIsolationPool(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n140: function setSecurity(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n424: function setPoolFee(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n33: function setLastUpdateGlobal(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n42: function setRoundData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n52: function setGlobalAggregatorRoundId(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n49: function setRepayBadDebtIncentive(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n82: function setAaveFlagBulk(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n592: function changeMintFee(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n51: function setFarmContract(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n161: function setBaseURI(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n170: function setBaseExtension(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n980: function setBlacklistToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n995: function setSecurityWorker(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1111: function changeMinDepositValue(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n64: function setAaveTokenAddressBulk(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L65"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n105: function setWiseSecurity(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Missing/malformed underscores for large numeric literals",
      "description": "Large hardcoded numbers in code can be difficult to read. Consider using underscores for number literals to improve readability (e.g `1234567` -> `1_234_567`). Consider using an underscore for every third digit from the right.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n307: uint256 internal constant NORMALISATION_FACTOR = 4838400;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L307"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Missing NatSpec `@dev` from event declaration",
      "description": "Some events have an incomplete NatSpec: add a @notice notation to describe the event to improve the code documentation.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n48: event MasterProposed(\n\n53: event RenouncedOwnership(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L48",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n35: event FundsDeposited(\n\n44: event FundsSolelyDeposited(\n\n52: event FundsWithdrawn(\n\n61: event FundsWithdrawnOnBehalf(\n\n70: event FundsSolelyWithdrawn(\n\n78: event FundsBorrowed(\n\n87: event FundsBorrowedOnBehalf(\n\n96: event FundsReturned(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L96",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L87",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L78",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L70",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L52",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L61",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L44",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n7: event ClaimedFeesWiseBulk(\n\n11: event PoolTokenRemoved(\n\n16: event PoolTokenAdded(\n\n21: event IncentiveOwnerBChanged(\n\n26: event IncentiveOwnerAChanged(\n\n31: event ClaimedOwnershipIncentiveMaster(\n\n36: event IncentiveMasterProposed(\n\n41: event PoolFeeChanged(\n\n47: event ClaimedIncentives(\n\n54: event ClaimedIncentivesBulk(\n\n58: event IncentiveIncreasedB(\n\n63: event IncentiveIncreasedA(\n\n68: event BadDebtIncreasedLiquidation(\n\n73: event TotalBadDebtIncreased(\n\n78: event TotalBadDebtDecreased(\n\n83: event SetBadDebtPosition(\n\n89: event UpdateBadDebtPosition(\n\n95: event SetBeneficial(\n\n101: event RevokeBeneficial(\n\n107: event ClaimedFeesWise(\n\n113: event ClaimedFeesBeneficial(\n\n120: event PayedBackBadDebt(\n\n129: event PayedBackBadDebtFree(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L83",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L129",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L120",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L113",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L107",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L101",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L95",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L54",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L58",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L63",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L68",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L73",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L78",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L89",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L16",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L21",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L26",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L31",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L36",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L41"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n110: event FarmEntry(\n\n118: event FarmExit(\n\n125: event FarmStatus(\n\n130: event ManualPaybackShares(\n\n137: event ManualWithdrawShares(\n\n144: event MinDepositChange(\n\n149: event ETHReceived(\n\n154: event RegistrationFarm(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L110",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L118",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L125",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L130",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L137",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L149",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n135: event ETHReceived(\n\n140: event ChangeExchangeIncentive(\n\n144: event WithdrawLp(\n\n150: event ExchangeRewardsForCompounding(\n\n157: event ExchangeLpFeesForPendle(\n\n164: event AddPendleMarket(\n\n169: event UpdateRewardTokens(\n\n174: event ChangeMintFee(\n\n179: event LockPendle(\n\n188: event ClaimArb(\n\n194: event IncreaseReservedForCompound(\n\n199: event ClaimVoteRewards(\n\n205: event WithdrawLock(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L140",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L135",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L150",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L157",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L164",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L169",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L174",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L179",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L188",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L194",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L199",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L205"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n153: event ERC721Received(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L153"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n47: event SecurityShutdown(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n7: event SetAaveTokenAddress(\n\n13: event IsDepositAave(\n\n18: event IsWithdrawAave(\n\n23: event IsBorrowAave(\n\n28: event IsPaybackAave(\n\n33: event IsSolelyDepositAave(\n\n38: event IsSolelyWithdrawAave(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L18",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L23",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L28",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L13"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Missing NatSpec `@dev` from function declaration",
      "description": "Some functions have an incomplete NatSpec: add a `@dev` notation to describe the function to improve the code documentation.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n17: function calculateLendingShares(\n\n33: function _calculateShares(\n\n55: function calculateBorrowShares(\n\n79: function cashoutAmount(\n\n93: function _cashoutAmount(\n\n114: function paybackAmount(\n\n135: function _preparationsWithdraw(\n\n163: function _getValueUtilization(\n\n187: function _updateUtilization(\n\n202: function _checkCleanUp(\n\n232: function _validateIsolationPoolLiquidation(\n\n258: function _checkLiquidatorNft(\n\n278: function _getBalance(\n\n298: function _cleanUp(\n\n350: function _getAllowedDifference(\n\n372: function _preparePool(\n\n391: function _preparationTokens(\n\n417: function _prepareTokens(\n\n454: function _curveSecurityChecks(\n\n473: function _whileLoopCurveSecurity(\n\n500: function _updatePseudoTotalAmounts(\n\n584: function _increasePositionLendingDeposit(\n\n599: function _decreaseLendingShares(\n\n614: function _addPositionTokenData(\n\n647: function _getHash(\n\n667: function _removePositionData(\n\n733: function _deleteLastPositionLendingData(\n\n752: function _corePayback(\n\n794: function _deleteLastPositionBorrowData(\n\n814: function isUncollateralized(\n\n830: function _checkLendingDataEmpty(\n\n851: function _calculateNewBorrowRate(\n\n877: function _newBorrowRate(\n\n896: function _aboveThreshold(\n\n911: function _scalingAlgorithm(\n\n947: function _newMaxPoolShares(\n\n969: function _saveUp(\n\n987: function _resonanceOutcome(\n\n1006: function _resetResonanceFactor(\n\n1045: function _updateResonanceFactor(\n\n1094: function _increaseResonanceFactor(\n\n1125: function _decreaseResonanceFactor(\n\n1155: function _removeEmptyLendingData(\n\n1184: function _updatePoolStorage(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L947",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L911",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L896",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L877",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L851",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L830",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L17",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L33",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L55",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L79",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L93",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L114",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L135",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L163",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L187",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L202",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L232",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L258",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L278",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L298",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L350",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L372",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L391",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L417",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L454",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L473",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L500",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L584",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L599",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L614",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L647",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L667",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L733",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L752",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L814",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L794",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1094",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1045",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1006",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L987",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1155",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1125",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1184",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L969"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n21: function _onlyMaster()\n\n37: function _onlyProposed()\n\n70: function proposeOwner(\n\n92: function claimOwnership()\n\n103: function renounceOwnership()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L103",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L21",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L37",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L70",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L92"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n25: function setParamsLASA(\n\n100: function setPoolParameters(\n\n135: function createPool(\n\n146: function createCurvePool(\n\n164: function _createPool(\n\n277: function _getPoleValue(\n\n293: function _getDeltaPole(\n\n304: function _getStartValue(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L100",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L135",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L146",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L164",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L304",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L277",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L293",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n54: function assignReserveRole(\n\n64: function blockReservePublic()\n\n71: function forwardFeeManagerNFT(\n\n90: function reservePosition()\n\n99: function reservePositionForUser(\n\n111: function _reservePositionForUser(\n\n130: function getNextExpectedId()\n\n142: function mintPosition()\n\n174: function mintPositionForUser(\n\n193: function _mintPositionForUser(\n\n222: function isOwner(\n\n245: function approveMint(\n\n328: function setBaseExtension(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L64",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L130",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L142",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L174",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L222",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L193",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L245",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L111",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L99",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L90",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L71",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L54"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n15: function _prepareAssociatedTokens(\n\n44: function _coreWithdrawToken(\n\n106: function _handleDeposit(\n\n173: function checkPositionLocked(\n\n193: function _checkPositionLocked(\n\n215: function checkDeposit(\n\n236: function _checkDeposit(\n\n271: function _checkAllowDeposit(\n\n294: function _checkMaxDepositValue(\n\n316: function _coreWithdrawBare(\n\n349: function _coreBorrowTokens(\n\n428: function _withdrawPureCollateralLiquidation(\n\n460: function _withdrawOrAllocateSharesLiquidation(\n\n543: function _calculateReceiveAmount(\n\n604: function _calculatePotentialPureExtraCashout(\n\n625: function _coreLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L316",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L460",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L543",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L604",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L625",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L15",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L44",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L106",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L173",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L193",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L215",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L236",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L271",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L294",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L349",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L428"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n77: function _healthStateCheck(\n\n128: function _emitFundsSolelyWithdrawn(\n\n145: function _emitFundsSolelyDeposited(\n\n192: function _checkHealthState(\n\n210: function _compareSharePrices(\n\n255: function _getCurrentSharePriceMax(\n\n275: function _syncPoolBeforeCodeExecution(\n\n308: function _syncPoolAfterCodeExecution(\n\n388: function depositExactAmountETH(\n\n401: function _depositExactAmountETH(\n\n426: function depositExactAmountETHMint()\n\n442: function depositExactAmountMint(\n\n460: function depositExactAmount(\n\n493: function solelyDepositETHMint()\n\n508: function solelyDepositETH(\n\n539: function _handleSolelyDeposit(\n\n581: function solelyDepositMint(\n\n600: function solelyDeposit(\n\n636: function withdrawExactAmountETH(\n\n675: function withdrawExactSharesETH(\n\n714: function withdrawExactAmount(\n\n751: function solelyWithdrawETH(\n\n780: function solelyWithdraw(\n\n808: function _coreSolelyWithdraw(\n\n859: function withdrawOnBehalfExactAmount(\n\n902: function withdrawExactShares(\n\n939: function withdrawOnBehalfExactShares(\n\n975: function borrowExactAmountETH(\n\n1016: function borrowExactAmount(\n\n1055: function borrowOnBehalfExactAmount(\n\n1088: function paybackExactAmountETH(\n\n1161: function paybackExactAmount(\n\n1204: function paybackExactShares(\n\n1250: function liquidatePartiallyFromTokens(\n\n1367: function syncManually(\n\n1386: function setRegistrationIsolationPool(\n\n1412: function corePaybackFeeManager(\n\n1434: function _handlePayback(\n\n1460: function _handleWithdrawAmount(\n\n1489: function _handleSolelyWithdraw(\n\n1517: function _handleWithdrawShares(\n\n1553: function _handleBorrowExactAmount(\n\n1588: function _reservePosition()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L751",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L675",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L77",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L808",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L780",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L714",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L975",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L939",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L902",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L308",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L275",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L255",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L210",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L192",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L145",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L128",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L859",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L426",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L442",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L460",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L493",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L508",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L539",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L581",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L600",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L636",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1016",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L388",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1055",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1088",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1161",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1204",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L401",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1250",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1367",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1412",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1434",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1460",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1489",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1517",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1553",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1588"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n140: function setSecurity(\n\n257: function _onlyAaveHub()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L140",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L257"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n14: function _onlyFeeManager()\n\n25: function _validateParameter(\n\n39: function getTotalPool(\n\n49: function getPseudoTotalPool(\n\n59: function getTotalBareToken(\n\n69: function getPseudoTotalBorrowAmount(\n\n79: function getTotalDepositShares(\n\n89: function getTotalBorrowShares(\n\n99: function getPositionLendingShares(\n\n110: function getPositionBorrowShares(\n\n121: function getPureCollateralAmount(\n\n134: function getTimeStamp(\n\n144: function getPositionLendingTokenByIndex(\n\n155: function getPositionLendingTokenLength(\n\n165: function getPositionBorrowTokenByIndex(\n\n176: function getPositionBorrowTokenLength(\n\n188: function _setMaxValue(\n\n197: function _setBestPole(\n\n206: function _setIncreasePole(\n\n215: function _setPole(\n\n224: function _increaseTotalPool(\n\n233: function _decreaseTotalPool(\n\n242: function _increaseTotalDepositShares(\n\n251: function _decreaseTotalDepositShares(\n\n260: function _increasePseudoTotalBorrowAmount(\n\n269: function _decreasePseudoTotalBorrowAmount(\n\n278: function _increaseTotalBorrowShares(\n\n287: function _decreaseTotalBorrowShares(\n\n296: function _increasePseudoTotalPool(\n\n305: function _decreasePseudoTotalPool(\n\n314: function _setTimeStamp(\n\n323: function _setTimeStampScaling(\n\n332: function _increaseTotalBareToken(\n\n341: function _decreaseTotalBareToken(\n\n350: function _checkReentrancy()\n\n363: function _sendingProgressAaveHub()\n\n371: function _decreasePositionMappingValue(\n\n382: function _increaseMappingValue(\n\n393: function _byPassCase(\n\n407: function _increaseTotalAndPseudoTotalPool(\n\n424: function setPoolFee(\n\n434: function _checkOwnerPosition(\n\n447: function _validateNonZero(\n\n458: function _validateZero(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L14",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L25",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L39",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L49",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L59",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L69",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L79",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L89",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L99",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L110",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L121",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L134",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L155",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L165",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L176",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L188",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L197",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L206",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L215",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L224",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L233",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L242",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L251",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L260",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L269",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L278",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L287",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L296",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L305",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L314",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L323",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L332",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L341",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L350",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L363",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L371",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L382",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L393",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L407",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L434",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L447",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L458"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n26: function renounceOwnership()\n\n33: function setLastUpdateGlobal(\n\n42: function setRoundData(\n\n52: function setGlobalAggregatorRoundId(\n\n61: function getTimeStamp()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L26",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L52",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L61"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n35: function latestAnswer()\n\n47: function decimals()\n\n55: function latestRoundData()\n\n78: function getRoundData(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L35",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L55",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L78"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n83: function latestAnswer()\n\n122: function _getLpToAssetRateWrapper(\n\n151: function latestRoundData()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L83",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L122",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L151"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n81: function latestAnswer()\n\n146: function latestRoundData()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L81",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n68: function latestAnswer()\n\n125: function latestRoundData()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L68",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n191: function _onlyIncentiveMaster()\n\n202: function _onlyWiseSecurity()\n\n213: function _onlyWiseLending()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L191",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L202",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L213"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n49: function setRepayBadDebtIncentive(\n\n66: function setAaveFlag(\n\n108: function setPoolFee(\n\n135: function setPoolFeeBulk(\n\n173: function proposeIncentiveMaster(\n\n214: function increaseIncentiveA(\n\n232: function increaseIncentiveB(\n\n315: function changeIncentiveUSDA(\n\n352: function changeIncentiveUSDB(\n\n390: function addPoolTokenAddress(\n\n412: function addPoolTokenAddressManual(\n\n438: function removePoolTokenManual(\n\n494: function increaseTotalBadDebtLiquidation(\n\n514: function setBadDebtUserLiquidation(\n\n538: function setBeneficial(\n\n571: function revokeBeneficial(\n\n628: function claimWiseFees(\n\n689: function claimFeesBeneficial(\n\n730: function paybackBadDebtForToken(\n\n816: function paybackBadDebtNoReward(\n\n872: function getPoolTokenAddressesLength()\n\n884: function getPoolTokenAdressesByIndex(\n\n898: function syncAllPools()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L66",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L135",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L173",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L214",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L232",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L315",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L352",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L390",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L412",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L438",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L494",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L538",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L571",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L628",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L689",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L730",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L816",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L872",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L884",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L898"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n15: function _prepareBorrows(\n\n47: function _prepareCollaterals(\n\n134: function _updateUserBadDebt(\n\n195: function _increaseFeeTokens(\n\n208: function _decreaseFeeTokens(\n\n230: function _setAaveFlag(\n\n244: function getReceivingToken(\n\n270: function updatePositionCurrentBadDebt(\n\n292: function _distributeIncentives(\n\n330: function _gatherIncentives(\n\n383: function _checkValue(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L15",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L134",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L195",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L208",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L230",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L244",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L270",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L292",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L330",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L383"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n15: function getApproxNetAPY(\n\n41: function getNewBorrowRate(\n\n57: function getLiveDebtRatio(\n\n93: function liquidatePartiallyFromToken(\n\n119: function _manuallyPaybackShares(\n\n157: function _manuallyWithdrawShares(\n\n185: function _openPosition(\n\n230: function _closingPosition(\n\n274: function _registrationFarm(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L15",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L41",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L57",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L93",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L119",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L157",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L185",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L230",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L274"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n266: function doApprovals()\n\n274: function _doApprovals(\n\n361: function _isActive()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L266",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L274",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L361"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n15: function _executeBalancerFlashLoan(\n\n59: function receiveFlashLoan(\n\n232: function _getEthBack(\n\n264: function _getTokensUniV3(\n\n293: function _swapStETHintoETH(\n\n310: function _withdrawPendleLPs(\n\n326: function _paybackExactShares(\n\n354: function _closingRouteToken(\n\n383: function _closingRouteETH(\n\n414: function _logicOpenPosition(\n\n531: function _borrowExactAmount(\n\n560: function _coreLiquidation(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L15",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L59",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L232",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L264",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L293",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L310",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L326",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L354",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L383",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L414",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L531",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L560"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n19: function _updatePools()\n\n35: function _checkReentrancy()\n\n57: function _getPositionBorrowShares(\n\n75: function _getPositionBorrowSharesAave(\n\n92: function _getPositionBorrowTokenAmount(\n\n111: function _getPositionBorrowTokenAmountAave(\n\n136: function _getPositionLendingShares(\n\n153: function _getPostionCollateralTokenAmount(\n\n174: function getPositionBorrowETH(\n\n229: function getTotalWeightedCollateralETH(\n\n244: function _getTokensInETH(\n\n258: function _getEthInTokens(\n\n272: function getLeverageAmount(\n\n289: function _getApproxNetAPY(\n\n344: function _getNewBorrowRate(\n\n389: function _checkDebtRatio(\n\n416: function _notBelowMinDepositAmount(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L19",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L35",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L57",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L75",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L92",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L111",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L136",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L153",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L174",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L229",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L244",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L258",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L272",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L289",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L344",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L389",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L416"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n63: function changeMinDeposit(\n\n82: function shutDownFarm(\n\n96: function enterFarm(\n\n142: function enterFarmETH(\n\n185: function _getWiseLendingNFT()\n\n210: function exitFarm(\n\n254: function manuallyPaybackShares(\n\n274: function manuallyWithdrawShares(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L82",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L96",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L142",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L185",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L210",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L254",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L274"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n32: function withdrawLp(\n\n53: function exchangeRewardsForCompoundingWithIncentive(\n\n113: function exchangeLpFeesForPendleWithIncentive(\n\n172: function skim(\n\n211: function addPendleMarket(\n\n293: function updateRewardTokens(\n\n321: function changeExchangeIncentive(\n\n334: function changeMintFee(\n\n431: function claimArb(\n\n451: function withdrawLock()\n\n497: function increaseReservedForCompound(\n\n526: function overWriteIndex(\n\n544: function overWriteIndexAll(\n\n566: function overWriteAmounts(\n\n581: function claimVoteRewards(\n\n600: function forwardETH(\n\n612: function vote(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L600",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L32",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L53",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L113",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L172",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L211",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L293",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L431",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L451",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L497",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L526",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L544",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L566",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L581",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L612"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n236: function _onlyArbitrum()\n\n245: function _onlyChildContract(\n\n256: function _syncSupply(\n\n272: function syncAllSupply()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L245",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L236",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L256",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L272"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n9: function _findIndex(\n\n32: function _calcExpiry(\n\n45: function _getExpiry()\n\n53: function _getLockAmount()\n\n61: function _getPositionData(\n\n73: function _getAmountToSend(\n\n95: function pendleChildCompoundInfoReservedForCompound(\n\n105: function pendleChildCompoundInfoLastIndex(\n\n115: function pendleChildCompoundInfoRewardTokens(\n\n125: function activePendleMarketsLength()\n\n133: function _checkFeed(\n\n144: function _getRewardTokens(\n\n156: function _getUserReward(\n\n173: function _getUserRewardIndex(\n\n189: function _getTokensInETH(\n\n203: function _getTokensFromETH(\n\n217: function _compareHashes(\n\n236: function _setRewardTokens(\n\n245: function getExpiry()\n\n253: function getLockAmount()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L53",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L61",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L73",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L95",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L105",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L115",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L125",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L133",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L156",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L173",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L189",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L203",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L217",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L236",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L253",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L245",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L32",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n72: function _onlyController()\n\n98: function _validateSharePrice(\n\n114: function _validateSharePriceGrowth(\n\n132: function _overWriteCheck()\n\n140: function _triggerIndexUpdate()\n\n149: function _wrapOverWrites(\n\n160: function _updateRewardTokens()\n\n169: function _overWriteIndexAll()\n\n177: function _overWriteIndex(\n\n188: function _overWriteAmounts()\n\n196: function _updateRewards()\n\n218: function _calculateRewardsClaimedOutside()\n\n305: function _getBalanceLpBalanceController()\n\n315: function _getActiveBalance()\n\n325: function _getSharePrice()\n\n334: function _syncSupply()\n\n347: function _increaseCardinalityNext()\n\n359: function _withdrawLp(\n\n372: function _getUserReward(\n\n386: function previewDistribution()\n\n416: function _setLastInteraction()\n\n422: function _applyMintFee(\n\n434: function totalLpAssets()\n\n443: function previewUnderlyingLpAssets()\n\n452: function previewMintShares(\n\n465: function previewAmountWithdrawShares(\n\n478: function previewBurnShares(\n\n494: function manualSync()\n\n502: function addCompoundRewards(\n\n592: function changeMintFee(\n\n647: function withdrawExactAmount(\n\n682: function initialize(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L434",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L72",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L98",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L114",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L132",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L140",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L149",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L160",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L169",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L177",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L188",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L196",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L218",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L305",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L315",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L325",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L334",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L347",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L359",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L372",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L386",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L416",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L422",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L443",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L452",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L465",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L478",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L494",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L502",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L647",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L682"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n35: function deploy(\n\n56: function _clone(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L35",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L56"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n41: function _onlyKeyOwner(\n\n63: function _incrementReserved()\n\n70: function _getNextReserveKey()\n\n77: function _reserveKey(\n\n96: function isOwner(\n\n115: function _mintKeyForUser(\n\n141: function mintReserved()\n\n160: function onERC721Received(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L141",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L41",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L63",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L70",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L77",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L96",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L115",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L160"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n16: function reservedKeys(\n\n51: function setFarmContract(\n\n66: function mintKey(\n\n93: function checkOwner(\n\n170: function setBaseExtension(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L93",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L16",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L66",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n13: function _safeApprove(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n12: function _sendValue(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n13: function _safeTransfer(\n\n34: function _safeTransferFrom(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n24: function _wrapETH(\n\n38: function _unwrapETH(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L24",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L38"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n32: function _addAggregator(\n\n60: function _checkFunctionExistence(\n\n87: function _compareMinMax(\n\n106: function latestResolverTwap(\n\n131: function _validateAnswer(\n\n216: function _getRelativeDifference(\n\n235: function _compareDifference(\n\n246: function _getChainlinkAnswer(\n\n265: function getETHPriceInUSD()\n\n283: function _getPool(\n\n303: function _validateTokenAddress(\n\n324: function _validatePoolAddress(\n\n344: function _validatePriceFeed(\n\n359: function _validateTwapOracle(\n\n374: function _getTwapPrice(\n\n394: function _getOneUnit(\n\n406: function _getAverageTick(\n\n450: function decimals(\n\n460: function _getTwapDerivatePrice(\n\n507: function _recalibrate(\n\n521: function sequencerIsDead()\n\n556: function _chainLinkIsDead(\n\n592: function _recalibratePreview(\n\n658: function _getIterationCount(\n\n674: function _getRoundTimestamp(\n\n699: function getLatestRoundId(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L450",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L32",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L60",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L87",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L106",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L131",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L216",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L235",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L246",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L265",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L283",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L303",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L324",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L344",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L359",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L374",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L394",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L406",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L460",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L507",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L521",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L556",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L592",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L658",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L674",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L699"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n24: * mandatory to wrap its answer into a function mimicking {latestRoundData}\n\n69: function latestResolver(\n\n85: function getTokenDecimals(\n\n96: function getTokensInUSD(\n\n123: function getTokensPriceInUSD(\n\n143: function getTokensInETH(\n\n171: function getTokensFromUSD(\n\n198: function getTokensPriceFromUSD(\n\n218: function addTwapOracle(\n\n266: function addTwapOracleDerivative(\n\n327: function getTokensFromETH(\n\n359: function addOracle(\n\n379: function addOracleBulk(\n\n403: function addAggregator(\n\n419: function recalibratePreview(\n\n439: function chainLinkIsDead(\n\n487: function recalibrate(\n\n501: function recalibrateBulk(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L24",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L69",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L85",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L96",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L123",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L143",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L171",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L198",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L218",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L266",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L327",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L359",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L379",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L403",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L419",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L439",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L487",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L501"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n31: function _onlyWiseLending()\n\n59: function getLiveDebtRatio(\n\n85: function setLiquidationSettings(\n\n193: function curveSecurityCheck(\n\n388: function checkHealthState(\n\n405: function checkBadDebtLiquidation(\n\n442: function overallLendingAPY(\n\n499: function overallBorrowAPY(\n\n556: function overallNetAPY(\n\n641: function safeLimitPosition(\n\n695: function positionBlackListToken(\n\n764: function maximumWithdrawToken(\n\n826: function maximumWithdrawTokenSolely(\n\n868: function maximumBorrowToken(\n\n906: function getExpectedPaybackAmount(\n\n943: function getExpectedLendingAmount(\n\n980: function setBlacklistToken(\n\n995: function setSecurityWorker(\n\n1006: * Safety function to perform a security\n\n1011: function securityShutdown()\n\n1032: function revokeShutdown()\n\n1045: function checkPoolCondition(\n\n1060: function checkPoolWithMinDeposit(\n\n1078: function checkMinDepositValue(\n\n1092: function _checkMinDepositValue(\n\n1111: function changeMinDepositValue(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L31",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L59",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L85",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L193",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L388",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L405",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L442",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L499",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L556",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L641",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L695",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L764",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L826",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L868",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L906",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L943",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L995",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1006",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1011",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1032",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1045",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1060",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1078",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1092",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n118: function _setLiquidationSettings(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L118"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n15: function overallETHCollateralsBoth(\n\n65: function overallETHCollateralsWeighted(\n\n107: function overallETHCollateralsBare(\n\n145: function _overallETHCollateralsWeighted(\n\n190: function getFullCollateralETH(\n\n224: function _isUncollateralized(\n\n246: function _getCollateralOfTokenETHUpdated(\n\n281: function getETHCollateralUpdated(\n\n323: function getETHCollateral(\n\n340: function _getTokensInEth(\n\n360: function overallETHBorrowBare(\n\n394: function overallETHBorrowHeartbeat(\n\n430: function overallETHBorrow(\n\n470: function _checkBlacklisted(\n\n486: function _overallETHBorrow(\n\n530: function _getUpdatedPseudoBorrow(\n\n554: function _getUpdatedPseudoPool(\n\n578: function _getInterest(\n\n610: function _getETHBorrowUpdated(\n\n651: function getETHBorrow(\n\n672: function checkTokenAllowed(\n\n687: function checkHeartbeat(\n\n701: function _checkPositionLocked(\n\n716: function checkMaxFee(\n\n736: function _checkMaxFee(\n\n760: function calculateWishPercentage(\n\n794: function _checkHealthState(\n\n806: function _getState(\n\n837: function checksRegister(\n\n859: function canLiquidate(\n\n876: function checkMaxShares(\n\n906: function checkBadDebtThreshold(\n\n922: function getPositionLendingAmount(\n\n945: function getPositionBorrowAmount(\n\n966: function checkOwnerPosition(\n\n985: function getBorrowRate(\n\n999: function getLendingRate(\n\n1029: function _getPossibleWithdrawAmount(\n\n1057: function _setPoolState(\n\n1096: function _checkSuccess(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L15",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L65",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L107",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L145",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L190",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L224",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L246",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L281",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L323",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L340",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L360",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L394",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L430",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L470",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L486",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L530",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L554",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L578",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L610",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L651",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L672",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L687",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L701",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L716",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L736",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L760",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L794",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L806",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L837",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L859",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L876",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L906",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L922",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L945",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L966",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L985",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L999",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1029",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1057",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1096"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n23: function _validToken(\n\n34: function _nonReentrantCheck()\n\n47: function _reservePosition()\n\n56: function _wrapDepositExactAmount(\n\n83: function _wrapWithdrawExactAmount(\n\n113: function _wrapWithdrawExactShares(\n\n141: function _wrapBorrowExactAmount(\n\n165: function _wrapAaveReturnValueDeposit(\n\n196: function _sendValue(\n\n219: function _getInfoPayback(\n\n243: function _prepareCollaterals(\n\n279: function _prepareBorrows(\n\n315: function getAavePoolAPY(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L279",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L23",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L34",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L56",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L83",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L113",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L141",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L165",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L196",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L219",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L243",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L315"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n44: function setAaveTokenAddress(\n\n64: function setAaveTokenAddressBulk(\n\n103: function depositExactAmountMint(\n\n122: function depositExactAmount(\n\n158: function depositExactAmountETHMint()\n\n172: function depositExactAmountETH(\n\n202: function withdrawExactAmount(\n\n238: function withdrawExactAmountETH(\n\n281: function withdrawExactShares(\n\n314: function withdrawExactSharesETH(\n\n357: function borrowExactAmount(\n\n393: function borrowExactAmountETH(\n\n433: function paybackExactAmount(\n\n482: function paybackExactAmountETH(\n\n556: function paybackExactShares(\n\n611: function skimAave(\n\n635: function getLendingRate(\n\n664: function _setAaveTokenAddress(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L44",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L64",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L103",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L122",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L158",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L172",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L202",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L238",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L281",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L314",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L357",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L393",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L433",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L482",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L556",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L611",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L635",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L664"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n81: function _checkOwner(\n\n93: function _checkPositionLocked(\n\n105: function setWiseSecurity(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L81",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L93",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Missing NatSpec `@dev` from modifier declaration",
      "description": "Some modifiers have an incomplete NatSpec: add a `@dev` notation to describe the modifier to improve the code documentation.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n16: modifier onlyProposed() {\n\n32: modifier onlyMaster() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L16",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n45: modifier onlyReserveRole() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n67: modifier healthStateCheck(\n\n97: modifier syncPool(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L67",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L97"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n252: modifier onlyAaveHub() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L252"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n9: modifier onlyFeeManager() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n14: modifier onlyOwner() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n176: modifier onlyWiseSecurity() {\n\n181: modifier onlyWiseLending() {\n\n186: modifier onlyIncentiveMaster() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L176",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L181",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L186"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n356: modifier isActive() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L356"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n9: modifier updatePools() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n210: modifier syncSupply(\n\n220: modifier onlyChildContract(\n\n230: modifier onlyArbitrum()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L210",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L220",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L230"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n67: modifier onlyController() {\n\n81: modifier syncSupply()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L67",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L81"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n32: modifier onlyKeyOwner(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n30: modifier onlyFarmContract() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n26: modifier onlyWiseLending() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n9: modifier nonReentrant() {\n\n14: modifier validToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L14"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Missing NatSpec `@notice` from event declaration",
      "description": "Some events have an incomplete NatSpec: add a `@dev` notation to describe the event to improve the code documentation.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n48: event MasterProposed(\n\n53: event RenouncedOwnership(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L48",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n104: * logic, security checks and event emit.\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L104"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n35: event FundsDeposited(\n\n44: event FundsSolelyDeposited(\n\n52: event FundsWithdrawn(\n\n61: event FundsWithdrawnOnBehalf(\n\n70: event FundsSolelyWithdrawn(\n\n78: event FundsBorrowed(\n\n87: event FundsBorrowedOnBehalf(\n\n96: event FundsReturned(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L35",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L44",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L52",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L61",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L70",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L78",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L87",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L96"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n7: event ClaimedFeesWiseBulk(\n\n11: event PoolTokenRemoved(\n\n16: event PoolTokenAdded(\n\n21: event IncentiveOwnerBChanged(\n\n26: event IncentiveOwnerAChanged(\n\n31: event ClaimedOwnershipIncentiveMaster(\n\n36: event IncentiveMasterProposed(\n\n41: event PoolFeeChanged(\n\n47: event ClaimedIncentives(\n\n54: event ClaimedIncentivesBulk(\n\n58: event IncentiveIncreasedB(\n\n63: event IncentiveIncreasedA(\n\n68: event BadDebtIncreasedLiquidation(\n\n73: event TotalBadDebtIncreased(\n\n78: event TotalBadDebtDecreased(\n\n83: event SetBadDebtPosition(\n\n89: event UpdateBadDebtPosition(\n\n95: event SetBeneficial(\n\n101: event RevokeBeneficial(\n\n107: event ClaimedFeesWise(\n\n113: event ClaimedFeesBeneficial(\n\n120: event PayedBackBadDebt(\n\n129: event PayedBackBadDebtFree(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L16",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L21",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L26",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L31",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L36",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L41",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L54",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L58",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L63",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L68",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L73",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L78",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L83",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L89",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L95",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L101",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L107",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L113",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L120",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L129"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n110: event FarmEntry(\n\n118: event FarmExit(\n\n125: event FarmStatus(\n\n130: event ManualPaybackShares(\n\n137: event ManualWithdrawShares(\n\n144: event MinDepositChange(\n\n149: event ETHReceived(\n\n154: event RegistrationFarm(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L110",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L118",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L125",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L130",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L137",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L149",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n135: event ETHReceived(\n\n140: event ChangeExchangeIncentive(\n\n144: event WithdrawLp(\n\n150: event ExchangeRewardsForCompounding(\n\n157: event ExchangeLpFeesForPendle(\n\n164: event AddPendleMarket(\n\n169: event UpdateRewardTokens(\n\n174: event ChangeMintFee(\n\n179: event LockPendle(\n\n188: event ClaimArb(\n\n194: event IncreaseReservedForCompound(\n\n199: event ClaimVoteRewards(\n\n205: event WithdrawLock(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L135",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L140",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L144",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L150",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L157",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L164",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L169",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L174",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L179",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L188",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L194",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L199",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L205"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n153: event ERC721Received(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L153"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n47: event SecurityShutdown(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L47"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n7: event SetAaveTokenAddress(\n\n13: event IsDepositAave(\n\n18: event IsWithdrawAave(\n\n23: event IsBorrowAave(\n\n28: event IsPaybackAave(\n\n33: event IsSolelyDepositAave(\n\n38: event IsSolelyWithdrawAave(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L18",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L23",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L28",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Missing NatSpec `@notice` from modifier declaration",
      "description": "Some modifiers have an incomplete NatSpec: add a `@notice` notation to describe the modifier to improve the code documentation.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n16: modifier onlyProposed() {\n\n32: modifier onlyMaster() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L16",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n45: modifier onlyReserveRole() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n67: modifier healthStateCheck(\n\n97: modifier syncPool(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L67",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L97"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n252: modifier onlyAaveHub() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L252"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n9: modifier onlyFeeManager() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n14: modifier onlyOwner() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n176: modifier onlyWiseSecurity() {\n\n181: modifier onlyWiseLending() {\n\n186: modifier onlyIncentiveMaster() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L176",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L181",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L186"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n356: modifier isActive() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L356"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n9: modifier updatePools() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n210: modifier syncSupply(\n\n220: modifier onlyChildContract(\n\n230: modifier onlyArbitrum()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L210",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L220",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L230"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n67: modifier onlyController() {\n\n81: modifier syncSupply()\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L67",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L81"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n32: modifier onlyKeyOwner(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L32"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n30: modifier onlyFarmContract() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n26: modifier onlyWiseLending() {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n9: modifier nonReentrant() {\n\n14: modifier validToken(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L14"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Consider using modifiers for address control",
      "description": "Modifiers in Solidity can improve code readability and modularity by encapsulating repetitive checks, such as address validity checks, into a reusable construct. For example, an `onlyOwner` modifier can be used to replace repetitive `require(msg.sender == owner)` checks across several functions, reducing code redundancy and enhancing maintainability. To implement, define a modifier with the check, then apply the modifier to relevant functions.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n25: if (msg.sender == master) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n41: if (msg.sender == proposedMaster) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L41"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n18: if (msg.sender == address(FEE_MANAGER)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n195: if (msg.sender == incentiveMaster) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L195"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n206: if (msg.sender == address(WISE_SECURITY)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L206"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n217: if (msg.sender == address(WISE_LENDING)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L217"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n514: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L514"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n635: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L635"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n35: if (msg.sender == address(WISE_LENDING)) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n87: if (msg.sender == WETH_ADDRESS) {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L87"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability",
      "description": "Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n20: mapping(address => uint256) public reserved;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L20"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n21: mapping(address => bool) public reserveRole;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n267: mapping(address => uint256) internal bufferIncrease;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L267"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n268: mapping(address => uint256) public maxDepositValueToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L268"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n273: mapping(uint256 => mapping(address => uint256)) public userBorrowShares;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L273"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n274: mapping(uint256 => mapping(address => uint256)) public pureCollateralAmount;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L274"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n275: mapping(uint256 => mapping(address => LendingEntry)) public userLendingData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L275"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n278: mapping(address => BorrowRatesEntry) public borrowRatesData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L278"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n279: mapping(address => AlgorithmEntry) public algorithmData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L279"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n280: mapping(address => GlobalPoolEntry) public globalPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L280"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n281: mapping(address => LendingPoolEntry) public lendingPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L281"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n282: mapping(address => BorrowPoolEntry) public borrowPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L282"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n283: mapping(address => TimestampsPoolEntry) public timestampsPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L283"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n287: mapping(address => bool) internal parametersLocked;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n288: mapping(address => bool) public verifiedIsolationPool;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n372: mapping(uint256 => mapping(address => uint256)) storage userMapping,\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L372"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n383: mapping(uint256 => mapping(address => uint256)) storage userMapping,\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L383"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n143: mapping(address => uint256) public feeTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L143"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n146: mapping(address => uint256) public incentiveUSD;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n149: mapping(address => bool) public poolTokenAdded;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n152: mapping(address => bool) public isAaveToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n155: mapping(address => address) public underlyingToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L155"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n158: mapping(address => mapping(address => bool)) public allowedTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n161: mapping(address => mapping(address => uint256)) public gatheredIncentiveToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n58: mapping(address => address) public pendleChildAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n59: mapping(address => CompoundStruct) pendleChildCompoundInfo;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L59"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n139: mapping(address => uint8) _tokenDecimals;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L139"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n142: mapping(address => IPriceFeed) public priceFeed;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L142"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n145: mapping(address => uint256) public heartBeat;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L145"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n148: mapping(address => IAggregator) public tokenAggregatorFromTokenAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L148"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n151: mapping(address => address[]) public underlyingFeedTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L151"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n154: mapping(address => UniTwapPoolInfo) public uniTwapPoolInfo;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n157: mapping(address => DerivativePartnerInfo) public derivativePartnerTwap;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L157"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n238: mapping(address => bool) public wasBlacklisted;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n241: mapping(address => CurveSwapStructData) public curveSwapInfoData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L241"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n244: mapping(address => CurveSwapStructToken) public curveSwapInfoToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L244"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n247: mapping(address => bool) public securityWorker;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Multiple mappings can be replaced with a single struct mapping",
      "description": "Using a single struct mapping in place of multiple defined mappings in a Solidity contract can lead to improved code organization, better readability, and easier maintainability. By consolidating related data into a single struct, developers can create a more cohesive data structure that logically groups together relevant pieces of information, thus reducing redundancy and clutter. This approach simplifies the codebase, making it easier to understand, navigate, and modify. Additionally, it can result in more efficient gas usage when accessing or updating multiple related data points simultaneously.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n20: mapping(address => uint256) public reserved;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L20"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n21: mapping(address => bool) public reserveRole;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n267: mapping(address => uint256) internal bufferIncrease;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L267"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n268: mapping(address => uint256) public maxDepositValueToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L268"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n273: mapping(uint256 => mapping(address => uint256)) public userBorrowShares;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L273"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n274: mapping(uint256 => mapping(address => uint256)) public pureCollateralAmount;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L274"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n275: mapping(uint256 => mapping(address => LendingEntry)) public userLendingData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L275"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n278: mapping(address => BorrowRatesEntry) public borrowRatesData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L278"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n279: mapping(address => AlgorithmEntry) public algorithmData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L279"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n280: mapping(address => GlobalPoolEntry) public globalPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L280"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n281: mapping(address => LendingPoolEntry) public lendingPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L281"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n282: mapping(address => BorrowPoolEntry) public borrowPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L282"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n283: mapping(address => TimestampsPoolEntry) public timestampsPoolData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L283"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n287: mapping(address => bool) internal parametersLocked;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n288: mapping(address => bool) public verifiedIsolationPool;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n372: mapping(uint256 => mapping(address => uint256)) storage userMapping,\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L372"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n383: mapping(uint256 => mapping(address => uint256)) storage userMapping,\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L383"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n143: mapping(address => uint256) public feeTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L143"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n146: mapping(address => uint256) public incentiveUSD;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n149: mapping(address => bool) public poolTokenAdded;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n152: mapping(address => bool) public isAaveToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n155: mapping(address => address) public underlyingToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L155"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n158: mapping(address => mapping(address => bool)) public allowedTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n161: mapping(address => mapping(address => uint256)) public gatheredIncentiveToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L161"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n58: mapping(address => address) public pendleChildAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n59: mapping(address => CompoundStruct) pendleChildCompoundInfo;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L59"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n139: mapping(address => uint8) _tokenDecimals;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L139"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n142: mapping(address => IPriceFeed) public priceFeed;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L142"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n145: mapping(address => uint256) public heartBeat;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L145"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n148: mapping(address => IAggregator) public tokenAggregatorFromTokenAddress;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L148"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n151: mapping(address => address[]) public underlyingFeedTokens;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L151"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n154: mapping(address => UniTwapPoolInfo) public uniTwapPoolInfo;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L154"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n157: mapping(address => DerivativePartnerInfo) public derivativePartnerTwap;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L157"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n238: mapping(address => bool) public wasBlacklisted;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n241: mapping(address => CurveSwapStructData) public curveSwapInfoData;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L241"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n244: mapping(address => CurveSwapStructToken) public curveSwapInfoToken;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L244"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n247: mapping(address => bool) public securityWorker;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "NatSpec comments should be increased in contracts",
      "description": "It is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as Defi, the interpretation of all functions and their arguments and returns is important for code readability and auditability. https://docs.soliditylang.org/en/v0.8.23/natspec-format.html",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "All in-scope contracts",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "NatSpec `@param` is missing",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n130: /**\n     * @dev Internal helper combining one\n     * security check with lending share\n     * calculation for withdraw.\n     */\n    function _preparationsWithdraw(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken,\n        uint256 _amount\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L130"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n159: /**\n     * @dev Internal helper calculating {_poolToken}\n     * utilization. Includes math underflow check.\n     */\n    function _getValueUtilization(\n        address _poolToken\n    )\n        private\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L159"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n214: /**\n     * @dev Wrapper for isolation pool check.\n     */\n    function _onlyIsolationPool(\n        address _poolAddress\n    )\n        internal\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L214"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n493: /**\n     * @dev Internal helper function\n     * updating pseudo amounts and\n     * printing fee shares for the\n     * feeManager proportional to the\n     * fee percentage of the pool.\n     */\n    function _updatePseudoTotalAmounts(\n        address _poolToken\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L493"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n642: /**\n     * @dev Internal helper calculating\n     * a hash out of {_nftId} and {_poolToken}\n     * using keccak256.\n     */\n    function _getHash(\n        uint256 _nftId,\n        address _poolToken\n    )\n        private\n        pure\n        returns (bytes32)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L642"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n729: /**\n     * @dev Internal helper deleting last entry\n     * of postion lending data.\n     */\n    function _deleteLastPositionLendingData(\n        uint256 _nftId,\n        address _poolToken\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L729"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n790: /**\n     * @dev Internal helper deleting last entry\n     * of postion borrow data.\n     */\n    function _deleteLastPositionBorrowData(\n        uint256 _nftId,\n        address _poolToken\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L790"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n891: /**\n     * @dev Internal helper function\n     * checking if time interval for\n     * next LASA call has passed.\n     */\n    function _aboveThreshold(\n        address _poolToken\n    )\n        internal\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L891"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n943: /**\n     * @dev Sets the new max value in shares\n     * and saves the corresponding resonance factor.\n     */\n    function _newMaxPoolShares(\n        address _poolToken,\n        uint256 _shareValue\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L943"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n983: /**\n     * @dev Returns bool to determine if resonance\n     * factor needs to be reset to last best value.\n     */\n    function _resonanceOutcome(\n        address _poolToken,\n        uint256 _shareValue\n    )\n        private\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L983"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1000: /**\n     * @dev Resets resonance factor to old best value when system\n     * evolves into too bad state and sets current totalDepositShares\n     * amount to new maxPoolShares to exclude eternal loops and that\n     * unorganic peaks do not set maxPoolShares forever.\n     */\n    function _resetResonanceFactor(\n        address _poolToken,\n        uint256 _shareValue\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1000"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1027: /**\n     * @dev Reverts the flag for stepping direction from LASA.\n     */\n    function _revertDirectionState(\n        address _poolToken\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1027"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1058: /**\n     * @dev Does a revert stepping and swaps stepping state in opposite flag.\n     */\n    function _reversedResonanceFactor(\n        address _poolToken\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1058"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n1075: /**\n     * @dev Increasing or decresing resonance factor depending on flag value.\n     */\n    function _changingResonanceFactor(\n        address _poolToken\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1075"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n66: /**\n     * @dev Allows to propose next master.\n     * Must be claimed by proposer.\n     */\n    function proposeOwner(\n        address _proposedOwner\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L66"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n122: /**\n     * @dev Allow to verify isolation pool.\n     */\n    function setVerifiedIsolationPool(\n        address _isolationPool,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n151: /**\n     * @dev See {IERC721-getApproved}.\n     */\n    function getApprovedSoft(\n        uint256 tokenId\n    )\n        external\n        view\n        returns (address)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L151"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n170: /**\n     * @dev Mints NFT for _user, without it\n     * user can not use WiseLending protocol\n     */\n    function mintPositionForUser(\n        address _user\n    )\n        external\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n268: /**\n     * @dev Returns positions of owner\n     */\n    function walletOfOwner(\n        address _owner\n    )\n        external\n        view\n        returns (uint256[] memory)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L268"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n316: /**\n     * @dev Allows to update base target for MetaData.\n     */\n    function setBaseURI(\n        string memory _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L316"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n337: /**\n     * @dev Returns path to MetaData URI\n     */\n    function tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L337"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n368: /**\n     * @dev Converts tokenId uint to string.\n     */\n    function _toString(\n        uint256 _tokenId\n    )\n        internal\n        pure\n        returns (string memory str)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L368"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n168: /**\n     * @dev External wrapper for\n     * {_checkPositionLocked}.\n     */\n\n    function checkPositionLocked(\n        uint256 _nftId,\n        address _caller\n    )\n        external\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L168"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n186: /**\n     * @dev Checks if a postion is locked\n     * for powerFarms. Get skipped when\n     * aaveHub or a powerFarm itself is\n     * the {msg.sender}.\n     */\n\n    function _checkPositionLocked(\n        uint256 _nftId,\n        address _caller\n    )\n        internal\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L186"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n211: /**\n     * @dev External wrapper for\n     * {_checkDeposit}.\n     */\n    function checkDeposit(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L211"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n63: /**\n     * @dev Checks if position is healthy\n     * after all state changes are done.\n     */\n    modifier healthStateCheck(\n        uint256 _nftId\n    ) {\n        _;\n\n        _healthStateCheck(\n            _nftId\n        );\n    }\n\n    function _healthStateCheck(\n        uint256 _nftId\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L63"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n162: /**\n     * @dev Fetches share price of lending shares.\n     */\n    function _getSharePrice(\n        address _poolToken\n    )\n        private\n        view\n        returns (\n            uint256,\n            uint256\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n205: /**\n     * @dev Compares share prices before and after\n     * execution. If borrow share price increased\n     * or lending share price decreased, revert.\n     */\n    function _compareSharePrices(\n        address _poolToken,\n        uint256 _lendSharePriceBefore,\n        uint256 _borrowSharePriceBefore\n    )\n        private\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L205"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n250: /**\n    * @dev Since pool inception share price\n    * increase for both lending and borrow shares\n    * is capped at 500% apr max in between a transaction.\n    */\n    function _getCurrentSharePriceMax(\n        address _poolToken\n    )\n        private\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L250"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n270: /**\n     * @dev First part of pool sync updating pseudo\n     * amounts. Is skipped when powerFarms or aaveHub\n     * is calling the function.\n     */\n    function _syncPoolBeforeCodeExecution(\n        address _poolToken\n    )\n        private\n        returns (\n            uint256 lendSharePrice,\n            uint256 borrowSharePrice\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L270"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n304: /**\n     * @dev Second part of pool sync updating\n     * the borrow pool rate and share price.\n     */\n    function _syncPoolAfterCodeExecution(\n        address _poolToken,\n        uint256 _lendSharePriceBefore,\n        uint256 _borrowSharePriceBefore\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L304"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n326: /**\n     * @dev Enables _poolToken to be used as a collateral.\n     */\n    function collateralizeDeposit(\n        uint256 _nftId,\n        address _poolToken\n    )\n        external\n        syncPool(_poolToken)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L326"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n345: /**\n     * @dev Disables _poolToken to be used as a collateral.\n     */\n    function unCollateralizeDeposit(\n        uint256 _nftId,\n        address _poolToken\n    )\n        external\n        syncPool(_poolToken)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L345"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n384: /**\n     * @dev Allows to supply funds using ETH.\n     * Without converting to WETH, use ETH directly.\n     */\n    function depositExactAmountETH(\n        uint256 _nftId\n    )\n        external\n        payable\n        syncPool(WETH_ADDRESS)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L384"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n437: /**\n     * @dev Allows to supply _poolToken and user\n     * can decide if _poolToken should be collateralized,\n     * also mints position to avoid extra transaction.\n     */\n    function depositExactAmountMint(\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L437"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n456: /**\n     * @dev Allows to supply _poolToken and user\n     * can decide if _poolToken should be collateralized.\n     */\n    function depositExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        public\n        syncPool(_poolToken)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L456"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n502: /**\n     * @dev Allows to supply funds using ETH in solely mode,\n     * which does not earn APY, but keeps the funds private.\n     * Other users are restricted from borrowing these funds,\n     * owner can always withdraw even if all funds are borrowed.\n     */\n    function solelyDepositETH(\n        uint256 _nftId\n    )\n        public\n        payable\n        syncPool(WETH_ADDRESS)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L502"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n574: /**\n     * @dev Allows to supply funds using ERC20 in solely mode,\n     * which does not earn APY, but keeps the funds private.\n     * Other users are restricted from borrowing these funds,\n     * owner can always withdraw even if all funds are borrowed.\n     * Also mints position to avoid extra transaction.\n     */\n    function solelyDepositMint(\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L574"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n594: /**\n     * @dev Allows to supply funds using ERC20 in solely mode,\n     * which does not earn APY, but keeps the funds private.\n     * Other users are restricted from borrowing these funds,\n     * owner can always withdraw even if all funds are borrowed.\n     */\n    function solelyDeposit(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        public\n        syncPool(_poolToken)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L594"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n632: /**\n     * @dev Allows to withdraw publicly\n     * deposited ETH funds using exact amount.\n     */\n    function withdrawExactAmountETH(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L632"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n671: /**\n     * @dev Allows to withdraw publicly\n     * deposited ETH funds using exact shares.\n     */\n    function withdrawExactSharesETH(\n        uint256 _nftId,\n        uint256 _shares\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L671"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n710: /**\n     * @dev Allows to withdraw publicly\n     * deposited ERC20 funds using exact amount.\n     */\n    function withdrawExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _withdrawAmount\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L710"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n747: /**\n     * @dev Allows to withdraw privately\n     * deposited ETH funds using input amount.\n     */\n    function solelyWithdrawETH(\n        uint256 _nftId,\n        uint256 _withdrawAmount\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L747"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n776: /**\n     * @dev Allows to withdraw privately\n     * deposited ERC20 funds using input amount.\n     */\n    function solelyWithdraw(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _withdrawAmount\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L776"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n854: /**\n     * @dev Allows to withdraw privately\n     * deposited ERC20 on behalf of owner.\n     * Requires approval by _nftId owner.\n     */\n    function withdrawOnBehalfExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _withdrawAmount\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L854"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n898: /**\n     * @dev Allows to withdraw ERC20\n     * funds using shares as input value\n     */\n    function withdrawExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L898"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n935: /**\n     * @dev Withdraws ERC20 funds on behalf\n     * of _nftId owner, requires approval.\n     */\n    function withdrawOnBehalfExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L935"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n971: /**\n     * @dev Allows to borrow ETH funds\n     * Requires user to have collateral.\n     */\n    function borrowExactAmountETH(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L971"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1012: /**\n     * @dev Allows to borrow ERC20 funds\n     * Requires user to have collateral.\n     */\n    function borrowExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1012"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1051: /**\n     * @dev Allows to borrow ERC20 funds\n     * on behalf of _nftId owner, if approved.\n     */\n    function borrowOnBehalfExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1051"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1084: /**\n     * @dev Ability to payback ETH loans\n     * by providing exact payback amount.\n     */\n    function paybackExactAmountETH(\n        uint256 _nftId\n    )\n        external\n        payable\n        syncPool(WETH_ADDRESS)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1084"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1157: /**\n     * @dev Ability to payback ERC20 loans\n     * by providing exact payback amount.\n     */\n    function paybackExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        syncPool(_poolToken)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1157"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1200: /**\n     * @dev Ability to payback ERC20 loans\n     * by providing exact payback shares.\n     */\n    function paybackExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        syncPool(_poolToken)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1200"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1363: /**\n     * @dev Allows to sync pool manually\n     * so that the pool is up to date.\n     */\n    function syncManually(\n        address _poolToken\n    )\n        external\n        syncPool(_poolToken)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1363"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1382: /**\n     * @dev Registers position _nftId\n     * for isolation pool functionality\n     */\n    function setRegistrationIsolationPool(\n        uint256 _nftId,\n        bool _registerState\n    )\n        external\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1382"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1407: /**\n    * @dev External wrapper for\n    * {_corePayback} logic callable\n    * by feeMananger.\n    */\n    function corePaybackFeeManager(\n        address _poolToken,\n        uint256 _nftId,\n        uint256 _amount,\n        uint256 _shares\n    )\n        external\n        onlyFeeManager\n        syncPool(_poolToken)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1407"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n62: /**\n     * @dev Maps underlying token with corresponding aToken.\n     * Sets bool to identify pool token as aToken.\n     */\n    function setAaveFlag(\n        address _poolToken,\n        address _underlyingToken\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L62"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n281: /**\n     * @dev Claims gathered incentives for a specific token.\n     */\n    function claimIncentives(\n        address _feeToken\n    )\n        public\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L281"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n624: /**\n     * @dev Claim fees from wiseLending and send them to feeManager for\n     * a specific pool.\n     */\n    function claimWiseFees(\n        address _poolToken\n    )\n        public\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L624"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n880: /**\n     * @dev Returns the pool token address\n     * at the _index postion of the array.\n     */\n    function getPoolTokenAdressesByIndex(\n        uint256 _index\n    )\n        external\n        view\n        returns (address)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L880"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n266: /**\n     * @dev Updates bad debt of a postion. Combines preparation of all\n     * collaterals and borrows for passed _nftId with _updateUserBadDebt().\n     */\n    function updatePositionCurrentBadDebt(\n        uint256 _nftId\n    )\n        public\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L266"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n270: /**\n     * @dev Makes a call to WISE_LENDING to\n     * register {_nftId} for specific farm use.\n     */\n    function _registrationFarm(\n        uint256 _nftId\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L270"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n131: /**\n     * @dev Closes position using balancer flashloans.\n     */\n    function _logicClosePosition(\n        uint256 _nftId,\n        uint256 _borrowShares,\n        uint256 _lendingShares,\n        uint256 _totalDebtBalancer,\n        uint256 _allowedSpread,\n        address _caller,\n        bool _ethBack,\n        bool _isAave\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L131"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n361: /**\n     * @dev Can also be used to extend existing lock.\n     */\n    function lockPendle(\n        uint256 _amount,\n        uint128 _weeks,\n        bool _fromInside,\n        bool _sameExpiry\n    )\n        external\n        onlyMaster\n        returns (uint256 newVeBalance)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L361"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n526: /**\n     * @dev External wrapper for mint function.\n     */\n    function depositExactAmount(\n        uint256 _underlyingLpAssetAmount\n    )\n        external\n        syncSupply\n        returns (\n            uint256,\n            uint256\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L526"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n605: /**\n     * @dev External wrapper for burn function.\n     */\n    function withdrawExactShares(\n        uint256 _shares\n    )\n        external\n        syncSupply\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L605"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n62: /**\n     * @dev Mints farming NFT, later to be sent\n     * to the user representing his farming position\n     */\n    function mintKey(\n        address _keyOwner,\n        uint256 _keyId\n    )\n        external\n        onlyFarmContract\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L62"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n79: /**\n     * @dev Burns farming NFT\n     */\n    function burnKey(\n        uint256 _keyId\n    )\n        external\n        onlyFarmContract\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L79"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n106: /**\n     * @dev Returns positions of owner\n     */\n    function walletOfOwner(\n        address _owner\n    )\n        external\n        view\n        returns (uint256[] memory)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L106"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n158: /**\n     * @dev Allows to update base target for MetaData.\n     */\n    function setBaseURI(\n        string calldata _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L158"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n179: /**\n     * @dev Returns path to MetaData URI\n     */\n    function tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L179"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n210: /**\n     * @dev Converts tokenId uint to string.\n     */\n    function _toString(\n        uint256 _tokenId\n    )\n        internal\n        pure\n        returns (string memory str)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L210"
          ]
        },
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n9: /**\n     * @dev\n     * Allows to execute safe approve for a token\n     */\n    function _safeApprove(\n        address _token,\n        address _spender,\n        uint256 _value\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n9: /**\n     * @dev\n     * Allows to execute safe transfer for a token\n     */\n    function _safeTransfer(\n        address _token,\n        address _to,\n        uint256 _value\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n30: /**\n     * @dev\n     * Allows to execute safe transferFrom for a token\n     */\n    function _safeTransferFrom(\n        address _token,\n        address _from,\n        address _to,\n        uint256 _value\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n20: /**\n     * @dev Wrapper for wrapping\n     * ETH call.\n     */\n    function _wrapETH(\n        uint256 _value\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L20"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n34: /**\n     * @dev Wrapper for unwrapping\n     * ETH call.\n     */\n    function _unwrapETH(\n        uint256 _value\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n9: /**\n     * @dev Adds priceFeed for a given token.\n     */\n    function _addOracle(\n        address _tokenAddress,\n        IPriceFeed _priceFeedAddress,\n        address[] calldata _underlyingFeedTokens\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n102: /**\n     * @dev Returns Twaps latest USD value\n     * by passing the underlying token address.\n     */\n    function latestResolverTwap(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L102"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n176: /**\n     * @dev Adds uniTwapPoolInfo for a given token.\n     */\n    function _writeUniTwapPoolInfoStruct(\n        address _tokenAddress,\n        address _oracle,\n        bool _isUniPool\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L176"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n192: /**\n     * @dev Adds uniTwapPoolInfo for a given token and its derivative.\n     */\n    function _writeUniTwapPoolInfoStructDerivative(\n        address _tokenAddress,\n        address _partnerTokenAddress,\n        address _oracleAddress,\n        address _partnerOracleAddress,\n        bool _isUniPool\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L192"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n279: /**\n    * @dev Retrieves the pool address for given\n    * tokens and fee from Uniswap V3 Factory.\n    */\n    function _getPool(\n        address _token0,\n        address _token1,\n        uint24 _fee\n    )\n        internal\n        view\n        returns (address pool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L279"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n299: /**\n    * @dev Validates if the given token address\n    * is one of the two specified token addresses.\n    */\n    function _validateTokenAddress(\n        address _tokenAddress,\n        address _token0,\n        address _token1\n    )\n        internal\n        pure\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L299"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n320: /**\n    * @dev Validates if the given pool\n    * address matches the expected pool address.\n    */\n    function _validatePoolAddress(\n        address _pool,\n        address _expectedPool\n    )\n        internal\n        pure\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L320"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n340: /**\n    * @dev Validates if the price feed for\n    * a given token address is set.\n    */\n    function _validatePriceFeed(\n        address _tokenAddress\n    )\n        internal\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L340"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n355: /**\n    * @dev Validates if the TWAP oracle for\n    * a given token address is already set.\n    */\n    function _validateTwapOracle(\n        address _tokenAddress\n    )\n        internal\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L355"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n370: /**\n     * @dev Returns twapPrice by passing\n     * the underlying token address.\n     */\n    function _getTwapPrice(\n        address _tokenAddress,\n        address _oracle\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L370"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n446: /**\n     * @dev Returns priceFeed decimals by\n     * passing the underlying token address.\n     */\n    function decimals(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (uint8)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L446"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n503: /**\n     * @dev Stores expected heartbeat\n     * value for a pricing feed token.\n     */\n    function _recalibrate(\n        address _tokenAddress\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L503"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n551: /**\n     * @dev Check if chainLink feed was\n     * updated within expected timeFrame\n     * for single {_tokenAddress}.\n     */\n    function _chainLinkIsDead(\n        address _tokenAddress\n    )\n        internal\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L551"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n588: /**\n     * @dev Recalibrates expected\n     * heartbeat for a pricing feed.\n     */\n    function _recalibratePreview(\n        address _tokenAddress\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L588"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n654: /**\n     * @dev Determines number of iterations\n     * needed during heartbeat recalibration.\n     */\n    function _getIterationCount(\n        uint80 _latestAggregatorRoundId\n    )\n        internal\n        pure\n        returns (uint80 res)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L654"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n670: /**\n     * @dev Fetches timestamp of a byteshifted\n     * aggregatorRound with specific _roundId.\n     */\n    function _getRoundTimestamp(\n        address _tokenAddress,\n        uint80 _roundId\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L670"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n695: /**\n     * @dev Routing latest round data from chainLink.\n     * Returns latestRoundData by passing underlying token address.\n     */\n    function getLatestRoundId(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (\n            uint80 roundId\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L695"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n65: /**\n     * @dev Returns priceFeed latest ETH value\n     * by passing the underlying token address.\n     */\n    function latestResolver(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L65"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n119: /**\n     * @dev Returns USD value of a given token\n     * amount in order of 1E18 decimal precision.\n     */\n    function getTokensPriceInUSD(\n        address _tokenAddress,\n        uint256 _tokenAmount\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L119"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n139: /**\n     * @dev Returns ETH value of a given token\n     * amount in order of 1E18 decimal precision.\n     */\n    function getTokensInETH(\n        address _tokenAddress,\n        uint256 _tokenAmount\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L139"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n194: /**\n     * @dev Converts USD value of a token into token amount with a\n     * current price. The order of the argument _usdValue is 1E18.\n     */\n    function getTokensPriceFromUSD(\n        address _tokenAddress,\n        uint256 _usdValue\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L194"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n214: /**\n     * @dev Adds a new token address to the oracleHub Twap.\n     * Can't overwrite existing mappings.\n     */\n    function addTwapOracle(\n        address _tokenAddress,\n        address _uniPoolAddress,\n        address _token0,\n        address _token1,\n        uint24 _fee\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L214"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n262: /**\n     * @dev Adds a new token address to TWAP as derivative.\n     * Not permitted to overwrite existing mappings.\n     */\n    function addTwapOracleDerivative(\n        address _tokenAddress,\n        address _partnerTokenAddress,\n        address[2] calldata _uniPools,\n        address[2] calldata _token0Array,\n        address[2] calldata _token1Array,\n        uint24[2] calldata _feeArray\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L262"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n323: /**\n     * @dev Converts ETH value of a token into token amount with a\n     * current price. The order of the argument _ethAmount is 1E18.\n     */\n    function getTokensFromETH(\n        address _tokenAddress,\n        uint256 _ethAmount\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L323"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n354: /**\n     * @dev Adds priceFeed for a token.\n     * Can't overwrite existing mappings.\n     * Master is a timelock contract.\n     */\n    function addOracle(\n        address _tokenAddress,\n        IPriceFeed _priceFeedAddress,\n        address[] calldata _underlyingFeedTokens\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L354"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n374: /**\n     * @dev Adds priceFeeds for tokens.\n     * Can't overwrite existing mappings.\n     * Master is a timelock contract.\n     */\n    function addOracleBulk(\n        address[] calldata _tokenAddresses,\n        IPriceFeed[] calldata _priceFeedAddresses,\n        address[][] calldata _underlyingFeedTokens\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L374"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n414: /**\n     * @dev Looks at the maximal last 50 rounds and\n     * takes second highest value to avoid counting\n     * offline time of chainlink as valid heartbeat.\n     */\n    function recalibratePreview(\n        address _tokenAddress\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L414"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n431: /**\n     * @dev Check if chainLink feed was\n     * updated within expected timeFrame.\n     * If length of {underlyingFeedTokens}\n     * is greater than zero it checks the\n     * heartbeat of all base feeds of the\n     * derivate oracle.\n     */\n    function chainLinkIsDead(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (bool state)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L431"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n483: /**\n     * @dev Recalibrates expected\n     * heartbeat for a pricing feed.\n     */\n    function recalibrate(\n        address _tokenAddress\n    )\n        external\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L483"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n54: /**\n     * @dev View functions returning current\n     * debt ratio of a postion in normal mode.\n     * 1% <=> 1E16\n     */\n    function getLiveDebtRatio(\n        uint256 _nftId\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L54"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n79: /**\n     * @dev Set Liquidation incentives and boundaries\n     * for liquidation. Only callable by the master.\n     * Assures liquidation cascade cannot be self imposed\n     * by limiting incentives.\n     */\n    function setLiquidationSettings(\n        uint256 _baseReward,\n        uint256 _baseRewardFarm,\n        uint256 _newMaxFeeETH,\n        uint256 _newMaxFeeFarmETH\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L79"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n102: /**\n     * @dev Checks for liquidation logic.\n     */\n    function checksLiquidation(\n        uint256 _nftIdLiquidate,\n        address _tokenToPayback,\n        uint256 _shareAmountToPay\n    )\n        external\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L102"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n189: /**\n     * @dev Reentrency guard for curve pools. Forces\n     * a swap to update internal curve values.\n     */\n    function curveSecurityCheck(\n        address _poolToken\n    )\n        external\n        onlyWiseLending\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L189"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n234: /**\n     * @dev Checks for withdraw logic.\n     */\n    function checksWithdraw(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken\n    )\n        external\n        view\n        returns (bool specialCase)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L234"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n272: /**\n     * @dev Checks for solely withdraw logic.\n     */\n    function checksSolelyWithdraw(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken\n    )\n        external\n        view\n        returns (bool specialCase)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L272"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n303: /**\n     * @dev Checks for borrow logic.\n     */\n    function checksBorrow(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken\n    )\n        external\n        view\n        returns (bool specialCase)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L303"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n332: /**\n     * @dev Checks for collateralize deposit logic.\n     */\n    function checksCollateralizeDeposit(\n        uint256 _nftId,\n        address _caller,\n        address _poolAddress\n    )\n        external\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L332"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n357: /**\n     * @dev Checks for uncollateralized deposit logic.\n     */\n    function checkUncollateralizedDeposit(\n        uint256 _nftId,\n        address _poolToken\n    )\n        external\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L357"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n384: /**\n     * @dev Checks if user has healthy position.\n     */\n\n    function checkHealthState(\n        uint256 _nftId,\n        bool _isPowerFarm\n    )\n        external\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L384"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n401: /**\n     * @dev Checks for bad debt logic. Compares\n     * total ETH of borrow and collateral.\n     */\n    function checkBadDebtLiquidation(\n        uint256 _nftId\n    )\n        external\n        onlyWiseLending\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L401"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1041: /**\n     * @dev External wrapper for pool condition\n     * check.\n     */\n    function checkPoolCondition(\n        address _token\n    )\n        external\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1041"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1056: /**\n     * @dev External wrapper for pool condition\n     * check.\n     */\n    function checkPoolWithMinDeposit(\n        address _token,\n        uint256 _amount\n    )\n        external\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1056"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n683: /**\n     * @dev Check if chainLink feed was\n     * updated within expected timeframe\n     */\n    function checkHeartbeat(\n        address _poolToken\n    )\n        public\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L683"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n697: /**\n     * @dev Check if the postion with\n     * {_nftId} is locked for interactions.\n     */\n    function _checkPositionLocked(\n        uint256 _nftId\n    )\n        internal\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L697"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n732: /**\n     * @dev Returning the possible fee\n     * for liquidation.\n     */\n    function _checkMaxFee(\n        uint256 _paybackETH,\n        uint256 _liquidationFee,\n        uint256 _maxFeeETH\n    )\n        internal\n        pure\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L732"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1052: /**\n     * Locking or unlocking all pools for borrow\n     * and deposit actions. Performs action for\n     * all pools.\n     */\n    function _setPoolState(\n        bool _state\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1052"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n1077: /**\n     * @dev Wrapper for {_checkBlacklisted}.\n     */\n    function _checkPoolCondition(\n        address _poolToken\n    )\n        internal\n        view\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1077"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n39: /**\n     * @dev Adds new mapping to aaveHub. Needed\n     * to link underlying assets with corresponding\n     * aTokens. Can only be called by master.\n     */\n    function setAaveTokenAddress(\n        address _underlyingAsset,\n        address _aaveToken\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L39"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n58: /**\n     * @dev Adds new mapping to aaveHub in bulk.\n     * Needed to link underlying assets with\n     * corresponding aTokens. Can only be called by master.\n     */\n\n    function setAaveTokenAddressBulk(\n        address[] calldata _underlyingAssets,\n        address[] calldata _aaveTokens\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L58"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n97: /**\n     * @dev Allows deposit ERC20 token to\n     * wiseLending and takes token amount\n     * as arguement. Also mints position\n     * NFT to reduce needed transactions.\n     */\n    function depositExactAmountMint(\n        address _underlyingAsset,\n        uint256 _amount\n    )\n        external\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L97"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n117: /**\n     * @dev Allows deposit ERC20 token to\n     * wiseLending and takes token amount as\n     * argument.\n     */\n    function depositExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _amount\n    )\n        public\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L117"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n168: /**\n     * @dev Allows to deposit ETH token directly to\n     * wiseLending and takes token amount as argument.\n     */\n    function depositExactAmountETH(\n        uint256 _nftId\n    )\n        public\n        payable\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L168"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n198: /**\n     * @dev Allows to withdraw deposited ERC20 token.\n     * Takes _withdrawAmount as argument.\n     */\n    function withdrawExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _withdrawAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L198"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n234: /**\n     * @dev Allows to withdraw deposited ETH token.\n     * Takes token amount as argument.\n     */\n    function withdrawExactAmountETH(\n        uint256 _nftId,\n        uint256 _withdrawAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L234"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n277: /**\n     * @dev Allows to withdraw deposited ERC20 token.\n     * Takes _shareAmount as argument.\n     */\n    function withdrawExactShares(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _shareAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L277"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n310: /**\n     * @dev Allows to withdraw deposited ETH token.\n     * Takes _shareAmount as argument.\n     */\n    function withdrawExactSharesETH(\n        uint256 _nftId,\n        uint256 _shareAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L310"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n350: /**\n     * @dev Allows to borrow ERC20 token from a\n     * wiseLending pool. Needs supplied collateral\n     * inside the same position and to approve\n     * aaveHub to borrow onBehalf for the caller.\n     * Takes token amount as argument.\n     */\n    function borrowExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _borrowAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L350"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n386: /**\n     * @dev Allows to borrow ETH token from\n     * wiseLending. Needs supplied collateral\n     * inside the same position and to approve\n     * aaveHub to borrow onBehalf for the caller.\n     * Takes token amount as argument.\n     */\n    function borrowExactAmountETH(\n        uint256 _nftId,\n        uint256 _borrowAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L386"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n429: /**\n     * @dev Allows to payback ERC20 token for\n     * any postion. Takes _paybackAmount as argument.\n     */\n    function paybackExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _paybackAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L429"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n478: /**\n     * @dev Allows to payback ETH token for\n     * any postion. Takes token amount as argument.\n     */\n    function paybackExactAmountETH(\n        uint256 _nftId\n    )\n        external\n        payable\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L478"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n552: /**\n     * @dev Allows to payback ERC20 token for\n     * any postion. Takes shares as argument.\n     */\n    function paybackExactShares(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _shares\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L552"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n630: /**\n     * @dev View functions returning the combined rate\n     * from aave supply APY and wiseLending borrow APY\n     * of a pool.\n     */\n    function getLendingRate(\n        address _underlyingAsset\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L630"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "NatSpec `@return` argument is missing",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n130: /**\n     * @dev Internal helper combining one\n     * security check with lending share\n     * calculation for withdraw.\n     */\n    function _preparationsWithdraw(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken,\n        uint256 _amount\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L130"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n159: /**\n     * @dev Internal helper calculating {_poolToken}\n     * utilization. Includes math underflow check.\n     */\n    function _getValueUtilization(\n        address _poolToken\n    )\n        private\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L159"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n642: /**\n     * @dev Internal helper calculating\n     * a hash out of {_nftId} and {_poolToken}\n     * using keccak256.\n     */\n    function _getHash(\n        uint256 _nftId,\n        address _poolToken\n    )\n        private\n        pure\n        returns (bytes32)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L642"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n891: /**\n     * @dev Internal helper function\n     * checking if time interval for\n     * next LASA call has passed.\n     */\n    function _aboveThreshold(\n        address _poolToken\n    )\n        internal\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L891"
          ]
        },
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n983: /**\n     * @dev Returns bool to determine if resonance\n     * factor needs to be reset to last best value.\n     */\n    function _resonanceOutcome(\n        address _poolToken,\n        uint256 _shareValue\n    )\n        private\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L983"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n151: /**\n     * @dev See {IERC721-getApproved}.\n     */\n    function getApprovedSoft(\n        uint256 tokenId\n    )\n        external\n        view\n        returns (address)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L151"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n170: /**\n     * @dev Mints NFT for _user, without it\n     * user can not use WiseLending protocol\n     */\n    function mintPositionForUser(\n        address _user\n    )\n        external\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L170"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n268: /**\n     * @dev Returns positions of owner\n     */\n    function walletOfOwner(\n        address _owner\n    )\n        external\n        view\n        returns (uint256[] memory)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L268"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n337: /**\n     * @dev Returns path to MetaData URI\n     */\n    function tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L337"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n368: /**\n     * @dev Converts tokenId uint to string.\n     */\n    function _toString(\n        uint256 _tokenId\n    )\n        internal\n        pure\n        returns (string memory str)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L368"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n162: /**\n     * @dev Fetches share price of lending shares.\n     */\n    function _getSharePrice(\n        address _poolToken\n    )\n        private\n        view\n        returns (\n            uint256,\n            uint256\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L162"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n250: /**\n    * @dev Since pool inception share price\n    * increase for both lending and borrow shares\n    * is capped at 500% apr max in between a transaction.\n    */\n    function _getCurrentSharePriceMax(\n        address _poolToken\n    )\n        private\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L250"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n270: /**\n     * @dev First part of pool sync updating pseudo\n     * amounts. Is skipped when powerFarms or aaveHub\n     * is calling the function.\n     */\n    function _syncPoolBeforeCodeExecution(\n        address _poolToken\n    )\n        private\n        returns (\n            uint256 lendSharePrice,\n            uint256 borrowSharePrice\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L270"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n384: /**\n     * @dev Allows to supply funds using ETH.\n     * Without converting to WETH, use ETH directly.\n     */\n    function depositExactAmountETH(\n        uint256 _nftId\n    )\n        external\n        payable\n        syncPool(WETH_ADDRESS)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L384"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n437: /**\n     * @dev Allows to supply _poolToken and user\n     * can decide if _poolToken should be collateralized,\n     * also mints position to avoid extra transaction.\n     */\n    function depositExactAmountMint(\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L437"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n456: /**\n     * @dev Allows to supply _poolToken and user\n     * can decide if _poolToken should be collateralized.\n     */\n    function depositExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        public\n        syncPool(_poolToken)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L456"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n632: /**\n     * @dev Allows to withdraw publicly\n     * deposited ETH funds using exact amount.\n     */\n    function withdrawExactAmountETH(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L632"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n671: /**\n     * @dev Allows to withdraw publicly\n     * deposited ETH funds using exact shares.\n     */\n    function withdrawExactSharesETH(\n        uint256 _nftId,\n        uint256 _shares\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L671"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n710: /**\n     * @dev Allows to withdraw publicly\n     * deposited ERC20 funds using exact amount.\n     */\n    function withdrawExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _withdrawAmount\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L710"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n854: /**\n     * @dev Allows to withdraw privately\n     * deposited ERC20 on behalf of owner.\n     * Requires approval by _nftId owner.\n     */\n    function withdrawOnBehalfExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _withdrawAmount\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L854"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n898: /**\n     * @dev Allows to withdraw ERC20\n     * funds using shares as input value\n     */\n    function withdrawExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L898"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n935: /**\n     * @dev Withdraws ERC20 funds on behalf\n     * of _nftId owner, requires approval.\n     */\n    function withdrawOnBehalfExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L935"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n971: /**\n     * @dev Allows to borrow ETH funds\n     * Requires user to have collateral.\n     */\n    function borrowExactAmountETH(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L971"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1012: /**\n     * @dev Allows to borrow ERC20 funds\n     * Requires user to have collateral.\n     */\n    function borrowExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1012"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1051: /**\n     * @dev Allows to borrow ERC20 funds\n     * on behalf of _nftId owner, if approved.\n     */\n    function borrowOnBehalfExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1051"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1084: /**\n     * @dev Ability to payback ETH loans\n     * by providing exact payback amount.\n     */\n    function paybackExactAmountETH(\n        uint256 _nftId\n    )\n        external\n        payable\n        syncPool(WETH_ADDRESS)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1084"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1157: /**\n     * @dev Ability to payback ERC20 loans\n     * by providing exact payback amount.\n     */\n    function paybackExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        syncPool(_poolToken)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1157"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1200: /**\n     * @dev Ability to payback ERC20 loans\n     * by providing exact payback shares.\n     */\n    function paybackExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        syncPool(_poolToken)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1200"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n880: /**\n     * @dev Returns the pool token address\n     * at the _index postion of the array.\n     */\n    function getPoolTokenAdressesByIndex(\n        uint256 _index\n    )\n        external\n        view\n        returns (address)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L880"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n361: /**\n     * @dev Can also be used to extend existing lock.\n     */\n    function lockPendle(\n        uint256 _amount,\n        uint128 _weeks,\n        bool _fromInside,\n        bool _sameExpiry\n    )\n        external\n        onlyMaster\n        returns (uint256 newVeBalance)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L361"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n526: /**\n     * @dev External wrapper for mint function.\n     */\n    function depositExactAmount(\n        uint256 _underlyingLpAssetAmount\n    )\n        external\n        syncSupply\n        returns (\n            uint256,\n            uint256\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L526"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n605: /**\n     * @dev External wrapper for burn function.\n     */\n    function withdrawExactShares(\n        uint256 _shares\n    )\n        external\n        syncSupply\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L605"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n106: /**\n     * @dev Returns positions of owner\n     */\n    function walletOfOwner(\n        address _owner\n    )\n        external\n        view\n        returns (uint256[] memory)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L106"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n179: /**\n     * @dev Returns path to MetaData URI\n     */\n    function tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L179"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n210: /**\n     * @dev Converts tokenId uint to string.\n     */\n    function _toString(\n        uint256 _tokenId\n    )\n        internal\n        pure\n        returns (string memory str)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L210"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n102: /**\n     * @dev Returns Twaps latest USD value\n     * by passing the underlying token address.\n     */\n    function latestResolverTwap(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L102"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n279: /**\n    * @dev Retrieves the pool address for given\n    * tokens and fee from Uniswap V3 Factory.\n    */\n    function _getPool(\n        address _token0,\n        address _token1,\n        uint24 _fee\n    )\n        internal\n        view\n        returns (address pool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L279"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n370: /**\n     * @dev Returns twapPrice by passing\n     * the underlying token address.\n     */\n    function _getTwapPrice(\n        address _tokenAddress,\n        address _oracle\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L370"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n446: /**\n     * @dev Returns priceFeed decimals by\n     * passing the underlying token address.\n     */\n    function decimals(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (uint8)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L446"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n551: /**\n     * @dev Check if chainLink feed was\n     * updated within expected timeFrame\n     * for single {_tokenAddress}.\n     */\n    function _chainLinkIsDead(\n        address _tokenAddress\n    )\n        internal\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L551"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n588: /**\n     * @dev Recalibrates expected\n     * heartbeat for a pricing feed.\n     */\n    function _recalibratePreview(\n        address _tokenAddress\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L588"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n654: /**\n     * @dev Determines number of iterations\n     * needed during heartbeat recalibration.\n     */\n    function _getIterationCount(\n        uint80 _latestAggregatorRoundId\n    )\n        internal\n        pure\n        returns (uint80 res)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L654"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n670: /**\n     * @dev Fetches timestamp of a byteshifted\n     * aggregatorRound with specific _roundId.\n     */\n    function _getRoundTimestamp(\n        address _tokenAddress,\n        uint80 _roundId\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L670"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n695: /**\n     * @dev Routing latest round data from chainLink.\n     * Returns latestRoundData by passing underlying token address.\n     */\n    function getLatestRoundId(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (\n            uint80 roundId\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L695"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n65: /**\n     * @dev Returns priceFeed latest ETH value\n     * by passing the underlying token address.\n     */\n    function latestResolver(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L65"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n119: /**\n     * @dev Returns USD value of a given token\n     * amount in order of 1E18 decimal precision.\n     */\n    function getTokensPriceInUSD(\n        address _tokenAddress,\n        uint256 _tokenAmount\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L119"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n139: /**\n     * @dev Returns ETH value of a given token\n     * amount in order of 1E18 decimal precision.\n     */\n    function getTokensInETH(\n        address _tokenAddress,\n        uint256 _tokenAmount\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L139"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n194: /**\n     * @dev Converts USD value of a token into token amount with a\n     * current price. The order of the argument _usdValue is 1E18.\n     */\n    function getTokensPriceFromUSD(\n        address _tokenAddress,\n        uint256 _usdValue\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L194"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n323: /**\n     * @dev Converts ETH value of a token into token amount with a\n     * current price. The order of the argument _ethAmount is 1E18.\n     */\n    function getTokensFromETH(\n        address _tokenAddress,\n        uint256 _ethAmount\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L323"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n414: /**\n     * @dev Looks at the maximal last 50 rounds and\n     * takes second highest value to avoid counting\n     * offline time of chainlink as valid heartbeat.\n     */\n    function recalibratePreview(\n        address _tokenAddress\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L414"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n431: /**\n     * @dev Check if chainLink feed was\n     * updated within expected timeFrame.\n     * If length of {underlyingFeedTokens}\n     * is greater than zero it checks the\n     * heartbeat of all base feeds of the\n     * derivate oracle.\n     */\n    function chainLinkIsDead(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (bool state)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L431"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n54: /**\n     * @dev View functions returning current\n     * debt ratio of a postion in normal mode.\n     * 1% <=> 1E16\n     */\n    function getLiveDebtRatio(\n        uint256 _nftId\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L54"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n234: /**\n     * @dev Checks for withdraw logic.\n     */\n    function checksWithdraw(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken\n    )\n        external\n        view\n        returns (bool specialCase)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L234"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n272: /**\n     * @dev Checks for solely withdraw logic.\n     */\n    function checksSolelyWithdraw(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken\n    )\n        external\n        view\n        returns (bool specialCase)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L272"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n303: /**\n     * @dev Checks for borrow logic.\n     */\n    function checksBorrow(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken\n    )\n        external\n        view\n        returns (bool specialCase)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L303"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1056: /**\n     * @dev External wrapper for pool condition\n     * check.\n     */\n    function checkPoolWithMinDeposit(\n        address _token,\n        uint256 _amount\n    )\n        external\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1056"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n683: /**\n     * @dev Check if chainLink feed was\n     * updated within expected timeframe\n     */\n    function checkHeartbeat(\n        address _poolToken\n    )\n        public\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L683"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n732: /**\n     * @dev Returning the possible fee\n     * for liquidation.\n     */\n    function _checkMaxFee(\n        uint256 _paybackETH,\n        uint256 _liquidationFee,\n        uint256 _maxFeeETH\n    )\n        internal\n        pure\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L732"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n97: /**\n     * @dev Allows deposit ERC20 token to\n     * wiseLending and takes token amount\n     * as arguement. Also mints position\n     * NFT to reduce needed transactions.\n     */\n    function depositExactAmountMint(\n        address _underlyingAsset,\n        uint256 _amount\n    )\n        external\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L97"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n117: /**\n     * @dev Allows deposit ERC20 token to\n     * wiseLending and takes token amount as\n     * argument.\n     */\n    function depositExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _amount\n    )\n        public\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L117"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n168: /**\n     * @dev Allows to deposit ETH token directly to\n     * wiseLending and takes token amount as argument.\n     */\n    function depositExactAmountETH(\n        uint256 _nftId\n    )\n        public\n        payable\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L168"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n198: /**\n     * @dev Allows to withdraw deposited ERC20 token.\n     * Takes _withdrawAmount as argument.\n     */\n    function withdrawExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _withdrawAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L198"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n234: /**\n     * @dev Allows to withdraw deposited ETH token.\n     * Takes token amount as argument.\n     */\n    function withdrawExactAmountETH(\n        uint256 _nftId,\n        uint256 _withdrawAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L234"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n277: /**\n     * @dev Allows to withdraw deposited ERC20 token.\n     * Takes _shareAmount as argument.\n     */\n    function withdrawExactShares(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _shareAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L277"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n310: /**\n     * @dev Allows to withdraw deposited ETH token.\n     * Takes _shareAmount as argument.\n     */\n    function withdrawExactSharesETH(\n        uint256 _nftId,\n        uint256 _shareAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L310"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n350: /**\n     * @dev Allows to borrow ERC20 token from a\n     * wiseLending pool. Needs supplied collateral\n     * inside the same position and to approve\n     * aaveHub to borrow onBehalf for the caller.\n     * Takes token amount as argument.\n     */\n    function borrowExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _borrowAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L350"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n386: /**\n     * @dev Allows to borrow ETH token from\n     * wiseLending. Needs supplied collateral\n     * inside the same position and to approve\n     * aaveHub to borrow onBehalf for the caller.\n     * Takes token amount as argument.\n     */\n    function borrowExactAmountETH(\n        uint256 _nftId,\n        uint256 _borrowAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L386"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n429: /**\n     * @dev Allows to payback ERC20 token for\n     * any postion. Takes _paybackAmount as argument.\n     */\n    function paybackExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _paybackAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L429"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n478: /**\n     * @dev Allows to payback ETH token for\n     * any postion. Takes token amount as argument.\n     */\n    function paybackExactAmountETH(\n        uint256 _nftId\n    )\n        external\n        payable\n        nonReentrant\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L478"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n552: /**\n     * @dev Allows to payback ERC20 token for\n     * any postion. Takes shares as argument.\n     */\n    function paybackExactShares(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _shares\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L552"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n630: /**\n     * @dev View functions returning the combined rate\n     * from aave supply APY and wiseLending borrow APY\n     * of a pool.\n     */\n    function getLendingRate(\n        address _underlyingAsset\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L630"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Non-assembly method available",
      "description": "There are some automated tools that will flag a project as having higher complexity if there is inline-assembly, so it's best to avoid using it where it's not necessary. In addition, most assembly methods can be replaced by non-assembly methods, for example:\n- `assembly{ g := gas() }` => `uint256 g = gasleft()`\n- `assembly{ id := chainid() }` => `uint256 id = block.chainid`\n- `assembly { r := mulmod(a, b, d) }` => `uint256 m = mulmod(x, y, k)`\n- `assembly { size := extcodesize() }` => `uint256 size = address(a).code.length`\n- etc.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n69: size := extcodesize(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L69"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Non `constant`/`immutable` state variables are missing a setter post deployment",
      "description": "Non-constant or non-immutable state variables lacking a setter function can create inflexibility in contract operations. If there's no way to update these variables post-deployment, the contract might not adapt to changing conditions or requirements, which can be a significant drawback, especially in upgradable or long-lived contracts. To resolve this, implement setter functions guarded by appropriate access controls, like `onlyOwner` or similar modifiers, so that these variables can be updated as required while maintaining security. This enables smoother contract maintenance and feature upgrades.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n17: uint256 public totalReserved;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L17"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n117: uint256 public totalBadDebtETH;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L117"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n123: address[] public poolTokenAddresses;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L123"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n129: address public proposedIncentiveMaster;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L129"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n43: bool public isShutdown;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n46: bool public allowEnter;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L46"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n56: uint256 public reservedPendleForLocking;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L56"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n61: address[] public activePendleMarkets;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L61"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n35: uint256 public totalLpAssetsToDistribute;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n15: uint256 public totalMinted;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L15"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n18: uint256 public totalReserved;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n21: uint256 public availableNFTCount;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n25: bool public sendingProgressAaveHub;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L25"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Non-usage of specific imports",
      "description": "The current form of relative path import is not recommended for use because it can unpredictably pollute the namespace.\nInstead, the Solidity docs recommend specifying imported symbols explicitly.\nhttps://docs.soliditylang.org/en/v0.8.23/layout-of-source-files.html#importing-other-source-files\n\nA good example:\n```solidity\nimport {OwnableUpgradeable} from \"openzeppelin-contracts-upgradeable/contracts/access/OwnableUpgradeable.sol\";\nimport {SafeTransferLib} from \"solmate/utils/SafeTransferLib.sol\";\nimport {SafeCastLib} from \"solmate/utils/SafeCastLib.sol\";\nimport {ERC20} from \"solmate/tokens/ERC20.sol\";\nimport {IProducer} from \"src/interfaces/IProducer.sol\";\nimport {GlobalState, UserState} from \"src/Common.sol\";\n```",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n5: import \"./WiseLowLevelHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n5: import \"./WiseCore.sol\";\n\n6: import \"./Babylonian.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L5-L6"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n5: import \"@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol\";\n\n7: import \"./OwnableMaster.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n5: import \"./MainHelper.sol\";\n\n6: import \"./TransferHub/TransferHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L5-L6"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n11: import \"./PoolManager.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n5: import \"./OwnableMaster.sol\";\n\n7: import \"./InterfaceHub/IAaveHubLite.sol\";\n\n8: import \"./InterfaceHub/IPositionNFTs.sol\";\n\n9: import \"./InterfaceHub/IWiseSecurity.sol\";\n\n10: import \"./InterfaceHub/IWiseOracleHub.sol\";\n\n11: import \"./InterfaceHub/IFeeManagerLight.sol\";\n\n13: import \"./TransferHub/WrapperHelper.sol\";\n\n14: import \"./TransferHub/SendValueHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L8",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n5: import \"./WiseLendingDeclaration.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n3: import \"./CustomOracleSetup.sol\";\n\n5: import \"../InterfaceHub/IPendle.sol\";\n\n6: import \"../InterfaceHub/IPriceFeed.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L3",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L6"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n16: import \"../InterfaceHub/IPendle.sol\";\n\n17: import \"../InterfaceHub/IPriceFeed.sol\";\n\n18: import \"../InterfaceHub/IOraclePendle.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L16-L18"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n16: import \"../InterfaceHub/IPriceFeed.sol\";\n\n17: import \"../InterfaceHub/IOraclePendle.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L16-L17"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n16: import \"../InterfaceHub/IPriceFeed.sol\";\n\n17: import \"../InterfaceHub/IOraclePendle.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L16-L17"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n5: import \"../InterfaceHub/IAave.sol\";\n\n6: import \"../InterfaceHub/IERC20.sol\";\n\n7: import \"../InterfaceHub/IWiseLending.sol\";\n\n8: import \"../InterfaceHub/IFeeManager.sol\";\n\n9: import \"../InterfaceHub/IWiseSecurity.sol\";\n\n10: import \"../InterfaceHub/IPositionNFTs.sol\";\n\n11: import \"../InterfaceHub/IWiseOracleHub.sol\";\n\n13: import \"../OwnableMaster.sol\";\n\n14: import \"./FeeManagerEvents.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L6",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L8",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n11: import \"./FeeManagerHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n5: import \"./DeclarationsFeeManager.sol\";\n\n6: import \"../TransferHub/TransferHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L5-L6"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n5: import \"./PendlePowerFarmLeverageLogic.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n5: import \"../../InterfaceHub/IERC20.sol\";\n\n6: import \"../../InterfaceHub/IAave.sol\";\n\n7: import \"../../InterfaceHub/IPendle.sol\";\n\n8: import \"../../InterfaceHub/IAaveHub.sol\";\n\n9: import \"../../InterfaceHub/IWiseLending.sol\";\n\n10: import \"../../InterfaceHub/IStETH.sol\";\n\n11: import \"../../InterfaceHub/IWiseSecurity.sol\";\n\n12: import \"../../InterfaceHub/IPositionNFTs.sol\";\n\n13: import \"../../InterfaceHub/IWiseOracleHub.sol\";\n\n14: import \"../../InterfaceHub/IBalancerFlashloan.sol\";\n\n15: import \"../../InterfaceHub/ICurve.sol\";\n\n16: import \"../../InterfaceHub/IUniswapV3.sol\";\n\n18: import \"../../TransferHub/WrapperHelper.sol\";\n\n19: import \"../../TransferHub/TransferHelper.sol\";\n\n20: import \"../../TransferHub/ApprovalHelper.sol\";\n\n21: import \"../../TransferHub/SendValueHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L14",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L6",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L8",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L12",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L15",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L16",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L18",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L19",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L20",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L21"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n5: import \"./PendlePowerFarmMathLogic.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n5: import \"./PendlePowerFarmDeclarations.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n11: import \"./PendlePowerFarm.sol\";\n\n12: import \"../../OwnableMaster.sol\";\n\n13: import \"../PowerFarmNFTs/MinterReserver.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L11-L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n5: import \"./PendlePowerFarmTokenFactory.sol\";\n\n6: import \"./PendlePowerFarmControllerHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L5-L6"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n5: import \"../../OwnableMaster.sol\";\n\n7: import \"../../TransferHub/TransferHelper.sol\";\n\n8: import \"../../TransferHub/ApprovalHelper.sol\";\n\n10: import \"../../InterfaceHub/IPendle.sol\";\n\n11: import \"../../InterfaceHub/IArbRewardsClaimer.sol\";\n\n12: import \"../../InterfaceHub/IWiseOracleHub.sol\";\n\n13: import \"../../InterfaceHub/IPendlePowerFarmToken.sol\";\n\n14: import \"../../InterfaceHub/IPendlePowerFarmTokenFactory.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L12",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L14",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L8",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n5: import \"./PendlePowerFarmControllerBase.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n5: import \"./SimpleERC20Clone.sol\";\n\n7: import \"../../InterfaceHub/IPendle.sol\";\n\n8: import \"../../InterfaceHub/IPendleController.sol\";\n\n10: import \"../../TransferHub/TransferHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n5: import \"./PendlePowerFarmToken.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n5: import \"../../InterfaceHub/IPowerFarmsNFTs.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n11: import \"../../OwnableMaster.sol\";\n\n12: import \"@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L11-L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n5: import \"./CallOptionalReturn.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n5: import \"../InterfaceHub/IERC20.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n5: import \"./CallOptionalReturn.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n5: import \"../InterfaceHub/IWETH.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n5: import \"../InterfaceHub/IERC20.sol\";\n\n6: import \"../InterfaceHub/IPriceFeed.sol\";\n\n7: import \"../InterfaceHub/IAggregator.sol\";\n\n9: import \"./Libraries/IUniswapV3Factory.sol\";\n\n10: import \"./Libraries/OracleLibrary.sol\";\n\n12: import \"../OwnableMaster.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L12",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L6",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n5: import \"./Declarations.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n11: import \"./OracleHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L11"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n11: import \"./WiseSecurityHelper.sol\";\n\n12: import \"../TransferHub/ApprovalHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L11-L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n5: import \"../InterfaceHub/IERC20.sol\";\n\n6: import \"../InterfaceHub/ICurve.sol\";\n\n7: import \"../InterfaceHub/IPositionNFTs.sol\";\n\n8: import \"../InterfaceHub/IWiseOracleHub.sol\";\n\n9: import \"../InterfaceHub/IFeeManager.sol\";\n\n10: import \"../InterfaceHub/IWiseLending.sol\";\n\n11: import \"../InterfaceHub/IWiseLiquidation.sol\";\n\n16: import \"../FeeManager/FeeManager.sol\";\n\n17: import \"../OwnableMaster.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L17",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L6",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L8",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L16"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n5: import \"./WiseSecurityDeclarations.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n5: import \"./Declarations.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n11: import \"./AaveHelper.sol\";\n\n12: import \"../TransferHub/TransferHelper.sol\";\n\n13: import \"../TransferHub/ApprovalHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L11-L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n5: import \"./AaveEvents.sol\";\n\n7: import \"../InterfaceHub/IAave.sol\";\n\n8: import \"../InterfaceHub/IWiseLending.sol\";\n\n9: import \"../InterfaceHub/IWiseSecurity.sol\";\n\n10: import \"../InterfaceHub/IPositionNFTs.sol\";\n\n12: import \"../OwnableMaster.sol\";\n\n13: import \"../TransferHub/WrapperHelper.sol\";\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L8",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L12",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L7"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Open TODOs",
      "description": "An open TODO is present. It is recommended to avoid open TODOs as they may indicate programming errors that still need to be fixed.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n563: // @TODO: Add a check for TWAP comparison on 2.5%\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L563"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n95: // @TODO: Delete later, keep for backward compatibility\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L95"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n170: // @TODO: Delete later, keep for backward compatibility\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L170"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Operations such as the changing of the owner should be behind a timelock",
      "description": "From the point of view of a user, the changing of the owner of a contract is a high risk operation that may have outcomes ranging from an attacker gaining control over the protocol, to the function no longer functioning due to a typo in the destination address. To give users plenty of warning so that they can validate any ownership changes, changes of ownership should be behind a timelock.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n103: function renounceOwnership(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L103"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n26: function renounceOwnership(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L26"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "`private` and `internal` variables should have a preceding `_` in their name",
      "description": "Add a preceding underscore `_` to the variable name, take care to refactor where there variables are read/write",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n186: bool internal powerFarmCheck;\n\n267: mapping(address => uint256) internal bufferIncrease;\n\n287: mapping(address => bool) internal parametersLocked;\n\n291: mapping(bytes32 => bool) internal hashMapPositionBorrow;\n\n292: mapping(bytes32 => bool) internal hashMapPositionLending;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L291",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L186",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L267",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n65: uint128 internal constant WEEK = 7 days;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L65"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n9: IWETH internal immutable WETH;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n23: IAave internal immutable AAVE;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L23"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Project should include an `EmergencyStop` pattern",
      "description": "Adding a way to quickly halt protocol functionality in an emergency, rather than having to pause individual contracts one-by-one, will make in-progress hack mitigation faster and much less stressful.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n7: abstract contract MainHelper is WiseLowLevelHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n8: abstract contract PoolManager is WiseCore {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n8: abstract contract WiseCore is MainHelper, TransferHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n43: contract WiseLending is PoolManager {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n7: abstract contract WiseLowLevelHelper is WiseLendingDeclaration {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n5: contract CustomOracleSetup {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n13: contract PendleChildLpOracle is CustomOracleSetup  {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n28: contract PendleLpOracle {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L28"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerEvents.sol\n\n5: contract FeeManagerEvents {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n8: abstract contract FeeManagerHelper is DeclarationsFeeManager, TransferHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n7: abstract contract PendlePowerFarm is PendlePowerFarmLeverageLogic {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n36: contract PendlePowerFarmDeclarations is\n    WrapperHelper,\n    TransferHelper,\n    ApprovalHelper,\n    SendValueHelper\n{\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L36"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n7: abstract contract PendlePowerFarmLeverageLogic is\n    PendlePowerFarmMathLogic,\n    IFlashLoanRecipient\n{\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n7: abstract contract PendlePowerFarmMathLogic is PendlePowerFarmDeclarations {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n8: contract PendlePowerFarmController is PendlePowerFarmControllerHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n7: abstract contract PendlePowerFarmControllerHelper is PendlePowerFarmControllerBase {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n9: contract PendlePowerFarmTokenFactory {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n10: contract MinterReserver {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n7: contract ApprovalHelper is CallOptionalReturn {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n7: contract CallOptionalReturn {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: SendValueHelper.sol\n\n8: contract SendValueHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L8"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n7: contract TransferHelper is CallOptionalReturn {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n7: contract WrapperHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n7: abstract contract OracleHelper is Declarations {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n31: contract WiseOracleHub is OracleHelper {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L31"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n7: abstract contract WiseSecurityHelper is WiseSecurityDeclarations {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L7"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n5: contract AaveEvents {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L5"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n7: abstract contract AaveHelper is Declarations {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L7"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "`public` functions not called internally by the contract should be declared `external` instead",
      "description": "Those functions should be declared as `external` instead of `public`, as they are never called internally by the contract.\nContracts are allowed to override their parents' functions and change the visibility from `external` to `public`.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\nfunction tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L340"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\nfunction latestRoundData()\n        public\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\nfunction latestRoundData()\n        public\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\nfunction syncAllSupply()\n        public\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L272"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\nfunction tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L182"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Public state arrays should have a getter to return all elements",
      "description": "In Solidity, public state variables automatically generate a getter function. For non-array types, this is straightforward: it simply returns the value. However, for arrays, the automatically generated getter only allows retrieval of an element at a specific index, not the entire array. This is mainly to prevent unintentional high gas costs, as returning the entire array can be expensive if it's large. If developers want to retrieve the whole array, they must explicitly define a function, as auto-generation could inadvertently expose contracts to gas-related vulnerabilities or lead to unwanted behavior for larger arrays.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n123: address[] public poolTokenAddresses;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L123"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n61: address[] public activePendleMarkets;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L61"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Public variable declarations should have NatSpec descriptions",
      "description": "e.g. `@dev` or `@notice`",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n17: uint256 public totalReserved;\n\n18: uint256 public immutable FEE_MANAGER_NFT;\n\n20: mapping(address => uint256) public reserved;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L17",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L18",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L20"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n8: uint256 public lastUpdateGlobal;\n\n12: mapping(uint80 => uint256) public timeStampByRoundId;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L8",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n58: address public immutable PENDLE_MARKET_ADDRESS;\n\n59: IPendleMarket public immutable PENDLE_MARKET;\n\n64: IOraclePendle public immutable ORACLE_PENDLE_PT;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L58",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L59",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L64"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n54: address public immutable aaveTokenAddresses;\n\n55: address public immutable borrowTokenAddresses;\n\n57: address public immutable ENTRY_ASSET;\n\n58: address public immutable PENDLE_CHILD;\n\n67: IAaveHub public immutable AAVE_HUB;\n\n68: IWiseLending public immutable WISE_LENDING;\n\n69: IWiseOracleHub public immutable ORACLE_HUB;\n\n70: IWiseSecurity public immutable WISE_SECURITY;\n\n71: IBalancerVault public immutable BALANCER_VAULT;\n\n72: IPositionNFTs public immutable POSITION_NFT;\n\n73: IStETH public immutable ST_ETH;\n\n74: ICurve public immutable CURVE;\n\n75: IUniswapV3 public immutable UNISWAP_V3_ROUTER;\n\n77: IPendleSy public immutable PENDLE_SY;\n\n78: IPendleRouter public immutable PENDLE_ROUTER;\n\n79: IPendleMarket public immutable PENDLE_MARKET;\n\n80: IPendleRouterStatic public immutable PENDLE_ROUTER_STATIC;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L54",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L55",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L57",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L58",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L67",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L68",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L69",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L70",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L71",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L72",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L73",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L74",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L75",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L77",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L78",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L79",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L80"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n10: PendlePowerFarmTokenFactory public immutable PENDLE_POWER_FARM_TOKEN_FACTORY;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L10"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n56: uint256 public reservedPendleForLocking;\n\n66: uint256 public exchangeIncentive;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L56",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L66"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n49: uint256 public mintFee;\n\n50: uint256 public lastInteraction;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L49-L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n13: address public immutable IMPLEMENTATION_TARGET;\n\n14: address public immutable PENDLE_POWER_FARM_CONTROLLER;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L13-L14"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n186: address public immutable AAVE_HUB;\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L186"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Empty blocks should be removed or emit something or at least add some comments to the body",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n126: {}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L126"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n43: {}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n60: {\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L60"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n49: {}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L49"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n52: {}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L52"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n37: {}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L37"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Adding A Return Statement When The Function Defines A Named Return Variable, Is Redundant",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n585: return receiveAmount\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L585"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n414: return newVeBalance\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L414"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n472: return amount\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L472"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n480: return state\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L480"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n207: return ethCollateral\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L207"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n264: return ethCollateral\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L264"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Remove unused `error` definition",
      "description": "Note that there may be cases where an error superficially appears to be used, but this is only because there are multiple definitions of the error in different files. In such cases, the error definition should be moved into a separate file. The instances below are the unused definitions.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\nerror PositionHasCollateral\nerror PositionHasBorrow\nerror Reentered\nerror NotEnoughCollateral\nerror NonVerifiedPool\nerror NotRegistered\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L0-L0"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "`require()` / `revert()` Statements Should Have Descriptive Reason Strings",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n32: revert();\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L32"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Returning a struct instead of a bunch of variables is better",
      "description": "If a function returns [too many variables](https://docs.soliditylang.org/en/v0.8.23/contracts.html#returning-multiple-values), replacing them with a struct can improve code readability, maintainability and reusability.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n55: function latestRoundData()\n        external\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answerdInRound\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L55"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n78: function getRoundData(\n        uint80 _roundId\n    )\n        external\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L78"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n151: function latestRoundData()\n        external\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L151"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n146: function latestRoundData()\n        public\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L146"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n125: function latestRoundData()\n        public\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L125"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Revert statements within external and public functions can be used to perform DOS attacks",
      "description": "In Solidity, 'revert' statements are used to undo changes and throw an exception when certain conditions are not met. However, in public and external functions, improper use of `revert` can be exploited for Denial of Service (DoS) attacks. An attacker can intentionally trigger these 'revert' conditions, causing legitimate transactions to consistently fail. For example, if a function relies on specific conditions from user input or contract state, an attacker could manipulate these to continually force reverts, blocking the function's execution. Therefore, it's crucial to design contract logic to handle exceptions properly and avoid scenarios where `revert` can be predictably triggered by malicious actors. This includes careful input validation and considering alternative design patterns that are less susceptible to such abuses.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n77: revert NoValue();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L77"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n37: revert InvalidAction();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L37"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n78: revert NotPermitted();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L78"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n185: revert NotPermitted();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L185"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n147: revert InvalidAction();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L147"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n105: revert CardinalityNotSatisfied();\n\n109: revert OldestObservationNotSatisfied();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L105",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L109"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n110: revert CardinalityNotSatisfied();\n\n114: revert OldestObservationNotSatisfied();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L110",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L114"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n91: revert CardinalityNotSatisfied();\n\n95: revert OldestObservationNotSatisfied();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L91",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L95"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n180: revert ZeroAddress();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L180"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n198: revert NotAllowed();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L198"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n292: revert NoIncentive();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n321: revert NotAllowed();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L321"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n358: revert NotAllowed();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L358"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n419: revert PoolAlreadyAdded();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L419"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n450: revert PoolNotPresent();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L450"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n698: revert ExistingBadDebt();\n\n702: revert NotAllowed();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L698",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L702"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n754: revert PoolNotActive();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L754"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n833: revert PoolNotActive();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L833"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n68: revert AccessDenied();\n\n74: revert InvalidParam();\n\n78: revert NotBalancerVault();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L68",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L74",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L78"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n292: revert DebtRatioTooHigh();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L292"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n72: revert NotEnoughCompound();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L72"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n125: revert ZeroShares();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L125"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n183: revert WrongAddress();\n\n195: revert NothingToSkim();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L183",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L195"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n221: revert AlreadySet();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L221"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n346: revert WrongAddress();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L346"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n385: revert LockTimeTooShort();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L385"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n476: revert NotExpired();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L476"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n620: revert InvalidLength();\n\n636: revert InvalidWeightSum();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L620",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L636"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n509: revert ZeroAmount();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L509"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n540: revert ZeroAmount();\n\n549: revert NotEnoughLpAssetsTransferred();\n\n560: revert ZeroFee();\n\n564: revert TooMuchFee();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L540",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L549",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L560",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L564"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n599: revert FeeTooHigh();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L599"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n616: revert ZeroAmount();\n\n620: revert InsufficientShares();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L616",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L620"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n655: revert ZeroAmount();\n\n664: revert NotEnoughShares();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L655",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L664"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n692: revert AlreadyInitialized();\n\n700: revert MarketExpired();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L692",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L700"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n45: revert DeployForbidden();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L45"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n271: revert OracleIsDead();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L271"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n77: revert OracleIsDead();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L77"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n249: revert OpenBorrowPosition();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L249"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n287: revert OpenBorrowPosition();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L287"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n344: revert ChainlinkDead();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L344"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n370: revert OpenBorrowPosition();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L370"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1015: revert NotAllowedEntity();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1015"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n1118: revert NoValue();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1118"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n679: revert NotAllowedToBorrow();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L679"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n850: revert NotAllowedWiseSecurity();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L850"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n867: revert LiquidationDenied();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L867"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n899: revert TooManyShares();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L899"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n977: revert NotOwner();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L977"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n112: revert AlreadySet();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L112"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Top-level declarations should be separated by at least two lines",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./WiseLowLevelHelper.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./WiseCore.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./MainHelper.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./OwnableMaster.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLowLevelHelper.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./WiseLendingDeclaration.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"../InterfaceHub/IAave.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./DeclarationsFeeManager.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./PendlePowerFarmLeverageLogic.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmDeclarations.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"../../InterfaceHub/IERC20.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./PendlePowerFarmMathLogic.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./PendlePowerFarmDeclarations.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n13: import \"../PowerFarmNFTs/MinterReserver.sol\";\n\ncontract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L13"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./PendlePowerFarmTokenFactory.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n6: import \"./PendlePowerFarmControllerHelper.sol\";\n\ncontract PendlePowerFarmController is PendlePowerFarmControllerHelper {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L6"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"../../OwnableMaster.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./PendlePowerFarmControllerBase.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./SimpleERC20Clone.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmTokenFactory.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./PendlePowerFarmToken.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: MinterReserver.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"../../InterfaceHub/IPowerFarmsNFTs.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n12: import \"@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol\";\n\ninterface IFarmContract {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./CallOptionalReturn.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"../InterfaceHub/IERC20.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./CallOptionalReturn.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"../InterfaceHub/IWETH.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"../InterfaceHub/IERC20.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./Declarations.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"../InterfaceHub/IERC20.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./WiseSecurityDeclarations.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHelper.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./Declarations.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L3"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n3: pragma solidity =0.8.24;\n\nimport \"./AaveEvents.sol\";\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L3"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Arrays can grow in size without a way to shrink them",
      "description": "New items are pushed into the following arrays but there is no option to `pop` them out. Currently, the array can grow indefinitely. E.g. there's no maximum limit and there's no functionality to remove array values.\nIf the array grows too large, calling relevant functions might run out of gas and revert. Calling these functions could result in a DOS condition.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n633: userTokenData[_nftId].push(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L633"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n283: activePendleMarkets.push(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L283"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Uncommented fields in a struct",
      "description": "Consider adding comments for all the fields in a struct to improve the readability of the codebase.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n12: struct CreatePool {\n        bool allowBorrow;\n        address poolToken;\n        uint256 poolMulFactor;\n        uint256 poolCollFactor;\n        uint256 maxDepositAmount;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L12"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n20: struct CurvePoolSettings {\n        CurveSwapStructData curveSecuritySwapsData;\n        CurveSwapStructToken curveSecuritySwapsToken;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L20"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n192: struct LendingEntry {\n        bool unCollateralized;\n        uint256 shares;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L192"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n197: struct BorrowRatesEntry {\n        uint256 pole;\n        uint256 deltaPole;\n        uint256 minPole;\n        uint256 maxPole;\n        uint256 multiplicativeFactor;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L197"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n205: struct AlgorithmEntry {\n        bool increasePole;\n        uint256 bestPole;\n        uint256 maxValue;\n        uint256 previousValue;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L205"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n212: struct GlobalPoolEntry {\n        uint256 totalPool;\n        uint256 utilization;\n        uint256 totalBareToken;\n        uint256 poolFee;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L212"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n219: struct LendingPoolEntry {\n        uint256 pseudoTotalPool;\n        uint256 totalDepositShares;\n        uint256 collateralFactor;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L219"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n225: struct BorrowPoolEntry {\n        bool allowBorrow;\n        uint256 pseudoTotalBorrowAmount;\n        uint256 totalBorrowShares;\n        uint256 borrowRate;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L225"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n232: struct TimestampsPoolEntry {\n        uint256 timeStamp;\n        uint256 timeStampScaling;\n        uint256 initialTimeStamp;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L232"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n238: struct CoreLiquidationStruct {\n        uint256 nftId;\n        uint256 nftIdLiquidator;\n        address caller;\n        address tokenToPayback;\n        address tokenToRecieve;\n        uint256 paybackAmount;\n        uint256 shareAmountToPay;\n        uint256 maxFeeETH;\n        uint256 baseRewardLiquidation;\n        address[] lendTokens;\n        address[] borrowTokens;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L238"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n35: struct CompoundStruct {\n        uint256[] reservedForCompound;\n        uint128[] lastIndex;\n        address[] rewardTokens;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n35: struct UniTwapPoolInfo {\n        bool isUniPool;\n        address oracle;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L35"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n40: struct DerivativePartnerInfo {\n        address partnerTokenAddress;\n        address partnerOracleAddress;\n    }\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L40"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Unused event may be unused code or indicative of missed emit/logic",
      "description": "Events that are declared but not used may be indicative of unused declarations where it makes sense to remove them for better readability/maintainability/auditability, or worse indicative of a missing emit which is bad for monitoring or missing logic that would have emitted that event.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n33: event IsSolelyDepositAave\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveEvents.sol\n\n38: event IsSolelyWithdrawAave\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Unused `struct` definition",
      "description": "Note that there may be cases where a struct superficially appears to be used, but this is only because there are multiple definitions of the struct in different files. In such cases, the struct definition should be moved into a separate file. The instances below are the unused definitions.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n238: struct CoreLiquidationStruct {\n        uint256 nftId;\n        uint256 nftIdLiquidator;\n        address caller;\n        address tokenToPayback;\n        address tokenToRecieve;\n        uint256 paybackAmount;\n        uint256 shareAmountToPay;\n        uint256 maxFeeETH;\n        uint256 baseRewardLiquidation;\n        address[] lendTokens;\n        address[] borrowTokens;\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L238"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Upgrade OpenZeppelin Contract Dependency",
      "description": "An outdated OZ version is used (which has known vulnerabilities, see: https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories).\nRelease: https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v5.0.0",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: package.json\n\n        \"@openzeppelin/contracts\": \"^4.9.3\"\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/package.json#L82"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Large multiples of ten should use scientific notation",
      "description": "Use (e.g. 1e6) rather than decimal literals (e.g. 100000), for better code readability.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n54: uint256 private constant MAX_MINT_FEE = 10000;\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L54"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Use a struct to encapsulate multiple function parameters",
      "description": "If a function has too many parameters, replacing them with a struct can improve code readability and maintainability, increase reusability, and reduce the likelihood of errors when passing the parameters.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n1314: function coreLiquidationIsolationPools(\n        uint256 _nftId,\n        uint256 _nftIdLiquidator,\n        address _caller,\n        address _paybackToken,\n        address _receiveToken,\n        uint256 _paybackAmount,\n        uint256 _shareAmountToPay\n    )\n        external\n        syncPool(_paybackToken)\n        syncPool(_receiveToken)\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1314"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n15: function _executeBalancerFlashLoan(\n        uint256 _nftId,\n        uint256 _flashAmount,\n        uint256 _initialAmount,\n        uint256 _lendingShares,\n        uint256 _borrowShares,\n        uint256 _allowedSpread,\n        bool _ethBack,\n        bool _isAave\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L15"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n134: function _logicClosePosition(\n        uint256 _nftId,\n        uint256 _borrowShares,\n        uint256 _lendingShares,\n        uint256 _totalDebtBalancer,\n        uint256 _allowedSpread,\n        address _caller,\n        bool _ethBack,\n        bool _isAave\n    )\n        private\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L134"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Use `@inheritdoc` for overridden functions",
      "description": "It is recommended to use `@inheritdoc` for overridden functions.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n340: function tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L340"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n182: function tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L182"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Use @inheritdoc rather than using a non-standard annotation",
      "description": "\n",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n9: /**\n     * @dev Helper function to convert {\n\n47: /**\n     * @dev Helper function to convert {\n\n71: /**\n     * @dev Helper function to convert {\n\n106: /**\n     * @dev Helper function to convert {\n\n9: /**\n     * @dev Helper function to convert {\n\n47: /**\n     * @dev Helper function to convert {\n\n71: /**\n     * @dev Helper function to convert {\n\n106: /**\n     * @dev Helper function to convert {\n\n9: /**\n     * @dev Helper function to convert {\n\n47: /**\n     * @dev Helper function to convert {\n\n71: /**\n     * @dev Helper function to convert {\n\n106: /**\n     * @dev Helper function to convert {\n\n9: /**\n     * @dev Helper function to convert {\n\n47: /**\n     * @dev Helper function to convert {\n\n71: /**\n     * @dev Helper function to convert {\n\n106: /**\n     * @dev Helper function to convert {\n\n130: /**\n     * @dev Internal helper combining one\n     * security check with lending share\n     * calculation for withdraw.\n     */\n    function _preparationsWithdraw(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken,\n        uint256 _amount\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n159: /**\n     * @dev Internal helper calculating {_poolToken}\n     * utilization. Includes math underflow check.\n     */\n    function _getValueUtilization(\n        address _poolToken\n    )\n        private\n        view\n        returns (uint256)\n    {\n\n183: /**\n     * @dev Internal helper function setting new pool\n     * utilization by calling {\n\n197: /**\n     * @dev Internal helper function checking if\n     * cleanup gathered new token to save into\n     * pool variables.\n     */\n    function _checkCleanUp(\n        uint256 _amountContract,\n        uint256 _totalPool,\n        uint256 _bareAmount\n    )\n        private\n        pure\n        returns (bool)\n    {\n\n214: /**\n     * @dev Wrapper for isolation pool check.\n     */\n    function _onlyIsolationPool(\n        address _poolAddress\n    )\n        internal\n        view\n    {\n\n228: /**\n     * @dev Internal helper function checking if\n     * user inputs are safe.\n     */\n    function _validateIsolationPoolLiquidation(\n        address _caller,\n        uint256 _nftId,\n        uint256 _nftIdLiquidator\n    )\n        internal\n        view\n    {\n\n290: /**\n     * @dev Internal helper function checking if falsely\n     * sent token are inside the contract for the pool with\n     * {\n\n345: /**\n     * @dev Internal helper function calculating\n     * allowed increase of pseudoTotalPool to\n     * contain shareprice increase reasoanbly.\n    */\n    function _getAllowedDifference(\n        address _poolToken\n    )\n        private\n        view\n        returns (uint256)\n    {\n\n366: /**\n     * @dev Internal helper function for\n     * updating pools and calling {\n\n386: /**\n     * @dev Internal helper function for\n     * updating all lending tokens of a\n     * position.\n     */\n    function _preparationTokens(\n        mapping(uint256 => address[]) storage _userTokenData,\n        uint256 _nftId,\n        address _poolToken\n    )\n        internal\n        returns (address[] memory)\n    {\n\n411: /**\n     * @dev Internal helper function for\n     * updating pseudo amounts of a pool\n     * inside {\n\n450: /**\n     * @dev Internal helper function for iterating\n     * over all tokens which may contain curvePools.\n     */\n    function _curveSecurityChecks(\n        address[] memory _lendTokens,\n        address[] memory _borrowTokens\n    )\n        internal\n    {\n\n469: /**\n     * @dev Internal helper function for executing while loops\n     * iterating over all tokens which may contain curvePools.\n     */\n    function _whileLoopCurveSecurity(\n        address[] memory _tokens\n    )\n        private\n    {\n\n493: /**\n     * @dev Internal helper function\n     * updating pseudo amounts and\n     * printing fee shares for the\n     * feeManager proportional to the\n     * fee percentage of the pool.\n     */\n    function _updatePseudoTotalAmounts(\n        address _poolToken\n    )\n        private\n    {\n\n579: /**\n     * @dev Internal increas function for\n     * lending shares of a postion {\n\n594: /**\n     * @dev Internal decrease function for\n     * lending shares of a postion {\n\n609: /**\n     * @dev Internal helper function adding a new\n     * {\n\n642: /**\n     * @dev Internal helper calculating\n     * a hash out of {_nftId} and {_poolToken}\n     * using keccak256.\n     */\n    function _getHash(\n        uint256 _nftId,\n        address _poolToken\n    )\n        private\n        pure\n        returns (bytes32)\n    {\n\n663: /**\n     * @dev Internal helper function deleting an\n     * entry in {\n\n729: /**\n     * @dev Internal helper deleting last entry\n     * of postion lending data.\n     */\n    function _deleteLastPositionLendingData(\n        uint256 _nftId,\n        address _poolToken\n    )\n        private\n    {\n\n748: /**\n     * @dev Core function combining payback\n     * logic with security checks.\n     */\n    function _corePayback(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount,\n        uint256 _shares\n    )\n        internal\n    {\n\n790: /**\n     * @dev Internal helper deleting last entry\n     * of postion borrow data.\n     */\n    function _deleteLastPositionBorrowData(\n        uint256 _nftId,\n        address _poolToken\n    )\n        private\n    {\n\n809: /**\n     * @dev Internal helper function calculating\n     * returning if a {\n\n825: /**\n     * @dev Internal helper function\n     * checking if {\n\n842: /**\n     * @dev Internal helper function\n     * calculating new borrow rates\n     * for {\n\n869: /**\n     * @dev Internal helper function\n     * updating utilization of the pool\n     * with {\n\n891: /**\n     * @dev Internal helper function\n     * checking if time interval for\n     * next LASA call has passed.\n     */\n    function _aboveThreshold(\n        address _poolToken\n    )\n        internal\n        view\n        returns (bool)\n    {\n\n906: /**\n     * @dev function that tries to maximise totalDepositShares of the pool.\n     * Reacting to negative and positive feedback by changing the resonance\n     * factor of the pool. Method similar to one parameter monte-carlo methods\n     */\n    function _scalingAlgorithm(\n        address _poolToken\n    )\n        internal\n    {\n\n943: /**\n     * @dev Sets the new max value in shares\n     * and saves the corresponding resonance factor.\n     */\n    function _newMaxPoolShares(\n        address _poolToken,\n        uint256 _shareValue\n    )\n        private\n    {\n\n964: /**\n     * @dev Internal function setting {\n\n983: /**\n     * @dev Returns bool to determine if resonance\n     * factor needs to be reset to last best value.\n     */\n    function _resonanceOutcome(\n        address _poolToken,\n        uint256 _shareValue\n    )\n        private\n        view\n        returns (bool)\n    {\n\n1000: /**\n     * @dev Resets resonance factor to old best value when system\n     * evolves into too bad state and sets current totalDepositShares\n     * amount to new maxPoolShares to exclude eternal loops and that\n     * unorganic peaks do not set maxPoolShares forever.\n     */\n    function _resetResonanceFactor(\n        address _poolToken,\n        uint256 _shareValue\n    )\n        private\n    {\n\n1027: /**\n     * @dev Reverts the flag for stepping direction from LASA.\n     */\n    function _revertDirectionState(\n        address _poolToken\n    )\n        private\n    {\n\n1041: /**\n     * @dev Function combining all possible stepping scenarios.\n     * Depending how share values has changed compared to last time.\n     */\n    function _updateResonanceFactor(\n        address _poolToken,\n        uint256 _shareValues\n    )\n        private\n    {\n\n1058: /**\n     * @dev Does a revert stepping and swaps stepping state in opposite flag.\n     */\n    function _reversedResonanceFactor(\n        address _poolToken\n    )\n        private\n    {\n\n1075: /**\n     * @dev Increasing or decresing resonance factor depending on flag value.\n     */\n    function _changingResonanceFactor(\n        address _poolToken\n    )\n        private\n    {\n\n1088: /**\n     * @dev stepping function increasing the resonance factor\n     * depending on the time past in the last time interval.\n     * Checks if current resonance factor is bigger than max value.\n     * If this is the case sets current value to maximal value\n     */\n    function _increaseResonanceFactor(\n        address _poolToken\n    )\n        private\n    {\n\n1119: /**\n     * @dev Stepping function decresing the resonance factor\n     * depending on the time past in the last time interval.\n     * Checks if current resonance factor undergoes the min value,\n     * if this is the case sets current value to minimal value.\n     */\n    function _decreaseResonanceFactor(\n        address _poolToken\n    )\n        private\n    {\n\n1149: /**\n     * @dev Internal helper function for removing token address\n     * from lending data array if all shares are removed. When\n     * feeManager (nftId = 0) is calling this function is skipped\n     * to save gas for continues fee accounting.\n     */\n    function _removeEmptyLendingData(\n        uint256 _nftId,\n        address _poolToken\n    )\n        internal\n    {\n\n1179: /**\n     * @dev Internal helper function grouping several function\n     * calls into one function for refactoring and code size\n     * reduction.\n     */\n    function _updatePoolStorage(\n        address _poolToken,\n        uint256 _amount,\n        uint256 _shares,\n        function(address, uint256) functionAmountA,\n        function(address, uint256) functionAmountB,\n        function(address, uint256) functionSharesA\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L366",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L71",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L106",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L71",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L106",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L71",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L106",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L47",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L71",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L106",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L130",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L159",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L183",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L197",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L214",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L228",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L290",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L345",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L386",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L411",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L450",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L469",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L493",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L579",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L594",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L609",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L642",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L663",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L729",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L748",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L790",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L809",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L825",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L842",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L869",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L891",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L906",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L943",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L964",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L983",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1000",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1027",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1041",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1058",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1075",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1088",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1119",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1149",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1179"
          ]
        },
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n66: /**\n     * @dev Allows to propose next master.\n     * Must be claimed by proposer.\n     */\n    function proposeOwner(\n        address _proposedOwner\n    )\n        external\n        onlyMaster\n    {\n\n88: /**\n     * @dev Allows to claim master role.\n     * Must be called by proposer.\n     */\n    function claimOwnership()\n        external\n        onlyProposed\n    {\n\n99: /**\n     * @dev Removes master role.\n     * No ability to be in control.\n     */\n    function renounceOwnership()\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L66",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L88",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L99"
          ]
        },
        {
          "content": "```solidity\n\nFile: PoolManager.sol\n\n122: /**\n     * @dev Allow to verify isolation pool.\n     */\n    function setVerifiedIsolationPool(\n        address _isolationPool,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L122"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n138: /**\n     * @dev Mints NFT for sender, without it\n     * user can not use WiseLending protocol\n     */\n    function mintPosition()\n        external\n        returns (uint256)\n    {\n\n151: /**\n     * @dev See {IERC721-getApproved}.\n     */\n    function getApprovedSoft(\n        uint256 tokenId\n    )\n        external\n        view\n        returns (address)\n    {\n\n170: /**\n     * @dev Mints NFT for _user, without it\n     * user can not use WiseLending protocol\n     */\n    function mintPositionForUser(\n        address _user\n    )\n        external\n        returns (uint256)\n    {\n\n268: /**\n     * @dev Returns positions of owner\n     */\n    function walletOfOwner(\n        address _owner\n    )\n        external\n        view\n        returns (uint256[] memory)\n    {\n\n316: /**\n     * @dev Allows to update base target for MetaData.\n     */\n    function setBaseURI(\n        string memory _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n337: /**\n     * @dev Returns path to MetaData URI\n     */\n    function tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n\n368: /**\n     * @dev Converts tokenId uint to string.\n     */\n    function _toString(\n        uint256 _tokenId\n    )\n        internal\n        pure\n        returns (string memory str)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L138",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L151",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L170",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L268",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L316",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L337",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L368"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseCore.sol\n\n10: /**\n     * @dev Wrapper function combining pool\n     * preparations for borrow and collaterals.\n     * Bypassed when called by powerFarms.\n     */\n    function _prepareAssociatedTokens(\n        uint256 _nftId,\n        address _poolTokenLend,\n        address _poolTokenBorrow\n    )\n        internal\n        returns (\n            address[] memory,\n            address[] memory\n        )\n    {\n\n40: /**\n     * @dev Core function combining withdraw\n     * logic and security checks.\n     */\n    function _coreWithdrawToken(\n        address _caller,\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount,\n        uint256 _shares,\n        bool _onBehalf\n    )\n        internal\n    {\n\n102: /**\n     * @dev Internal function combining deposit\n     * logic, security checks and event emit.\n     */\n    function _handleDeposit(\n        address _caller,\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        internal\n        returns (uint256)\n    {\n\n168: /**\n     * @dev External wrapper for\n     * {_checkPositionLocked}.\n     */\n\n    function checkPositionLocked(\n        uint256 _nftId,\n        address _caller\n    )\n        external\n        view\n    {\n\n186: /**\n     * @dev Checks if a postion is locked\n     * for powerFarms. Get skipped when\n     * aaveHub or a powerFarm itself is\n     * the {msg.sender}.\n     */\n\n    function _checkPositionLocked(\n        uint256 _nftId,\n        address _caller\n    )\n        internal\n        view\n    {\n\n211: /**\n     * @dev External wrapper for\n     * {_checkDeposit}.\n     */\n    function checkDeposit(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        view\n    {\n\n232: /**\n     * @dev Internal function including\n     * security checks for deposit logic.\n     */\n    function _checkDeposit(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken,\n        uint256 _amount\n    )\n        internal\n        view\n    {\n\n289: /**\n     * @dev Internal function checking\n     * if the deposit amount for the\n     * pool token is reached.\n     */\n    function _checkMaxDepositValue(\n        address _poolToken,\n        uint256 _amount\n    )\n        private\n        view\n    {\n\n311: /**\n     * @dev Low level core function combining\n     * pure withdraw math (without security\n     * checks).\n     */\n    function _coreWithdrawBare(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount,\n        uint256 _shares\n    )\n        private\n    {\n\n345: /**\n     * @dev Core function combining borrow\n     * logic with security checks.\n     */\n    function _coreBorrowTokens(\n        address _caller,\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount,\n        uint256 _shares,\n        bool _onBehalf\n    )\n        internal\n    {\n\n423: /**\n     * @dev Internal math function for liquidation logic\n     * caluclating amount to withdraw from pure\n     * collateral for liquidation.\n     */\n    function _withdrawPureCollateralLiquidation(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _percentLiquidation\n    )\n        private\n        returns (uint256 transferAmount)\n    {\n\n454: /**\n     * @dev Internal math function for liquidation logic\n     * which checks if pool has enough token to pay out\n     * liquidator. If not, liquidator get corresponding\n     * shares for later withdraw.\n     */\n    function _withdrawOrAllocateSharesLiquidation(\n        uint256 _nftId,\n        uint256 _nftIdLiquidator,\n        address _poolToken,\n        uint256 _percentWishCollateral\n    )\n        private\n        returns (uint256)\n    {\n\n538: /**\n     * @dev Internal math function combining functionallity\n     * of {\n\n621: /**\n     * @dev Core liquidation function for\n     * security checks and liquidation math.\n     */\n    function _coreLiquidation(\n        CoreLiquidationStruct memory _data\n    )\n        internal\n        returns (uint256 receiveAmount)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L40",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L102",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L168",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L186",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L211",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L232",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L289",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L311",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L345",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L423",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L454",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L538",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L621"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n5: /**\n * @author René Hochmuth\n * @author Christoph Krpoun\n * @author Vitally Marinchenko\n */\n\nimport \"./PoolManager.sol\";\n\n/**\n * @dev WISE lending is an automated lending platform on which users can collateralize\n * their assets and borrow tokens against them.\n *\n * Users need to pay borrow rates for debt tokens, which are reflected in a borrow APY for\n * each asset type (pool). This borrow rate is variable over time and determined through the\n * utilization of the pool. The bounding curve is a family of different bonding curves adjusted\n * automatically by LASA (Lending Automated Scaling Algorithm). For more information, see:\n * [https://wisesoft.gitbook.io/wise/wise-lending-protocol/lasa-ai]\n *\n * In addition to normal deposit, withdraw, borrow, and payback functions, there are other\n * interacting modes:\n *\n * - Solely deposit and withdraw allows the user to keep their funds private, enabling\n *    them to withdraw even when the pools are borrowed empty.\n *\n * - Aave pools  allow for maximal capital efficiency by earning aave supply APY for not\n *   borrowed funds.\n *\n * - Special curve pools nside beefy farms can be used as collateral, opening up new usage\n *   possibilities for these asset types.\n *\n * - Users can pay back their borrow with lending shares of the same asset type, making it\n *   easier to manage their positions.\n *\n * - Users save their collaterals and borrows inside a position NFT, making it possible\n *   to trade their whole positions or use them in second-layer contracts\n *   (e.g., spot trading with PTP NFT trading platforms).\n */\n\ncontract WiseLending is PoolManager {\n\n45: /**\n     * @dev Standard receive functions forwarding\n     * directly send ETH to the master address.\n     */\n    receive()\n        external\n        payable\n    {\n\n63: /**\n     * @dev Checks if position is healthy\n     * after all state changes are done.\n     */\n    modifier healthStateCheck(\n        uint256 _nftId\n    ) {\n        _;\n\n        _healthStateCheck(\n            _nftId\n        );\n    }\n\n    function _healthStateCheck(\n        uint256 _nftId\n    )\n        private\n    {\n\n92: /**\n     * @dev Runs the LASA algorithm known as\n     * Lending Automated Scaling Algorithm\n     * and updates pool data based on token\n     */\n    modifier syncPool(\n        address _poolToken\n    ) {\n        (\n            uint256 lendSharePrice,\n            uint256 borrowSharePrice\n        ) = _syncPoolBeforeCodeExecution(\n            _poolToken\n        );\n\n        _;\n\n        _syncPoolAfterCodeExecution(\n            _poolToken,\n            lendSharePrice,\n            borrowSharePrice\n        );\n    }\n\n    constructor(\n        address _master,\n        address _wiseOracleHubAddress,\n        address _nftContract\n    )\n        WiseLendingDeclaration(\n            _master,\n            _wiseOracleHubAddress,\n            _nftContract\n        )\n    {}\n\n    function _emitFundsSolelyWithdrawn(\n        address _caller,\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        private\n    {\n\n162: /**\n     * @dev Fetches share price of lending shares.\n     */\n    function _getSharePrice(\n        address _poolToken\n    )\n        private\n        view\n        returns (\n            uint256,\n            uint256\n        )\n    {\n\n205: /**\n     * @dev Compares share prices before and after\n     * execution. If borrow share price increased\n     * or lending share price decreased, revert.\n     */\n    function _compareSharePrices(\n        address _poolToken,\n        uint256 _lendSharePriceBefore,\n        uint256 _borrowSharePriceBefore\n    )\n        private\n        view\n    {\n\n250: /**\n    * @dev Since pool inception share price\n    * increase for both lending and borrow shares\n    * is capped at 500% apr max in between a transaction.\n    */\n    function _getCurrentSharePriceMax(\n        address _poolToken\n    )\n        private\n        view\n        returns (uint256)\n    {\n\n270: /**\n     * @dev First part of pool sync updating pseudo\n     * amounts. Is skipped when powerFarms or aaveHub\n     * is calling the function.\n     */\n    function _syncPoolBeforeCodeExecution(\n        address _poolToken\n    )\n        private\n        returns (\n            uint256 lendSharePrice,\n            uint256 borrowSharePrice\n        )\n    {\n\n304: /**\n     * @dev Second part of pool sync updating\n     * the borrow pool rate and share price.\n     */\n    function _syncPoolAfterCodeExecution(\n        address _poolToken,\n        uint256 _lendSharePriceBefore,\n        uint256 _borrowSharePriceBefore\n    )\n        private\n    {\n\n326: /**\n     * @dev Enables _poolToken to be used as a collateral.\n     */\n    function collateralizeDeposit(\n        uint256 _nftId,\n        address _poolToken\n    )\n        external\n        syncPool(_poolToken)\n    {\n\n345: /**\n     * @dev Disables _poolToken to be used as a collateral.\n     */\n    function unCollateralizeDeposit(\n        uint256 _nftId,\n        address _poolToken\n    )\n        external\n        syncPool(_poolToken)\n    {\n\n384: /**\n     * @dev Allows to supply funds using ETH.\n     * Without converting to WETH, use ETH directly.\n     */\n    function depositExactAmountETH(\n        uint256 _nftId\n    )\n        external\n        payable\n        syncPool(WETH_ADDRESS)\n        returns (uint256)\n    {\n\n421: /**\n     * @dev Allows to supply funds using ETH.\n     * Without converting to WETH, use ETH directly,\n     * also mints position to avoid extra transaction.\n     */\n    function depositExactAmountETHMint()\n        external\n        payable\n        syncPool(WETH_ADDRESS)\n        returns (uint256)\n    {\n\n437: /**\n     * @dev Allows to supply _poolToken and user\n     * can decide if _poolToken should be collateralized,\n     * also mints position to avoid extra transaction.\n     */\n    function depositExactAmountMint(\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        returns (uint256)\n    {\n\n456: /**\n     * @dev Allows to supply _poolToken and user\n     * can decide if _poolToken should be collateralized.\n     */\n    function depositExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        public\n        syncPool(_poolToken)\n        returns (uint256)\n    {\n\n486: /**\n     * @dev Allows to supply funds using ETH in solely mode,\n     * which does not earn APY, but keeps the funds private.\n     * Other users are restricted from borrowing these funds,\n     * owner can always withdraw even if all funds are borrowed.\n     * Also mints position to avoid extra transaction.\n     */\n    function solelyDepositETHMint()\n        external\n        payable\n    {\n\n502: /**\n     * @dev Allows to supply funds using ETH in solely mode,\n     * which does not earn APY, but keeps the funds private.\n     * Other users are restricted from borrowing these funds,\n     * owner can always withdraw even if all funds are borrowed.\n     */\n    function solelyDepositETH(\n        uint256 _nftId\n    )\n        public\n        payable\n        syncPool(WETH_ADDRESS)\n    {\n\n534: /**\n     * @dev Core function combining\n     * supply logic with security\n     * checks for solely deposit.\n     */\n    function _handleSolelyDeposit(\n        address _caller,\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        private\n    {\n\n574: /**\n     * @dev Allows to supply funds using ERC20 in solely mode,\n     * which does not earn APY, but keeps the funds private.\n     * Other users are restricted from borrowing these funds,\n     * owner can always withdraw even if all funds are borrowed.\n     * Also mints position to avoid extra transaction.\n     */\n    function solelyDepositMint(\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n    {\n\n594: /**\n     * @dev Allows to supply funds using ERC20 in solely mode,\n     * which does not earn APY, but keeps the funds private.\n     * Other users are restricted from borrowing these funds,\n     * owner can always withdraw even if all funds are borrowed.\n     */\n    function solelyDeposit(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        public\n        syncPool(_poolToken)\n    {\n\n632: /**\n     * @dev Allows to withdraw publicly\n     * deposited ETH funds using exact amount.\n     */\n    function withdrawExactAmountETH(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n671: /**\n     * @dev Allows to withdraw publicly\n     * deposited ETH funds using exact shares.\n     */\n    function withdrawExactSharesETH(\n        uint256 _nftId,\n        uint256 _shares\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n710: /**\n     * @dev Allows to withdraw publicly\n     * deposited ERC20 funds using exact amount.\n     */\n    function withdrawExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _withdrawAmount\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n747: /**\n     * @dev Allows to withdraw privately\n     * deposited ETH funds using input amount.\n     */\n    function solelyWithdrawETH(\n        uint256 _nftId,\n        uint256 _withdrawAmount\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n    {\n\n776: /**\n     * @dev Allows to withdraw privately\n     * deposited ERC20 funds using input amount.\n     */\n    function solelyWithdraw(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _withdrawAmount\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n    {\n\n803: /**\n     * @dev Core function combining\n     * withdraw logic for solely\n     * withdraw with security checks.\n     */\n    function _coreSolelyWithdraw(\n        address _caller,\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        private\n    {\n\n854: /**\n     * @dev Allows to withdraw privately\n     * deposited ERC20 on behalf of owner.\n     * Requires approval by _nftId owner.\n     */\n    function withdrawOnBehalfExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _withdrawAmount\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n898: /**\n     * @dev Allows to withdraw ERC20\n     * funds using shares as input value\n     */\n    function withdrawExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n935: /**\n     * @dev Withdraws ERC20 funds on behalf\n     * of _nftId owner, requires approval.\n     */\n    function withdrawOnBehalfExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n971: /**\n     * @dev Allows to borrow ETH funds\n     * Requires user to have collateral.\n     */\n    function borrowExactAmountETH(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        syncPool(WETH_ADDRESS)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n1012: /**\n     * @dev Allows to borrow ERC20 funds\n     * Requires user to have collateral.\n     */\n    function borrowExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n1051: /**\n     * @dev Allows to borrow ERC20 funds\n     * on behalf of _nftId owner, if approved.\n     */\n    function borrowOnBehalfExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        onlyAaveHub\n        syncPool(_poolToken)\n        healthStateCheck(_nftId)\n        returns (uint256)\n    {\n\n1084: /**\n     * @dev Ability to payback ETH loans\n     * by providing exact payback amount.\n     */\n    function paybackExactAmountETH(\n        uint256 _nftId\n    )\n        external\n        payable\n        syncPool(WETH_ADDRESS)\n        returns (uint256)\n    {\n\n1157: /**\n     * @dev Ability to payback ERC20 loans\n     * by providing exact payback amount.\n     */\n    function paybackExactAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount\n    )\n        external\n        syncPool(_poolToken)\n        returns (uint256)\n    {\n\n1200: /**\n     * @dev Ability to payback ERC20 loans\n     * by providing exact payback shares.\n     */\n    function paybackExactShares(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _shares\n    )\n        external\n        syncPool(_poolToken)\n        returns (uint256)\n    {\n\n1242: /**\n     * @dev Function to liquidate a postion which reaches\n     * a debt ratio greater than 100%. The liquidator can choose\n     * token to payback and receive. (Both can differ!). The\n     * amount is in shares of the payback token. The liquidator\n     * gets an incentive which is calculated inside the liquidation\n     * logic.\n     */\n    function liquidatePartiallyFromTokens(\n        uint256 _nftId,\n        uint256 _nftIdLiquidator,\n        address _paybackToken,\n        address _receiveToken,\n        uint256 _shareAmountToPay\n    )\n        external\n        syncPool(_paybackToken)\n        syncPool(_receiveToken)\n        returns (uint256)\n    {\n\n1311: /**\n     * @dev Wrapper function for liqudaiton flow\n     */\n    function coreLiquidationIsolationPools(\n        uint256 _nftId,\n        uint256 _nftIdLiquidator,\n        address _caller,\n        address _paybackToken,\n        address _receiveToken,\n        uint256 _paybackAmount,\n        uint256 _shareAmountToPay\n    )\n        external\n        syncPool(_paybackToken)\n        syncPool(_receiveToken)\n        returns (uint256)\n    {\n\n1363: /**\n     * @dev Allows to sync pool manually\n     * so that the pool is up to date.\n     */\n    function syncManually(\n        address _poolToken\n    )\n        external\n        syncPool(_poolToken)\n    {\n\n1382: /**\n     * @dev Registers position _nftId\n     * for isolation pool functionality\n     */\n    function setRegistrationIsolationPool(\n        uint256 _nftId,\n        bool _registerState\n    )\n        external\n    {\n\n1407: /**\n    * @dev External wrapper for\n    * {_corePayback} logic callable\n    * by feeMananger.\n    */\n    function corePaybackFeeManager(\n        address _poolToken,\n        uint256 _nftId,\n        uint256 _amount,\n        uint256 _shares\n    )\n        external\n        onlyFeeManager\n        syncPool(_poolToken)\n    {\n\n1430: /**\n     * @dev Internal function combining payback\n     * logic and emit of an event.\n     */\n    function _handlePayback(\n        address _caller,\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _amount,\n        uint256 _shares\n    )\n        private\n    {\n\n1584: /**\n     * @dev Internal helper function for reservating a\n     * position NFT id.\n     */\n    function _reservePosition()\n        private\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L45",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L63",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L92",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L162",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L205",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L250",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L270",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L304",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L326",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L345",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L384",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L421",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L437",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L456",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L486",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L502",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L534",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L574",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L594",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L632",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L671",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L710",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L747",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L776",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L803",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L854",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L898",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L935",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L971",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1012",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1051",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1084",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1157",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1200",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1242",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1311",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1363",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1382",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1407",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1430",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1584"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n5: /**\n * @author René Hochmuth\n */\n\n/**\n * @dev PriceFeed contract for Lp-Token with USD\n * chainLink feed to get a feed measured in ETH.\n * Takes chainLink oracle value and multiplies it\n * with the corresponding TWAP and other chainLink oracles.\n */\n\nimport \"../InterfaceHub/IPendle.sol\";\nimport \"../InterfaceHub/IPriceFeed.sol\";\nimport \"../InterfaceHub/IOraclePendle.sol\";\nimport {\n    PendleLpOracleLib,\n    IPMarket\n} from \"@pendle/core-v2/contracts/oracles/PendleLpOracleLib.sol\";\n\nerror InvalidDecimals();\nerror CardinalityNotSatisfied();\nerror OldestObservationNotSatisfied();\n\ncontract PendleLpOracle {\n\n    uint256 internal constant DEFAULT_DECIMALS = 18;\n\n    constructor(\n        address _pendleMarketAddress,\n        IPriceFeed _priceFeedChainLinkEth,\n        IOraclePendle _oraclePendlePt,\n        string memory _oracleName,\n        uint32 _twapDuration\n    )\n    {\n        PENDLE_MARKET_ADDRESS = _pendleMarketAddress;\n\n        FEED_ASSET = _priceFeedChainLinkEth;\n\n        if (FEED_ASSET.decimals() != DEFAULT_DECIMALS) {\n            revert InvalidDecimals();\n        }\n\n        TWAP_DURATION = _twapDuration;\n        ORACLE_PENDLE_PT = _oraclePendlePt;\n\n        PENDLE_MARKET = IPendleMarket(\n            _pendleMarketAddress\n        );\n\n        name = _oracleName;\n    }\n\n    address public immutable PENDLE_MARKET_ADDRESS;\n    IPendleMarket public immutable PENDLE_MARKET;\n\n    // Pricefeed for asset in ETH and TWAP for PtToken.\n    IPendleSy public immutable PENDLE_SY;\n    IPriceFeed public immutable FEED_ASSET;\n    IOraclePendle public immutable ORACLE_PENDLE_PT;\n\n    uint8 internal constant FEED_DECIMALS = 18;\n    uint256 internal constant POW_FEED_DECIMALS = 10 ** 18;\n\n    // Precision factor for computations.\n    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;\n\n    // -- Twap duration in seconds --\n    uint32 public immutable TWAP_DURATION;\n\n    // -- Farm description --\n    string public name;\n\n    /**\n     * @dev Read function returning latest ETH value for PtToken.\n     * Uses answer from USD chainLink pricefeed and combines it with\n     * the result from ethInUsd for one token of PtToken.\n     */\n    function latestAnswer()\n        public\n        view\n        returns (uint256)\n    {\n\n136: /**\n     * @dev Returns priceFeed decimals.\n     */\n    function decimals()\n        external\n        pure\n        returns (uint8)\n    {\n\n147: /**\n     * @dev Read function returning the latest answer\n     * so wise oracle hub can fetch it\n     */\n    function latestRoundData()\n        external\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L136",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L147"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n5: /**\n * @author René Hochmuth\n */\n\n/**\n * @dev Pricefeed contract for PtToken with USD\n * chainLink feed to get a feed measured in ETH.\n * Takes chainLink oracle value and multiplies it with\n * the corresponding TWAP and other chainLink oracles\n */\n\nimport \"../InterfaceHub/IPriceFeed.sol\";\nimport \"../InterfaceHub/IOraclePendle.sol\";\n\nerror CardinalityNotSatisfied();\nerror OldestObservationNotSatisfied();\n\ncontract PtOracleDerivative {\n\n    constructor(\n        address _pendleMarketAddress,\n        IPriceFeed _priceFeedChainLinkUsd,\n        IPriceFeed _priceFeedChainLinkEthUsd,\n        IOraclePendle _oraclePendlePt,\n        string memory _oracleName,\n        uint32 _twapDuration\n    )\n    {\n        PENDLE_MARKET_ADDRESS = _pendleMarketAddress;\n\n        USD_FEED_ASSET = _priceFeedChainLinkUsd;\n        ETH_FEED_ASSET = _priceFeedChainLinkEthUsd;\n\n        POW_USD_FEED = 10 ** USD_FEED_ASSET.decimals();\n        POW_ETH_USD_FEED = 10 ** ETH_FEED_ASSET.decimals();\n\n        ORACLE_PENDLE_PT = _oraclePendlePt;\n        TWAP_DURATION = _twapDuration;\n        name = _oracleName;\n    }\n\n    // Token interface for the asset.\n    address immutable PENDLE_MARKET_ADDRESS;\n\n    // Pricefeed for Asset in USD.\n    IPriceFeed public immutable USD_FEED_ASSET;\n\n    // Pricefeed for ETH in USD.\n    IPriceFeed public immutable ETH_FEED_ASSET;\n\n    // Oracle for Pendle PtToken.\n    IOraclePendle public immutable ORACLE_PENDLE_PT;\n\n    // 10 ** Decimals of the feeds for AssetUSD.\n    uint256 public immutable POW_USD_FEED;\n\n    // 10 ** Decimals of the feeds for EthUSD.\n    uint256 public immutable POW_ETH_USD_FEED;\n\n    // Default decimals for the Feed.\n    uint8 internal constant FEED_DECIMALS = 18;\n\n    // Precision factor for computations.\n    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;\n\n    // -- Twap Duration --\n    uint32 public immutable TWAP_DURATION;\n\n    // -- Description --\n    string public name;\n\n    /**\n     * @dev Read function returning latest ETH value for PtToken.\n     * Uses answer from Usd chainLink pricefeed and combines it with\n     * the result from ethInUsd for one token of PtToken.\n     */\n    function latestAnswer()\n        public\n        view\n        returns (uint256)\n    {\n\n131: /**\n     * @dev Returns priceFeed decimals.\n     */\n    function decimals()\n        external\n        pure\n        returns (uint8)\n    {\n\n142: /**\n     * @dev Read function returning the latest\n     * answer so WiseOracleHub can fetch it properly.\n     */\n    function latestRoundData()\n        public\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L131",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L142"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n5: /**\n * @author René Hochmuth\n */\n\n/**\n * @dev PriceFeed contract for Pt-Token with USD\n * chainLink feed to get a feed measured in ETH.\n * Takes chainLink oracle value and multiplies it\n * with the corresponding TWAP and other chainLink oracles.\n */\n\nimport \"../InterfaceHub/IPriceFeed.sol\";\nimport \"../InterfaceHub/IOraclePendle.sol\";\n\nerror CardinalityNotSatisfied();\nerror OldestObservationNotSatisfied();\n\ncontract PtOraclePure {\n\n    constructor(\n        address _pendleMarketAddress,\n        IPriceFeed _priceFeedChainLinkEth,\n        IOraclePendle _oraclePendlePt,\n        string memory _oracleName,\n        uint32 _twapDuration\n    )\n    {\n        PENDLE_MARKET_ADDRESS = _pendleMarketAddress;\n\n        FEED_ASSET = _priceFeedChainLinkEth;\n        POW_FEED = 10 ** FEED_ASSET.decimals();\n\n        DURATION = _twapDuration;\n        ORACLE_PENDLE_PT = _oraclePendlePt;\n\n        name = _oracleName;\n    }\n\n    // Token interface\n    address public immutable PENDLE_MARKET_ADDRESS;\n\n    // Pricefeed for asset in ETH and TWAP for PtToken.\n    IPriceFeed public immutable FEED_ASSET;\n    IOraclePendle public immutable ORACLE_PENDLE_PT;\n\n    uint256 internal immutable POW_FEED;\n    uint8 internal constant FEED_DECIMALS = 18;\n\n    // Precision factor for computations.\n    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;\n\n    // -- Twap Duration --\n    uint32 public immutable DURATION;\n\n    // -- Description --\n    string public name;\n\n    /**\n     * @dev Read function returning latest ETH value for PtToken.\n     * Uses answer from Usd chainLink pricefeed and combines it with\n     * the result from ethInUsd for one token of PtToken.\n     */\n\n    function latestAnswer()\n        public\n        view\n        returns (uint256)\n    {\n\n110: /**\n     * @dev Returns priceFeed decimals.\n     */\n    function decimals()\n        external\n        pure\n        returns (uint8)\n    {\n\n121: /**\n     * @dev Read function returning the latest answer\n     * so wise oracle hub can fetch it\n     */\n    function latestRoundData()\n        public\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L110",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L121"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManager.sol\n\n5: /**\n * @author Christoph Krpoun\n * @author René Hochmuth\n * @author Vitally Marinchenko\n */\n\nimport \"./FeeManagerHelper.sol\";\n\n/**\n * @dev Purpose of this contract is to organize fee distribution from wiseLending.\n * The feeManager aquires fee token in form of shares from each pool and can call them\n * with \"claimWiseFees()\" for each pool.\n *\n * Furthermore, this contracts has two different incentive\n * structures which can be used to bootstrap the WISE ecosystem (beneficial and incnetiveOwner roles).\n *\n * Additionally, this contract keeps track of the bad debt of each postion and has a simple mechanism\n * to pay them back via incentives. The incentive amount is funded by the gathered fees.\n */\n\ncontract FeeManager is FeeManagerHelper {\n\n    constructor(\n        address _master,\n        address _aaveAddress,\n        address _wiseLendingAddress,\n        address _oracleHubAddress,\n        address _wiseSecurityAddress,\n        address _positionNFTAddress\n    )\n        DeclarationsFeeManager(\n            _master,\n            _aaveAddress,\n            _wiseLendingAddress,\n            _oracleHubAddress,\n            _wiseSecurityAddress,\n            _positionNFTAddress\n        )\n    {}\n\n    /**\n     * @dev Allows to adjust the paid out incentive\n     * percentage for user to reduce bad debt.\n     */\n    function setRepayBadDebtIncentive(\n        uint256 _percent\n    )\n        external\n        onlyMaster\n    {\n\n62: /**\n     * @dev Maps underlying token with corresponding aToken.\n     * Sets bool to identify pool token as aToken.\n     */\n    function setAaveFlag(\n        address _poolToken,\n        address _underlyingToken\n    )\n        external\n        onlyMaster\n    {\n\n79: /**\n     * @dev Bulk function for setting aave flag for multiple pools.\n     */\n    function setAaveFlagBulk(\n        address[] calldata _poolTokens,\n        address[] calldata _underlyingTokens\n    )\n        external\n        onlyMaster\n    {\n\n104: /**\n     * @dev Function to adjust pool fee. Fee can not be greater than 100%\n     * or lower than 1%. Can be adjusted for each pool individually.\n     */\n    function setPoolFee(\n        address _poolToken,\n        uint256 _newFee\n    )\n        external\n        onlyMaster\n    {\n\n131: /**\n    * @dev Function to adjust pool fees in bulk. Fee for each pool can not be\n    * greater than 100% or lower than 1%. Can be adjusted for each pool individually.\n    */\n    function setPoolFeeBulk(\n        address[] calldata _poolTokens,\n        uint256[] calldata _newFees\n    )\n        external\n        onlyMaster\n    {\n\n168: /**\n     * @dev Function to propose new incentive master. This role can increase\n     * the incentive amount for both incentive mappings. These are two roles\n     * for incentivising external persons e.g. developers.\n     */\n    function proposeIncentiveMaster(\n        address _proposedIncentiveMaster\n    )\n        external\n        onlyIncentiveMaster\n    {\n\n191: /**\n     * @dev Claim proposed incentive master by proposed entity.\n     */\n    function claimOwnershipIncentiveMaster()\n        external\n    {\n\n210: /**\n     * @dev Increase function for increasing incentive amount for entity A.\n     * Only callable by incentive master.\n     */\n    function increaseIncentiveA(\n        uint256 _value\n    )\n        external\n        onlyIncentiveMaster\n    {\n\n228: /**\n     * @dev Increase function for increasing incentive amount for entity B.\n     * Only callable by incentive master.\n     */\n    function increaseIncentiveB(\n        uint256 _value\n    )\n        external\n        onlyIncentiveMaster\n    {\n\n246: /**\n     * @dev Function to claim all gathered incetives.\n     */\n    function claimIncentivesBulk()\n        external\n    {\n\n281: /**\n     * @dev Claims gathered incentives for a specific token.\n     */\n    function claimIncentives(\n        address _feeToken\n    )\n        public\n    {\n\n311: /**\n     * @dev Function changing incentiveOwnerA! Only callable by\n     * incentiveOwnerA.\n     */\n    function changeIncentiveUSDA(\n        address _newOwner\n    )\n        external\n    {\n\n348: /**\n     * @dev Function changing incentiveOwnerB! Only callable by\n     * incentiveOwnerB.\n     */\n    function changeIncentiveUSDB(\n        address _newOwner\n    )\n        external\n    {\n\n385: /**\n     * @dev Function adding new pool token to pool token list.\n     * Called during pool creation and only callable by wiseLending\n     * contract.\n     */\n    function addPoolTokenAddress(\n        address _poolToken\n    )\n        external\n        onlyWiseLending\n    {\n\n408: /**\n     * @dev Function to add pool token manualy. Only\n     * callable by feeManager master.\n     */\n    function addPoolTokenAddressManual(\n        address _poolToken\n    )\n        external\n        onlyMaster\n    {\n\n434: /**\n     * @dev Function to remove pool token manualy from pool\n     * token list. Only callable by feeManager master.\n     */\n    function removePoolTokenManual(\n        address _poolToken\n    )\n        external\n        onlyMaster\n    {\n\n489: /**\n     * @dev Increase function for total bad debt of\n     * wiseLending. Only callable by wiseSecurity contract\n     * during liquidation.\n     */\n    function increaseTotalBadDebtLiquidation(\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n\n510: /**\n     * @dev Increase function for bad debt of a position.\n     * Only callable by wiseSecurity contract during liquidation.\n     */\n    function setBadDebtUserLiquidation(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        external\n        onlyWiseSecurity\n    {\n\n533: /**\n     * @dev Set function to declare an address as beneficial for\n     * a fee token. Address can claim gathered fee token as long as\n     * it is declared as beneficial. Only setable by master.\n     */\n    function setBeneficial(\n        address _user,\n        address[] calldata _feeTokens\n    )\n        external\n        onlyMaster\n    {\n\n567: /**\n     * @dev Set function to remove an address as beneficial for\n     * a fee token. Only setable by master.\n     */\n    function revokeBeneficial(\n        address _user,\n        address[] memory _feeTokens\n    )\n        external\n        onlyMaster\n    {\n\n600: /**\n     * @dev Claim all fees from wiseLending and send them to feeManager.\n     */\n    function claimWiseFeesBulk()\n        external\n    {\n\n624: /**\n     * @dev Claim fees from wiseLending and send them to feeManager for\n     * a specific pool.\n     */\n    function claimWiseFees(\n        address _poolToken\n    )\n        public\n    {\n\n684: /**\n     * @dev Function for beneficial to claim gathered fees. Can only\n     * claim fees for which the beneficial is allowed. Can only claim\n     * token which are inside the feeManager.\n     */\n    function claimFeesBeneficial(\n        address _feeToken,\n        uint256 _amount\n    )\n        external\n    {\n\n724: /**\n     * @dev Function for paying back bad debt of a position. Caller\n     * chooses postion, token and receive token. Only gathered fee token\n     * can be distributed as receive token. Caller gets 5% more\n     * in ETH value as incentive.\n     */\n    function paybackBadDebtForToken(\n        uint256 _nftId,\n        address _paybackToken,\n        address _receivingToken,\n        uint256 _shares\n    )\n        external\n        returns (\n            uint256 paybackAmount,\n            uint256 receivingAmount\n        )\n    {\n\n811: /**\n     * @dev Function for paying back bad debt of a position. Caller\n     * chooses postion, token and receive token. Caller gets no\n     * receive token!\n     */\n    function paybackBadDebtNoReward(\n        uint256 _nftId,\n        address _paybackToken,\n        uint256 _shares\n    )\n        external\n        returns (uint256 paybackAmount)\n    {\n\n868: /**\n     * @dev Returning the number of pool token\n     * addresses saved inside the feeManager.\n     */\n    function getPoolTokenAddressesLength()\n        public\n        view\n        returns (uint256)\n    {\n\n880: /**\n     * @dev Returns the pool token address\n     * at the _index postion of the array.\n     */\n    function getPoolTokenAdressesByIndex(\n        uint256 _index\n    )\n        external\n        view\n        returns (address)\n    {\n\n894: /**\n     * @dev Bulk function for updating pools - loops through\n     * all pools saved inside the poolTokenAddresses array.\n     */\n    function syncAllPools()\n        external\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L62",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L79",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L104",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L131",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L168",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L191",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L210",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L228",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L246",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L281",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L311",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L348",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L385",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L408",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L434",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L489",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L510",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L533",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L567",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L600",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L624",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L684",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L724",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L811",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L868",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L880",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L894"
          ]
        },
        {
          "content": "```solidity\n\nFile: FeeManagerHelper.sol\n\n10: /**\n     * @dev Internal update function which adds latest aquired token from borrow rate\n     * for all borrow tokens of the position. Idnetical implementation like in wiseSecurity\n     * or wiseLending.\n     */\n    function _prepareBorrows(\n        uint256 _nftId\n    )\n        internal\n    {\n\n42: /**\n     * @dev Internal update function which adds latest aquired token from borrow rate\n     * for all collateral tokens of the position. Idnetical implementation like in wiseSecurity\n     * or wiseLending.\n     */\n    function _prepareCollaterals(\n        uint256 _nftId\n    )\n        internal\n    {\n\n74: /**\n     * @dev Internal set function for adjusting bad debt amount of a position.\n     */\n    function _setBadDebtPosition(\n        uint256 _nftId,\n        uint256 _amount\n    )\n        internal\n    {\n\n86: /**\n     * @dev Internal increase function for global bad debt amount.\n     */\n    function _increaseTotalBadDebt(\n        uint256 _amount\n    )\n        internal\n    {\n\n102: /**\n     * @dev Internal decrease function for global bad debt amount.\n     */\n    function _decreaseTotalBadDebt(\n        uint256 _amount\n    )\n        internal\n    {\n\n118: /**\n     * @dev Internal erease function to delete bad debt amount of a postion.\n     */\n    function _eraseBadDebtUser(\n        uint256 _nftId\n    )\n        internal\n    {\n\n129: /**\n     * @dev Internal function updating bad debt amount of a position and global one (in ETH).\n     * Compares totalBorrow and totalCollateral of the postion in ETH and adjustes bad debt\n     * variables. Pseudo pool amounts needed to be updated before this function is called.\n     */\n    function _updateUserBadDebt(\n        uint256 _nftId\n    )\n        internal\n    {\n\n191: /**\n     * @dev Internal increase function for tracking gathered fee token. No need for\n     * balanceOf() checks.\n     */\n    function _increaseFeeTokens(\n        address _feeToken,\n        uint256 _amount\n    )\n        internal\n    {\n\n204: /**\n     * @dev Internal decrease function for tracking gathered fee token. No need for\n     * balanceOf() checks.\n     */\n    function _decreaseFeeTokens(\n        address _feeToken,\n        uint256 _amount\n    )\n        internal\n    {\n\n217: /**\n     * @dev Internal function to set benefical mapping for a certain token.\n     */\n    function _setAllowedTokens(\n        address _user,\n        address _feeToken,\n        bool _state\n    )\n        internal\n    {\n\n240: /**\n     * @dev Internal function calculating receive amount for the caller.\n     * paybackIncentive is set to 5E16 => 5% incentive for paying back bad debt.\n     */\n    function getReceivingToken(\n        address _paybackToken,\n        address _receivingToken,\n        uint256 _paybackAmount\n    )\n        public\n        view\n        returns (uint256 receivingAmount)\n    {\n\n266: /**\n     * @dev Updates bad debt of a postion. Combines preparation of all\n     * collaterals and borrows for passed _nftId with _updateUserBadDebt().\n     */\n    function updatePositionCurrentBadDebt(\n        uint256 _nftId\n    )\n        public\n    {\n\n288: /**\n     * @dev Internal function for distributing incentives to incentiveOwnerA\n     * and incentiveOwnerB.\n     */\n    function _distributeIncentives(\n        uint256 _amount,\n        address _poolToken,\n        address _underlyingToken\n    )\n        internal\n        returns (uint256)\n    {\n\n325: /**\n     * @dev Internal function computing the incentive amount for an incentiveOwner\n     * depending of the amount per fee token. Reduces the open incentive amount for\n     * the owner.\n     */\n    function _gatherIncentives(\n        address _poolToken,\n        address _underlyingToken,\n        address _incentiveOwner,\n        uint256 _amount\n    )\n        internal\n        returns (uint256)\n    {\n\n379: /**\n     * @dev Internal function checking if the\n     * passed value is smaller 100% and bigger 1%.\n     */\n    function _checkValue(\n        uint256 _value\n    )\n        internal\n        pure\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L10",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L42",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L74",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L86",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L102",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L118",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L129",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L191",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L204",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L217",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L240",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L266",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L288",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L325",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L379"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarm.sol\n\n9: /**\n     * @dev External view function approximating the\n     * new resulting net APY for a position setup.\n     *\n     * Note: Not 100% accurate because no syncPool is performed.\n     */\n    function getApproxNetAPY(\n        uint256 _initialAmount,\n        uint256 _leverage,\n        uint256 _pendleChildApy\n    )\n        external\n        view\n        returns (\n            uint256,\n            bool\n        )\n    {\n\n34: /**\n     * @dev External view function approximating the\n     * new borrow amount for the pool when {\n\n53: /**\n     * @dev View functions returning the current\n     * debt ratio of the postion with {\n\n89: /**\n     * @dev Liquidation function for open power farm\n     * postions which have a debtratio greater than 100%.\n     */\n    function liquidatePartiallyFromToken(\n        uint256 _nftId,\n        uint256 _nftIdLiquidator,\n        uint256 _shareAmountToPay\n    )\n        external\n        updatePools\n        returns (\n            uint256 paybackAmount,\n            uint256 receivingAmount\n        )\n    {\n\n112: /**\n     * @dev Manually payback function for users. Takes\n     * {\n\n150: /**\n     * @dev Manually withdraw function for users. Takes\n     * {\n\n181: /**\n     * @dev Internal function combining the core\n     * logic for {\n\n221: /**\n     * @dev Internal function combining the core\n     * logic for {\n\n181: /**\n     * @dev Internal function combining the core\n     * logic for {\n\n221: /**\n     * @dev Internal function combining the core\n     * logic for {\n\n270: /**\n     * @dev Makes a call to WISE_LENDING to\n     * register {_nftId} for specific farm use.\n     */\n    function _registrationFarm(\n        uint256 _nftId\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L34",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L53",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L89",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L112",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L150",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L181",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L221",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L181",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L221",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L270"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmLeverageLogic.sol\n\n11: /**\n     * @dev Wrapper function preparing balancer flashloan and\n     * loading data to pass into receiver.\n     */\n    function _executeBalancerFlashLoan(\n        uint256 _nftId,\n        uint256 _flashAmount,\n        uint256 _initialAmount,\n        uint256 _lendingShares,\n        uint256 _borrowShares,\n        uint256 _allowedSpread,\n        bool _ethBack,\n        bool _isAave\n    )\n        internal\n    {\n\n54: /**\n     * @dev Receive function from balancer flashloan. Body\n     * is called from balancer at the end of their {\n\n131: /**\n     * @dev Closes position using balancer flashloans.\n     */\n    function _logicClosePosition(\n        uint256 _nftId,\n        uint256 _borrowShares,\n        uint256 _lendingShares,\n        uint256 _totalDebtBalancer,\n        uint256 _allowedSpread,\n        address _caller,\n        bool _ethBack,\n        bool _isAave\n    )\n        private\n    {\n\n289: /**\n     * @dev Internal wrapper function for curve swap\n     * of stETH into ETH.\n     */\n    function _swapStETHintoETH(\n        uint256 _swapAmount,\n        uint256 _minOutAmount\n    )\n        internal\n        returns (uint256)\n    {\n\n350: /**\n     * @dev Internal wrapper function for a closing route\n     * which returns {\n\n379: /**\n     * @dev Internal wrapper function for a closing route\n     * which returns ETH to the owner in the end.\n     */\n    function _closingRouteETH(\n        uint256 _ethAmount,\n        uint256 _totalDebtBalancer,\n        address _caller\n    )\n        internal\n    {\n\n407: /**\n     * @dev Internal function executing the\n     * collateral deposit by converting ETH\n     * into {\n\n555: /**\n     * @dev Internal function summarizing liquidation\n     * checks and interface call for core liquidation\n     * from wise lending.\n     */\n    function _coreLiquidation(\n        uint256 _nftId,\n        uint256 _nftIdLiquidator,\n        uint256 _shareAmountToPay\n    )\n        internal\n        returns (\n            uint256 paybackAmount,\n            uint256 receivingAmount\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L54",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L131",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L289",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L350",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L379",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L407",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L555"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmMathLogic.sol\n\n15: /**\n     * @dev Update logic for pools via wise lending\n     * interfaces\n     */\n    function _updatePools()\n        private\n    {\n\n52: /**\n     * @dev Internal function getting the\n     * borrow shares from position {\n\n70: /**\n     * @dev Internal function getting the\n     * borrow shares of aave from position {\n\n88: /**\n     * @dev Internal function converting\n     * borrow shares into tokens.\n     */\n    function _getPositionBorrowTokenAmount(\n        uint256 _nftId\n    )\n        internal\n        view\n        returns (uint256 tokenAmount)\n    {\n\n131: /**\n     * @dev Internal function getting the\n     * lending shares from position {\n\n149: /**\n     * @dev Internal function converting\n     * lending shares into tokens.\n     */\n    function _getPostionCollateralTokenAmount(\n        uint256 _nftId\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n170: /**\n     * @dev Read function returning the total\n     * borrow amount in ETH from postion {\n\n225: /**\n     * @dev Read function returning the total\n     * lending amount in ETH from postion {\n\n285: /**\n     * @dev Internal function with math logic for approximating\n     * the net APY for the postion aftrer creation.\n     */\n    function _getApproxNetAPY(\n        uint256 _initialAmount,\n        uint256 _leverage,\n        uint256 _wstETHAPY\n    )\n        internal\n        view\n        returns (\n            uint256,\n            bool\n        )\n    {\n\n340: /**\n     * @dev Internal function with math logic for approximating\n     * the new borrow APY.\n     */\n    function _getNewBorrowRate(\n        uint256 _borrowAmount\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n385: /**\n     * @dev Internal function checking if a position\n     * with {\n\n412: /**\n     * @dev Internal function checking if the leveraged\n     * amount not below {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L15",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L52",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L70",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L88",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L131",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L149",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L170",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L225",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L285",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L340",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L385",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L412"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n5: /**\n * @author René Hochmuth\n * @author Christoph Krpoun\n * @author Vitally Marinchenko\n */\n\nimport \"./PendlePowerFarm.sol\";\nimport \"../../OwnableMaster.sol\";\nimport \"../PowerFarmNFTs/MinterReserver.sol\";\n\ncontract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {\n\n    /**\n     * @dev Standard receive functions forwarding\n     * directly send ETH to the master address.\n     */\n    receive()\n        external\n        payable\n    {\n\n77: /**\n     * @dev External function deactivating the power farm by\n     * disableing the openPosition function. Allowing user\n     * to manualy payback and withdraw.\n     */\n    function shutDownFarm(\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L77"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n361: /**\n     * @dev Can also be used to extend existing lock.\n     */\n    function lockPendle(\n        uint256 _amount,\n        uint128 _weeks,\n        bool _fromInside,\n        bool _sameExpiry\n    )\n        external\n        onlyMaster\n        returns (uint256 newVeBalance)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L361"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n526: /**\n     * @dev External wrapper for mint function.\n     */\n    function depositExactAmount(\n        uint256 _underlyingLpAssetAmount\n    )\n        external\n        syncSupply\n        returns (\n            uint256,\n            uint256\n        )\n    {\n\n605: /**\n     * @dev External wrapper for burn function.\n     */\n    function withdrawExactShares(\n        uint256 _shares\n    )\n        external\n        syncSupply\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L526",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L605"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n62: /**\n     * @dev Mints farming NFT, later to be sent\n     * to the user representing his farming position\n     */\n    function mintKey(\n        address _keyOwner,\n        uint256 _keyId\n    )\n        external\n        onlyFarmContract\n    {\n\n79: /**\n     * @dev Burns farming NFT\n     */\n    function burnKey(\n        uint256 _keyId\n    )\n        external\n        onlyFarmContract\n    {\n\n106: /**\n     * @dev Returns positions of owner\n     */\n    function walletOfOwner(\n        address _owner\n    )\n        external\n        view\n        returns (uint256[] memory)\n    {\n\n158: /**\n     * @dev Allows to update base target for MetaData.\n     */\n    function setBaseURI(\n        string calldata _newBaseURI\n    )\n        external\n        onlyMaster\n    {\n\n179: /**\n     * @dev Returns path to MetaData URI\n     */\n    function tokenURI(\n        uint256 _tokenId\n    )\n        public\n        view\n        override\n        returns (string memory)\n    {\n\n210: /**\n     * @dev Converts tokenId uint to string.\n     */\n    function _toString(\n        uint256 _tokenId\n    )\n        internal\n        pure\n        returns (string memory str)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L62",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L79",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L106",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L158",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L179",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L210"
          ]
        },
        {
          "content": "```solidity\n\nFile: ApprovalHelper.sol\n\n9: /**\n     * @dev\n     * Allows to execute safe approve for a token\n     */\n    function _safeApprove(\n        address _token,\n        address _spender,\n        uint256 _value\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: CallOptionalReturn.sol\n\n9: /**\n     * @dev Helper function to do low-level call\n     */\n    function _callOptionalReturn(\n        address token,\n        bytes memory data\n    )\n        internal\n        returns (bool call)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: TransferHelper.sol\n\n9: /**\n     * @dev\n     * Allows to execute safe transfer for a token\n     */\n    function _safeTransfer(\n        address _token,\n        address _to,\n        uint256 _value\n    )\n        internal\n    {\n\n30: /**\n     * @dev\n     * Allows to execute safe transferFrom for a token\n     */\n    function _safeTransferFrom(\n        address _token,\n        address _from,\n        address _to,\n        uint256 _value\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L30"
          ]
        },
        {
          "content": "```solidity\n\nFile: WrapperHelper.sol\n\n20: /**\n     * @dev Wrapper for wrapping\n     * ETH call.\n     */\n    function _wrapETH(\n        uint256 _value\n    )\n        internal\n    {\n\n34: /**\n     * @dev Wrapper for unwrapping\n     * ETH call.\n     */\n    function _unwrapETH(\n        uint256 _value\n    )\n        internal\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L20",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n9: /**\n     * @dev Adds priceFeed for a given token.\n     */\n    function _addOracle(\n        address _tokenAddress,\n        IPriceFeed _priceFeedAddress,\n        address[] calldata _underlyingFeedTokens\n    )\n        internal\n    {\n\n102: /**\n     * @dev Returns Twaps latest USD value\n     * by passing the underlying token address.\n     */\n    function latestResolverTwap(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n176: /**\n     * @dev Adds uniTwapPoolInfo for a given token.\n     */\n    function _writeUniTwapPoolInfoStruct(\n        address _tokenAddress,\n        address _oracle,\n        bool _isUniPool\n    )\n        internal\n    {\n\n192: /**\n     * @dev Adds uniTwapPoolInfo for a given token and its derivative.\n     */\n    function _writeUniTwapPoolInfoStructDerivative(\n        address _tokenAddress,\n        address _partnerTokenAddress,\n        address _oracleAddress,\n        address _partnerOracleAddress,\n        bool _isUniPool\n    )\n        internal\n    {\n\n279: /**\n    * @dev Retrieves the pool address for given\n    * tokens and fee from Uniswap V3 Factory.\n    */\n    function _getPool(\n        address _token0,\n        address _token1,\n        uint24 _fee\n    )\n        internal\n        view\n        returns (address pool)\n    {\n\n299: /**\n    * @dev Validates if the given token address\n    * is one of the two specified token addresses.\n    */\n    function _validateTokenAddress(\n        address _tokenAddress,\n        address _token0,\n        address _token1\n    )\n        internal\n        pure\n    {\n\n320: /**\n    * @dev Validates if the given pool\n    * address matches the expected pool address.\n    */\n    function _validatePoolAddress(\n        address _pool,\n        address _expectedPool\n    )\n        internal\n        pure\n    {\n\n340: /**\n    * @dev Validates if the price feed for\n    * a given token address is set.\n    */\n    function _validatePriceFeed(\n        address _tokenAddress\n    )\n        internal\n        view\n    {\n\n355: /**\n    * @dev Validates if the TWAP oracle for\n    * a given token address is already set.\n    */\n    function _validateTwapOracle(\n        address _tokenAddress\n    )\n        internal\n        view\n    {\n\n370: /**\n     * @dev Returns twapPrice by passing\n     * the underlying token address.\n     */\n    function _getTwapPrice(\n        address _tokenAddress,\n        address _oracle\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n446: /**\n     * @dev Returns priceFeed decimals by\n     * passing the underlying token address.\n     */\n    function decimals(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (uint8)\n    {\n\n503: /**\n     * @dev Stores expected heartbeat\n     * value for a pricing feed token.\n     */\n    function _recalibrate(\n        address _tokenAddress\n    )\n        internal\n    {\n\n517: /**\n     * @dev Check if chainLink\n     * squencer is wroking.\n     */\n    function sequencerIsDead()\n        public\n        view\n        returns (bool)\n    {\n\n551: /**\n     * @dev Check if chainLink feed was\n     * updated within expected timeFrame\n     * for single {_tokenAddress}.\n     */\n    function _chainLinkIsDead(\n        address _tokenAddress\n    )\n        internal\n        view\n        returns (bool)\n    {\n\n588: /**\n     * @dev Recalibrates expected\n     * heartbeat for a pricing feed.\n     */\n    function _recalibratePreview(\n        address _tokenAddress\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n654: /**\n     * @dev Determines number of iterations\n     * needed during heartbeat recalibration.\n     */\n    function _getIterationCount(\n        uint80 _latestAggregatorRoundId\n    )\n        internal\n        pure\n        returns (uint80 res)\n    {\n\n670: /**\n     * @dev Fetches timestamp of a byteshifted\n     * aggregatorRound with specific _roundId.\n     */\n    function _getRoundTimestamp(\n        address _tokenAddress,\n        uint80 _roundId\n    )\n        internal\n        view\n        returns (uint256)\n    {\n\n695: /**\n     * @dev Routing latest round data from chainLink.\n     * Returns latestRoundData by passing underlying token address.\n     */\n    function getLatestRoundId(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (\n            uint80 roundId\n        )\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L102",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L176",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L192",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L279",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L299",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L320",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L340",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L355",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L370",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L446",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L503",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L517",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L551",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L588",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L654",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L670",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L695"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseOracleHub.sol\n\n5: /**\n * @author René Hochmuth\n * @author Christoph Krpoun\n * @author Vitally Marinchenko\n */\n\nimport \"./OracleHelper.sol\";\n\n/**\n * @dev WiseOracleHub is an onchain extension for price feeds (chainLink or others).\n * The master address is owned by a timelock contract which itself is secured by a\n * multisig. Only the master can add new price feed <-> address pairs to the contract.\n *\n * One advantage is the linking of price feeds to their underlying token address.\n * Therefore, users can get the current ETH value of a token by just knowing the token\n * address when calling {latestResolver}. It takes the answer from {latestRoundData}\n * for chainLink oracles as recommended from chainLink.\n *\n * NOTE: If you want to propose adding an own developed price feed it is\n * mandatory to wrap its answer into a function mimicking {\n\n65: /**\n     * @dev Returns priceFeed latest ETH value\n     * by passing the underlying token address.\n     */\n    function latestResolver(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n119: /**\n     * @dev Returns USD value of a given token\n     * amount in order of 1E18 decimal precision.\n     */\n    function getTokensPriceInUSD(\n        address _tokenAddress,\n        uint256 _tokenAmount\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n139: /**\n     * @dev Returns ETH value of a given token\n     * amount in order of 1E18 decimal precision.\n     */\n    function getTokensInETH(\n        address _tokenAddress,\n        uint256 _tokenAmount\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n194: /**\n     * @dev Converts USD value of a token into token amount with a\n     * current price. The order of the argument _usdValue is 1E18.\n     */\n    function getTokensPriceFromUSD(\n        address _tokenAddress,\n        uint256 _usdValue\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n214: /**\n     * @dev Adds a new token address to the oracleHub Twap.\n     * Can't overwrite existing mappings.\n     */\n    function addTwapOracle(\n        address _tokenAddress,\n        address _uniPoolAddress,\n        address _token0,\n        address _token1,\n        uint24 _fee\n    )\n        external\n        onlyMaster\n    {\n\n262: /**\n     * @dev Adds a new token address to TWAP as derivative.\n     * Not permitted to overwrite existing mappings.\n     */\n    function addTwapOracleDerivative(\n        address _tokenAddress,\n        address _partnerTokenAddress,\n        address[2] calldata _uniPools,\n        address[2] calldata _token0Array,\n        address[2] calldata _token1Array,\n        uint24[2] calldata _feeArray\n    )\n        external\n        onlyMaster\n    {\n\n323: /**\n     * @dev Converts ETH value of a token into token amount with a\n     * current price. The order of the argument _ethAmount is 1E18.\n     */\n    function getTokensFromETH(\n        address _tokenAddress,\n        uint256 _ethAmount\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n354: /**\n     * @dev Adds priceFeed for a token.\n     * Can't overwrite existing mappings.\n     * Master is a timelock contract.\n     */\n    function addOracle(\n        address _tokenAddress,\n        IPriceFeed _priceFeedAddress,\n        address[] calldata _underlyingFeedTokens\n    )\n        external\n        onlyMaster\n    {\n\n374: /**\n     * @dev Adds priceFeeds for tokens.\n     * Can't overwrite existing mappings.\n     * Master is a timelock contract.\n     */\n    function addOracleBulk(\n        address[] calldata _tokenAddresses,\n        IPriceFeed[] calldata _priceFeedAddresses,\n        address[][] calldata _underlyingFeedTokens\n    )\n        external\n        onlyMaster\n    {\n\n414: /**\n     * @dev Looks at the maximal last 50 rounds and\n     * takes second highest value to avoid counting\n     * offline time of chainlink as valid heartbeat.\n     */\n    function recalibratePreview(\n        address _tokenAddress\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n431: /**\n     * @dev Check if chainLink feed was\n     * updated within expected timeFrame.\n     * If length of {underlyingFeedTokens}\n     * is greater than zero it checks the\n     * heartbeat of all base feeds of the\n     * derivate oracle.\n     */\n    function chainLinkIsDead(\n        address _tokenAddress\n    )\n        public\n        view\n        returns (bool state)\n    {\n\n483: /**\n     * @dev Recalibrates expected\n     * heartbeat for a pricing feed.\n     */\n    function recalibrate(\n        address _tokenAddress\n    )\n        external\n    {\n\n497: /**\n     * @dev Bulk function to recalibrate\n     * the heartbeat for several tokens.\n     */\n    function recalibrateBulk(\n        address[] calldata _tokenAddresses\n    )\n        external\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L65",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L119",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L139",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L194",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L214",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L262",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L323",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L354",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L374",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L414",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L431",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L483",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L497"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n5: /**\n * @author Christoph Krpoun\n * @author René Hochmuth\n * @author Vitally Marinchenko\n */\n\nimport \"./WiseSecurityHelper.sol\";\nimport \"../TransferHub/ApprovalHelper.sol\";\n\n/**\n * @dev WiseSecurity is a core contract for wiseLending including most of\n * the performed security checks for withdraws, borrows, paybacks and liquidations.\n * It also has several read only functions providing UI data for a better user\n * experiencne.\n *\n */\n\nerror NotWiseLendingSecurity();\n\ncontract WiseSecurity is WiseSecurityHelper, ApprovalHelper {\n\n54: /**\n     * @dev View functions returning current\n     * debt ratio of a postion in normal mode.\n     * 1% <=> 1E16\n     */\n    function getLiveDebtRatio(\n        uint256 _nftId\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n79: /**\n     * @dev Set Liquidation incentives and boundaries\n     * for liquidation. Only callable by the master.\n     * Assures liquidation cascade cannot be self imposed\n     * by limiting incentives.\n     */\n    function setLiquidationSettings(\n        uint256 _baseReward,\n        uint256 _baseRewardFarm,\n        uint256 _newMaxFeeETH,\n        uint256 _newMaxFeeFarmETH\n    )\n        external\n        onlyMaster\n    {\n\n102: /**\n     * @dev Checks for liquidation logic.\n     */\n    function checksLiquidation(\n        uint256 _nftIdLiquidate,\n        address _tokenToPayback,\n        uint256 _shareAmountToPay\n    )\n        external\n        view\n    {\n\n139: /**\n     * @dev Set function for preparing curve pools.\n     */\n    function prepareCurvePools(\n        address _poolToken,\n        CurveSwapStructData calldata _curveSwapStructData,\n        CurveSwapStructToken calldata _curveSwapStructToken\n    )\n        external\n        onlyWiseLending\n    {\n\n189: /**\n     * @dev Reentrency guard for curve pools. Forces\n     * a swap to update internal curve values.\n     */\n    function curveSecurityCheck(\n        address _poolToken\n    )\n        external\n        onlyWiseLending\n    {\n\n234: /**\n     * @dev Checks for withdraw logic.\n     */\n    function checksWithdraw(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken\n    )\n        external\n        view\n        returns (bool specialCase)\n    {\n\n272: /**\n     * @dev Checks for solely withdraw logic.\n     */\n    function checksSolelyWithdraw(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken\n    )\n        external\n        view\n        returns (bool specialCase)\n    {\n\n303: /**\n     * @dev Checks for borrow logic.\n     */\n    function checksBorrow(\n        uint256 _nftId,\n        address _caller,\n        address _poolToken\n    )\n        external\n        view\n        returns (bool specialCase)\n    {\n\n332: /**\n     * @dev Checks for collateralize deposit logic.\n     */\n    function checksCollateralizeDeposit(\n        uint256 _nftId,\n        address _caller,\n        address _poolAddress\n    )\n        external\n        view\n    {\n\n357: /**\n     * @dev Checks for uncollateralized deposit logic.\n     */\n    function checkUncollateralizedDeposit(\n        uint256 _nftId,\n        address _poolToken\n    )\n        external\n        view\n    {\n\n384: /**\n     * @dev Checks if user has healthy position.\n     */\n\n    function checkHealthState(\n        uint256 _nftId,\n        bool _isPowerFarm\n    )\n        external\n        view\n    {\n\n401: /**\n     * @dev Checks for bad debt logic. Compares\n     * total ETH of borrow and collateral.\n     */\n    function checkBadDebtLiquidation(\n        uint256 _nftId\n    )\n        external\n        onlyWiseLending\n    {\n\n438: /**\n     * @dev View function returning weighted\n     * supply APY of a postion. 1% <=> 1E16\n     */\n    function overallLendingAPY(\n        uint256 _nftId\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n495: /**\n     * @dev View function returning weighted\n     * borrow APY of a postion. 1% <=> 1E16\n     */\n    function overallBorrowAPY(\n        uint256 _nftId\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n552: /**\n     * @dev View function returning the total\n     * net APY of a postion. 1% <=> 1E16\n     */\n    function overallNetAPY(\n        uint256 _nftId\n    )\n        external\n        view\n        returns (uint256, bool)\n    {\n\n637: /**\n     * @dev View function claculating the open\n     * amount a postion is allowed to borrow.\n     */\n    function safeLimitPosition(\n        uint256 _nftId\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n691: /**\n     * @dev View function checking if the postion is\n     * locked due to blacklisted token.\n     */\n    function positionBlackListToken(\n        uint256 _nftId\n    )\n        external\n        view\n        returns (bool, address)\n    {\n\n759: /**\n     * @dev View function extrapolating the\n     * possible withdraw amount of a postion\n     * for a specific _poolToken.\n     */\n    function maximumWithdrawToken(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _interval,\n        uint256 _solelyWithdrawAmount\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n821: /**\n     * @dev View function extrapolating the\n     * possible withdraw amount of a private\n     * postion for a specific _poolToken.\n     */\n    function maximumWithdrawTokenSolely(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _interval,\n        uint256 _poolWithdrawAmount\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n863: /**\n     * @dev View function extrapolating the\n     * possible borrow amount of postion for\n     * a specific _poolToken.\n     */\n    function maximumBorrowToken(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _interval\n    )\n        external\n        view\n        returns (uint256 tokenAmount)\n    {\n\n901: /**\n     * @dev View function extrapolating the\n     * possible payback amount of a position\n     * for a specific _poolToken.\n     */\n    function getExpectedPaybackAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _interval\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n938: /**\n     * @dev View function extrapolating the\n     * possible lending amount of a position\n     * for a specific _poolToken.\n     */\n    function getExpectedLendingAmount(\n        uint256 _nftId,\n        address _poolToken,\n        uint256 _interval\n    )\n        public\n        view\n        returns (uint256)\n    {\n\n975: /**\n     * @dev Set function for blacklisting token.\n     * Those token can not be borrowed or used as\n     * collateral anymore. Only callable by master.\n     */\n    function setBlacklistToken(\n        address _tokenAddress,\n        bool _state\n    )\n        external\n        onlyMaster()\n    {\n\n990: /**\n     * @dev Set function for adding or removing\n     * workers to perform a security shutdown.\n     * Only callable by the master.\n     */\n    function setSecurityWorker(\n        address _entitiy,\n        bool _state\n    )\n        external\n        onlyMaster\n    {\n\n1028: /**\n     * @dev Master function to revoke all locks,\n     * only callable by the master.\n     */\n    function revokeShutdown()\n        external\n        onlyMaster\n    {\n\n1041: /**\n     * @dev External wrapper for pool condition\n     * check.\n     */\n    function checkPoolCondition(\n        address _token\n    )\n        external\n        view\n    {\n\n1056: /**\n     * @dev External wrapper for pool condition\n     * check.\n     */\n    function checkPoolWithMinDeposit(\n        address _token,\n        uint256 _amount\n    )\n        external\n        view\n        returns (bool)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L54",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L79",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L102",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L139",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L189",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L234",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L272",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L303",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L332",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L357",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L384",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L401",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L438",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L495",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L552",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L637",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L691",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L759",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L821",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L863",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L901",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L938",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L975",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L990",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1028",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1041",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1056"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityHelper.sol\n\n9: /**\n     * @dev Read function returning weighted and\n     * and unweighted total collateral of a\n     * postion with {\n\n61: /**\n     * @dev Read function returning weighted\n     *  total collateral of a postion with {\n\n102: /**\n     * @dev Read function returning unweighted\n     *  total collateral of a postion with {\n\n139: /**\n     * @dev Internal calculation function returning\n     * the updated weighted collateral amount of a\n     * postion with {\n\n184: /**\n     * @dev Read function returning the full bare\n     * collateral amount of a {\n\n220: /**\n     * @dev Wrapper function checking if a supplied\n     * fund is uncollateralized.\n     */\n    function _isUncollateralized(\n        uint256 _nftId,\n        address _poolToken\n    )\n        internal\n        view\n        returns (bool)\n    {\n\n238: /**\n     * @dev Read function returning the full\n     * collateral amount of a {\n\n274: /**\n     * @dev Read function returning the full\n     * (private and public) collateral amount\n     * of a {\n\n318: /**\n     * @dev Read function returning the public\n     * collateral amount of a {\n\n354: /**\n     * @dev Read function returning the total\n     * borrow amount of a postion with {\n\n388: /**\n     * @dev Read function returning the total\n     * borrow amount of a postion with {\n\n426: /**\n     * @dev Read function returning the total\n     * borrow amount of a postion with {\n\n354: /**\n     * @dev Read function returning the total\n     * borrow amount of a postion with {\n\n388: /**\n     * @dev Read function returning the total\n     * borrow amount of a postion with {\n\n426: /**\n     * @dev Read function returning the total\n     * borrow amount of a postion with {\n\n354: /**\n     * @dev Read function returning the total\n     * borrow amount of a postion with {\n\n388: /**\n     * @dev Read function returning the total\n     * borrow amount of a postion with {\n\n426: /**\n     * @dev Read function returning the total\n     * borrow amount of a postion with {\n\n466: /**\n     * @dev Internal function combining hearbeat\n     * and blacklisted checks.\n     */\n    function _checkBlacklisted(\n        address _poolToken\n    )\n        internal\n        view\n        returns (bool)\n    {\n\n480: /**\n     * @dev Read function returning the total\n     * updated current borrow amount of a\n     * postion with {\n\n524: /**\n     * @dev Internal function calculating\n     * the updated pseudo borrow amount of\n     * {\n\n548: /**\n     * @dev Internal function calculating\n     * the updated pseudo lending amount of\n     * {\n\n572: /**\n     * @dev Internal math function calculating\n     * the accumulated interest amount for\n     * {\n\n603: /**\n     * @dev Read function returning the full\n     * borrow amount of a {\n\n647: /**\n     * @dev Read function returning the borow\n     * amount of a {\n\n668: /**\n     * @dev Read function checking if\n     * {\n\n683: /**\n     * @dev Check if chainLink feed was\n     * updated within expected timeframe\n     */\n    function checkHeartbeat(\n        address _poolToken\n    )\n        public\n        view\n        returns (bool)\n    {\n\n697: /**\n     * @dev Check if the postion with\n     * {_nftId} is locked for interactions.\n     */\n    function _checkPositionLocked(\n        uint256 _nftId\n    )\n        internal\n        view\n    {\n\n712: /**\n     * @dev Wrapper function for external\n     * {\n\n732: /**\n     * @dev Returning the possible fee\n     * for liquidation.\n     */\n    function _checkMaxFee(\n        uint256 _paybackETH,\n        uint256 _liquidationFee,\n        uint256 _maxFeeETH\n    )\n        internal\n        pure\n        returns (uint256)\n    {\n\n754: /**\n     * @dev Math function computing the\n     * percentage of the receiving token\n     * which the liquidator receivs for\n     * liquidation.\n     */\n    function calculateWishPercentage(\n        uint256 _nftId,\n        address _receiveToken,\n        uint256 _paybackETH,\n        uint256 _maxFeeETH,\n        uint256 _baseRewardLiquidation\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n788: /**\n     * @dev Check function for withdraw flow.\n     * Tests if debt ratio is not greater than\n     * 100% after withdraw of {\n\n832: /**\n     * @dev Check function for registration\n     * of power farms. User can only register\n     * when the postion is empty!\n     */\n    function checksRegister(\n        uint256 _nftId,\n        address _caller\n    )\n        public\n        view\n    {\n\n854: /**\n     * @dev Pure math function comparing\n     * borrow and collateral amount for\n     * liquidation.\n     */\n    function canLiquidate(\n        uint256 _borrowETHTotal,\n        uint256 _weightedCollateralETH\n    )\n        public\n        pure\n    {\n\n871: /**\n     * @dev Helper function for liquidation checking\n     * return amount of receiving shares for liquidator.\n     * Has to be smaller 50% when no bad debt occurs.\n     */\n    function checkMaxShares(\n        uint256 _nftId,\n        address _tokenToPayback,\n        uint256 _borrowETHTotal,\n        uint256 _unweightedCollateralETH,\n        uint256 _shareAmountToPay\n    )\n        public\n        view\n    {\n\n902: /**\n     * @dev Helper function for liquidation checking\n     * if postion has bad debt.\n     */\n    function checkBadDebtThreshold(\n        uint256 _borrowETHTotal,\n        uint256 _unweightedCollateral\n    )\n        public\n        pure\n        returns (bool)\n    {\n\n918: /**\n     * @dev Helper function computing lending\n     * token amount for {\n\n941: /**\n     * @dev Helper function computing borrow\n     * token amount for {\n\n962: /**\n     * @dev Helper function checking the owner\n     * of {\n\n981: /**\n     * @dev Wrapper function returning the borrow\n     * rate from pool with token {\n\n995: /**\n     * @dev View function returning the lending\n     * rate from pool with token {\n\n1023: /**\n     * @dev Internal helper function calculating\n     * the possible withdraw amount of {\n\n1077: /**\n     * @dev Wrapper for {_checkBlacklisted}.\n     */\n    function _checkPoolCondition(\n        address _poolToken\n    )\n        internal\n        view\n    {\n\n1091: /**\n     * @dev Internal helper checking of success\n     * for a low level byte call of a function\n     * with {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L9",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L61",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L102",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L139",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L184",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L220",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L238",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L274",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L318",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L354",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L388",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L426",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L354",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L388",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L426",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L354",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L388",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L426",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L466",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L480",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L524",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L548",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L572",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L603",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L647",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L668",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L683",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L697",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L712",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L732",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L754",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L788",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L832",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L854",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L871",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L902",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L918",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L941",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L962",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L981",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L995",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1023",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1077",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1091"
          ]
        },
        {
          "content": "```solidity\n\nFile: AaveHub.sol\n\n5: /**\n * @author Christoph Krpoun\n * @author René Hochmuth\n * @author Vitally Marinchenko\n */\n\nimport \"./AaveHelper.sol\";\nimport \"../TransferHub/TransferHelper.sol\";\nimport \"../TransferHub/ApprovalHelper.sol\";\n\n/**\n * @dev Purpose of this contract is to optimize capital efficency by using\n * aave pools. Not borrowed funds are deposited into correspoding aave pools\n * to earn supply APY.\n *\n * The aToken are holded by the wiseLending contract but the accounting\n * is managed by the position NFTs. This is possible due to the included\n * onBehlaf functionallity inside wiseLending.\n */\n\ncontract AaveHub is AaveHelper, TransferHelper, ApprovalHelper {\n\n39: /**\n     * @dev Adds new mapping to aaveHub. Needed\n     * to link underlying assets with corresponding\n     * aTokens. Can only be called by master.\n     */\n    function setAaveTokenAddress(\n        address _underlyingAsset,\n        address _aaveToken\n    )\n        external\n        onlyMaster\n    {\n\n58: /**\n     * @dev Adds new mapping to aaveHub in bulk.\n     * Needed to link underlying assets with\n     * corresponding aTokens. Can only be called by master.\n     */\n\n    function setAaveTokenAddressBulk(\n        address[] calldata _underlyingAssets,\n        address[] calldata _aaveTokens\n    )\n        external\n        onlyMaster\n    {\n\n79: /**\n     * @dev Receive functions forwarding\n     * sent ETH to the master address\n     */\n    receive()\n        external\n        payable\n    {\n\n97: /**\n     * @dev Allows deposit ERC20 token to\n     * wiseLending and takes token amount\n     * as arguement. Also mints position\n     * NFT to reduce needed transactions.\n     */\n    function depositExactAmountMint(\n        address _underlyingAsset,\n        uint256 _amount\n    )\n        external\n        returns (uint256)\n    {\n\n117: /**\n     * @dev Allows deposit ERC20 token to\n     * wiseLending and takes token amount as\n     * argument.\n     */\n    function depositExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _amount\n    )\n        public\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n153: /**\n     * @dev Allows to deposit ETH token directly to\n     * wiseLending and takes token amount as argument.\n     * Also mints position NFT to avoid extra transaction.\n     */\n    function depositExactAmountETHMint()\n        external\n        payable\n        returns (uint256)\n    {\n\n168: /**\n     * @dev Allows to deposit ETH token directly to\n     * wiseLending and takes token amount as argument.\n     */\n    function depositExactAmountETH(\n        uint256 _nftId\n    )\n        public\n        payable\n        nonReentrant\n        returns (uint256)\n    {\n\n198: /**\n     * @dev Allows to withdraw deposited ERC20 token.\n     * Takes _withdrawAmount as argument.\n     */\n    function withdrawExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _withdrawAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n234: /**\n     * @dev Allows to withdraw deposited ETH token.\n     * Takes token amount as argument.\n     */\n    function withdrawExactAmountETH(\n        uint256 _nftId,\n        uint256 _withdrawAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n277: /**\n     * @dev Allows to withdraw deposited ERC20 token.\n     * Takes _shareAmount as argument.\n     */\n    function withdrawExactShares(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _shareAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n310: /**\n     * @dev Allows to withdraw deposited ETH token.\n     * Takes _shareAmount as argument.\n     */\n    function withdrawExactSharesETH(\n        uint256 _nftId,\n        uint256 _shareAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n350: /**\n     * @dev Allows to borrow ERC20 token from a\n     * wiseLending pool. Needs supplied collateral\n     * inside the same position and to approve\n     * aaveHub to borrow onBehalf for the caller.\n     * Takes token amount as argument.\n     */\n    function borrowExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _borrowAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n386: /**\n     * @dev Allows to borrow ETH token from\n     * wiseLending. Needs supplied collateral\n     * inside the same position and to approve\n     * aaveHub to borrow onBehalf for the caller.\n     * Takes token amount as argument.\n     */\n    function borrowExactAmountETH(\n        uint256 _nftId,\n        uint256 _borrowAmount\n    )\n        external\n        nonReentrant\n        returns (uint256)\n    {\n\n429: /**\n     * @dev Allows to payback ERC20 token for\n     * any postion. Takes _paybackAmount as argument.\n     */\n    function paybackExactAmount(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _paybackAmount\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n478: /**\n     * @dev Allows to payback ETH token for\n     * any postion. Takes token amount as argument.\n     */\n    function paybackExactAmountETH(\n        uint256 _nftId\n    )\n        external\n        payable\n        nonReentrant\n        returns (uint256)\n    {\n\n552: /**\n     * @dev Allows to payback ERC20 token for\n     * any postion. Takes shares as argument.\n     */\n    function paybackExactShares(\n        uint256 _nftId,\n        address _underlyingAsset,\n        uint256 _shares\n    )\n        external\n        nonReentrant\n        validToken(_underlyingAsset)\n        returns (uint256)\n    {\n\n630: /**\n     * @dev View functions returning the combined rate\n     * from aave supply APY and wiseLending borrow APY\n     * of a pool.\n     */\n    function getLendingRate(\n        address _underlyingAsset\n    )\n        external\n        view\n        returns (uint256)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L39",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L58",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L79",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L97",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L117",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L153",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L168",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L198",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L234",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L277",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L310",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L350",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L386",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L429",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L478",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L552",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L630"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Ensure block.timestamp is only used in long time intervals",
      "description": "`block.timestamp` represents the current block's timestamp and can be influenced, within limits, by miners. For short time intervals, this malleability can be exploited, potentially allowing miners to manipulate contract behavior. For instance, they might fast-forward an expiration or delay an event. When designing smart contracts, if precise time checks are needed for short intervals, alternatives like block numbers can be considered. However, for longer durations where a few seconds of deviation is inconsequential, `block.timestamp` is generally safe and efficient. Always assess the implications of time manipulations for the specific use-case before utilizing `block.timestamp`. In practice, if you're using block.timestamp to measure intervals that are a matter of days, weeks, or longer, the potential manipulation by miners becomes less significant. Always prioritize the security and integrity of your smart contract operations when making these decisions.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: MainHelper.sol\n\n357: uint256 timeDifference = block.timestamp\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L357"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLending.sol\n\n262: uint256 timeDifference = block.timestamp\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L262"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n475: if (_getExpiry() > block.timestamp) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L475"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n120: uint256 timeDifference = block.timestamp\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L120"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmToken.sol\n\n395: if (block.timestamp == lastInteraction) {\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L395"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Use `Ownable2Step` rather than `Ownable`",
      "description": "`Ownable2Step` and `Ownable2StepUpgradeable` prevent the contract ownership from mistakenly being transferred to an address that cannot handle it (e.g. due to a typo in the address), by requiring that the recipient of the owner permissions actively accept via a contract call of its own.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OwnableMaster.sol\n\n9: contract OwnableMaster {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L9"
          ]
        },
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n7: import \"./OwnableMaster.sol\";\n\n11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {\n\n34: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L7",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseLendingDeclaration.sol\n\n5: import \"./OwnableMaster.sol\";\n\n31: OwnableMaster,\n\n110: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L31",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L110"
          ]
        },
        {
          "content": "```solidity\n\nFile: DeclarationsFeeManager.sol\n\n13: import \"../OwnableMaster.sol\";\n\n31: contract DeclarationsFeeManager is FeeManagerEvents, OwnableMaster {\n\n41: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L13",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L31",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L41"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n12: import \"../../OwnableMaster.sol\";\n\n15: contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {\n\n43: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L12",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L15",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerBase.sol\n\n5: import \"../../OwnableMaster.sol\";\n\n31: OwnableMaster,\n\n86: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L5",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L31",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n11: import \"../../OwnableMaster.sol\";\n\n24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {\n\n46: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L11",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L46"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n12: import \"../OwnableMaster.sol\";\n\n33: abstract contract Declarations is OwnableMaster {\n\n50: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L12",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L33",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L50"
          ]
        },
        {
          "content": "```solidity\n\nFile: WiseSecurityDeclarations.sol\n\n17: import \"../OwnableMaster.sol\";\n\n45: contract WiseSecurityDeclarations is OwnableMaster {\n\n57: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L17",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L45",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L57"
          ]
        },
        {
          "content": "```solidity\n\nFile: Declarations.sol\n\n12: import \"../OwnableMaster.sol\";\n\n21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {\n\n48: OwnableMaster(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L12",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L48"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Use SafeCast to safely downcast variables",
      "description": "Downcasting `int`/`uint`s in Solidity can be unsafe due to the potential for data loss and unintended behavior. When downcasting a larger integer type to a smaller one (e.g., `uint256` to `uint128`), the value may exceed the range of the target type, leading to truncation and loss of significant digits. This data loss can result in unexpected state changes, incorrect calculations, or other contract vulnerabilities, ultimately compromising the contracts functionality and reliability. To prevent these risks, developers should carefully consider the range of values their variables may hold and ensure that proper checks are in place to prevent out-of-range values before performing downcasting. Also consider using OZ SafeCast functionality.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n399: uint8(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L399"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmController.sol\n\n379: ? uint128(currentExpiry)\n\n407: uint128(_amount),\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L379",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L407"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerFarmControllerHelper.sol\n\n39: uint128 startTime = uint128((block.timestamp / WEEK)\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L39"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n241: uint8(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L241"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n157: int192(uint192(answer))\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L157"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n401: return uint128(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L401"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n427: int56 twapPeriodInt56 = int56(\n\n428: int32(TWAP_PERIOD)\n\n434: int24 tick = int24(\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L427",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L428",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L434"
          ]
        }
      ]
    },
    {
      "severity": "NonCritical",
      "title": "Consider using `SafeTransferLib.safeTransferETH()` or `Address.sendValue()` for clearer semantic meaning",
      "description": "These Functions indicate their purpose with their name more clearly than using low-level calls.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: WiseSecurity.sol\n\n208: ) = curvePool.call{value: 0}\n\n225: ) = curveMeta.call{value: 0}\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L208",
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L225"
          ]
        }
      ]
    },
    {
      "severity": "Medium",
      "title": "Chainlink aggregators return the incorrect price if it drops below `minAnswer`",
      "description": "Chainlink aggregators have a built in circuit breaker if the price of an asset goes outside of a predetermined price band. The result is that if an asset experiences a huge drop in value (i.e. LUNA crash) the price of the oracle will continue to return the `minAnswer` instead of the actual price of the asset. See [Chainlink's docs](https://docs.chain.link/data-feeds#check-the-latest-answer-against-reasonable-limits) for more info.  Chainlink's `latestRoundData` pulls the associated aggregator and requests round data from it. ChainlinkAggregators have `minAnswer` and `maxAnswer` circuit breakers built into them. This means that if the price of the asset drops below the `minAnswer`, the protocol will continue to value the token at `minAnswer` instead of it's actual value. This will allow users to exploit certain parts of the protocol.  This discrepency could cause major issues within the protocol and potentially lead to loss of funds. This is exactly what happened to  [Venus on BSC when LUNA imploded](https://rekt.news/venus-blizz-rekt/).  \n\n**Recommendation:** add a check to revert if the price received from the oracle is out of bounds.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n258: ) = priceFeed[_tokenAddress].latestRoundData();\n\n        return uint256(\n            answer\n        );\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L258"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n535: ) = SEQUENCER.latestRoundData();\n\n        if (answer == 1) {\n            return true;\n        }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L535"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n714: ) = priceFeed[_tokenAddress].latestRoundData();\n    }\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L714"
          ]
        }
      ]
    },
    {
      "severity": "Medium",
      "title": "ChainLink pricer is using a deprecated API",
      "description": "According to Chainlink’s documentation, the `latestAnswer` function is deprecated. https://docs.chain.link/data-feeds/price-feeds/api-reference#latestanswer\nIf no answer is received it will return 0. If chainlink stops support, the function may stop working, causing Oracle price to default to fallback, even though Chainlink Oracle may still be available. This may potentially lead to oracle price manipulation.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendleChildLpOracle.sol\n\n40: return priceFeedPendleLpOracle.latestAnswer()\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L40"
          ]
        }
      ]
    },
    {
      "severity": "Medium",
      "title": "Insufficient oracle validation",
      "description": "The Oracle feed is insufficiently validated. It is currently missing either checking the roundId, price or that there is no freshness check on the timestamp of the prices fetched from the Chainlink oracle, so old prices may be used if <a href=\"https://docs.chain.link/architecture-overview/off-chain-reporting\">OCR</a> was unable to push an update in time. Add a staleness threshold number of seconds configuration parameter, and ensure that the price fetched is from within that time range.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n88: (\n            ,\n            int256 answerFeed,\n            ,\n            ,\n        ) = FEED_ASSET.latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L88"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n86: (\n            ,\n            int256 answerUsdFeed,\n            ,\n            ,\n        ) = USD_FEED_ASSET.latestRoundData();\n\n        (\n            ,\n            int256 answerEthUsdFeed,\n            ,\n            ,\n        ) = ETH_FEED_ASSET.latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n73: (\n            ,\n            int256 answerFeed,\n            ,\n            ,\n\n        ) = FEED_ASSET.latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n253: (\n            ,\n            int256 answer,\n            ,\n            ,\n        ) = priceFeed[_tokenAddress].latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L253"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n530: (\n            ,\n            int256 answer,\n            uint256 startedAt,\n            ,\n        ) = SEQUENCER.latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L530"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n708: (\n            roundId\n            ,\n            ,\n            ,\n            ,\n        ) = priceFeed[_tokenAddress].latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L708"
          ]
        }
      ]
    },
    {
      "severity": "Medium",
      "title": "Use `_safeMint` instead of `_mint`",
      "description": "`_mint()` is [discouraged](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/d4d8d2ed9798cc3383912a23b5e8d5cb602f7d4b/contracts/token/ERC721/ERC721.sol#L271) in favor of `_safeMint()` which ensures that the recipient is either an EOA or implements `IERC721Receiver`. Both [OpenZeppelin](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/d4d8d2ed9798cc3383912a23b5e8d5cb602f7d4b/contracts/token/ERC721/ERC721.sol#L238-L250) and [solmate](https://github.com/Rari-Capital/solmate/blob/4eaf6b68202e36f67cab379768ac6be304c8ebde/src/tokens/ERC721.sol#L180) have versions of this function. In the cases below, `_mint()` does not call `ERC721TokenReceiver.onERC721Received()` on the recipient.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PositionNFTs.sol\n\n214: _mint(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L214"
          ]
        },
        {
          "content": "```solidity\n\nFile: PowerFarmNFTs.sol\n\n73: _mint(\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L73"
          ]
        }
      ]
    },
    {
      "severity": "Medium",
      "title": "Missing checks for whether the L2 Sequencer is active",
      "description": "Chainlink recommends that users using price oracles, check whether the Arbitrum Sequencer is <a href=\"https://docs.chain.link/data-feeds/l2-sequencer-feeds#arbitrum\">active</a>. If the sequencer goes down, the Chainlink oracles will have stale prices from before the downtime, until a new L2 OCR transaction goes through. Users who submit their transactions via the <a href=\"https://developer.arbitrum.io/tx-lifecycle#1b--or-from-l1-via-the-delayed-inbox\">L1 Dealyed Inbox</a> will be able to take advantage of these stale prices. Use a <a href=\"https://blog.chain.link/how-to-use-chainlink-price-feeds-on-arbitrum/#almost_done!_meet_the_l2_sequencer_health_flag\">Chainlink oracle</a> to determine whether the sequencer is offline or not, and don't allow operations to take place while the sequencer is offline.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: PendleLpOracle.sol\n\n88: (\n            ,\n            int256 answerFeed,\n            ,\n            ,\n        ) = FEED_ASSET.latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L88"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOracleDerivative.sol\n\n86: (\n            ,\n            int256 answerUsdFeed,\n            ,\n            ,\n        ) = USD_FEED_ASSET.latestRoundData();\n\n        (\n            ,\n            int256 answerEthUsdFeed,\n            ,\n            ,\n        ) = ETH_FEED_ASSET.latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L86"
          ]
        },
        {
          "content": "```solidity\n\nFile: PtOraclePure.sol\n\n73: (\n            ,\n            int256 answerFeed,\n            ,\n            ,\n\n        ) = FEED_ASSET.latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L73"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n253: (\n            ,\n            int256 answer,\n            ,\n            ,\n        ) = priceFeed[_tokenAddress].latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L253"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n530: (\n            ,\n            int256 answer,\n            uint256 startedAt,\n            ,\n        ) = SEQUENCER.latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L530"
          ]
        },
        {
          "content": "```solidity\n\nFile: OracleHelper.sol\n\n708: (\n            roundId\n            ,\n            ,\n            ,\n            ,\n        ) = priceFeed[_tokenAddress].latestRoundData();\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L708"
          ]
        }
      ]
    },
    {
      "severity": "Medium",
      "title": "Admin privilege - A single point of failure can allow a hacked or malicious owner use critical functions in the project",
      "description": "The `owner` role has a single point of failure and `onlyOwner` can use critical a few functions.\n\n`owner` role in the project:\nOwner is not behind a multisig and changes are not behind a timelock.\n\nEven if protocol admins/developers are not malicious there is still a chance for Owner keys to be stolen. In such a case, the attacker can cause serious damage to the project due to important functions. In such a case, users who have invested in project will suffer high financial losses.\n\n#### Impact\nHacked owner or malicious owner can immediately use critical functions in the project.",
      "gasSavings": null,
      "category": null,
      "instances": [
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n26: function renounceOwnership()\n        external\n        onlyOwner\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L26"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n34: function setLastUpdateGlobal(\n        uint256 _time\n    )\n        external\n        onlyOwner\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n43: function setRoundData(\n        uint80 _roundId,\n        uint256 _updateTime\n    )\n        external\n        onlyOwner\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43"
          ]
        },
        {
          "content": "```solidity\n\nFile: CustomOracleSetup.sol\n\n53: function setGlobalAggregatorRoundId(\n        uint80 _aggregatorRoundId\n    )\n        external\n        onlyOwner\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n211: function exitFarm(\n        uint256 _keyId,\n        uint256 _allowedSpread,\n        bool _ethBack\n    )\n        external\n        updatePools\n        onlyKeyOwner(_keyId)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L211"
          ]
        },
        {
          "content": "```solidity\n\nFile: PendlePowerManager.sol\n\n275: function manuallyWithdrawShares(\n        uint256 _keyId,\n        uint256 _withdrawShares\n    )\n        external\n        updatePools\n        onlyKeyOwner(_keyId)\n    {\n\n\n\n```",
          "loc": [
            "https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L275"
          ]
        }
      ]
    }
  ],
  "createdAt": "2024-02-21T20:51:03.110Z",
  "updatedAt": "2024-02-21T20:51:03.872Z"
}