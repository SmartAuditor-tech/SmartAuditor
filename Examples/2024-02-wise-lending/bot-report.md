# Winning bot race submission
This is the top-ranked automated findings report, from znBotty bot. All findings in this report will be considered known issues for the purposes of your C4 audit.

## Summary

| |Issue|Instances| Gas Savings
|-|:-|:-:|:-:|
| [[M-01](#m-01)] | Chainlink aggregators return the incorrect price if it drops below `minAnswer` | 3| 0|
| [[M-02](#m-02)] | ChainLink pricer is using a deprecated API | 1| 0|
| [[M-03](#m-03)] | Insufficient oracle validation | 6| 0|
| [[M-04](#m-04)] | Use `_safeMint` instead of `_mint` | 2| 0|
| [[M-05](#m-05)] | Missing checks for whether the L2 Sequencer is active | 6| 0|
| [[M-06](#m-06)] | Admin privilege - A single point of failure can allow a hacked or malicious owner use critical functions in the project | 6| 0|
| [[L-01](#l-01)] | Addition/multiplication in `unchecked` block is unsafe | 1| 0|
| [[L-02](#l-02)] | Governance functions should be controlled by time locks | 68| 0|
| [[L-03](#l-03)] | IERC20 `approve()` Is Deprecated | 1| 0|
| [[L-04](#l-04)] | Consider checking that transfer to `address(this)` is disabled | 3| 0|
| [[L-05](#l-05)] | Owner can renounce Ownership | 19| 0|
| [[L-06](#l-06)] | Consider implementing two-step procedure for updating protocol addresses | 14| 0|
| [[L-07](#l-07)] | Consider the case where `totalsupply` is 0 | 3| 0|
| [[L-08](#l-08)] | Do not allow fees to be set to `100%` | 1| 0|
| [[L-09](#l-09)] | `decimals()` not part of ERC20 standard | 8| 0|
| [[L-10](#l-10)] | External call recipient may consume all transaction gas | 6| 0|
| [[L-11](#l-11)] | External calls in an un-bounded `for-`loop may result in a DOS | 1| 0|
| [[L-12](#l-12)] | `forceApprove` should be used instead of `approve` | 1| 0|
| [[L-13](#l-13)] | Functions which set address state variables should have zero address checks | 3| 0|
| [[L-14](#l-14)] | Init functions are susceptible to front-running | 1| 0|
| [[L-15](#l-15)] | Initialization function lacks parameter validation | 1| 0|
| [[L-16](#l-16)] | Lack of index element validation in function | 16| 0|
| [[L-17](#l-17)] | Possible rounding issue | 16| 0|
| [[L-18](#l-18)] | Minting tokens to the zero address should be avoided | 12| 0|
| [[L-19](#l-19)] | The Contract Should `approve(0)` First | 1| 0|
| [[L-20](#l-20)] | Constructor is missing zero address check | 7| 0|
| [[L-21](#l-21)] | Cap state variables at reasonable values | 15| 0|
| [[L-22](#l-22)] | Missing Checks for Address(0x0) | 16| 0|
| [[L-23](#l-23)] | Protect your NFT from copying in POW forks | 2| 0|
| [[L-24](#l-24)] | Contracts are designed to receive ETH but do not implement function for withdrawal | 2| 0|
| [[L-25](#l-25)] | `safeTransfer` function does not check for contract existence | 2| 0|
| [[L-26](#l-26)] | `tokenURI()` does not follow EIP-721 | 2| 0|
| [[L-27](#l-27)] | Usage of `payable.transfer` can lead to loss of funds | 1| 0|
| [[L-28](#l-28)] | A year is not always 365 days | 3| 0|
| [[G-01](#g-01)] | `abi.encode()` is less efficient than `abi.encodepacked()` | 2| 0|
| [[G-02](#g-02)] | Activate the optimizer | 1| 0|
| [[G-03](#g-03)] | Consider activating `via-ir` for deploying | 1| 0|
| [[G-04](#g-04)] | `address(this)` can be stored in `state variable` that will ultimately cost less, than every time calculating this, specifically when it used multiple times in a `contract` | 34| 0|
| [[G-05](#g-05)] | `<array>.length` Should Not Be Looked Up In Every Loop Of A For-loop | 1| 0|
| [[G-06](#g-06)] | Avoid repeating computations | 3| 0|
| [[G-07](#g-07)] | Avoid updating storage when the value hasn't changed | 52| 0|
| [[G-08](#g-08)] | Avoid zero transfer to save gas | 1| 0|
| [[G-09](#g-09)] | Call `msg.sender` directly instead of caching them | 1| 0|
| [[G-10](#g-10)] | Gas savings can be achieved by changing the model for assigning value to the structure | 6| 0|
| [[G-11](#g-11)] | Comparing to constant boolean | 90| 0|
| [[G-12](#g-12)] | Consider using solady's 'FixedPointMathLib' | 1| 0|
| [[G-13](#g-13)] | Setting the `constructor` to `payable` | 25| 0|
| [[G-14](#g-14)] | Counting down in `for` statements is more gas efficient | 1| 0|
| [[G-15](#g-15)] | Divisions which do not divide by -X cannot overflow or overflow so such operations can be unchecked to save gas | 2| 0|
| [[G-16](#g-16)] | Use shift Right instead of division if possible to save gas | 14| 0|
| [[G-17](#g-17)] | Empty Blocks Should Be Removed Or Emit Something | 1| 0|
| [[G-18](#g-18)] | Using `delete` statement can save gas | 7| 0|
| [[G-19](#g-19)] | `++i` Costs Less Gas Than `i++`, Especially When It’s Used In For-loops (`--i`/`i--` Too) | 1| 0|
| [[G-20](#g-20)] | Use `assembly` to write address storage values | 14| 0|
| [[G-21](#g-21)] | Use hardcoded address instead `address(this)` | 39| 0|
| [[G-22](#g-22)] | Hash using `assembly` instead of solidity | 3| 0|
| [[G-23](#g-23)] | Increments can be `unchecked` to save gas | 6| 0|
| [[G-24](#g-24)] | It Costs More Gas To Initialize Variables To Zero Than To Let The Default Of Zero Be Applied | 1| 0|
| [[G-25](#g-25)] | `internal` functions only called once can be inlined to save gas | 173| 0|
| [[G-26](#g-26)] | Multiple accesses of a mapping/array should use a local variable cache | 105| 0|
| [[G-27](#g-27)] | Multiple Address Mappings Can Be Combined Into A Single Mapping Of An Address To A Struct, Where Appropriate | 37| 0|
| [[G-28](#g-28)] | Multiplication/division By Two Should Use Bit Shifting | 2| 0|
| [[G-29](#g-29)] | Use shift Left instead of multiplication if possible to save gas | 9| 0|
| [[G-30](#g-30)] | Operator `>=`/`<=` costs less gas than operator `>`/`<` | 126| 0|
| [[G-31](#g-31)] | Optimize names to save gas | 1| 0|
| [[G-32](#g-32)] | + <y>` For State Variables | 39| 0|
| [[G-33](#g-33)] | Structs can be packed into fewer storage slots by editing time variables | 1| 0|
| [[G-34](#g-34)] | Using `private` rather than `public` for constants, saves gas | 61| 0|
| [[G-35](#g-35)] | Redundant state variable getters | 1| 0|
| [[G-36](#g-36)] | The result of a function call should be cached rather than re-calling the function | 2| 0|
| [[G-37](#g-37)] | Shorten the array rather than copying to a new one | 6| 0|
| [[G-38](#g-38)] | State variables can be packed into fewer storage slots | 4| 0|
| [[G-39](#g-39)] | State variables that are used multiple times in a function should be cached in stack variables | 8| 0|
| [[G-40](#g-40)] | Structs can be packed into fewer storage slots | 1| 0|
| [[G-41](#g-41)] | Superfluous event fields | 52| 0|
| [[G-42](#g-42)] | Usage of `uints`/`ints` smaller than 32 bytes (256 bits) incurs overhead | 9| 0|
| [[G-43](#g-43)] | `unchecked {}` can be used on the division of two `uints` in order to save gas | 1| 0|
| [[G-44](#g-44)] | `++i`/`i++` Should Be `unchecked{++i}`/`unchecked{i++}` When It Is Not Possible For Them To Overflow, As Is The Case When Used In For- And While-loops | 1| 0|
| [[G-45](#g-45)] | Add `unchecked /{/}` for subtractions where the operands cannot underflow | 31| 0|
| [[G-46](#g-46)] | Use assembly to check for `address(0)` | 1| 0|
| [[G-47](#g-47)] | Use assembly in place of abi.decode to extract calldata values more efficiently | 2| 0|
| [[G-48](#g-48)] | Use assembly to validate `msg.sender` | 18| 0|
| [[G-49](#g-49)] | Use do while loops instead of for loops | 4| 0|
| [[G-50](#g-50)] | Use `!= 0` or `== 0` for unsigned integer comparison | 23| 0|
| [[G-51](#g-51)] | A modifier used only once and not being inherited should be inlined to save gas | 10| 0|
| [[G-52](#g-52)] | Use v5.0.0 OpenZeppelin contracts | 1| 0|
| [[G-53](#g-53)] | Use mappings instead of arrays | 2| 0|
| [[G-54](#g-54)] | Use nested `if` and avoid multiple check combinations | 5| 0|
| [[G-55](#g-55)] | Use of Custom Errors Instead of String | 4| 0|
| [[G-56](#g-56)] | Use `uint256(1)`/`uint256(2)` instead for `true` and `false` boolean states | 32| 0|
| [[G-57](#g-57)] | Using XOR (^) and AND (&) bitwise equivalents for gas optimizations | 137| 0|
| [[G-58](#g-58)] | Using assembly to check for zero can save gas | 52| 0|
| [[G-59](#g-59)] | Using Bools For Storage Incurs Overhead | 17| 0|
| [[G-60](#g-60)] | Using `++X/`--X` instead of `X++`/`X--` can save gas | 7| 0|
| [[G-61](#g-61)] | Using `this` to access functions results in an external call, wasting gas | 5| 0|
| [[G-62](#g-62)] | Write direct outcome, instead of performing mathematical operations | 1| 0|
| [[N-01](#n-01)] | The call `abi.encodeWithSelector` is not type safe | 3| 0|
| [[N-02](#n-02)] | Add inline comments for unnamed variables in function declarations | 2| 0|
| [[N-03](#n-03)] | `address` shouldn't be hard-coded | 7| 0|
| [[N-04](#n-04)] | Array lengths not checked | 5| 0|
| [[N-05](#n-05)] | Assembly block creates dirty bits | 1| 0|
| [[N-06](#n-06)] | Avoid mutating function parameters | 1| 0|
| [[N-07](#n-07)] | Avoid the use of sensitive terms | 24| 0|
| [[N-08](#n-08)] | No need for `== true` or `== false` checks | 90| 0|
| [[N-09](#n-09)] | Condition will not revert when `block.timestamp` is `==` to the compared variable | 1| 0|
| [[N-10](#n-10)] | Consider adding a deny-list | 3| 0|
| [[N-11](#n-11)] | Consider adding formal verification proofs | 1| 0|
| [[N-12](#n-12)] | Consider emitting an event at the end of the constructor | 1| 0|
| [[N-13](#n-13)] | Consider making contracts `Upgradeable` | 52| 0|
| [[N-14](#n-14)] | Consider using named mappings | 45| 0|
| [[N-15](#n-15)] | Constant redefined elsewhere | 42| 0|
| [[N-16](#n-16)] | Constants Should Be Defined Rather Than Using Magic Numbers | 4| 0|
| [[N-17](#n-17)] | Constants in comparisons should appear on the left side | 48| 0|
| [[N-18](#n-18)] | Constructor declarations should have NatSpec descriptions | 25| 0|
| [[N-19](#n-19)] | Contract declarations should have NatSpec `@author` annotations | 34| 0|
| [[N-20](#n-20)] | Contracts should have NatSpec `@dev` tags | 28| 0|
| [[N-21](#n-21)] | Contract declarations should have NatSpec `@title` annotations | 44| 0|
| [[N-22](#n-22)] | Contract does not follow the Solidity style guide's suggested layout ordering | 15| 0|
| [[N-23](#n-23)] | Contracts with only unimplemented functions can be labeled as abstract | 28| 0|
| [[N-24](#n-24)] | Critical Changes Should Use Two-step Procedure | 68| 0|
| [[N-25](#n-25)] | Custom error has no error details | 29| 0|
| [[N-26](#n-26)] | Custom errors should be used rather than `revert()`/`require()` | 2| 0|
| [[N-27](#n-27)] | Declare interfaces on separate files | 1| 0|
| [[N-28](#n-28)] | Default `address(0)` can be returned | 12| 0|
| [[N-29](#n-29)] | Defined named returns not used within function | 26| 0|
| [[N-30](#n-30)] | Dependence on external protocols | 2| 0|
| [[N-31](#n-31)] | Do not cache immutable variables | 4| 0|
| [[N-32](#n-32)] | Don't use assembly for `create2` | 1| 0|
| [[N-33](#n-33)] | Complex casting | 1| 0|
| [[N-34](#n-34)] | Empty `bytes` check is missing | 6| 0|
| [[N-35](#n-35)] | Enable IR-based code generation | 1| 0|
| [[N-36](#n-36)] | Enum values should be used in place of constant array indexes | 6| 0|
| [[N-37](#n-37)] | `Event` declarations should have NatSpec descriptions | 63| 0|
| [[N-38](#n-38)] | Event Is Missing Indexed Fields | 43| 0|
| [[N-39](#n-39)] | Events should be emitted before external calls | 8| 0|
| [[N-40](#n-40)] | Expressions for constant values should use `immutable` rather than `constant` | 4| 0|
| [[N-41](#n-41)] | For extended 'using-for' usage, use the latest pragma version  | 1| 0|
| [[N-42](#n-42)] | File is missing NatSpec | 17| 0|
| [[N-43](#n-43)] | Function names should differ to make the code more readable | 95| 0|
| [[N-44](#n-44)] | Function must not be longer than 50 lines | 35| 0|
| [[N-45](#n-45)] | Functions that alter state should emit events containing both the old and the new value | 22| 0|
| [[N-46](#n-46)] | Some functions contain the same exact logic | 10| 0|
| [[N-47](#n-47)] | Functions should be marked as `payable` when interacting with `ETH` like for transfering `ETH` to other contracts | 1| 0|
| [[N-48](#n-48)] | Functions should have `@notice` tags | 239| 0|
| [[N-49](#n-49)] | A function which defines named returns in it's declaration doesn't need to use return | 23| 0|
| [[N-50](#n-50)] | Function writing that does not comply with the Solidity Style Guide | 1| 0|
| [[N-51](#n-51)] | Large or complicated code bases should implement fuzzing tests | 1| 0|
| [[N-52](#n-52)] | Use `delete` to Clear Variables | 7| 0|
| [[N-53](#n-53)] | `if`-statement can be converted to a ternary | 4| 0|
| [[N-54](#n-54)] | Immutables can be named using the same convention | 29| 0|
| [[N-55](#n-55)] | Imports can be grouped together | 31| 0|
| [[N-56](#n-56)] | Incorrect withdraw declaration | 18| 0|
| [[N-57](#n-57)] | No need to initialize uints to zero | 1| 0|
| [[N-58](#n-58)] | Initial value check is missing in Set Functions | 50| 0|
| [[N-59](#n-59)] | Contracts should have full test coverage | 1| 0|
| [[N-60](#n-60)] | Interface imports should be declared first | 5| 0|
| [[N-61](#n-61)] | Invalid NatSpec comment style | 3| 0|
| [[N-62](#n-62)] | It is best practice to use linear inheritance | 4| 0|
| [[N-63](#n-63)] | Lack Of brace spacing | 2| 0|
| [[N-64](#n-64)] | Assembly blocks should have extensive comments | 2| 0|
| [[N-65](#n-65)] | Large or complicated code bases should implement invariant tests | 1| 0|
| [[N-66](#n-66)] | Long functions should be refactored into multiple, smaller, functions | 53| 0|
| [[N-67](#n-67)] | Make use of Solidity's `using` keyword | 5| 0|
| [[N-68](#n-68)] | Missing Contract-existence Checks Before Low-level Calls | 8| 0|
| [[N-69](#n-69)] | Missing event for critical parameter change | 22| 0|
| [[N-70](#n-70)] | Missing/malformed underscores for large numeric literals | 1| 0|
| [[N-71](#n-71)] | Missing NatSpec `@dev` from event declaration | 63| 0|
| [[N-72](#n-72)] | Missing NatSpec `@dev` from function declaration | 516| 0|
| [[N-73](#n-73)] | Missing NatSpec `@dev` from modifier declaration | 23| 0|
| [[N-74](#n-74)] | Missing NatSpec `@notice` from event declaration | 64| 0|
| [[N-75](#n-75)] | Missing NatSpec `@notice` from modifier declaration | 23| 0|
| [[N-76](#n-76)] | Consider using modifiers for address control | 10| 0|
| [[N-77](#n-77)] | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability | 37| 0|
| [[N-78](#n-78)] | Multiple mappings can be replaced with a single struct mapping | 37| 0|
| [[N-79](#n-79)] | NatSpec comments should be increased in contracts | 1| 0|
| [[N-80](#n-80)] | NatSpec `@param` is missing | 139| 0|
| [[N-81](#n-81)] | NatSpec `@return` argument is missing | 71| 0|
| [[N-82](#n-82)] | Non-assembly method available | 1| 0|
| [[N-83](#n-83)] | Non `constant`/`immutable` state variables are missing a setter post deployment | 13| 0|
| [[N-84](#n-84)] | Non-usage of specific imports | 101| 0|
| [[N-85](#n-85)] | Open TODOs | 3| 0|
| [[N-86](#n-86)] | Operations such as the changing of the owner should be behind a timelock | 2| 0|
| [[N-87](#n-87)] | `private` and `internal` variables should have a preceding `_` in their name | 8| 0|
| [[N-88](#n-88)] | Project should include an `EmergencyStop` pattern | 29| 0|
| [[N-89](#n-89)] | `public` functions not called internally by the contract should be declared `external` instead | 5| 0|
| [[N-90](#n-90)] | Public state arrays should have a getter to return all elements | 2| 0|
| [[N-91](#n-91)] | Public variable declarations should have NatSpec descriptions | 31| 0|
| [[N-92](#n-92)] | Empty blocks should be removed or emit something or at least add some comments to the body | 6| 0|
| [[N-93](#n-93)] | Adding A Return Statement When The Function Defines A Named Return Variable, Is Redundant | 6| 0|
| [[N-94](#n-94)] | Remove unused `error` definition | 1| 0|
| [[N-95](#n-95)] | `require()` / `revert()` Statements Should Have Descriptive Reason Strings | 1| 0|
| [[N-96](#n-96)] | Returning a struct instead of a bunch of variables is better | 5| 0|
| [[N-97](#n-97)] | Revert statements within external and public functions can be used to perform DOS attacks | 63| 0|
| [[N-98](#n-98)] | Top-level declarations should be separated by at least two lines | 31| 0|
| [[N-99](#n-99)] | Arrays can grow in size without a way to shrink them | 2| 0|
| [[N-100](#n-100)] | Uncommented fields in a struct | 13| 0|
| [[N-101](#n-101)] | Unused event may be unused code or indicative of missed emit/logic | 2| 0|
| [[N-102](#n-102)] | Unused `struct` definition | 1| 0|
| [[N-103](#n-103)] | Upgrade OpenZeppelin Contract Dependency | 1| 0|
| [[N-104](#n-104)] | Large multiples of ten should use scientific notation | 1| 0|
| [[N-105](#n-105)] | Use a struct to encapsulate multiple function parameters | 3| 0|
| [[N-106](#n-106)] | Use `@inheritdoc` for overridden functions | 2| 0|
| [[N-107](#n-107)] | Use @inheritdoc rather than using a non-standard annotation | 345| 0|
| [[N-108](#n-108)] | Ensure block.timestamp is only used in long time intervals | 5| 0|
| [[N-109](#n-109)] | Use `Ownable2Step` rather than `Ownable` | 28| 0|
| [[N-110](#n-110)] | Use SafeCast to safely downcast variables | 10| 0|
| [[N-111](#n-111)] | Consider using `SafeTransferLib.safeTransferETH()` or `Address.sendValue()` for clearer semantic meaning | 2| 0|

### Medium Risk Issues

### [M-01]<a name="m-01"></a> Chainlink aggregators return the incorrect price if it drops below `minAnswer`

Chainlink aggregators have a built in circuit breaker if the price of an asset goes outside of a predetermined price band. The result is that if an asset experiences a huge drop in value (i.e. LUNA crash) the price of the oracle will continue to return the `minAnswer` instead of the actual price of the asset. See [Chainlink's docs](https://docs.chain.link/data-feeds#check-the-latest-answer-against-reasonable-limits) for more info.  Chainlink's `latestRoundData` pulls the associated aggregator and requests round data from it. ChainlinkAggregators have `minAnswer` and `maxAnswer` circuit breakers built into them. This means that if the price of the asset drops below the `minAnswer`, the protocol will continue to value the token at `minAnswer` instead of it's actual value. This will allow users to exploit certain parts of the protocol.  This discrepency could cause major issues within the protocol and potentially lead to loss of funds. This is exactly what happened to  [Venus on BSC when LUNA imploded](https://rekt.news/venus-blizz-rekt/).  

**Recommendation:** add a check to revert if the price received from the oracle is out of bounds.

*There are 3 instance(s) of this issue:*

```solidity

File: OracleHelper.sol

258: ) = priceFeed[_tokenAddress].latestRoundData();

        return uint256(
            answer
        );
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L258

```solidity

File: OracleHelper.sol

535: ) = SEQUENCER.latestRoundData();

        if (answer == 1) {
            return true;
        }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L535

```solidity

File: OracleHelper.sol

714: ) = priceFeed[_tokenAddress].latestRoundData();
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L714

### [M-02]<a name="m-02"></a> ChainLink pricer is using a deprecated API

According to Chainlink’s documentation, the `latestAnswer` function is deprecated. https://docs.chain.link/data-feeds/price-feeds/api-reference#latestanswer
If no answer is received it will return 0. If chainlink stops support, the function may stop working, causing Oracle price to default to fallback, even though Chainlink Oracle may still be available. This may potentially lead to oracle price manipulation.

*There are 1 instance(s) of this issue:*

```solidity

File: PendleChildLpOracle.sol

40: return priceFeedPendleLpOracle.latestAnswer()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L40

### [M-03]<a name="m-03"></a> Insufficient oracle validation

The Oracle feed is insufficiently validated. It is currently missing either checking the roundId, price or that there is no freshness check on the timestamp of the prices fetched from the Chainlink oracle, so old prices may be used if <a href="https://docs.chain.link/architecture-overview/off-chain-reporting">OCR</a> was unable to push an update in time. Add a staleness threshold number of seconds configuration parameter, and ensure that the price fetched is from within that time range.

*There are 6 instance(s) of this issue:*

```solidity

File: PendleLpOracle.sol

88: (
            ,
            int256 answerFeed,
            ,
            ,
        ) = FEED_ASSET.latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L88

```solidity

File: PtOracleDerivative.sol

86: (
            ,
            int256 answerUsdFeed,
            ,
            ,
        ) = USD_FEED_ASSET.latestRoundData();

        (
            ,
            int256 answerEthUsdFeed,
            ,
            ,
        ) = ETH_FEED_ASSET.latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L86

```solidity

File: PtOraclePure.sol

73: (
            ,
            int256 answerFeed,
            ,
            ,

        ) = FEED_ASSET.latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L73

```solidity

File: OracleHelper.sol

253: (
            ,
            int256 answer,
            ,
            ,
        ) = priceFeed[_tokenAddress].latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L253

```solidity

File: OracleHelper.sol

530: (
            ,
            int256 answer,
            uint256 startedAt,
            ,
        ) = SEQUENCER.latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L530

```solidity

File: OracleHelper.sol

708: (
            roundId
            ,
            ,
            ,
            ,
        ) = priceFeed[_tokenAddress].latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L708

### [M-04]<a name="m-04"></a> Use `_safeMint` instead of `_mint`

`_mint()` is [discouraged](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/d4d8d2ed9798cc3383912a23b5e8d5cb602f7d4b/contracts/token/ERC721/ERC721.sol#L271) in favor of `_safeMint()` which ensures that the recipient is either an EOA or implements `IERC721Receiver`. Both [OpenZeppelin](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/d4d8d2ed9798cc3383912a23b5e8d5cb602f7d4b/contracts/token/ERC721/ERC721.sol#L238-L250) and [solmate](https://github.com/Rari-Capital/solmate/blob/4eaf6b68202e36f67cab379768ac6be304c8ebde/src/tokens/ERC721.sol#L180) have versions of this function. In the cases below, `_mint()` does not call `ERC721TokenReceiver.onERC721Received()` on the recipient.

*There are 2 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

214: _mint(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L214

```solidity

File: PowerFarmNFTs.sol

73: _mint(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L73

### [M-05]<a name="m-05"></a> Missing checks for whether the L2 Sequencer is active

Chainlink recommends that users using price oracles, check whether the Arbitrum Sequencer is <a href="https://docs.chain.link/data-feeds/l2-sequencer-feeds#arbitrum">active</a>. If the sequencer goes down, the Chainlink oracles will have stale prices from before the downtime, until a new L2 OCR transaction goes through. Users who submit their transactions via the <a href="https://developer.arbitrum.io/tx-lifecycle#1b--or-from-l1-via-the-delayed-inbox">L1 Dealyed Inbox</a> will be able to take advantage of these stale prices. Use a <a href="https://blog.chain.link/how-to-use-chainlink-price-feeds-on-arbitrum/#almost_done!_meet_the_l2_sequencer_health_flag">Chainlink oracle</a> to determine whether the sequencer is offline or not, and don't allow operations to take place while the sequencer is offline.

*There are 6 instance(s) of this issue:*

```solidity

File: PendleLpOracle.sol

88: (
            ,
            int256 answerFeed,
            ,
            ,
        ) = FEED_ASSET.latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L88

```solidity

File: PtOracleDerivative.sol

86: (
            ,
            int256 answerUsdFeed,
            ,
            ,
        ) = USD_FEED_ASSET.latestRoundData();

        (
            ,
            int256 answerEthUsdFeed,
            ,
            ,
        ) = ETH_FEED_ASSET.latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L86

```solidity

File: PtOraclePure.sol

73: (
            ,
            int256 answerFeed,
            ,
            ,

        ) = FEED_ASSET.latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L73

```solidity

File: OracleHelper.sol

253: (
            ,
            int256 answer,
            ,
            ,
        ) = priceFeed[_tokenAddress].latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L253

```solidity

File: OracleHelper.sol

530: (
            ,
            int256 answer,
            uint256 startedAt,
            ,
        ) = SEQUENCER.latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L530

```solidity

File: OracleHelper.sol

708: (
            roundId
            ,
            ,
            ,
            ,
        ) = priceFeed[_tokenAddress].latestRoundData();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L708

### [M-06]<a name="m-06"></a> Admin privilege - A single point of failure can allow a hacked or malicious owner use critical functions in the project

The `owner` role has a single point of failure and `onlyOwner` can use critical a few functions.

`owner` role in the project:
Owner is not behind a multisig and changes are not behind a timelock.

Even if protocol admins/developers are not malicious there is still a chance for Owner keys to be stolen. In such a case, the attacker can cause serious damage to the project due to important functions. In such a case, users who have invested in project will suffer high financial losses.

#### Impact
Hacked owner or malicious owner can immediately use critical functions in the project.

*There are 6 instance(s) of this issue:*

```solidity

File: CustomOracleSetup.sol

26: function renounceOwnership()
        external
        onlyOwner
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L26

```solidity

File: CustomOracleSetup.sol

34: function setLastUpdateGlobal(
        uint256 _time
    )
        external
        onlyOwner
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34

```solidity

File: CustomOracleSetup.sol

43: function setRoundData(
        uint80 _roundId,
        uint256 _updateTime
    )
        external
        onlyOwner
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43

```solidity

File: CustomOracleSetup.sol

53: function setGlobalAggregatorRoundId(
        uint80 _aggregatorRoundId
    )
        external
        onlyOwner
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53

```solidity

File: PendlePowerManager.sol

211: function exitFarm(
        uint256 _keyId,
        uint256 _allowedSpread,
        bool _ethBack
    )
        external
        updatePools
        onlyKeyOwner(_keyId)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L211

```solidity

File: PendlePowerManager.sol

275: function manuallyWithdrawShares(
        uint256 _keyId,
        uint256 _withdrawShares
    )
        external
        updatePools
        onlyKeyOwner(_keyId)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L275

### Low Risk Issues

### [L-01]<a name="l-01"></a> Addition/multiplication in `unchecked` block is unsafe

The additions/multiplications may silently overflow because they're in `unchecked` blocks with no preceding value checks, which may lead to unexpected results

*There are 1 instance(s) of this issue:*

```solidity

File: MainHelper.sol

321: totalPool + bareToken
            );



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L321

### [L-02]<a name="l-02"></a> Governance functions should be controlled by time locks

Governance functions (such as upgrading contracts, setting critical parameters) should be controlled using time locks to introduce a delay between a proposal and its execution. This gives users time to exit before a potentially dangerous or malicious operation is applied.

*There are 68 instance(s) of this issue:*

```solidity

File: PoolManager.sol

25: function setParamsLASA(
        address _poolToken,
        uint256 _poolMulFactor,
        uint256 _upperBoundMaxRate,
        uint256 _lowerBoundMaxRate,
        bool _steppingDirection,
        bool _isFinal
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25

```solidity

File: PoolManager.sol

26: function setParamsLASA(
        address _poolToken,
        uint256 _poolMulFactor,
        uint256 _upperBoundMaxRate,
        uint256 _lowerBoundMaxRate,
        bool _steppingDirection,
        bool _isFinal
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26

```solidity

File: PoolManager.sol

100: function setPoolParameters(
        address _poolToken,
        uint256 _collateralFactor,
        uint256 _maximumDeposit
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L100

```solidity

File: PoolManager.sol

101: function setPoolParameters(
        address _poolToken,
        uint256 _collateralFactor,
        uint256 _maximumDeposit
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L101

```solidity

File: PoolManager.sol

125: function setVerifiedIsolationPool(
        address _isolationPool,
        bool _state
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L125

```solidity

File: PoolManager.sol

126: function setVerifiedIsolationPool(
        address _isolationPool,
        bool _state
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126

```solidity

File: PositionNFTs.sol

319: function setBaseURI(
        string memory _newBaseURI
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L319

```solidity

File: PositionNFTs.sol

320: function setBaseURI(
        string memory _newBaseURI
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320

```solidity

File: PositionNFTs.sol

328: function setBaseExtension(
        string memory _newBaseExtension
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328

```solidity

File: PositionNFTs.sol

329: function setBaseExtension(
        string memory _newBaseExtension
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329

```solidity

File: WiseLending.sol

1386: function setRegistrationIsolationPool(
        uint256 _nftId,
        bool _registerState
    )
        external
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386

```solidity

File: WiseLending.sol

1387: function setRegistrationIsolationPool(
        uint256 _nftId,
        bool _registerState
    )
        external
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387

```solidity

File: WiseLendingDeclaration.sol

140: function setSecurity(
        address _wiseSecurity
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L140

```solidity

File: WiseLendingDeclaration.sol

141: function setSecurity(
        address _wiseSecurity
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141

```solidity

File: WiseLowLevelHelper.sol

424: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyFeeManager
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424

```solidity

File: WiseLowLevelHelper.sol

425: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyFeeManager
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425

```solidity

File: CustomOracleSetup.sol

33: function setLastUpdateGlobal(
        uint256 _time
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33

```solidity

File: CustomOracleSetup.sol

34: function setLastUpdateGlobal(
        uint256 _time
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34

```solidity

File: CustomOracleSetup.sol

42: function setRoundData(
        uint80 _roundId,
        uint256 _updateTime
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42

```solidity

File: CustomOracleSetup.sol

43: function setRoundData(
        uint80 _roundId,
        uint256 _updateTime
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43

```solidity

File: CustomOracleSetup.sol

52: function setGlobalAggregatorRoundId(
        uint80 _aggregatorRoundId
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L52

```solidity

File: CustomOracleSetup.sol

53: function setGlobalAggregatorRoundId(
        uint80 _aggregatorRoundId
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53

```solidity

File: FeeManager.sol

49: function setRepayBadDebtIncentive(
        uint256 _percent
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49

```solidity

File: FeeManager.sol

50: function setRepayBadDebtIncentive(
        uint256 _percent
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50

```solidity

File: FeeManager.sol

66: function setAaveFlag(
        address _poolToken,
        address _underlyingToken
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L66

```solidity

File: FeeManager.sol

67: function setAaveFlag(
        address _poolToken,
        address _underlyingToken
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L67

```solidity

File: FeeManager.sol

82: function setAaveFlagBulk(
        address[] calldata _poolTokens,
        address[] calldata _underlyingTokens
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L82

```solidity

File: FeeManager.sol

83: function setAaveFlagBulk(
        address[] calldata _poolTokens,
        address[] calldata _underlyingTokens
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83

```solidity

File: FeeManager.sol

108: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108

```solidity

File: FeeManager.sol

109: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109

```solidity

File: FeeManager.sol

135: function setPoolFeeBulk(
        address[] calldata _poolTokens,
        uint256[] calldata _newFees
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L135

```solidity

File: FeeManager.sol

136: function setPoolFeeBulk(
        address[] calldata _poolTokens,
        uint256[] calldata _newFees
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L136

```solidity

File: FeeManager.sol

315: function changeIncentiveUSDA(
        address _newOwner
    )
        external
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L315

```solidity

File: FeeManager.sol

316: function changeIncentiveUSDA(
        address _newOwner
    )
        external
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L316

```solidity

File: FeeManager.sol

352: function changeIncentiveUSDB(
        address _newOwner
    )
        external
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L352

```solidity

File: FeeManager.sol

353: function changeIncentiveUSDB(
        address _newOwner
    )
        external
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L353

```solidity

File: FeeManager.sol

514: function setBadDebtUserLiquidation(
        uint256 _nftId,
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514

```solidity

File: FeeManager.sol

515: function setBadDebtUserLiquidation(
        uint256 _nftId,
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L515

```solidity

File: FeeManager.sol

538: function setBeneficial(
        address _user,
        address[] calldata _feeTokens
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L538

```solidity

File: FeeManager.sol

539: function setBeneficial(
        address _user,
        address[] calldata _feeTokens
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L539

```solidity

File: PendlePowerManager.sol

63: function changeMinDeposit(
        uint256 _newMinDeposit
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63

```solidity

File: PendlePowerManager.sol

64: function changeMinDeposit(
        uint256 _newMinDeposit
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L64

```solidity

File: PendlePowerFarmController.sol

321: function changeExchangeIncentive(
        uint256 _newExchangeIncentive
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321

```solidity

File: PendlePowerFarmController.sol

322: function changeExchangeIncentive(
        uint256 _newExchangeIncentive
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L322

```solidity

File: PendlePowerFarmController.sol

334: function changeMintFee(
        address _pendleMarket,
        uint256 _newFee
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334

```solidity

File: PendlePowerFarmController.sol

335: function changeMintFee(
        address _pendleMarket,
        uint256 _newFee
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335

```solidity

File: PendlePowerFarmToken.sol

592: function changeMintFee(
        uint256 _newFee
    )
        external
        onlyController
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592

```solidity

File: PendlePowerFarmToken.sol

593: function changeMintFee(
        uint256 _newFee
    )
        external
        onlyController
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593

```solidity

File: PowerFarmNFTs.sol

51: function setFarmContract(
        address _farmContract
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51

```solidity

File: PowerFarmNFTs.sol

52: function setFarmContract(
        address _farmContract
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52

```solidity

File: PowerFarmNFTs.sol

161: function setBaseURI(
        string calldata _newBaseURI
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L161

```solidity

File: PowerFarmNFTs.sol

162: function setBaseURI(
        string calldata _newBaseURI
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162

```solidity

File: PowerFarmNFTs.sol

170: function setBaseExtension(
        string calldata _newBaseExtension
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170

```solidity

File: PowerFarmNFTs.sol

171: function setBaseExtension(
        string calldata _newBaseExtension
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171

```solidity

File: WiseSecurity.sol

85: function setLiquidationSettings(
        uint256 _baseReward,
        uint256 _baseRewardFarm,
        uint256 _newMaxFeeETH,
        uint256 _newMaxFeeFarmETH
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L85

```solidity

File: WiseSecurity.sol

86: function setLiquidationSettings(
        uint256 _baseReward,
        uint256 _baseRewardFarm,
        uint256 _newMaxFeeETH,
        uint256 _newMaxFeeFarmETH
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L86

```solidity

File: WiseSecurity.sol

980: function setBlacklistToken(
        address _tokenAddress,
        bool _state
    )
        external
        onlyMaster()
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980

```solidity

File: WiseSecurity.sol

981: function setBlacklistToken(
        address _tokenAddress,
        bool _state
    )
        external
        onlyMaster()
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981

```solidity

File: WiseSecurity.sol

995: function setSecurityWorker(
        address _entitiy,
        bool _state
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L995

```solidity

File: WiseSecurity.sol

996: function setSecurityWorker(
        address _entitiy,
        bool _state
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996

```solidity

File: WiseSecurity.sol

1111: function changeMinDepositValue(
        uint256 _newMinDepositValue
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111

```solidity

File: WiseSecurity.sol

1112: function changeMinDepositValue(
        uint256 _newMinDepositValue
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112

```solidity

File: AaveHub.sol

44: function setAaveTokenAddress(
        address _underlyingAsset,
        address _aaveToken
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L44

```solidity

File: AaveHub.sol

45: function setAaveTokenAddress(
        address _underlyingAsset,
        address _aaveToken
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L45

```solidity

File: AaveHub.sol

64: function setAaveTokenAddressBulk(
        address[] calldata _underlyingAssets,
        address[] calldata _aaveTokens
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L64

```solidity

File: AaveHub.sol

65: function setAaveTokenAddressBulk(
        address[] calldata _underlyingAssets,
        address[] calldata _aaveTokens
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L65

```solidity

File: Declarations.sol

105: function setWiseSecurity(
        address _securityAddress
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105

```solidity

File: Declarations.sol

106: function setWiseSecurity(
        address _securityAddress
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106

### [L-03]<a name="l-03"></a> IERC20 `approve()` Is Deprecated




*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerManager.sol

197: POSITION_NFT.approve(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L197

### [L-04]<a name="l-04"></a> Consider checking that transfer to `address(this)` is disabled

Functions allowing users to specify the receiving address should check whether the referenced address is not `address(this)`. This would prevent tokens to remain lock inside the contract due to an incorrect `transfer` or `mint`.

*There are 3 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

193: function _mintPositionForUser(
        address _user
    )
        internal
        returns (uint256)
    {
        uint256 nftId = reserved[
            _user
        ];

        if (nftId > 0) {
            delete reserved[
                _user
            ];

            totalReserved--;

        } else {
            nftId = getNextExpectedId();
        }

        _mint(
            _user,
            nftId
        );

        return nftId;
    }
194: function _mintPositionForUser(
        address _user
    )
        internal
        returns (uint256)
    {
        uint256 nftId = reserved[
            _user
        ];

        if (nftId > 0) {
            delete reserved[
                _user
            ];

            totalReserved--;

        } else {
            nftId = getNextExpectedId();
        }

        _mint(
            _user,
            nftId
        );

        return nftId;
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L193-L194

```solidity

File: WiseCore.sol

428: function _withdrawPureCollateralLiquidation(
        uint256 _nftId,
        address _poolToken,
        uint256 _percentLiquidation
    )
        private
        returns (uint256 transferAmount)
    {
        uint256 product = _percentLiquidation
            * pureCollateralAmount[_nftId][_poolToken];

        transferAmount = product / PRECISION_FACTOR_E18;

        _decreasePositionMappingValue(
            pureCollateralAmount,
            _nftId,
            _poolToken,
            transferAmount
        );

        _decreaseTotalBareToken(
            _poolToken,
            transferAmount
        );
    }
429: function _withdrawPureCollateralLiquidation(
        uint256 _nftId,
        address _poolToken,
        uint256 _percentLiquidation
    )
        private
        returns (uint256 transferAmount)
    {
        uint256 product = _percentLiquidation
            * pureCollateralAmount[_nftId][_poolToken];

        transferAmount = product / PRECISION_FACTOR_E18;

        _decreasePositionMappingValue(
            pureCollateralAmount,
            _nftId,
            _poolToken,
            transferAmount
        );

        _decreaseTotalBareToken(
            _poolToken,
            transferAmount
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L428-L429

```solidity

File: PowerFarmNFTs.sol

66: function mintKey(
        address _keyOwner,
        uint256 _keyId
    )
        external
        onlyFarmContract
    {
        _mint(
            _keyOwner,
            _keyId
        );
    }
67: function mintKey(
        address _keyOwner,
        uint256 _keyId
    )
        external
        onlyFarmContract
    {
        _mint(
            _keyOwner,
            _keyId
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L66-L67

### [L-05]<a name="l-05"></a> Owner can renounce Ownership

Typically, the contract's owner is the account that deploys the contract. As a result, the owner is able to perform certain privileged activities. The OpenZeppelin's `Ownable` is used in this project contract implements `renounceOwnership`. This can represent a certain risk if the ownership is renounced for any other reason than by design. Renouncing ownership will leave the contract without an owner, thereby removing any functionality that is only available to the owner.

*There are 19 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

9: contract OwnableMaster {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L9

```solidity

File: PositionNFTs.sol

11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {

34: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L34

```solidity

File: WiseLendingDeclaration.sol

31: OwnableMaster,

110: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L110, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L31

```solidity

File: DeclarationsFeeManager.sol

31: contract DeclarationsFeeManager is FeeManagerEvents, OwnableMaster {

41: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L41, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L31

```solidity

File: PendlePowerManager.sol

15: contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {

43: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L15, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L43

```solidity

File: PendlePowerFarmControllerBase.sol

31: OwnableMaster,

86: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L31, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L86

```solidity

File: PowerFarmNFTs.sol

24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {

46: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L46

```solidity

File: Declarations.sol

33: abstract contract Declarations is OwnableMaster {

50: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L50, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L33

```solidity

File: WiseSecurityDeclarations.sol

45: contract WiseSecurityDeclarations is OwnableMaster {

57: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L45, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L57

```solidity

File: Declarations.sol

21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {

48: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L48, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21

### [L-06]<a name="l-06"></a> Consider implementing two-step procedure for updating protocol addresses

A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must 'accept' the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the 'set' functions ensure that the recipient is of the right interface type.

*There are 14 instance(s) of this issue:*

```solidity

File: PoolManager.sol

26: function setParamsLASA(
        address _poolToken,
        uint256 _poolMulFactor,
        uint256 _upperBoundMaxRate,
        uint256 _lowerBoundMaxRate,
        bool _steppingDirection,
        bool _isFinal
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26

```solidity

File: PoolManager.sol

101: function setPoolParameters(
        address _poolToken,
        uint256 _collateralFactor,
        uint256 _maximumDeposit
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L101

```solidity

File: PoolManager.sol

126: function setVerifiedIsolationPool(
        address _isolationPool,
        bool _state
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126

```solidity

File: WiseLendingDeclaration.sol

141: function setSecurity(
        address _wiseSecurity
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141

```solidity

File: WiseLowLevelHelper.sol

425: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyFeeManager
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425

```solidity

File: FeeManager.sol

109: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109

```solidity

File: FeeManager.sol

316: function changeIncentiveUSDA(
        address _newOwner
    )
        external
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L316

```solidity

File: FeeManager.sol

353: function changeIncentiveUSDB(
        address _newOwner
    )
        external
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L353

```solidity

File: FeeManager.sol

539: function setBeneficial(
        address _user,
        address[] calldata _feeTokens
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L539

```solidity

File: PendlePowerFarmController.sol

335: function changeMintFee(
        address _pendleMarket,
        uint256 _newFee
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335

```solidity

File: PowerFarmNFTs.sol

52: function setFarmContract(
        address _farmContract
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52

```solidity

File: WiseSecurity.sol

981: function setBlacklistToken(
        address _tokenAddress,
        bool _state
    )
        external
        onlyMaster()
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981

```solidity

File: WiseSecurity.sol

996: function setSecurityWorker(
        address _entitiy,
        bool _state
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996

```solidity

File: Declarations.sol

106: function setWiseSecurity(
        address _securityAddress
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106

### [L-07]<a name="l-07"></a> Consider the case where `totalsupply` is 0

Consider the case where `totalsupply` is 0. When `totalsupply` is 0, it should return 0 directly, because there will be an error of dividing by 0.

#### <ins>Impact</ins>

This would cause the affected functions to revert and as a result can lead to potential loss.

*There are 3 instance(s) of this issue:*

```solidity

File: PendlePowerFarmToken.sol

331: / totalSupply();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L331

```solidity

File: PendlePowerFarmToken.sol

475: / totalSupply();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L475

```solidity

File: WiseSecurity.sol

626: / totalETHSupply;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L626

### [L-08]<a name="l-08"></a> Do not allow fees to be set to `100%`

It is recommended from a risk perspective to disallow setting 100% fees at all. A reasonable fee maximum should be checked for instead.

*There are 1 instance(s) of this issue:*

```solidity

File: WiseLowLevelHelper.sol


function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyFeeManager
    {
        globalPoolData[_poolToken].poolFee = _newFee;
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424-L425

### [L-09]<a name="l-09"></a> `decimals()` not part of ERC20 standard

`decimals()` is not part of the official ERC20 standard and might fail for tokens that do not implement it. While in practice it is very unlikely, as usually most of the tokens implement it, this should still be considered as a potential issue.

*There are 8 instance(s) of this issue:*

```solidity

File: PendleLpOracle.sol

44: if (FEED_ASSET.decimals()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L44

```solidity

File: PtOracleDerivative.sol

38: POW_USD_FEED = 10 ** USD_FEED_ASSET.decimals()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L38

```solidity

File: PtOracleDerivative.sol

39: POW_ETH_USD_FEED = 10 ** ETH_FEED_ASSET.decimals()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L39

```solidity

File: PtOraclePure.sol

35: POW_FEED = 10 ** FEED_ASSET.decimals()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L35

```solidity

File: PendlePowerFarmToken.sol

724: _decimals = PENDLE_SY.decimals()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L724

```solidity

File: Declarations.sol

58: ).decimals()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L58

```solidity

File: OracleHelper.sol

27: ).decimals()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L27

```solidity

File: OracleHelper.sol

457: return priceFeed[_tokenAddress].decimals()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L457

### [L-10]<a name="l-10"></a> External call recipient may consume all transaction gas

There is no limit specified on the amount of gas used, so the recipient can use up all of the transaction's gas, causing it to revert. Use `addr.call{gas: <amount>}("")` or [this](https://github.com/nomad-xyz/ExcessivelySafeCall) library instead.

*There are 6 instance(s) of this issue:*

```solidity

File: CallOptionalReturn.sol

22: ) = token.call(
            data
        );



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L22

```solidity

File: SendValueHelper.sol

27: ) = payable(_recipient).call{
            value: _amount
        }("");



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L27

```solidity

File: OracleHelper.sol

78: (bool success, ) = _tokenAggregator.call(
            abi.encodeWithSignature(
                "maxAnswer()"
            )
        );



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L78

```solidity

File: WiseSecurity.sol

208: ) = curvePool.call{value: 0} (
            curveSwapInfoData[_poolToken].swapBytesPool
        );

225: ) = curveMeta.call{value: 0} (
            curveSwapInfoData[_poolToken].swapBytesMeta
        );



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L225, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L208

```solidity

File: AaveHelper.sol

208: (bool success, ) = payable(_recipient).call{
            value: _amount
        }("");



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L208

### [L-11]<a name="l-11"></a> External calls in an un-bounded `for-`loop may result in a DOS

Consider limiting the number of iterations in `for-`loops that make external calls

*There are 1 instance(s) of this issue:*

```solidity

File: PowerFarmNFTs.sol

140: for (i; i < ownerTokenCount;) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L140

### [L-12]<a name="l-12"></a> `forceApprove` should be used instead of `approve`

In order to prevent front running, `forceApprove`  should be used in place of `approve` where possible 

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerManager.sol

197: POSITION_NFT.approve(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L197

### [L-13]<a name="l-13"></a> Functions which set address state variables should have zero address checks




*There are 3 instance(s) of this issue:*

```solidity

File: FeeManagerHelper.sol

232: function _setAaveFlag: address _underlyingToken

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L232

```solidity

File: PowerFarmNFTs.sol

52: function setFarmContract: address _farmContract

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52

```solidity

File: AaveHub.sol

666: function _setAaveTokenAddress: address _aaveToken

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L666

### [L-14]<a name="l-14"></a> Init functions are susceptible to front-running

The `initialize()` functions below are not called by another contract atomically after the contract is deployed, so it's possible for a malicious user to call `initialize()` which, if it's noticed in time, would require the project to re-deploy the contract in order to properly initialize. Consider creating a factory contract, which will `new` and `initialize()` each contract atomically.

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmToken.sol

function initialize(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L682

### [L-15]<a name="l-15"></a> Initialization function lacks parameter validation

Initialization functions play a critical role in contracts by setting important initial states when the contract is first deployed before the system starts. The parameters passed to the initialization functions directly affect the behavior of the contract / protocol. If incorrect parameters are provided, the system may fail to run, behave abnormally, be unstable, or lack security. Therefore, it's crucial to carefully check each parameter in the initialization functions. If an exception is found, the transaction should be rolled back.

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmToken.sol

682: function initialize(
        address _underlyingPendleMarket,
        address _pendleController,
        string memory _tokenName,
        string memory _symbolName,
        uint16 _maxCardinality
    )
        external
    {
        if (address(PENDLE_MARKET) != address(0)) {
            revert AlreadyInitialized();
        }

        PENDLE_MARKET = IPendleMarket(
            _underlyingPendleMarket
        );

        if (PENDLE_MARKET.isExpired() == true) {
            revert MarketExpired();
        }

        PENDLE_CONTROLLER = IPendleController(
            _pendleController
        );

        MAX_CARDINALITY = _maxCardinality;

        _name = _tokenName;
        _symbol = _symbolName;

        PENDLE_POWER_FARM_CONTROLLER = _pendleController;
        UNDERLYING_PENDLE_MARKET = _underlyingPendleMarket;

        (
            address pendleSyAddress,
            ,
        ) = PENDLE_MARKET.readTokens();

        PENDLE_SY = IPendleSy(
            pendleSyAddress
        );

        _decimals = PENDLE_SY.decimals();

        lastInteraction = block.timestamp;

        _totalSupply = 1;
        underlyingLpAssetsCurrent = 1;
        mintFee = 3000;
        INITIAL_TIME_STAMP = block.timestamp;
    }
}


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L683

### [L-16]<a name="l-16"></a> Lack of index element validation in function

There's no validation to check whether the index element provided as an argument actually exists in the call. This omission could lead to unintended behavior if an element that does not exist in the call is passed to the function.

The function should validate that the provided index element exists in the call before proceeding.

Without this validation, the function could cause unintended behaviour as it will call an non-existing index element. This could lead to inconsistencies in data and potentially affect the integrity of the call structure.

A validation can be added such as:
```solidity

require(structName[elementIndex] < size, "Element Index does not exist in the structName");

```

*There are 16 instance(s) of this issue:*

```solidity

File: MainHelper.sol

311: uint256 totalPool = globalPoolData[_poolToken].totalPool;

312: uint256 bareToken = globalPoolData[_poolToken].totalBareToken;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L311-L312

```solidity

File: MainHelper.sol

507: uint256 bareIncrease = borrowPoolData[_poolToken].borrowRate



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L507

```solidity

File: MainHelper.sol

856: uint256 pole = borrowRatesData[_poolToken].pole;

857: uint256 utilization = globalPoolData[_poolToken].utilization;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L856-L857

```solidity

File: MainHelper.sol

1130: uint256 minValue = borrowRatesData[_poolToken].minPole;

1132: uint256 delta = borrowRatesData[_poolToken].deltaPole

1135: uint256 sub = borrowRatesData[_poolToken].pole > delta



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1135, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1132, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1130

```solidity

File: WiseCore.sol

479: uint256 totalPoolToken = globalPoolData[_poolToken].totalPool;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L479

```solidity

File: WiseLending.sol

1096: uint256 maxBorrowShares = userBorrowShares[_nftId][WETH_ADDRESS];



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1096

```solidity

File: FeeManager.sol

289: uint256 amount = gatheredIncentiveToken[msg.sender][_feeToken];



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L289

```solidity

File: FeeManagerHelper.sol

348: uint256 reduceUSD = usdEquivalent < incentiveUSD[_incentiveOwner]



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L348

```solidity

File: PendlePowerFarmLeverageLogic.sol

575: address paybackToken = isAave[_nftId] == true

584: uint256 cutoffShares = isAave[_nftId] == true



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L584, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L575

```solidity

File: WiseSecurity.sol

153: address curvePool = curveSwapInfoData[_poolToken].curvePool;

168: address curveMetaPool = curveSwapInfoData[_poolToken].curveMetaPool;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L153, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L168

```solidity

File: WiseSecurity.sol

199: address curvePool = curveSwapInfoData[_poolToken].curvePool;

216: address curveMeta = curveSwapInfoData[_poolToken].curveMetaPool;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L216, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L199

### [L-17]<a name="l-17"></a> Possible rounding issue

Division by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator

*There are 16 instance(s) of this issue:*

```solidity

File: MainHelper.sol

866: / baseDivider;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L866

```solidity

File: PoolManager.sol

301: return (_maxPole - _minPole) / NORMALISATION_FACTOR;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L301

```solidity

File: WiseLending.sol

177: / borrowPoolData[_poolToken].totalBorrowShares;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L177

```solidity

File: FeeManagerHelper.sol

341: / WISE_LENDING.globalPoolData(_poolToken).poolFee;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L341

```solidity

File: PendlePowerFarm.sol

86: / totalCollateral;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L86

```solidity

File: PendlePowerFarmMathLogic.sol

382: / baseDivider;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L382

```solidity

File: PendlePowerFarmToken.sol

462: / _underlyingLpAssetsCurrent;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L462

```solidity

File: PendlePowerFarmToken.sol

491: : product / _underlyingLpAssetsCurrent + 1;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L491

```solidity

File: OracleHelper.sol

227: / _fetchTwapValue;

232: / _answerUint256;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L232, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L227

```solidity

File: WiseSecurity.sol

76: / overallCollateral;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L76

```solidity

File: WiseSecurityHelper.sol

310: / currentTotalLendingShares;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L310

```solidity

File: WiseSecurityHelper.sol

639: / currentTotalBorrowShares;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L639

```solidity

File: WiseSecurityHelper.sol

785: return numerator / denominator + 1;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L785

```solidity

File: WiseSecurityHelper.sol

1040: / BORROW_PERCENTAGE_CAP;

1044: / WISE_LENDING.lendingPoolData(_poolToken).collateralFactor;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1044, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1040

### [L-18]<a name="l-18"></a> Minting tokens to the zero address should be avoided

The core function `mint` is used by users to mint an option position by providing token1 as collateral and borrowing the max amount of liquidity. `Address(0)` check is missing in both this function and the internal function `_mint`, which is triggered to mint the tokens to the to address. Consider applying a check in the function to ensure tokens aren't minted to the zero address.

*There are 12 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol


function mintPositionForUser(
        address _user
    )
        external
        returns (uint256)
    {
        if (isApprovedForAll(
                _user,
                msg.sender
            ) == false
        ) {
            revert NotPermitted();
        }

        return _mintPositionForUser(
            _user
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L174-L175

```solidity

File: PositionNFTs.sol


function approveMint(
        address _spender,
        uint256 _nftId
    )
        external
    {
        if (reserved[msg.sender] == _nftId) {
            approve(
                _spender,
                _mintPositionForUser(
                    msg.sender
                )
            );

            return;
        }

        approve(
            _spender,
            _nftId
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L245-L246

```solidity

File: WiseLending.sol


function depositExactAmountETHMint()
        external
        payable
        syncPool(WETH_ADDRESS)
        returns (uint256)
    {
        return _depositExactAmountETH(
            _reservePosition()
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L426

```solidity

File: WiseLending.sol


function depositExactAmountMint(
        address _poolToken,
        uint256 _amount
    )
        external
        returns (uint256)
    {
        return depositExactAmount(
            _reservePosition(),
            _poolToken,
            _amount
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L442-L443

```solidity

File: WiseLending.sol


function solelyDepositETHMint()
        external
        payable
    {
        solelyDepositETH(
            _reservePosition()
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L493

```solidity

File: WiseLending.sol


function solelyDepositMint(
        address _poolToken,
        uint256 _amount
    )
        external
    {
        solelyDeposit(
            _reservePosition(),
            _poolToken,
            _amount
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L581-L582

```solidity

File: PendlePowerFarmController.sol


function changeMintFee(
        address _pendleMarket,
        uint256 _newFee
    )
        external
        onlyMaster
    {
        address child = pendleChildAddress[
            _pendleMarket
        ];

        if (child == ZERO_ADDRESS) {
            revert WrongAddress();
        }

        IPendlePowerFarmToken(
            child
        ).changeMintFee(
            _newFee
        );

        emit ChangeMintFee(
            _pendleMarket,
            _newFee
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334-L335

```solidity

File: PendlePowerFarmToken.sol


function changeMintFee(
        uint256 _newFee
    )
        external
        onlyController
    {
        if (_newFee > MAX_MINT_FEE) {
            revert FeeTooHigh();
        }

        mintFee = _newFee;
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592-L593

```solidity

File: MinterReserver.sol


function mintReserved()
        external
        returns (uint256)
    {
        return _mintKeyForUser(
            reservedKeys[
                msg.sender
            ],
            msg.sender
        );
    }

    event ERC721Received(
        address operator,
        address from,
        uint256 tokenId,
        bytes _data
    );


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L141

```solidity

File: PowerFarmNFTs.sol


function mintKey(
        address _keyOwner,
        uint256 _keyId
    )
        external
        onlyFarmContract
    {
        _mint(
            _keyOwner,
            _keyId
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L66-L67

```solidity

File: AaveHub.sol


function depositExactAmountMint(
        address _underlyingAsset,
        uint256 _amount
    )
        external
        returns (uint256)
    {
        return depositExactAmount(
            _reservePosition(),
            _underlyingAsset,
            _amount
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L103-L104

```solidity

File: AaveHub.sol


function depositExactAmountETHMint()
        external
        payable
        returns (uint256)
    {
        return depositExactAmountETH(
            _reservePosition()
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L158

### [L-19]<a name="l-19"></a> The Contract Should `approve(0)` First

Some tokens (like USDT L199) do not work when changing the allowance from an existing non-zero allowance value. They must first be approved by zero and then the actual allowance must be approved.

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerManager.sol

197: POSITION_NFT.approve(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L197

### [L-20]<a name="l-20"></a> Constructor is missing zero address check

In Solidity, constructors often take address parameters to initialize important components of a contract, such as owner or linked contracts. However, without a check, there's a risk that an address parameter could be mistakenly set to the zero address (0x0). This could occur due to a mistake or oversight during contract deployment. A zero address in a crucial role can cause serious issues, as it cannot perform actions like a normal address, and any funds sent to it are irretrievable. Therefore, it's crucial to include a zero address check in constructors to prevent such potential problems. If a zero address is detected, the constructor should revert the transaction.

*There are 7 instance(s) of this issue:*

```solidity

File: PendleLpOracle.sol

32: constructor: address _pendleMarketAddress

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L32

```solidity

File: PtOracleDerivative.sol

24: constructor: address _pendleMarketAddress

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L24

```solidity

File: PtOraclePure.sol

24: constructor: address _pendleMarketAddress

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L24

```solidity

File: PendlePowerFarmDeclarations.sol

159: constructor: address _pendleChilTokenAddress

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L159

```solidity

File: PendlePowerFarmControllerBase.sol

79: constructor: address _vePendle

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L79

```solidity

File: PendlePowerFarmTokenFactory.sol

16: constructor: address _pendlePowerFarmController

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L16

```solidity

File: Declarations.sol

45: constructor: address _wethAddress

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L45

### [L-21]<a name="l-21"></a> Cap state variables at reasonable values

Consider adding maximum value checks to ensure that state variables cannot be set to values that may excessively harm users.

*There are 15 instance(s) of this issue:*

```solidity

File: PoolManager.sol


function setParamsLASA(
        address _poolToken,
        uint256 _poolMulFactor,
        uint256 _upperBoundMaxRate,
        uint256 _lowerBoundMaxRate,
        bool _steppingDirection,
        bool _isFinal
    )
        external
        onlyMaster
    {
        if (parametersLocked[_poolToken] == true) {
            revert InvalidAction();
        }

        parametersLocked[_poolToken] = _isFinal;

        AlgorithmEntry storage algoData = algorithmData[
            _poolToken
        ];

        algoData.increasePole = _steppingDirection;

        _validateParameter(
            _upperBoundMaxRate,
            UPPER_BOUND_MAX_RATE
        );

        _validateParameter(
            _lowerBoundMaxRate,
            LOWER_BOUND_MAX_RATE
        );

        _validateParameter(
            _lowerBoundMaxRate,
            _upperBoundMaxRate
        );

        uint256 staticMinPole = _getPoleValue(
            _poolMulFactor,
            _upperBoundMaxRate
        );

        uint256 staticMaxPole = _getPoleValue(
            _poolMulFactor,
            _lowerBoundMaxRate
        );

        uint256 staticDeltaPole = _getDeltaPole(
            staticMaxPole,
            staticMinPole
        );

        uint256 startValuePole = _getStartValue(
            staticMaxPole,
            staticMinPole
        );

        _validateParameter(
            _poolMulFactor,
            PRECISION_FACTOR_E18
        );

        borrowRatesData[_poolToken] = BorrowRatesEntry(
            startValuePole,
            staticDeltaPole,
            staticMinPole,
            staticMaxPole,
            _poolMulFactor
        );

        algoData.bestPole = startValuePole;
        algoData.maxValue = lendingPoolData[_poolToken].totalDepositShares;
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25-L26

```solidity

File: PoolManager.sol


function setPoolParameters(
        address _poolToken,
        uint256 _collateralFactor,
        uint256 _maximumDeposit
    )
        external
        onlyMaster
    {
        if (_maximumDeposit > 0) {
            maxDepositValueToken[_poolToken] = _maximumDeposit;
        }

        if (_collateralFactor > 0) {
            lendingPoolData[_poolToken].collateralFactor = _collateralFactor;
        }

        _validateParameter(
            _collateralFactor,
            PRECISION_FACTOR_E18
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L100-L101

```solidity

File: WiseLending.sol


function setRegistrationIsolationPool(
        uint256 _nftId,
        bool _registerState
    )
        external
    {
        _onlyIsolationPool(
            msg.sender
        );

        _validateZero(
            WISE_SECURITY.overallETHCollateralsBare(_nftId)
        );

        _validateZero(
            WISE_SECURITY.overallETHBorrowBare(_nftId)
        );

        positionLocked[_nftId] = _registerState;
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386-L1387

```solidity

File: WiseLowLevelHelper.sol


function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyFeeManager
    {
        globalPoolData[_poolToken].poolFee = _newFee;
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424-L425

```solidity

File: CustomOracleSetup.sol


function setLastUpdateGlobal(
        uint256 _time
    )
        external
        onlyOwner
    {
        lastUpdateGlobal = _time;
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33-L34

```solidity

File: CustomOracleSetup.sol


function setRoundData(
        uint80 _roundId,
        uint256 _updateTime
    )
        external
        onlyOwner
    {
        timeStampByRoundId[_roundId] = _updateTime;
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42-L43

```solidity

File: FeeManager.sol


function setRepayBadDebtIncentive(
        uint256 _percent
    )
        external
        onlyMaster
    {
        _checkValue(
            _percent
        );

        paybackIncentive = _percent;
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49-L50

```solidity

File: FeeManager.sol


function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyMaster
    {
        _checkValue(
            _newFee
        );

        WISE_LENDING.setPoolFee(
            _poolToken,
            _newFee
        );

        emit PoolFeeChanged(
            _poolToken,
            _newFee,
            block.timestamp
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108-L109

```solidity

File: FeeManager.sol


function setPoolFeeBulk(
        address[] calldata _poolTokens,
        uint256[] calldata _newFees
    )
        external
        onlyMaster
    {
        uint256 i;
        uint256 l = _poolTokens.length;

        while (i < l) {

            _checkValue(
                _newFees[i]
            );

            WISE_LENDING.setPoolFee(
                _poolTokens[i],
                _newFees[i]
            );

            emit PoolFeeChanged(
                _poolTokens[i],
                _newFees[i],
                block.timestamp
            );

            unchecked {
                ++i;
            }
        }
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L135-L136

```solidity

File: FeeManager.sol


function setBadDebtUserLiquidation(
        uint256 _nftId,
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {
        _setBadDebtPosition(
            _nftId,
            _amount
        );

        emit SetBadDebtPosition(
            _nftId,
            _amount,
            block.timestamp
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514-L515

```solidity

File: PendlePowerManager.sol


function changeMinDeposit(
        uint256 _newMinDeposit
    )
        external
        onlyMaster
    {
        minDepositEthAmount = _newMinDeposit;

        emit MinDepositChange(
            _newMinDeposit,
            block.timestamp
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63-L64

```solidity

File: PendlePowerFarmController.sol


function changeExchangeIncentive(
        uint256 _newExchangeIncentive
    )
        external
        onlyMaster
    {
        exchangeIncentive = _newExchangeIncentive;

        emit ChangeExchangeIncentive(
            _newExchangeIncentive
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321-L322

```solidity

File: PendlePowerFarmController.sol


function changeMintFee(
        address _pendleMarket,
        uint256 _newFee
    )
        external
        onlyMaster
    {
        address child = pendleChildAddress[
            _pendleMarket
        ];

        if (child == ZERO_ADDRESS) {
            revert WrongAddress();
        }

        IPendlePowerFarmToken(
            child
        ).changeMintFee(
            _newFee
        );

        emit ChangeMintFee(
            _pendleMarket,
            _newFee
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334-L335

```solidity

File: PendlePowerFarmToken.sol


function changeMintFee(
        uint256 _newFee
    )
        external
        onlyController
    {
        if (_newFee > MAX_MINT_FEE) {
            revert FeeTooHigh();
        }

        mintFee = _newFee;
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592-L593

```solidity

File: WiseSecurity.sol


function changeMinDepositValue(
        uint256 _newMinDepositValue
    )
        external
        onlyMaster
    {
        if (_newMinDepositValue == 0) {
            revert NoValue();
        }

        minDepositEthValue = _newMinDepositValue;
    }
}


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111-L1112

### [L-22]<a name="l-22"></a> Missing Checks for Address(0x0)

Lack of zero-address validation on address parameters may lead to transaction reverts, waste gas, require resubmission of transactions and may even force contract redeployments in certain cases within the protocol.

*There are 16 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

72: function forwardFeeManagerNFT: address _feeManagerContract

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L72

```solidity

File: WiseLending.sol

1253: function liquidatePartiallyFromTokens: address _paybackToken

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1253

```solidity

File: WiseLending.sol

1254: function liquidatePartiallyFromTokens: address _receiveToken

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1254

```solidity

File: WiseLending.sol

1317: function coreLiquidationIsolationPools: address _caller

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1317

```solidity

File: WiseLending.sol

1318: function coreLiquidationIsolationPools: address _paybackToken

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1318

```solidity

File: WiseLending.sol

1319: function coreLiquidationIsolationPools: address _receiveToken

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1319

```solidity

File: WiseLending.sol

1368: function syncManually: address _poolToken

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1368

```solidity

File: FeeManager.sol

629: function claimWiseFees: address _poolToken

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L629

```solidity

File: FeeManagerHelper.sol

232: function _setAaveFlag: address _underlyingToken

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L232

```solidity

File: PendlePowerFarmToken.sol

683: function initialize: address _underlyingPendleMarket

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L683

```solidity

File: PendlePowerFarmToken.sol

684: function initialize: address _pendleController

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L684

```solidity

File: PowerFarmNFTs.sol

52: function setFarmContract: address _farmContract

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52

```solidity

File: CallOptionalReturn.sol

13: function _callOptionalReturn: address token

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L13

```solidity

File: OracleHelper.sol

14: function _addOracle: IPriceFeed _priceFeedAddress

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L14

```solidity

File: OracleHelper.sol

61: function _checkFunctionExistence: address _tokenAggregator

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L61

```solidity

File: AaveHub.sol

666: function _setAaveTokenAddress: address _aaveToken

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L666

### [L-23]<a name="l-23"></a> Protect your NFT from copying in POW forks

Ethereum has performed the long-awaited "merge" that will dramatically reduce the environmental impact of the network

There may be forked versions of Ethereum, which could cause confusion and lead to scams as duplicated NFT assets enter the market.

If the Ethereum Merge, which took place in September 2022, results in the Blockchain splitting into two Blockchains due to the 'THE DAO' attack in 2016, this could result in duplication of immutable tokens (NFTs).

In any case, duplicate NFTs will exist due to the ETH proof-of-work chain and other potential forks, and there’s likely to be some level of confusion around which assets are 'official' or 'authentic.'

Even so, there could be a frenzy for these copies, as NFT owners attempt to flip the proof-of-work versions of their valuable tokens.

As ETHPOW and any other forks spin off of the Ethereum mainnet, they will yield duplicate versions of Ethereum’s NFTs. An NFT is simply a blockchain token, and it can work as a deed of ownership to digital items like artwork and collectibles. A forked Ethereum chain will thus have duplicated deeds that point to the same tokenURI

About Merge Replay Attack: https://twitter.com/elerium115/status/1558471934924431363?s=20&t=RRheaYJwo-GmSnePwofgag

*There are 2 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

340: function tokenURI(

341: function tokenURI(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L340-L341

```solidity

File: PowerFarmNFTs.sol

182: function tokenURI(

183: function tokenURI(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L182-L183

### [L-24]<a name="l-24"></a> Contracts are designed to receive ETH but do not implement function for withdrawal

The following contracts can receive ETH but can not withdraw, ETH is occasionally sent by users will be stuck in those contracts.
This functionality also applies to baseTokens resulting in locked tokens and loss of funds.

*There are 2 instance(s) of this issue:*

```solidity

File: PendlePowerManager.sol

21: receive()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L21

```solidity

File: PendlePowerFarmControllerBase.sol

125: receive()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L125

### [L-25]<a name="l-25"></a> `safeTransfer` function does not check for contract existence

According to the implementation of the of the library's safeTransfer function, the contract existences are not checked. It is possible that a token becomes non-existent in the future; for instance, if some bugs are found for the output token, it is possible that the output token will be destroyed through calling its selfdestruct function after migrating its data to another contract for fixing these bugs. When this happens, such output token becomes non-existent but calling the swap function to swap for it does not revert. As a result, the user can lose tokens 

*There are 2 instance(s) of this issue:*

```solidity

File: TransferHelper.sol

13: function _safeTransfer(
        address _token,
        address _to,
        uint256 _value
    )
        internal
    {
        _callOptionalReturn(
            _token,
            abi.encodeWithSelector(
                IERC20.transfer.selector,
                _to,
                _value
            )
        );
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L13

```solidity

File: TransferHelper.sol

34: function _safeTransferFrom(
        address _token,
        address _from,
        address _to,
        uint256 _value
    )
        internal
    {
        _callOptionalReturn(
            _token,
            abi.encodeWithSelector(
                IERC20.transferFrom.selector,
                _from,
                _to,
                _value
            )
        );
    }
}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L34

### [L-26]<a name="l-26"></a> `tokenURI()` does not follow EIP-721

The <a href="https://eips.ethereum.org/EIPS/eip-721">EIP</a> states that `tokenURI()` "Throws if `_tokenId` is not a valid NFT", which the code below does not do. If the NFT has not yet been minted, `tokenURI()` should revert

*There are 2 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

341: function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {
        require(
            _exists(_tokenId) == true,
            "PositionNFTs: WRONG_TOKEN"
        );

        string memory currentBaseURI = baseURI;

        if (bytes(currentBaseURI).length == 0) {
            return "";
        }

        return string(
            abi.encodePacked(
                currentBaseURI,
                _toString(_tokenId),
                baseExtension
            )
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L341

```solidity

File: PowerFarmNFTs.sol

183: function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {
        require(
            _exists(_tokenId) == true,
            "PowerFarmsNFTs: WRONG_TOKEN"
        );

        string memory currentBaseURI = baseURI;

        if (bytes(currentBaseURI).length == 0) {
            return "";
        }

        return string(
            abi.encodePacked(
                currentBaseURI,
                _toString(_tokenId),
                baseExtension
            )
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L183

### [L-27]<a name="l-27"></a> Usage of `payable.transfer` can lead to loss of funds

The funds that are to be sent can be lost. The issues with `transfer()` and `send()` are outlined <a href="https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/">here</a>:
The `transfer()` call requires that the recipient to be either an EOA account, or a contract that has a `payable` callback. For the contract case, the `transfer()` call only provides 2300 gas for the contract to complete its operations. This means the following cases can cause the transfer to fail:

- The contract does not have a `payable` callback
- The contract's `payable` callback spends more than 2300 gas (which is only enough to emit something)
- The contract is called through a proxy which itself uses up the 2300 gas Use OpenZeppelin's `Address.sendValue()` instead

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmController.sol

607: payable(_to).transfer(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L607

### [L-28]<a name="l-28"></a> A year is not always 365 days

On leap years, the number of days is 366, so calculations during those years will return the wrong value

*There are 3 instance(s) of this issue:*

```solidity

File: WiseLendingDeclaration.sol

300: uint256 internal constant ONE_YEAR = 365 days;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L300

```solidity

File: PendlePowerFarmToken.sol

53: uint256 internal constant ONE_YEAR = 365 days;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L53

```solidity

File: WiseSecurityDeclarations.sol

210: uint256 internal constant ONE_YEAR = 365 days;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L210

### Gas Risk Issues

### [G-01]<a name="g-01"></a> `abi.encode()` is less efficient than `abi.encodepacked()`

See for more information: https://github.com/ConnorBlockchain/Solidity-Encode-Gas-Comparison 

*There are 2 instance(s) of this issue:*

```solidity

File: PendlePowerFarmLeverageLogic.sol

41: abi.encode(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L41

```solidity

File: PendlePowerFarmControllerHelper.sol

226: abi.encode(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L226

### [G-02]<a name="g-02"></a> Activate the optimizer

Before deploying your contract, activate the optimizer when compiling using “solc --optimize --bin sourceFile.sol”. By default, the optimizer will optimize the contract assuming it is called 200 times across its lifetime. If you want the initial contract deployment to be cheaper and the later function executions to be more expensive, set it to “ --optimize-runs=1”. Conversely, if you expect many transactions and do not care for higher deployment cost and output size, set “--optimize-runs” to a high number.

```
module.exports = {
	solidity: {
		version: "0.8.19",
		settings: {
			optimizer: {
				enabled: true,
				runs: 1000,
			},
		},
	},
};
```
Kindly visit the following site for further information:

https://docs.soliditylang.org/en/v0.8.19/using-the-compiler.html#using-the-commandline-compiler

Here is one particular example of instance on opcode comparison that delineates the gas saving mechanism:

```
for !=0 before optimization
PUSH1 0x00
DUP2
EQ
ISZERO
PUSH1 [cont offset]
JUMPI

after optimization
DUP1
PUSH1 [revert offset]
JUMPI
```

*There are 1 instance(s) of this issue:*

All in-scope contracts

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0

### [G-03]<a name="g-03"></a> Consider activating `via-ir` for deploying

The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions.

You can enable it on the command line using `--via-ir` or with the option `{"viaIR": true}`.

This will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command

More on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html

*There are 1 instance(s) of this issue:*

All in-scope contracts

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0

### [G-04]<a name="g-04"></a> `address(this)` can be stored in `state variable` that will ultimately cost less, than every time calculating this, specifically when it used multiple times in a `contract`




*There are 34 instance(s) of this issue:*

```solidity

File: MainHelper.sol

286: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L286

```solidity

File: PositionNFTs.sol

84: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L84

```solidity

File: WiseCore.sol

677: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L677

```solidity

File: WiseLending.sol

479: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L479

```solidity

File: WiseLending.sol

625: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L625

```solidity

File: WiseLending.sol

1193: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1193

```solidity

File: WiseLending.sol

1233: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1233

```solidity

File: FeeManager.sol

659: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L659

```solidity

File: PendlePowerFarm.sol

139: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L139

```solidity

File: PendlePowerFarmLeverageLogic.sol

167: _receiver: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L167

```solidity

File: PendlePowerFarmLeverageLogic.sol

279: recipient: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L279

```solidity

File: PendlePowerFarmLeverageLogic.sol

444: _receiver: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L444

```solidity

File: PendlePowerManager.sol

112: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L112

```solidity

File: PendlePowerFarmController.sol

89: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L89

```solidity

File: PendlePowerFarmController.sol

145: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L145

```solidity

File: PendlePowerFarmController.sol

187: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L187

```solidity

File: PendlePowerFarmController.sol

265: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L265

```solidity

File: PendlePowerFarmController.sol

400: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L400

```solidity

File: PendlePowerFarmController.sol

540: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L540

```solidity

File: PendlePowerFarmController.sol

588: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L588

```solidity

File: PendlePowerFarmControllerHelper.sol

50: return _getPositionData(address(this)).expiry;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L50

```solidity

File: PendlePowerFarmControllerHelper.sol

58: return _getPositionData(address(this)).amount;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L58

```solidity

File: SendValueHelper.sol

18: if (address(this).balance < _amount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L18

```solidity

File: AaveHelper.sol

67: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L67

```solidity

File: AaveHelper.sol

178: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L178

```solidity

File: AaveHelper.sol

202: if (address(this).balance < _amount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L202

```solidity

File: AaveHub.sol

135: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L135

```solidity

File: AaveHub.sol

256: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L256

```solidity

File: AaveHub.sol

329: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L329

```solidity

File: AaveHub.sol

408: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L408

```solidity

File: AaveHub.sol

454: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L454

```solidity

File: AaveHub.sol

528: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L528

```solidity

File: AaveHub.sol

586: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L586

```solidity

File: AaveHub.sol

626: IERC20(tokenToSend).balanceOf(address(this))



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L626

### [G-05]<a name="g-05"></a> `<array>.length` Should Not Be Looked Up In Every Loop Of A For-loop

The overheads outlined below are PER LOOP, excluding the first loop

storage arrays incur a Gwarmaccess (100 gas)
memory arrays use MLOAD (3 gas)
calldata arrays use CALLDATALOAD (3 gas)

Caching the length changes each of these to a DUP<N> (3 gas), and gets rid of the extra DUP<N> needed to store the stack offset

*There are 1 instance(s) of this issue:*

```solidity

File: AaveHub.sol

71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71

### [G-06]<a name="g-06"></a> Avoid repeating computations

The following instances show only the first instance of the repeated computations.

*There are 3 instance(s) of this issue:*

```solidity

File: MainHelper.sol

43: _product / _pseudo



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L43

```solidity

File: PendlePowerFarmToken.sol

490: product / _underlyingLpAssetsCurrent



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L490

```solidity

File: OracleHelper.sol

122: _decimalsWETH - decimals



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L122

### [G-07]<a name="g-07"></a> Avoid updating storage when the value hasn't changed

If the old value is equal to the new value, not re-storing the value will avoid a Gsreset (2900 gas), potentially at the expense of a Gcoldsload (2100 gas) or a Gwarmaccess (100 gas)

*There are 52 instance(s) of this issue:*

```solidity

File: PoolManager.sol

125: function setVerifiedIsolationPool(
        address _isolationPool,
        bool _state
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L125

```solidity

File: PoolManager.sol

126: function setVerifiedIsolationPool(
        address _isolationPool,
        bool _state
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126

```solidity

File: PositionNFTs.sol

319: function setBaseURI(
        string memory _newBaseURI
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L319

```solidity

File: PositionNFTs.sol

320: function setBaseURI(
        string memory _newBaseURI
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320

```solidity

File: PositionNFTs.sol

328: function setBaseExtension(
        string memory _newBaseExtension
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328

```solidity

File: PositionNFTs.sol

329: function setBaseExtension(
        string memory _newBaseExtension
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329

```solidity

File: WiseLending.sol

1386: function setRegistrationIsolationPool(
        uint256 _nftId,
        bool _registerState
    )
        external
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386

```solidity

File: WiseLending.sol

1387: function setRegistrationIsolationPool(
        uint256 _nftId,
        bool _registerState
    )
        external
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387

```solidity

File: WiseLowLevelHelper.sol

424: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyFeeManager
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424

```solidity

File: WiseLowLevelHelper.sol

425: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyFeeManager
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425

```solidity

File: CustomOracleSetup.sol

33: function setLastUpdateGlobal(
        uint256 _time
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33

```solidity

File: CustomOracleSetup.sol

34: function setLastUpdateGlobal(
        uint256 _time
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34

```solidity

File: CustomOracleSetup.sol

42: function setRoundData(
        uint80 _roundId,
        uint256 _updateTime
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42

```solidity

File: CustomOracleSetup.sol

43: function setRoundData(
        uint80 _roundId,
        uint256 _updateTime
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43

```solidity

File: CustomOracleSetup.sol

52: function setGlobalAggregatorRoundId(
        uint80 _aggregatorRoundId
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L52

```solidity

File: CustomOracleSetup.sol

53: function setGlobalAggregatorRoundId(
        uint80 _aggregatorRoundId
    )
        external
        onlyOwner
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53

```solidity

File: FeeManager.sol

49: function setRepayBadDebtIncentive(
        uint256 _percent
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49

```solidity

File: FeeManager.sol

50: function setRepayBadDebtIncentive(
        uint256 _percent
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50

```solidity

File: FeeManager.sol

66: function setAaveFlag(
        address _poolToken,
        address _underlyingToken
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L66

```solidity

File: FeeManager.sol

67: function setAaveFlag(
        address _poolToken,
        address _underlyingToken
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L67

```solidity

File: FeeManager.sol

82: function setAaveFlagBulk(
        address[] calldata _poolTokens,
        address[] calldata _underlyingTokens
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L82

```solidity

File: FeeManager.sol

83: function setAaveFlagBulk(
        address[] calldata _poolTokens,
        address[] calldata _underlyingTokens
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83

```solidity

File: FeeManager.sol

108: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108

```solidity

File: FeeManager.sol

109: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109

```solidity

File: FeeManager.sol

514: function setBadDebtUserLiquidation(
        uint256 _nftId,
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514

```solidity

File: FeeManager.sol

515: function setBadDebtUserLiquidation(
        uint256 _nftId,
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L515

```solidity

File: PendlePowerManager.sol

63: function changeMinDeposit(
        uint256 _newMinDeposit
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63

```solidity

File: PendlePowerManager.sol

64: function changeMinDeposit(
        uint256 _newMinDeposit
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L64

```solidity

File: PendlePowerFarmController.sol

321: function changeExchangeIncentive(
        uint256 _newExchangeIncentive
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321

```solidity

File: PendlePowerFarmController.sol

322: function changeExchangeIncentive(
        uint256 _newExchangeIncentive
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L322

```solidity

File: PendlePowerFarmController.sol

334: function changeMintFee(
        address _pendleMarket,
        uint256 _newFee
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334

```solidity

File: PendlePowerFarmController.sol

335: function changeMintFee(
        address _pendleMarket,
        uint256 _newFee
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335

```solidity

File: PendlePowerFarmToken.sol

592: function changeMintFee(
        uint256 _newFee
    )
        external
        onlyController
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592

```solidity

File: PendlePowerFarmToken.sol

593: function changeMintFee(
        uint256 _newFee
    )
        external
        onlyController
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593

```solidity

File: PowerFarmNFTs.sol

51: function setFarmContract(
        address _farmContract
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51

```solidity

File: PowerFarmNFTs.sol

52: function setFarmContract(
        address _farmContract
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52

```solidity

File: PowerFarmNFTs.sol

161: function setBaseURI(
        string calldata _newBaseURI
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L161

```solidity

File: PowerFarmNFTs.sol

162: function setBaseURI(
        string calldata _newBaseURI
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162

```solidity

File: PowerFarmNFTs.sol

170: function setBaseExtension(
        string calldata _newBaseExtension
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170

```solidity

File: PowerFarmNFTs.sol

171: function setBaseExtension(
        string calldata _newBaseExtension
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171

```solidity

File: WiseSecurity.sol

85: function setLiquidationSettings(
        uint256 _baseReward,
        uint256 _baseRewardFarm,
        uint256 _newMaxFeeETH,
        uint256 _newMaxFeeFarmETH
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L85

```solidity

File: WiseSecurity.sol

86: function setLiquidationSettings(
        uint256 _baseReward,
        uint256 _baseRewardFarm,
        uint256 _newMaxFeeETH,
        uint256 _newMaxFeeFarmETH
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L86

```solidity

File: WiseSecurity.sol

980: function setBlacklistToken(
        address _tokenAddress,
        bool _state
    )
        external
        onlyMaster()
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980

```solidity

File: WiseSecurity.sol

981: function setBlacklistToken(
        address _tokenAddress,
        bool _state
    )
        external
        onlyMaster()
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981

```solidity

File: WiseSecurity.sol

995: function setSecurityWorker(
        address _entitiy,
        bool _state
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L995

```solidity

File: WiseSecurity.sol

996: function setSecurityWorker(
        address _entitiy,
        bool _state
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996

```solidity

File: WiseSecurity.sol

1111: function changeMinDepositValue(
        uint256 _newMinDepositValue
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111

```solidity

File: WiseSecurity.sol

1112: function changeMinDepositValue(
        uint256 _newMinDepositValue
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112

```solidity

File: AaveHub.sol

44: function setAaveTokenAddress(
        address _underlyingAsset,
        address _aaveToken
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L44

```solidity

File: AaveHub.sol

45: function setAaveTokenAddress(
        address _underlyingAsset,
        address _aaveToken
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L45

```solidity

File: Declarations.sol

105: function setWiseSecurity(
        address _securityAddress
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105

```solidity

File: Declarations.sol

106: function setWiseSecurity(
        address _securityAddress
    )
        external
        onlyMaster
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106

### [G-08]<a name="g-08"></a> Avoid zero transfer to save gas

In Solidity, unnecessary operations can waste gas. For example, a transfer function without a zero amount check uses gas even if called with a zero amount, since the contract state remains unchanged. Implementing a zero amount check avoids these unnecessary function calls, saving gas and improving efficiency.

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmController.sol

607: payable(_to).transfer(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L607

### [G-09]<a name="g-09"></a> Call `msg.sender` directly instead of caching them

In the instance below, instead of caching `msg.sender` and incurring unnecessary stack manipulation, we can call `msg.sender` directly.

*There are 1 instance(s) of this issue:*

```solidity

File: FeeManager.sol

695: address caller = msg.sender;

function claimFeesBeneficial(
        address _feeToken,
        uint256 _amount
    )
        external
    {
        address caller = msg.sender;

        if (totalBadDebtETH > 0) {
            revert ExistingBadDebt();
        }

        if (allowedTokens[caller][_feeToken] == false) {
            revert NotAllowed();
        }

        _decreaseFeeTokens(
            _feeToken,
            _amount
        );

        _safeTransfer(
            _feeToken,
            caller,
            _amount
        );

        emit ClaimedFeesBeneficial(
            caller,
            _feeToken,
            _amount,
            block.timestamp
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L695

### [G-10]<a name="g-10"></a> Gas savings can be achieved by changing the model for assigning value to the structure

Here's an example to illustrate this:
```solidity
	struct MyStruct {
	    uint256 a;
	    uint256 b;
	    uint256 c;
	}

	function assignValuesToStruct(uint256 _a, uint256 _b, uint256 _c) public {
	    MyStruct memory myStruct = MyStruct(_a, _b, _c);
	    // Do something with myStruct
	}
```
In this example, we have a simple MyStruct data structure with three uint256 fields. The assignValuesToStruct function takes three input parameters _a, _b, and _c, and assigns them to the corresponding fields in a new myStruct variable. This is done using the struct constructor syntax, which creates a new instance of the MyStruct struct with the specified field values.

The following approach can be more efficient than assigning values to the struct fields:
```solidity
	function assignValuesToStruct(uint256 _a, uint256 _b, uint256 _c) public {
	    MyStruct memory myStruct;
	    myStruct.a = _a;
	    myStruct.b = _b;
	    myStruct.c = _c;
	    // Do something with myStruct
	}
```
By changing the pattern of assigning value to the structure, gas savings of `~130` per instance are achieved. In addition, this use will provide significant savings in distribution costs.

*There are 6 instance(s) of this issue:*

```solidity

File: PoolManager.sol

239: algorithmData[_params.poolToken] = AlgorithmEntry({
            bestPole: startValuePole,
            maxValue: 0,
            previousValue: 0,
            increasePole: false
        });

208: globalPoolData[_params.poolToken] = GlobalPoolEntry({
            totalPool: 0,
            utilization: 0,
            totalBareToken: 0,
            poolFee: 20 * PRECISION_FACTOR_E16
        });

247: lendingPoolData[_params.poolToken] = LendingPoolEntry({
            pseudoTotalPool: GHOST_AMOUNT,
            totalDepositShares: GHOST_AMOUNT,
            collateralFactor: _params.poolCollFactor
        });

231: borrowPoolData[_params.poolToken] = BorrowPoolEntry({
            allowBorrow: _params.allowBorrow,
            pseudoTotalBorrowAmount: GHOST_AMOUNT,
            totalBorrowShares: GHOST_AMOUNT,
            borrowRate: 0
        });

254: timestampsPoolData[_params.poolToken] = TimestampsPoolEntry({
            timeStamp: block.timestamp,
            timeStampScaling: block.timestamp,
            initialTimeStamp: block.timestamp
        });



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L247, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L239, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L208, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L231, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L254

```solidity

File: OracleHelper.sol

186: uniTwapPoolInfo[_tokenAddress] = UniTwapPoolInfo({
            oracle: _oracle,
            isUniPool: _isUniPool
        });



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L186

### [G-11]<a name="g-11"></a> Comparing to constant boolean

There is no need to verify that `== true` or `== false` when the variable checked upon is a boolean as well.

*There are 90 instance(s) of this issue:*

```solidity

File: MainHelper.sol

223: if (verifiedIsolationPool[_poolAddress] == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L223

```solidity

File: MainHelper.sol

244: if (positionLocked[_nftId] == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L244

```solidity

File: MainHelper.sol

265: if (positionLocked[_nftIdLiquidator] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L265

```solidity

File: MainHelper.sol

627: if (hashMap[hashData] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L627

```solidity

File: MainHelper.sol

1165: if (_checkLendingDataEmpty(_nftId, _poolToken) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1165

```solidity

File: PoolManager.sol

36: if (parametersLocked[_poolToken] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L36

```solidity

File: PositionNFTs.sol

161: if (_exists(tokenId) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L161

```solidity

File: WiseCore.sol

76: if (_onBehalf == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L76

```solidity

File: WiseCore.sol

200: if (_byPassCase(_caller) == true) {

204: if (positionLocked[_nftId] == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L204, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L200

```solidity

File: WiseCore.sol

246: if (WISE_ORACLE.chainLinkIsDead(_poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L246

```solidity

File: WiseCore.sol

282: if (POSITION_NFT.isOwner(_nftId, _caller) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L282

```solidity

File: WiseCore.sol

306: if (state == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L306

```solidity

File: WiseCore.sol

397: if (_onBehalf == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L397

```solidity

File: WiseCore.sol

592: if (userLendingData[_nftId][_receiveTokens].unCollateralized == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L592

```solidity

File: WiseLending.sol

87: if (powerFarmCheck == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L87

```solidity

File: WiseLending.sol

290: if (_aboveThreshold(_poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L290

```solidity

File: WiseLending.sol

1527: if (_onBehalf == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1527

```solidity

File: WiseLowLevelHelper.sol

354: if (sendingProgress == true) {

358: if (_sendingProgressAaveHub() == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L354, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L358

```solidity

File: WiseLowLevelHelper.sol

400: if (verifiedIsolationPool[_sender] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L400

```solidity

File: PendleLpOracle.sol

104: if (increaseCardinalityRequired == true) {

108: if (oldestObservationSatisfied == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L104, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L108

```solidity

File: PtOracleDerivative.sol

109: if (increaseCardinalityRequired == true) {

113: if (oldestObservationSatisfied == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L109, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L113

```solidity

File: PtOraclePure.sol

90: if (increaseCardinalityRequired == true) {

94: if (oldestObservationSatisfied == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L94, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L90

```solidity

File: FeeManager.sol

261: if (isAaveToken[tokenAddress] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L261

```solidity

File: FeeManager.sol

418: if (poolTokenAdded[_poolToken] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L418

```solidity

File: FeeManager.sol

449: if (poolTokenAdded[_poolToken] == false) {

473: if (found == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L449, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L473

```solidity

File: FeeManager.sol

650: if (isAaveToken[_poolToken] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L650

```solidity

File: FeeManager.sol

701: if (allowedTokens[caller][_feeToken] == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L701

```solidity

File: PendlePowerFarm.sol

127: if (isAave[_nftId] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L127

```solidity

File: PendlePowerFarm.sol

203: if (_notBelowMinDepositAmount(leveragedAmount) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L203

```solidity

File: PendlePowerFarmDeclarations.sol

365: if (isShutdown == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L365

```solidity

File: PendlePowerFarmLeverageLogic.sol

67: if (allowEnter == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L67

```solidity

File: PendlePowerFarmLeverageLogic.sol

215: if (_ethBack == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L215

```solidity

File: PendlePowerFarmLeverageLogic.sol

333: if (_isAave == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L333

```solidity

File: PendlePowerFarmLeverageLogic.sol

520: if (_checkDebtRatio(_nftId) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L520

```solidity

File: PendlePowerFarmLeverageLogic.sol

538: if (_isAave == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L538

```solidity

File: PendlePowerFarmLeverageLogic.sol

571: if (_checkDebtRatio(_nftId) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L571

```solidity

File: PendlePowerFarmMathLogic.sol

39: if (sendingProgress == true) {

43: if (WISE_LENDING.sendingProgress() == true) {

47: if (AAVE_HUB.sendingProgressAaveHub() == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L39, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L43, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L47

```solidity

File: PendlePowerManager.sol

291: if (_checkDebtRatio(wiseLendingNFT) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L291

```solidity

File: PendlePowerFarmController.sol

304: if (_compareHashes(_pendleMarket, rewardTokens) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L304

```solidity

File: PendlePowerFarmController.sol

396: if (_fromInside == false) {

396: if (_fromInside == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L396, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L396

```solidity

File: PendlePowerFarmController.sol

456: if (IS_ETH_MAIN == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L456

```solidity

File: PendlePowerFarmToken.sol

154: if (_overWritten == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L154

```solidity

File: PendlePowerFarmToken.sol

699: if (PENDLE_MARKET.isExpired() == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L699

```solidity

File: CallOptionalReturn.sol

31: if (success == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L31

```solidity

File: SendValueHelper.sol

33: if (success == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L33

```solidity

File: OracleHelper.sol

45: if (_checkFunctionExistence(address(tokenAggregator)) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L45

```solidity

File: OracleHelper.sol

117: if (uniTwapPoolInfoStruct.isUniPool == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L117

```solidity

File: OracleHelper.sol

270: if (_chainLinkIsDead(ETH_USD_PLACEHOLDER) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L270

```solidity

File: OracleHelper.sol

526: if (IS_ARBITRUM_CHAIN == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L526

```solidity

File: WiseOracleHub.sol

76: if (chainLinkIsDead(_tokenAddress) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L76

```solidity

File: WiseOracleHub.sol

451: if (sequencerIsDead() == true) {

475: if (state == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L451, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L475

```solidity

File: WiseSecurity.sol

246: if (_checkBlacklisted(_poolToken) == true) {

255: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {

259: if (WISE_LENDING.positionLocked(_nftId) == true) {

263: if (_isUncollateralized(_nftId, _poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L246, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L263, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L259, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L255

```solidity

File: WiseSecurity.sol

284: if (_checkBlacklisted(_poolToken) == true) {

293: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {

297: if (WISE_LENDING.positionLocked(_nftId) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L293, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L284, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L297

```solidity

File: WiseSecurity.sol

323: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {

327: if (WISE_LENDING.positionLocked(_nftId) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L327, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L323

```solidity

File: WiseSecurity.sol

343: if (checkHeartbeat(_poolAddress) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L343

```solidity

File: WiseSecurity.sol

367: if (_checkBlacklisted(_poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L367

```solidity

File: WiseSecurity.sol

671: if (checkHeartbeat(token) == false) {

675: if (wasBlacklisted[token] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L675, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L671

```solidity

File: WiseSecurity.sol

716: if (_checkBlacklisted(token) == true) {

716: if (_checkBlacklisted(token) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L716, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L716

```solidity

File: WiseSecurity.sol

792: if (_isUncollateralized(_nftId, _poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L792

```solidity

File: WiseSecurity.sol

842: if (_isUncollateralized(_nftId, _poolToken) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L842

```solidity

File: WiseSecurity.sol

1014: if (securityWorker[msg.sender] == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1014

```solidity

File: WiseSecurityHelper.sol

206: if (_isUncollateralized(_nftId, _poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L206

```solidity

File: WiseSecurityHelper.sol

263: if (_isUncollateralized(_nftId, _poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L263

```solidity

File: WiseSecurityHelper.sol

678: if (WISE_LENDING.borrowPoolData(_poolAddress).allowBorrow == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L678

```solidity

File: WiseSecurityHelper.sol

707: if (WISE_LENDING.positionLocked(_nftId) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L707

```solidity

File: WiseSecurityHelper.sol

801: if (_getState(_nftId, _powerFarm) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L801

```solidity

File: WiseSecurityHelper.sol

1086: if (_checkBlacklisted(_poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1086

```solidity

File: WiseSecurityHelper.sol

1102: if (_success == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1102

```solidity

File: AaveHelper.sol

38: if (sendingProgressAaveHub == true) {

42: if (WISE_LENDING.sendingProgress() == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L42, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L38

```solidity

File: AaveHelper.sol

70: if (POSITION_NFT.isOwner(_nftId, msg.sender) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L70

```solidity

File: AaveHelper.sol

214: if (success == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L214

### [G-12]<a name="g-12"></a> Consider using solady's 'FixedPointMathLib'

Using Solady's 'FixedPointMathLib' for multiplication or division operations in Solidity can lead to significant gas savings. This library is designed to optimize fixed-point arithmetic operations, which are common in financial calculations involving tokens or currencies. By implementing more efficient algorithms and assembly optimizations, 'FixedPointMathLib' minimizes the computational resources required for these operations. 

For contracts that frequently perform such calculations, integrating this library can reduce transaction costs, thereby enhancing overall performance and cost-effectiveness. However, developers must ensure compatibility with their existing codebase and thoroughly test for accuracy and expected behavior to avoid any unintended consequences.

*There are 1 instance(s) of this issue:*

```solidity

File: WiseSecurityHelper.sol

893: : totalSharesUser * MAX_LIQUIDATION_50 / PRECISION_FACTOR_E18;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L893

### [G-13]<a name="g-13"></a> Setting the `constructor` to `payable`

Saves ~13 gas per instance

*There are 25 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

57: constructor(
        address _master
    )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L57

```solidity

File: PositionNFTs.sol

25: constructor(
        string memory _name,
        string memory _symbol,
        string memory _baseURI
    )
        ERC721(
            _name,
            _symbol
        )
        OwnableMaster(
            msg.sender
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L25

```solidity

File: WiseLending.sol

116: constructor(
        address _master,
        address _wiseOracleHubAddress,
        address _nftContract
    )
        WiseLendingDeclaration(
            _master,
            _wiseOracleHubAddress,
            _nftContract
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L116

```solidity

File: WiseLendingDeclaration.sol

105: constructor(
        address _master,
        address _wiseOracleHub,
        address _nftContract
    )
        OwnableMaster(
            _master
        )
        WrapperHelper(
            IWiseOracleHub(
                _wiseOracleHub
            ).WETH_ADDRESS()
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L105

```solidity

File: CustomOracleSetup.sol

22: constructor()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L22

```solidity

File: PendleChildLpOracle.sol

21: constructor(
        address _pendleLpOracle,
        address _pendleChild
    )
        CustomOracleSetup()

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L21

```solidity

File: PendleLpOracle.sol

32: constructor(
        address _pendleMarketAddress,
        IPriceFeed _priceFeedChainLinkEth,
        IOraclePendle _oraclePendlePt,
        string memory _oracleName,
        uint32 _twapDuration
    )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L32

```solidity

File: PtOracleDerivative.sol

24: constructor(
        address _pendleMarketAddress,
        IPriceFeed _priceFeedChainLinkUsd,
        IPriceFeed _priceFeedChainLinkEthUsd,
        IOraclePendle _oraclePendlePt,
        string memory _oracleName,
        uint32 _twapDuration
    )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L24

```solidity

File: PtOraclePure.sol

24: constructor(
        address _pendleMarketAddress,
        IPriceFeed _priceFeedChainLinkEth,
        IOraclePendle _oraclePendlePt,
        string memory _oracleName,
        uint32 _twapDuration
    )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L24

```solidity

File: DeclarationsFeeManager.sol

33: constructor(
        address _master,
        address _aaveAddress,
        address _wiseLendingAddress,
        address _oracleHubAddress,
        address _wiseSecurityAddress,
        address _positionNFTAddress
    )
        OwnableMaster(
            _master
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L33

```solidity

File: FeeManager.sol

27: constructor(
        address _master,
        address _aaveAddress,
        address _wiseLendingAddress,
        address _oracleHubAddress,
        address _wiseSecurityAddress,
        address _positionNFTAddress
    )
        DeclarationsFeeManager(
            _master,
            _aaveAddress,
            _wiseLendingAddress,
            _oracleHubAddress,
            _wiseSecurityAddress,
            _positionNFTAddress
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L27

```solidity

File: PendlePowerFarmDeclarations.sol

159: constructor(
        address _wiseLendingAddress,
        address _pendleChilTokenAddress,
        address _pendleRouter,
        address _entryAsset,
        address _pendleSy,
        address _underlyingMarket,
        address _routerStatic,
        address _dexAddress,
        uint256 _collateralFactor
    )
        WrapperHelper(
            IWiseLending(
                _wiseLendingAddress
            ).WETH_ADDRESS()
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L159

```solidity

File: PendlePowerManager.sol

31: constructor(
        address _wiseLendingAddress,
        address _pendleChilTokenAddress,
        address _pendleRouter,
        address _entryAsset,
        address _pendleSy,
        address _underlyingMarket,
        address _routerStatic,
        address _dexAddress,
        uint256 _collateralFactor,
        address _powerFarmNFTs
    )
        OwnableMaster(
            msg.sender
        )
        MinterReserver(
            _powerFarmNFTs
        )
        PendlePowerFarmDeclarations(
            _wiseLendingAddress,
            _pendleChilTokenAddress,
            _pendleRouter,
            _entryAsset,
            _pendleSy,
            _underlyingMarket,
            _routerStatic,
            _dexAddress,
            _collateralFactor
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L31

```solidity

File: PendlePowerFarmController.sol

12: constructor(
        address _vePendle,
        address _pendleToken,
        address _voterContract,
        address _voterRewardsClaimerAddress,
        address _wiseOracleHub
    )
        PendlePowerFarmControllerBase(
            _vePendle,
            _pendleToken,
            _voterContract,
            _voterRewardsClaimerAddress,
            _wiseOracleHub
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L12

```solidity

File: PendlePowerFarmControllerBase.sol

79: constructor(
        address _vePendle,
        address _pendleToken,
        address _voterContract,
        address _voterRewardsClaimerAddress,
        address _wiseOracleHub
    )
        OwnableMaster(
            msg.sender
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L79

```solidity

File: PendlePowerFarmTokenFactory.sol

16: constructor(
        address _pendlePowerFarmController
    )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L16

```solidity

File: MinterReserver.sol

55: constructor(
        address _powerFarmNFTs
    )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L55

```solidity

File: PowerFarmNFTs.sol

38: constructor(
        string memory _name,
        string memory _symbol
    )
        ERC721(
            _name,
            _symbol
        )
        OwnableMaster(
            msg.sender
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L38

```solidity

File: WrapperHelper.sol

11: constructor(
        address _wethAddress
    )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L11

```solidity

File: Declarations.sol

45: constructor(
        address _wethAddress,
        address _ethPriceFeed,
        address _uniswapV3Factory
    )
        OwnableMaster(
            msg.sender
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L45

```solidity

File: WiseOracleHub.sol

33: constructor(
        address _wethAddrss,
        address _ethPricingFeed,
        address _uniswapFactoryV3
    )
        Declarations(
            _wethAddrss,
            _ethPricingFeed,
            _uniswapFactoryV3
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L33

```solidity

File: WiseSecurity.sol

42: constructor(
        address _master,
        address _wiseLendingAddress,
        address _aaveHubAddress
    )
        WiseSecurityDeclarations(
            _master,
            _wiseLendingAddress,
            _aaveHubAddress
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L42

```solidity

File: WiseSecurityDeclarations.sol

52: constructor(
        address _master,
        address _wiseLendingAddress,
        address _aaveHubAddress
    )
        OwnableMaster(
            _master
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L52

```solidity

File: AaveHub.sol

27: constructor(
        address _master,
        address _aaveAddress,
        address _lendingAddress
    )
        Declarations(
            _master,
            _aaveAddress,
            _lendingAddress
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L27

```solidity

File: Declarations.sol

43: constructor(
        address _master,
        address _aaveAddress,
        address _lendingAddress
    )
        OwnableMaster(
            _master
        )
        WrapperHelper(
            IWiseLending(
                _lendingAddress
            ).WETH_ADDRESS()
        )

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L43

### [G-14]<a name="g-14"></a> Counting down in `for` statements is more gas efficient

Counting down is more gas efficient than counting up because neither we are making zero variable to non-zero variable and also we will get gas refund in the last transaction when making non-zero to zero variable.

*There are 1 instance(s) of this issue:*

```solidity

File: AaveHub.sol

71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71

### [G-15]<a name="g-15"></a> Divisions which do not divide by -X cannot overflow or overflow so such operations can be unchecked to save gas

Make such found divisions are unchecked when ensured it is safe to do so

*There are 2 instance(s) of this issue:*

```solidity

File: PoolManager.sol

301: return (_maxPole - _minPole) / NORMALISATION_FACTOR;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L301

```solidity

File: PoolManager.sol

312: return (_maxPole + _minPole) / 2;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L312

### [G-16]<a name="g-16"></a> Use shift Right instead of division if possible to save gas




*There are 14 instance(s) of this issue:*

```solidity

File: PoolManager.sol

285: return PRECISION_FACTOR_E18 / 2


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L285

```solidity

File: PoolManager.sol

286: + (PRECISION_FACTOR_E36 / 4


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L286

```solidity

File: PoolManager.sol

312: return (_maxPole + _minPole) / 2;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L312

```solidity

File: WiseLendingDeclaration.sol

170: uint256 internal constant MIN_BORROW_SHARE_PRICE = 5 * PRECISION_FACTOR_E18
        / 10;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L170

```solidity

File: OracleHelper.sol

122: ) / 10 ** (_decimalsWETH - decimals(_tokenAddress));


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L122

```solidity

File: WiseOracleHub.sol

110: * latestResolver(_tokenAddress)
                / 10 ** decimals(_tokenAddress)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L110

```solidity

File: WiseOracleHub.sol

112: / 10 ** (tokenDecimals - _decimalsETH)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L112

```solidity

File: WiseOracleHub.sol

115: * latestResolver(_tokenAddress)
                / 10 ** decimals(_tokenAddress);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L115

```solidity

File: WiseOracleHub.sol

135: * getETHPriceInUSD()
            / 10 ** _decimalsUSD;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L135

```solidity

File: WiseOracleHub.sol

161: * latestResolver(_tokenAddress)
                / 10 ** decimals(_tokenAddress)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L161

```solidity

File: WiseOracleHub.sol

163: / 10 ** (tokenDecimals - _decimalsETH)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L163

```solidity

File: WiseOracleHub.sol

166: * latestResolver(_tokenAddress)
                / 10 ** decimals(_tokenAddress);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L166

```solidity

File: WiseOracleHub.sol

190: / latestResolver(_tokenAddress)
                / 10 ** (_decimalsETH - tokenDecimals);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L190

```solidity

File: WiseOracleHub.sol

350: / latestResolver(_tokenAddress)
                / 10 ** (_decimalsETH - tokenDecimals);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L350

### [G-17]<a name="g-17"></a> Empty Blocks Should Be Removed Or Emit Something

The code should be refactored such that they no longer exist, or the block should do something useful, such as emitting an event or reverting. If the contract is meant to be extended, the contract should be abstract and the function signatures be added without any default implementation. If the block is an empty if-statement block to avoid doing subsequent checks in the else-if/else conditions, the else-if/else conditions should be nested under the negation of the if-statement, because they involve different classes of checks, which may lead to the introduction of errors when the code is later modified (if(x){}else if(y){...}else{...} => if(!x){if(y){...}else{...}})

*There are 1 instance(s) of this issue:*

```solidity

File: WiseSecurity.sol

52: {}

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L52

### [G-18]<a name="g-18"></a> Using `delete` statement can save gas




*There are 7 instance(s) of this issue:*

```solidity

File: PendlePowerManager.sol

228: reservedKeys[msg.sender] = 0;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L228

```solidity

File: PendlePowerFarmController.sol

268: childInfo.reservedForCompound[i] = 0;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L268

```solidity

File: PendlePowerFarmController.sol

459: reservedPendleForLocking = 0;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L459

```solidity

File: PendlePowerFarmToken.sol

256: rewardsOutsideArray[i] = 0;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L256

```solidity

File: OracleHelper.sol

418: secondsAgo[1] = 0;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L418

```solidity

File: WiseSecurity.sol

600: i = 0;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L600

```solidity

File: WiseSecurity.sol

732: i = 0;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L732

### [G-19]<a name="g-19"></a> `++i` Costs Less Gas Than `i++`, Especially When It’s Used In For-loops (`--i`/`i--` Too)

Saves 6 gas per loop

*There are 1 instance(s) of this issue:*

```solidity

File: AaveHub.sol

71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71

### [G-20]<a name="g-20"></a> Use `assembly` to write address storage values




*There are 14 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

63: master = _master;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L63

```solidity

File: OwnableMaster.sol

80: proposedMaster = _proposedOwner;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L80

```solidity

File: PositionNFTs.sol

81: feeManager = _feeManagerContract;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L81

```solidity

File: PendleLpOracle.sol

40: PENDLE_MARKET_ADDRESS = _pendleMarketAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L40

```solidity

File: PtOraclePure.sol

32: PENDLE_MARKET_ADDRESS = _pendleMarketAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L32

```solidity

File: DeclarationsFeeManager.sol

87: incentiveMaster = _master;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L87

```solidity

File: PendlePowerFarmDeclarations.sol

204: ENTRY_ASSET = _entryAsset;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L204

```solidity

File: PendlePowerFarmDeclarations.sol

205: PENDLE_CHILD = _pendleChilTokenAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L205

```solidity

File: PendlePowerFarmToken.sol

712: PENDLE_POWER_FARM_CONTROLLER = _pendleController;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L712

```solidity

File: PendlePowerFarmToken.sol

713: UNDERLYING_PENDLE_MARKET = _underlyingPendleMarket;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L713

```solidity

File: PendlePowerFarmTokenFactory.sol

20: PENDLE_POWER_FARM_CONTROLLER = _pendlePowerFarmController;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L20

```solidity

File: PowerFarmNFTs.sol

58: farmContract = _farmContract;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L58

```solidity

File: Declarations.sol

54: WETH_ADDRESS = _wethAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L54

```solidity

File: WiseSecurityDeclarations.sol

75: AAVE_HUB = _aaveHubAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L75

### [G-21]<a name="g-21"></a> Use hardcoded address instead `address(this)`

Instead of using `address(this)`, it is more gas-efficient to pre-calculate and use the hardcoded `address`. Foundry's script.sol and solmate's `LibRlp.sol` contracts can help achieve this.

References: 
https://book.getfoundry.sh/reference/forge-std/compute-create-address 

https://twitter.com/transmissions11/status/1518507047943245824

*There are 39 instance(s) of this issue:*

```solidity

File: MainHelper.sol

286: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L286

```solidity

File: PositionNFTs.sol

84: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L84

```solidity

File: WiseCore.sol

677: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L677

```solidity

File: WiseLending.sol

479: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L479

```solidity

File: WiseLending.sol

625: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L625

```solidity

File: WiseLending.sol

1193: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1193

```solidity

File: WiseLending.sol

1233: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1233

```solidity

File: FeeManager.sol

659: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L659

```solidity

File: PendlePowerFarm.sol

139: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L139

```solidity

File: PendlePowerFarmLeverageLogic.sol

167: _receiver: address(this),

167: _receiver: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L167, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L167

```solidity

File: PendlePowerFarmLeverageLogic.sol

279: recipient: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L279

```solidity

File: PendlePowerFarmLeverageLogic.sol

444: _receiver: address(this),

444: _receiver: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L444, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L444

```solidity

File: PendlePowerManager.sol

112: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L112

```solidity

File: PendlePowerFarmController.sol

89: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L89

```solidity

File: PendlePowerFarmController.sol

145: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L145

```solidity

File: PendlePowerFarmController.sol

187: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L187

```solidity

File: PendlePowerFarmController.sol

265: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L265

```solidity

File: PendlePowerFarmController.sol

400: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L400

```solidity

File: PendlePowerFarmController.sol

540: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L540

```solidity

File: PendlePowerFarmController.sol

588: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L588

```solidity

File: PendlePowerFarmControllerHelper.sol

50: return _getPositionData(address(this)).expiry;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L50

```solidity

File: PendlePowerFarmControllerHelper.sol

58: return _getPositionData(address(this)).amount;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L58

```solidity

File: SendValueHelper.sol

18: if (address(this).balance < _amount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L18

```solidity

File: AaveHelper.sol

67: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L67

```solidity

File: AaveHelper.sol

178: address(this)

178: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L178, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L178

```solidity

File: AaveHelper.sol

202: if (address(this).balance < _amount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L202

```solidity

File: AaveHub.sol

135: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L135

```solidity

File: AaveHub.sol

256: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L256

```solidity

File: AaveHub.sol

329: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L329

```solidity

File: AaveHub.sol

408: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L408

```solidity

File: AaveHub.sol

454: address(this),

454: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L454, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L454

```solidity

File: AaveHub.sol

528: address(this)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L528

```solidity

File: AaveHub.sol

586: address(this),

586: address(this),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L586, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L586

```solidity

File: AaveHub.sol

626: IERC20(tokenToSend).balanceOf(address(this))



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L626

### [G-22]<a name="g-22"></a> Hash using `assembly` instead of solidity

Saves about ~80 gas

```solidity
function solidityHash(uint256 a, uint256 b) public view {
    //unoptimized
    keccak256(abi.encodePacked(a, b));
}
```
Gas Test: 313

```solidity
function assemblyHash(uint256 a, uint256 b) public view {
    //optimized
    assembly {
        mstore(0x00, a)
        mstore(0x20, b)
        let hashedVal := keccak256(0x00, 0x40)
    }
} 
```
Gas Test: 231

*There are 3 instance(s) of this issue:*

```solidity

File: MainHelper.sol

655: return keccak256(
            abi.encodePacked(
                _nftId,
                _poolToken
            )
        );



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L655

```solidity

File: PendlePowerFarmControllerHelper.sol

225: return keccak256(
            abi.encode(
                rewardTokensToCompare
            )
        ) == keccak256(
            abi.encode(
                pendleChildCompoundInfo[_pendleMarket].rewardTokens
            )
        );



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L225

```solidity

File: PendlePowerFarmTokenFactory.sol

65: bytes32 salt = keccak256(
            abi.encodePacked(
                _underlyingPendleMarket
            )
        );



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L65

### [G-23]<a name="g-23"></a> Increments can be `unchecked` to save gas

Using `unchecked` increments can save gas by bypassing the built-in overflow checks. This can save [30-40 gas](https://gist.github.com/hrkrshnn/ee8fabd532058307229d65dcd5836ddc#the-increment-in-for-loop-post-condition-can-be-made-unchecked) **per iteration**. So it is recommended to use `unchecked` increments when overflow is not possible.

*There are 6 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

386: length++;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L386

```solidity

File: PendlePowerManager.sol

236: ++availableNFTCount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L236

```solidity

File: MinterReserver.sol

67: return ++totalReserved;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L67

```solidity

File: MinterReserver.sol

135: totalMinted++;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L135

```solidity

File: PowerFarmNFTs.sol

228: length++;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L228

```solidity

File: AaveHub.sol

71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71

### [G-24]<a name="g-24"></a> It Costs More Gas To Initialize Variables To Zero Than To Let The Default Of Zero Be Applied




*There are 1 instance(s) of this issue:*

```solidity

File: AaveHub.sol

71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71

### [G-25]<a name="g-25"></a> `internal` functions only called once can be inlined to save gas




*There are 173 instance(s) of this issue:*

```solidity

File: MainHelper.sol

93: function _cashoutAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L93

```solidity

File: MainHelper.sol

135: function _preparationsWithdraw



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L135

```solidity

File: MainHelper.sol

217: function _onlyIsolationPool



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L217

```solidity

File: MainHelper.sol

232: function _validateIsolationPoolLiquidation



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L232

```solidity

File: MainHelper.sol

258: function _checkLiquidatorNft



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L258

```solidity

File: MainHelper.sol

278: function _getBalance



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L278

```solidity

File: MainHelper.sol

298: function _cleanUp



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L298

```solidity

File: MainHelper.sol

372: function _preparePool



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L372

```solidity

File: MainHelper.sol

391: function _preparationTokens



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L391

```solidity

File: MainHelper.sol

454: function _curveSecurityChecks



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L454

```solidity

File: MainHelper.sol

584: function _increasePositionLendingDeposit



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L584

```solidity

File: MainHelper.sol

599: function _decreaseLendingShares



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L599

```solidity

File: MainHelper.sol

614: function _addPositionTokenData



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L614

```solidity

File: MainHelper.sol

752: function _corePayback



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L752

```solidity

File: MainHelper.sol

851: function _calculateNewBorrowRate



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L851

```solidity

File: MainHelper.sol

877: function _newBorrowRate



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L877

```solidity

File: MainHelper.sol

896: function _aboveThreshold



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L896

```solidity

File: MainHelper.sol

911: function _scalingAlgorithm



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L911

```solidity

File: MainHelper.sol

1155: function _removeEmptyLendingData



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1155

```solidity

File: MainHelper.sol

1184: function _updatePoolStorage



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1184

```solidity

File: PositionNFTs.sol

371: function _toString



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L371

```solidity

File: WiseCore.sol

44: function _coreWithdrawToken



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L44

```solidity

File: WiseCore.sol

106: function _handleDeposit



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L106

```solidity

File: WiseCore.sol

271: function _checkAllowDeposit



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L271

```solidity

File: WiseCore.sol

349: function _coreBorrowTokens



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L349

```solidity

File: WiseCore.sol

625: function _coreLiquidation



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L625

```solidity

File: WiseLending.sol

192: function _checkHealthState



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L192

```solidity

File: WiseLowLevelHelper.sol

25: function _validateParameter



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L25

```solidity

File: WiseLowLevelHelper.sol

188: function _setMaxValue



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L188

```solidity

File: WiseLowLevelHelper.sol

197: function _setBestPole



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L197

```solidity

File: WiseLowLevelHelper.sol

206: function _setIncreasePole



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L206

```solidity

File: WiseLowLevelHelper.sol

215: function _setPole



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L215

```solidity

File: WiseLowLevelHelper.sol

224: function _increaseTotalPool



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L224

```solidity

File: WiseLowLevelHelper.sol

233: function _decreaseTotalPool



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L233

```solidity

File: WiseLowLevelHelper.sol

242: function _increaseTotalDepositShares



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L242

```solidity

File: WiseLowLevelHelper.sol

251: function _decreaseTotalDepositShares



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L251

```solidity

File: WiseLowLevelHelper.sol

260: function _increasePseudoTotalBorrowAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L260

```solidity

File: WiseLowLevelHelper.sol

269: function _decreasePseudoTotalBorrowAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L269

```solidity

File: WiseLowLevelHelper.sol

278: function _increaseTotalBorrowShares



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L278

```solidity

File: WiseLowLevelHelper.sol

287: function _decreaseTotalBorrowShares



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L287

```solidity

File: WiseLowLevelHelper.sol

296: function _increasePseudoTotalPool



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L296

```solidity

File: WiseLowLevelHelper.sol

305: function _decreasePseudoTotalPool



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L305

```solidity

File: WiseLowLevelHelper.sol

314: function _setTimeStamp

323: function _setTimeStamp



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L314, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L323

```solidity

File: WiseLowLevelHelper.sol

323: function _setTimeStampScaling



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L323

```solidity

File: WiseLowLevelHelper.sol

332: function _increaseTotalBareToken



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L332

```solidity

File: WiseLowLevelHelper.sol

341: function _decreaseTotalBareToken



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L341

```solidity

File: WiseLowLevelHelper.sol

350: function _checkReentrancy



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L350

```solidity

File: WiseLowLevelHelper.sol

371: function _decreasePositionMappingValue



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L371

```solidity

File: WiseLowLevelHelper.sol

382: function _increaseMappingValue



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L382

```solidity

File: WiseLowLevelHelper.sol

393: function _byPassCase



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L393

```solidity

File: WiseLowLevelHelper.sol

407: function _increaseTotalAndPseudoTotalPool



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L407

```solidity

File: WiseLowLevelHelper.sol

434: function _checkOwnerPosition



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L434

```solidity

File: WiseLowLevelHelper.sol

447: function _validateNonZero



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L447

```solidity

File: WiseLowLevelHelper.sol

458: function _validateZero



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L458

```solidity

File: PendleLpOracle.sol

122: function _getLpToAssetRateWrapper



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L122

```solidity

File: FeeManagerHelper.sol

15: function _prepareBorrows



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L15

```solidity

File: FeeManagerHelper.sol

47: function _prepareCollaterals



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L47

```solidity

File: FeeManagerHelper.sol

77: function _setBadDebtPosition



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L77

```solidity

File: FeeManagerHelper.sol

89: function _increaseTotalBadDebt



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L89

```solidity

File: FeeManagerHelper.sol

121: function _eraseBadDebtUser



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L121

```solidity

File: FeeManagerHelper.sol

195: function _increaseFeeTokens



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L195

```solidity

File: FeeManagerHelper.sol

208: function _decreaseFeeTokens



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L208

```solidity

File: FeeManagerHelper.sol

220: function _setAllowedTokens



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L220

```solidity

File: FeeManagerHelper.sol

230: function _setAaveFlag



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L230

```solidity

File: FeeManagerHelper.sol

292: function _distributeIncentives



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L292

```solidity

File: FeeManagerHelper.sol

383: function _checkValue



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L383

```solidity

File: PendlePowerFarm.sol

119: function _manuallyPaybackShares



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L119

```solidity

File: PendlePowerFarm.sol

157: function _manuallyWithdrawShares



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L157

```solidity

File: PendlePowerFarm.sol

185: function _openPosition



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L185

```solidity

File: PendlePowerFarm.sol

230: function _closingPosition



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L230

```solidity

File: PendlePowerFarm.sol

274: function _registrationFarm



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L274

```solidity

File: PendlePowerFarmDeclarations.sol

361: function _isActive



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L361

```solidity

File: PendlePowerFarmLeverageLogic.sol

15: function _executeBalancerFlashLoan



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L15

```solidity

File: PendlePowerFarmLeverageLogic.sol

232: function _getEthBack



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L232

```solidity

File: PendlePowerFarmLeverageLogic.sol

293: function _swapStETHintoETH



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L293

```solidity

File: PendlePowerFarmLeverageLogic.sol

326: function _paybackExactShares



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L326

```solidity

File: PendlePowerFarmLeverageLogic.sol

383: function _closingRouteETH



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L383

```solidity

File: PendlePowerFarmLeverageLogic.sol

414: function _logicOpenPosition



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L414

```solidity

File: PendlePowerFarmLeverageLogic.sol

531: function _borrowExactAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L531

```solidity

File: PendlePowerFarmLeverageLogic.sol

560: function _coreLiquidation



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L560

```solidity

File: PendlePowerFarmMathLogic.sol

92: function _getPositionBorrowTokenAmount

111: function _getPositionBorrowTokenAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L92, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L111

```solidity

File: PendlePowerFarmMathLogic.sol

111: function _getPositionBorrowTokenAmountAave



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L111

```solidity

File: PendlePowerFarmMathLogic.sol

136: function _getPositionLendingShares



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L136

```solidity

File: PendlePowerFarmMathLogic.sol

153: function _getPostionCollateralTokenAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L153

```solidity

File: PendlePowerFarmMathLogic.sol

258: function _getEthInTokens



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L258

```solidity

File: PendlePowerFarmMathLogic.sol

289: function _getApproxNetAPY



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L289

```solidity

File: PendlePowerFarmMathLogic.sol

344: function _getNewBorrowRate



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L344

```solidity

File: PendlePowerFarmMathLogic.sol

389: function _checkDebtRatio



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L389

```solidity

File: PendlePowerFarmMathLogic.sol

416: function _notBelowMinDepositAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L416

```solidity

File: PendlePowerFarmControllerHelper.sol

9: function _findIndex



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L9

```solidity

File: PendlePowerFarmControllerHelper.sol

32: function _calcExpiry



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L32

```solidity

File: PendlePowerFarmControllerHelper.sol

45: function _getExpiry



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L45

```solidity

File: PendlePowerFarmControllerHelper.sol

53: function _getLockAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L53

```solidity

File: PendlePowerFarmControllerHelper.sol

73: function _getAmountToSend



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L73

```solidity

File: PendlePowerFarmControllerHelper.sol

133: function _checkFeed



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L133

```solidity

File: PendlePowerFarmControllerHelper.sol

144: function _getRewardTokens



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L144

```solidity

File: PendlePowerFarmControllerHelper.sol

156: function _getUserReward

173: function _getUserReward



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L173, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L156

```solidity

File: PendlePowerFarmControllerHelper.sol

173: function _getUserRewardIndex



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L173

```solidity

File: PendlePowerFarmControllerHelper.sol

189: function _getTokensInETH



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L189

```solidity

File: PendlePowerFarmControllerHelper.sol

203: function _getTokensFromETH



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L203

```solidity

File: PendlePowerFarmControllerHelper.sol

217: function _compareHashes



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L217

```solidity

File: PendlePowerFarmControllerHelper.sol

236: function _setRewardTokens



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L236

```solidity

File: PendlePowerFarmToken.sol

132: function _overWriteCheck



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L132

```solidity

File: PendlePowerFarmToken.sol

140: function _triggerIndexUpdate



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L140

```solidity

File: PendlePowerFarmToken.sol

149: function _wrapOverWrites



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L149

```solidity

File: PendlePowerFarmToken.sol

218: function _calculateRewardsClaimedOutside



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L218

```solidity

File: PendlePowerFarmToken.sol

347: function _increaseCardinalityNext



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L347

```solidity

File: PendlePowerFarmToken.sol

422: function _applyMintFee



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L422

```solidity

File: MinterReserver.sol

63: function _incrementReserved



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L63

```solidity

File: MinterReserver.sol

70: function _getNextReserveKey



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L70

```solidity

File: MinterReserver.sol

77: function _reserveKey



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L77

```solidity

File: MinterReserver.sol

115: function _mintKeyForUser



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L115

```solidity

File: PowerFarmNFTs.sol

213: function _toString



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L213

```solidity

File: ApprovalHelper.sol

13: function _safeApprove



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L13

```solidity

File: CallOptionalReturn.sol

12: function _callOptionalReturn



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L12

```solidity

File: SendValueHelper.sol

12: function _sendValue



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L12

```solidity

File: TransferHelper.sol

13: function _safeTransfer

34: function _safeTransfer



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L34, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L13

```solidity

File: TransferHelper.sol

34: function _safeTransferFrom



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L34

```solidity

File: WrapperHelper.sol

24: function _wrapETH



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L24

```solidity

File: WrapperHelper.sol

38: function _unwrapETH



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L38

```solidity

File: OracleHelper.sol

12: function _addOracle



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L12

```solidity

File: OracleHelper.sol

32: function _addAggregator



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L32

```solidity

File: OracleHelper.sol

60: function _checkFunctionExistence



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L60

```solidity

File: OracleHelper.sol

87: function _compareMinMax



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L87

```solidity

File: OracleHelper.sol

131: function _validateAnswer



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L131

```solidity

File: OracleHelper.sol

179: function _writeUniTwapPoolInfoStruct

195: function _writeUniTwapPoolInfoStruct



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L179, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L195

```solidity

File: OracleHelper.sol

195: function _writeUniTwapPoolInfoStructDerivative



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L195

```solidity

File: OracleHelper.sol

216: function _getRelativeDifference



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L216

```solidity

File: OracleHelper.sol

235: function _compareDifference



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L235

```solidity

File: OracleHelper.sol

246: function _getChainlinkAnswer



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L246

```solidity

File: OracleHelper.sol

283: function _getPool



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L283

```solidity

File: OracleHelper.sol

303: function _validateTokenAddress



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L303

```solidity

File: OracleHelper.sol

324: function _validatePoolAddress



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L324

```solidity

File: OracleHelper.sol

344: function _validatePriceFeed



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L344

```solidity

File: OracleHelper.sol

359: function _validateTwapOracle



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L359

```solidity

File: OracleHelper.sol

374: function _getTwapPrice



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L374

```solidity

File: OracleHelper.sol

460: function _getTwapDerivatePrice



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L460

```solidity

File: OracleHelper.sol

507: function _recalibrate

592: function _recalibrate



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L592, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L507

```solidity

File: OracleHelper.sol

556: function _chainLinkIsDead



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L556

```solidity

File: OracleHelper.sol

592: function _recalibratePreview



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L592

```solidity

File: OracleHelper.sol

658: function _getIterationCount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L658

```solidity

File: WiseSecurityDeclarations.sol

118: function _setLiquidationSettings



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L118

```solidity

File: WiseSecurityHelper.sol

145: function _overallETHCollateralsWeighted



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L145

```solidity

File: WiseSecurityHelper.sol

246: function _getCollateralOfTokenETHUpdated



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L246

```solidity

File: WiseSecurityHelper.sol

470: function _checkBlacklisted



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L470

```solidity

File: WiseSecurityHelper.sol

486: function _overallETHBorrow



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L486

```solidity

File: WiseSecurityHelper.sol

530: function _getUpdatedPseudoBorrow



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L530

```solidity

File: WiseSecurityHelper.sol

554: function _getUpdatedPseudoPool



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L554

```solidity

File: WiseSecurityHelper.sol

610: function _getETHBorrowUpdated



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L610

```solidity

File: WiseSecurityHelper.sol

701: function _checkPositionLocked



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L701

```solidity

File: WiseSecurityHelper.sol

794: function _checkHealthState



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L794

```solidity

File: WiseSecurityHelper.sol

806: function _getState



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L806

```solidity

File: WiseSecurityHelper.sol

1029: function _getPossibleWithdrawAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1029

```solidity

File: WiseSecurityHelper.sol

1057: function _setPoolState



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1057

```solidity

File: WiseSecurityHelper.sol

1096: function _checkSuccess



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1096

```solidity

File: AaveHelper.sol

23: function _validToken



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L23

```solidity

File: AaveHelper.sol

34: function _nonReentrantCheck



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L34

```solidity

File: AaveHelper.sol

47: function _reservePosition



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L47

```solidity

File: AaveHelper.sol

56: function _wrapDepositExactAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L56

```solidity

File: AaveHelper.sol

83: function _wrapWithdrawExactAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L83

```solidity

File: AaveHelper.sol

113: function _wrapWithdrawExactShares



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L113

```solidity

File: AaveHelper.sol

141: function _wrapBorrowExactAmount



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L141

```solidity

File: AaveHelper.sol

165: function _wrapAaveReturnValueDeposit



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L165

```solidity

File: AaveHelper.sol

196: function _sendValue



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L196

```solidity

File: AaveHelper.sol

219: function _getInfoPayback



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L219

```solidity

File: Declarations.sol

81: function _checkOwner



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L81

```solidity

File: Declarations.sol

93: function _checkPositionLocked



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L93

### [G-26]<a name="g-26"></a> Multiple accesses of a mapping/array should use a local variable cache

Caching a mapping's value in a local storage or calldata variable when the value is accessed multiple times saves ~42 gas per access due to not having to perform the same offset calculation every time. Help the Optimizer by saving a storage variable's reference instead of repeatedly fetching it

To help the optimizer,declare a storage type variable and use it instead of repeatedly fetching the reference in a map or an array. As an example, instead of repeatedly calling `someMap[someIndex]`, save its reference like this: `SomeStruct storage someStruct = someMap[someIndex]` and use it.

*There are 105 instance(s) of this issue:*

```solidity

File: MainHelper.sol

27: lendingPoolData[_poolToken].totalDepositShares * _amount,

28: lendingPoolData[_poolToken].pseudoTotalPool,



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L27-L28

```solidity

File: MainHelper.sol

65: borrowPoolData[_poolToken].totalBorrowShares * _amount,

66: borrowPoolData[_poolToken].pseudoTotalBorrowAmount,



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L65-L66

```solidity

File: MainHelper.sol

102: * lendingPoolData[_poolToken].pseudoTotalPool

361: * lendingPoolData[_poolToken].pseudoTotalPool

103: / lendingPoolData[_poolToken].totalDepositShares - 1;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L361, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L102, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L103

```solidity

File: MainHelper.sol

123: * borrowPoolData[_poolToken].pseudoTotalBorrowAmount;

125: uint256 totalBorrowShares = borrowPoolData[_poolToken].totalBorrowShares;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L125, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L123

```solidity

File: MainHelper.sol

170: uint256 totalPool = globalPoolData[_poolToken].totalPool;

311: uint256 totalPool = globalPoolData[_poolToken].totalPool;

312: uint256 bareToken = globalPoolData[_poolToken].totalBareToken;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L170, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L311, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L312

```solidity

File: MainHelper.sol

507: uint256 bareIncrease = borrowPoolData[_poolToken].borrowRate

123: * borrowPoolData[_poolToken].pseudoTotalBorrowAmount

509: * borrowPoolData[_poolToken].pseudoTotalBorrowAmount

510: + bufferIncrease[_poolToken];

513: bufferIncrease[_poolToken] = bareIncrease;

551: * lendingPoolData[_poolToken].totalDepositShares

552: / (lendingPoolData[_poolToken].pseudoTotalPool - feeAmount);



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L509, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L510, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L552, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L551, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L513, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L507, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L123

```solidity

File: MainHelper.sol

627: if (hashMap[hashData] == true) {

631: hashMap[hashData] = true;

633: userTokenData[_nftId].push(

637: if (userTokenData[_nftId].length > MAX_TOTAL_TOKEN_NUMBER) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L627, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L631, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L633, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L637

```solidity

File: MainHelper.sol

856: uint256 pole = borrowRatesData[_poolToken].pole;

863: borrowRatesData[_poolToken].multiplicativeFactor



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L856, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L863

```solidity

File: MainHelper.sol

1130: uint256 minValue = borrowRatesData[_poolToken].minPole;

1132: uint256 delta = borrowRatesData[_poolToken].deltaPole

1135: uint256 sub = borrowRatesData[_poolToken].pole > delta

1136: ? borrowRatesData[_poolToken].pole - delta



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1136, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1130, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1132, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1135

```solidity

File: PoolManager.sol

36: if (parametersLocked[_poolToken] == true) {

40: parametersLocked[_poolToken] = _isFinal;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L36, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L40

```solidity

File: PoolManager.sol

170: timestampsPoolData[_params.poolToken].timeStamp,

254: timestampsPoolData[_params.poolToken] = TimestampsPoolEntry({



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L254, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L170

```solidity

File: PositionNFTs.sol

117: if (reserved[_user] > 0) {

118: return reserved[_user];

122: reserved[_user] = reservedId;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L117, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L122, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L118

```solidity

File: PositionNFTs.sol

299: tokenIds[i] = tokenOfOwnerByIndex(

310: tokenIds[i] = reservedId;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L310, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L299

```solidity

File: WiseCore.sol

552: if (pureCollateralAmount[_nftId][_receiveTokens] > 0) {

561: uint256 userShares = userLendingData[_nftId][_receiveTokens].shares;

562: uint256 pureCollateral = pureCollateralAmount[_nftId][_receiveTokens];

592: if (userLendingData[_nftId][_receiveTokens].unCollateralized == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L562, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L552, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L561, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L592

```solidity

File: WiseLending.sol

175: uint256 borrowSharePrice = borrowPoolData[_poolToken].pseudoTotalBorrowAmount

177: / borrowPoolData[_poolToken].totalBorrowShares;

185: lendingPoolData[_poolToken].pseudoTotalPool

187: / lendingPoolData[_poolToken].totalDepositShares,



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L185, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L187, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L175, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L177

```solidity

File: FeeManager.sol

148: _newFees[i]

153: _newFees[i]

158: _newFees[i]

94: _poolTokens[i],

152: _poolTokens[i],

157: _poolTokens[i],



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L153, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L148, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L157, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L94, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L152, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L158

```solidity

File: FeeManager.sol

418: if (poolTokenAdded[_poolToken] == true) {

400: poolTokenAdded[_poolToken] = true;

426: poolTokenAdded[_poolToken] = true;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L426, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L400, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L418

```solidity

File: FeeManager.sol

449: if (poolTokenAdded[_poolToken] == false) {

476: poolTokenAdded[_poolToken] = false;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L449, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L476

```solidity

File: FeeManagerHelper.sol

348: uint256 reduceUSD = usdEquivalent < incentiveUSD[_incentiveOwner]

350: : incentiveUSD[_incentiveOwner];

354: incentiveUSD[_incentiveOwner] -= usdEquivalent;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L348, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L350, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L354

```solidity

File: PendlePowerFarmLeverageLogic.sol

81: uint256 totalDebtBalancer = _flashloanAmounts[0]

111: _flashloanAmounts[0] + initialAmount,



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L81, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L111

```solidity

File: PendlePowerFarmLeverageLogic.sol

575: address paybackToken = isAave[_nftId] == true

584: uint256 cutoffShares = isAave[_nftId] == true



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L584, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L575

```solidity

File: PendlePowerManager.sol

227: if (reservedKeys[msg.sender] == _keyId) {

228: reservedKeys[msg.sender] = 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L227-L228

```solidity

File: PendlePowerManager.sol

262: farmingKeys[_keyId],

268: farmingKeys[_keyId],



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L268, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L262

```solidity

File: PendlePowerFarmController.sol

71: if (childInfo.reservedForCompound[index] < _rewardAmount) {

83: childInfo.reservedForCompound[index] -= _rewardAmount;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L71, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L83

```solidity

File: PendlePowerFarmController.sol

220: if (pendleChildAddress[_pendleMarket] > ZERO_ADDRESS) {

231: pendleChildAddress[_pendleMarket] = pendleChild;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L220, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L231

```solidity

File: PendlePowerFarmToken.sol

238: rewardTokens[i],

248: rewardTokens[i],

255: if (lastIndex[i] == 0 && index > 0) {

256: rewardsOutsideArray[i] = 0;

267: rewardsOutsideArray[i] = 0;

266: if (index == lastIndex[i]) {

275: - lastIndex[i];

283: rewardsOutsideArray[i] = scaleNecessary



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L275, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L266, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L267, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L256, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L255, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L248, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L238, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L283

```solidity

File: MinterReserver.sol

84: if (reservedKeys[_userAddress] > 0) {

90: reservedKeys[_userAddress] = keyId;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L90, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L84

```solidity

File: PowerFarmNFTs.sol

141: tokenIds[i] = tokenOfOwnerByIndex(

152: tokenIds[i] = reservedId;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L141, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L152

```solidity

File: OracleHelper.sol

19: if (priceFeed[_tokenAddress] > ZERO_FEED) {

23: priceFeed[_tokenAddress] = _priceFeedAddress;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L19, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L23

```solidity

File: OracleHelper.sol

41: if (tokenAggregatorFromTokenAddress[_tokenAddress] > ZERO_AGGREGATOR) {

154: if (tokenAggregatorFromTokenAddress[_tokenAddress] > ZERO_AGGREGATOR) {

57: tokenAggregatorFromTokenAddress[_tokenAddress] = tokenAggregator;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L57, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L41, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L154

```solidity

File: OracleHelper.sol

41: if (tokenAggregatorFromTokenAddress[_tokenAddress] > ZERO_AGGREGATOR) {

154: if (tokenAggregatorFromTokenAddress[_tokenAddress] > ZERO_AGGREGATOR) {

156: tokenAggregatorFromTokenAddress[_tokenAddress],



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L41, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L154, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L156

```solidity

File: OracleHelper.sol

566: if (heartBeat[_tokenAddress] == 0) {

584: return upd > heartBeat[_tokenAddress];



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L566, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L584

```solidity

File: WiseOracleHub.sol

269: address[2] calldata _uniPools,

270: address[2] calldata _token0Array,

271: address[2] calldata _token1Array,



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L269-L271

```solidity

File: WiseOracleHub.sol

464: underlyingFeedTokens[_tokenAddress][i]

468: underlyingFeedTokens[_tokenAddress][i]



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L464, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L468

```solidity

File: WiseSecurity.sol

150: curveSwapInfoData[_poolToken] = _curveSwapStructData;

153: address curvePool = curveSwapInfoData[_poolToken].curvePool;

199: address curvePool = curveSwapInfoData[_poolToken].curvePool;

168: address curveMetaPool = curveSwapInfoData[_poolToken].curveMetaPool;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L150, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L153, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L199, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L168

```solidity

File: WiseSecurity.sol

153: address curvePool = curveSwapInfoData[_poolToken].curvePool;

199: address curvePool = curveSwapInfoData[_poolToken].curvePool;

209: curveSwapInfoData[_poolToken].swapBytesPool

216: address curveMeta = curveSwapInfoData[_poolToken].curveMetaPool;

226: curveSwapInfoData[_poolToken].swapBytesMeta



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L153, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L199, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L209, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L216, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L226

```solidity

File: AaveHub.sol

670: if (aaveTokenAddress[_underlyingAsset] > ZERO_ADDRESS) {

674: aaveTokenAddress[_underlyingAsset] = _aaveToken;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L674, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L670

### [G-27]<a name="g-27"></a> Multiple Address Mappings Can Be Combined Into A Single Mapping Of An Address To A Struct, Where Appropriate

Saves a storage slot for the mapping. Depending on the circumstances and sizes of types, can avoid a Gsset (20000 gas) per mapping combined. Reads and subsequent writes can also be cheaper when a function requires both values and they both fit in the same storage slot.

*There are 37 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

20: mapping(address => uint256) public reserved;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L20

```solidity

File: PositionNFTs.sol

21: mapping(address => bool) public reserveRole;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L21

```solidity

File: WiseLendingDeclaration.sol

267: mapping(address => uint256) internal bufferIncrease;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L267

```solidity

File: WiseLendingDeclaration.sol

268: mapping(address => uint256) public maxDepositValueToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L268

```solidity

File: WiseLendingDeclaration.sol

273: mapping(uint256 => mapping(address => uint256)) public userBorrowShares;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L273

```solidity

File: WiseLendingDeclaration.sol

274: mapping(uint256 => mapping(address => uint256)) public pureCollateralAmount;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L274

```solidity

File: WiseLendingDeclaration.sol

275: mapping(uint256 => mapping(address => LendingEntry)) public userLendingData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L275

```solidity

File: WiseLendingDeclaration.sol

278: mapping(address => BorrowRatesEntry) public borrowRatesData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L278

```solidity

File: WiseLendingDeclaration.sol

279: mapping(address => AlgorithmEntry) public algorithmData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L279

```solidity

File: WiseLendingDeclaration.sol

280: mapping(address => GlobalPoolEntry) public globalPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L280

```solidity

File: WiseLendingDeclaration.sol

281: mapping(address => LendingPoolEntry) public lendingPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L281

```solidity

File: WiseLendingDeclaration.sol

282: mapping(address => BorrowPoolEntry) public borrowPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L282

```solidity

File: WiseLendingDeclaration.sol

283: mapping(address => TimestampsPoolEntry) public timestampsPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L283

```solidity

File: WiseLendingDeclaration.sol

287: mapping(address => bool) internal parametersLocked;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287

```solidity

File: WiseLendingDeclaration.sol

288: mapping(address => bool) public verifiedIsolationPool;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288

```solidity

File: WiseLowLevelHelper.sol

372: mapping(uint256 => mapping(address => uint256)) storage userMapping,

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L372

```solidity

File: WiseLowLevelHelper.sol

383: mapping(uint256 => mapping(address => uint256)) storage userMapping,

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L383

```solidity

File: DeclarationsFeeManager.sol

143: mapping(address => uint256) public feeTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L143

```solidity

File: DeclarationsFeeManager.sol

146: mapping(address => uint256) public incentiveUSD;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L146

```solidity

File: DeclarationsFeeManager.sol

149: mapping(address => bool) public poolTokenAdded;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149

```solidity

File: DeclarationsFeeManager.sol

152: mapping(address => bool) public isAaveToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152

```solidity

File: DeclarationsFeeManager.sol

155: mapping(address => address) public underlyingToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L155

```solidity

File: DeclarationsFeeManager.sol

158: mapping(address => mapping(address => bool)) public allowedTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158

```solidity

File: DeclarationsFeeManager.sol

161: mapping(address => mapping(address => uint256)) public gatheredIncentiveToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L161

```solidity

File: PendlePowerFarmControllerBase.sol

58: mapping(address => address) public pendleChildAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L58

```solidity

File: PendlePowerFarmControllerBase.sol

59: mapping(address => CompoundStruct) pendleChildCompoundInfo;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L59

```solidity

File: Declarations.sol

139: mapping(address => uint8) _tokenDecimals;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L139

```solidity

File: Declarations.sol

142: mapping(address => IPriceFeed) public priceFeed;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L142

```solidity

File: Declarations.sol

145: mapping(address => uint256) public heartBeat;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L145

```solidity

File: Declarations.sol

148: mapping(address => IAggregator) public tokenAggregatorFromTokenAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L148

```solidity

File: Declarations.sol

151: mapping(address => address[]) public underlyingFeedTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L151

```solidity

File: Declarations.sol

154: mapping(address => UniTwapPoolInfo) public uniTwapPoolInfo;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L154

```solidity

File: Declarations.sol

157: mapping(address => DerivativePartnerInfo) public derivativePartnerTwap;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L157

```solidity

File: WiseSecurityDeclarations.sol

238: mapping(address => bool) public wasBlacklisted;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238

```solidity

File: WiseSecurityDeclarations.sol

241: mapping(address => CurveSwapStructData) public curveSwapInfoData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L241

```solidity

File: WiseSecurityDeclarations.sol

244: mapping(address => CurveSwapStructToken) public curveSwapInfoToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L244

```solidity

File: WiseSecurityDeclarations.sol

247: mapping(address => bool) public securityWorker;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247

### [G-28]<a name="g-28"></a> Multiplication/division By Two Should Use Bit Shifting

<x> * 2 is equivalent to <x> << 1 and <x> / 2 is the same as <x> >> 1. The MUL and DIV opcodes cost 5 gas, whereas SHL and SHR only cost 3 gas

*There are 2 instance(s) of this issue:*

```solidity

File: PoolManager.sol

285: return PRECISION_FACTOR_E18 / 2


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L285

```solidity

File: PoolManager.sol

312: return (_maxPole + _minPole) / 2;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L312

### [G-29]<a name="g-29"></a> Use shift Left instead of multiplication if possible to save gas




*There are 9 instance(s) of this issue:*

```solidity

File: WiseOracleHub.sol

113: : _tokenAmount
                * 10 ** (_decimalsETH - tokenDecimals)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L113

```solidity

File: WiseOracleHub.sol

164: : _tokenAmount
                * 10 ** (_decimalsETH - tokenDecimals)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L164

```solidity

File: WiseOracleHub.sol

184: ? _usdValue
                * 10 ** (tokenDecimals - _decimalsETH)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L184

```solidity

File: WiseOracleHub.sol

186: * 10 ** decimals(_tokenAddress)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L186

```solidity

File: WiseOracleHub.sol

188: : _usdValue
                * 10 ** decimals(_tokenAddress)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L188

```solidity

File: WiseOracleHub.sol

208: _usdValue
                * 10 ** _decimalsUSD


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L208

```solidity

File: WiseOracleHub.sol

344: ? _ethAmount
                * 10 ** (tokenDecimals - _decimalsETH)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L344

```solidity

File: WiseOracleHub.sol

346: * 10 ** decimals(_tokenAddress)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L346

```solidity

File: WiseOracleHub.sol

348: : _ethAmount
                * 10 ** decimals(_tokenAddress)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L348

### [G-30]<a name="g-30"></a> Operator `>=`/`<=` costs less gas than operator `>`/`<`

The compiler uses opcodes `GT` and `ISZERO` for code that uses `>`, but only requires `LT` for `>=`. A similar behavior applies for `>`, which uses opcodes `LT` and `ISZERO`, but only requires `GT` for `<=`. It can [save **3 gas**](https://gist.github.com/IllIllI000/3dc79d25acccfa16dee4e83ffdc6ffde) for each.
It should be converted to the `<=`/`>=` equivalent when comparing against integer literals.

*There are 126 instance(s) of this issue:*

```solidity

File: MainHelper.sol

328: if (difference > allowedDifference) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L328

```solidity

File: MainHelper.sol

428: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L428

```solidity

File: MainHelper.sol

481: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L481

```solidity

File: MainHelper.sol

512: if (bareIncrease < PRECISION_FACTOR_YEAR) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L512

```solidity

File: MainHelper.sol

637: if (userTokenData[_nftId].length > MAX_TOTAL_TOKEN_NUMBER) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L637

```solidity

File: MainHelper.sol

693: while (i < length) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L693

```solidity

File: MainHelper.sol

995: return _shareValue < THRESHOLD_RESET_RESONANCE_FACTOR



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L995

```solidity

File: MainHelper.sol

1051: _shareValues < THRESHOLD_SWITCH_DIRECTION



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1051

```solidity

File: PoolManager.sol

108: if (_maximumDeposit > 0) {

112: if (_collateralFactor > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L108, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L112

```solidity

File: PoolManager.sol

268: if (fetchBalance > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L268

```solidity

File: PositionNFTs.sol

77: if (feeManager > ZERO_ADDRESS) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L77

```solidity

File: PositionNFTs.sol

203: if (nftId > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L203

```solidity

File: PositionNFTs.sol

288: if (reservedId > 0) {

298: while (i < ownerTokenCount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L298, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L288

```solidity

File: WiseCore.sol

564: if (pureCollateral > 0 && userShares > 0) {

572: if (potentialPureExtraCashout > 0 && potentialPureExtraCashout <= pureCollateral) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L572, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L564

```solidity

File: WiseLending.sol

1122: if (msg.value > maxPaybackAmount) {

1147: if (refundAmount > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1147, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1122

```solidity

File: WiseLowLevelHelper.sol

32: if (_parameterValue > _parameterLimit) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L32

```solidity

File: WiseLowLevelHelper.sol

464: if (_value > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L464

```solidity

File: FeeManager.sol

92: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L92

```solidity

File: FeeManager.sol

145: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L145

```solidity

File: FeeManager.sol

257: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L257

```solidity

File: FeeManager.sol

453: while (i < len) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L453

```solidity

File: FeeManager.sol

548: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L548

```solidity

File: FeeManager.sol

581: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L581

```solidity

File: FeeManager.sol

609: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L609

```solidity

File: FeeManager.sol

697: if (totalBadDebtETH > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L697

```solidity

File: FeeManager.sol

904: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L904

```solidity

File: FeeManagerHelper.sol

25: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L25

```solidity

File: FeeManagerHelper.sol

57: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L57

```solidity

File: FeeManagerHelper.sol

151: if (currentBorrowETH < currentCollateralBareETH) {

179: newBadDebt > currentBadDebt



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L151, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L179

```solidity

File: FeeManagerHelper.sol

389: if (_value < PRECISION_FACTOR_E16) {

393: if (_value > PRECISION_FACTOR_E18) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L389, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L393

```solidity

File: PendlePowerFarm.sol

194: if (_leverage > MAX_LEVERAGE) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L194

```solidity

File: PendlePowerFarmLeverageLogic.sol

107: if (initialAmount > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L107

```solidity

File: PendlePowerFarmLeverageLogic.sol

211: if (ethValueAfter < ethValueBefore) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L211

```solidity

File: PendlePowerFarmLeverageLogic.sol

504: if (ethValueAfter < ethValueBefore) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L504

```solidity

File: PendlePowerFarmLeverageLogic.sol

592: if (_shareAmountToPay > cutoffShares) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L592

```solidity

File: PendlePowerFarmMathLogic.sol

103: if (positionBorrowShares > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L103

```solidity

File: PendlePowerFarmMathLogic.sol

122: if (positionBorrowSharesAave > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L122

```solidity

File: PendlePowerFarmMathLogic.sol

186: if (borrowShares > 0) {

198: if (borrowSharesAave > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L186, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L198

```solidity

File: PendlePowerFarmMathLogic.sol

301: if (_leverage < PRECISION_FACTOR_E18) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L301

```solidity

File: PendlePowerFarmMathLogic.sol

359: if (totalPool > pseudoPool) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L359

```solidity

File: PendlePowerFarmController.sol

194: if (balance < totalAssets + 1) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L194

```solidity

File: PendlePowerFarmController.sol

258: while (i < rewardTokensLength) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L258

```solidity

File: PendlePowerFarmController.sol

388: if (_amount > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L388

```solidity

File: PendlePowerFarmController.sol

511: while (i < length) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L511

```solidity

File: PendlePowerFarmController.sol

555: while (i < length) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L555

```solidity

File: PendlePowerFarmController.sol

628: while (i < len) {

635: if (weightSum > PRECISION_FACTOR_E18) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L628, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L635

```solidity

File: PendlePowerFarmControllerBase.sol

278: while (i < length) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L278

```solidity

File: PendlePowerFarmControllerHelper.sol

20: while (i < len) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L20

```solidity

File: PendlePowerFarmControllerHelper.sol

85: if (sendingValue < PRECISION_FACTOR_E10) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L85

```solidity

File: PendlePowerFarmToken.sol

107: if (sharePricenNow < _sharePriceBefore) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L107

```solidity

File: PendlePowerFarmToken.sol

127: if (_sharePriceNow > maximum) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L127

```solidity

File: PendlePowerFarmToken.sol

204: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L204

```solidity

File: PendlePowerFarmToken.sol

236: while (i < l) {

242: if (userReward.accrued > 0) {

255: if (lastIndex[i] == 0 && index > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L242, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L255, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L236

```solidity

File: PendlePowerFarmToken.sol

352: if (storageMarket.observationCardinalityNext < MAX_CARDINALITY) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L352

```solidity

File: PendlePowerFarmToken.sol

399: if (totalLpAssetsToDistribute < ONE_WEEK) {

409: if (additonalAssets > totalLpAssetsToDistribute) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L399, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L409

```solidity

File: PendlePowerFarmToken.sol

598: if (_newFee > MAX_MINT_FEE) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L598

```solidity

File: PendlePowerFarmToken.sol

619: if (_shares > balanceOf(msg.sender)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L619

```solidity

File: PendlePowerFarmToken.sol

663: if (shares > balanceOf(msg.sender)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L663

```solidity

File: PowerFarmNFTs.sol

130: if (reservedId > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L130

```solidity

File: CallOptionalReturn.sol

37: && token.code.length > 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L37

```solidity

File: SendValueHelper.sol

18: if (address(this).balance < _amount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L18

```solidity

File: OracleHelper.sol

53: if (uniTwapPoolInfoStruct.oracle > ZERO_ADDRESS) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L53

```solidity

File: OracleHelper.sol

97: if (_answer > maxAnswer || _answer < minAnswer) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L97

```solidity

File: OracleHelper.sol

144: if (uniTwapPoolInfoStruct.oracle > ZERO_ADDRESS) {

161: if (fetchTwapValue > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L161

```solidity

File: OracleHelper.sol

224: if (_answerUint256 > _fetchTwapValue) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L224

```solidity

File: OracleHelper.sol

241: if (_relativeDifference > ALLOWED_DIFFERENCE) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L241

```solidity

File: OracleHelper.sol

365: if (uniTwapPoolInfo[_tokenAddress].oracle > ZERO_ADDRESS) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L365

```solidity

File: OracleHelper.sol

439: if (tickCumulativesDelta < 0 && (tickCumulativesDelta % twapPeriodInt56 != 0)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L439

```solidity

File: OracleHelper.sol

584: return upd > heartBeat[_tokenAddress];



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L584

```solidity

File: OracleHelper.sol

612: if (iterationCount < MIN_ITERATION_COUNT) {

625: while (i < iterationCount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L612, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L625

```solidity

File: WiseOracleHub.sol

108: return _decimalsETH < tokenDecimals



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L108

```solidity

File: WiseOracleHub.sol

159: return _decimalsETH < tokenDecimals



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L159

```solidity

File: WiseOracleHub.sol

183: return _decimalsETH < tokenDecimals



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L183

```solidity

File: WiseOracleHub.sol

295: while (i < length) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L295

```solidity

File: WiseOracleHub.sol

343: return _decimalsETH < tokenDecimals



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L343

```solidity

File: WiseOracleHub.sol

390: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L390

```solidity

File: WiseOracleHub.sol

461: while (i < length) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L461

```solidity

File: WiseOracleHub.sol

509: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L509

```solidity

File: WiseSecurity.sol

419: if (totalBorrow < bareCollateral) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L419

```solidity

File: WiseSecurity.sol

464: while (i < len) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L464

```solidity

File: WiseSecurity.sol

521: while (i < len) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L521

```solidity

File: WiseSecurity.sol

580: while (i < lenBorrow) {

602: while (i < lenDeposit) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L602, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L580

```solidity

File: WiseSecurity.sol

660: while (i < len) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L660

```solidity

File: WiseSecurity.sol

709: while (i < lenDeposit) {

734: while (i < lenBorrow) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L709, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L734

```solidity

File: WiseSecurity.sol

788: if (expectedMaxAmount > maxAmountPool) {

804: if (possibelWithdraw > expectedMaxAmount) {

814: if (withdrawAmount > maxAmountPool) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L788, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L814, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L804

```solidity

File: WiseSecurity.sol

856: if (tokenAmount > maxSolelyAmount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L856

```solidity

File: WiseSecurity.sol

896: if (tokenAmount > maxPoolAmount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L896

```solidity

File: WiseSecurityDeclarations.sol

126: if (_baseReward > LIQUIDATION_INCENTIVE_MAX) {

130: if (_baseReward < LIQUIDATION_INCENTIVE_MIN) {

136: if (_baseRewardFarm > LIQUIDATION_INCENTIVE_POWERFARM_MAX) {

140: if (_baseRewardFarm < LIQUIDATION_INCENTIVE_MIN) {

154: if (_newMaxFeeETH > maxFee) {

158: if (_newMaxFeeETH < minFee) {

172: if (_newMaxFeeFarmETH > maxFeeFarm) {

176: if (_newMaxFeeFarmETH < minFeeFarm) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L140, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L136, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L130, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L126, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L176, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L158, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L172, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L154

```solidity

File: WiseSecurityHelper.sol

32: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L32

```solidity

File: WiseSecurityHelper.sol

79: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L79

```solidity

File: WiseSecurityHelper.sol

121: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L121

```solidity

File: WiseSecurityHelper.sol

160: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L160

```solidity

File: WiseSecurityHelper.sol

372: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L372

```solidity

File: WiseSecurityHelper.sol

408: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L408

```solidity

File: WiseSecurityHelper.sol

444: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L444

```solidity

File: WiseSecurityHelper.sol

501: while (i < l) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L501

```solidity

File: WiseSecurityHelper.sol

749: return feeETH < _maxFeeETH



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L749

```solidity

File: WiseSecurityHelper.sol

866: if (_borrowETHTotal < _weightedCollateralETH) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L866

```solidity

File: WiseSecurityHelper.sol

1065: while(i < len) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1065

```solidity

File: AaveHelper.sol

202: if (address(this).balance < _amount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L202

```solidity

File: AaveHelper.sol

230: if (_ethSent > _maxPaybackAmount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L230

```solidity

File: AaveHub.sol

537: if (ethRefundAmount > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L537

### [G-31]<a name="g-31"></a> Optimize names to save gas

Contracts most called functions could simply save gas by function ordering via Method ID. Calling a function at runtime will be cheaper if the function is positioned earlier in the order (has a relatively lower Method ID) because 22 gas are added to the cost of a function for every position that came before it. The caller can save on gas if you prioritize most called functions. 

See more <a href="https://medium.com/joyso/solidity-how-does-function-name-affect-gas-consumption-in-smart-contract-47d270d8ac92">here</a>

*There are 1 instance(s) of this issue:*

All in-scope contracts

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0

### [G-32]<a name="g-32"></a> + <y>` For State Variables




*There are 39 instance(s) of this issue:*

```solidity

File: MainHelper.sol

591: userLendingData[_nftId][_poolToken].shares += _shares;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L591

```solidity

File: MainHelper.sol

606: userLendingData[_nftId][_poolToken].shares -= _shares;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L606

```solidity

File: WiseLowLevelHelper.sol

230: globalPoolData[_poolToken].totalPool += _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L230

```solidity

File: WiseLowLevelHelper.sol

239: globalPoolData[_poolToken].totalPool -= _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L239

```solidity

File: WiseLowLevelHelper.sol

248: lendingPoolData[_poolToken].totalDepositShares += _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L248

```solidity

File: WiseLowLevelHelper.sol

257: lendingPoolData[_poolToken].totalDepositShares -= _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L257

```solidity

File: WiseLowLevelHelper.sol

266: borrowPoolData[_poolToken].pseudoTotalBorrowAmount += _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L266

```solidity

File: WiseLowLevelHelper.sol

275: borrowPoolData[_poolToken].pseudoTotalBorrowAmount -= _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L275

```solidity

File: WiseLowLevelHelper.sol

284: borrowPoolData[_poolToken].totalBorrowShares += _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L284

```solidity

File: WiseLowLevelHelper.sol

293: borrowPoolData[_poolToken].totalBorrowShares -= _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L293

```solidity

File: WiseLowLevelHelper.sol

302: lendingPoolData[_poolToken].pseudoTotalPool += _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L302

```solidity

File: WiseLowLevelHelper.sol

311: lendingPoolData[_poolToken].pseudoTotalPool -= _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L311

```solidity

File: WiseLowLevelHelper.sol

338: globalPoolData[_poolToken].totalBareToken += _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L338

```solidity

File: WiseLowLevelHelper.sol

347: globalPoolData[_poolToken].totalBareToken -= _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L347

```solidity

File: WiseLowLevelHelper.sol

379: userMapping[_nftId][_poolToken] -= _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L379

```solidity

File: WiseLowLevelHelper.sol

390: userMapping[_nftId][_poolToken] += _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L390

```solidity

File: FeeManager.sol

220: incentiveUSD[incentiveOwnerA] += _value;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L220

```solidity

File: FeeManager.sol

238: incentiveUSD[incentiveOwnerB] += _value;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L238

```solidity

File: FeeManagerHelper.sol

94: totalBadDebtETH += _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L94

```solidity

File: FeeManagerHelper.sol

110: totalBadDebtETH -= _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L110

```solidity

File: FeeManagerHelper.sol

201: feeTokens[_feeToken] += _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L201

```solidity

File: FeeManagerHelper.sol

214: feeTokens[_feeToken] -= _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L214

```solidity

File: FeeManagerHelper.sol

354: incentiveUSD[_incentiveOwner] -= usdEquivalent;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L354

```solidity

File: FeeManagerHelper.sol

358: _underlyingToken] += incentiveAmount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L358

```solidity

File: PendlePowerFarmController.sol

83: childInfo.reservedForCompound[index] -= _rewardAmount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L83

```solidity

File: PendlePowerFarmController.sol

140: reservedPendleForLocking += tokenAmountSend;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L140

```solidity

File: PendlePowerFarmController.sol

418: reservedPendleForLocking -= _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L418

```solidity

File: PendlePowerFarmController.sol

512: childInfo.reservedForCompound[i] += _amounts[i];


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L512

```solidity

File: PendlePowerFarmController.sol

630: weightSum += _weights[i];


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L630

```solidity

File: PendlePowerFarmToken.sol

343: underlyingLpAssetsCurrent += additonalAssets;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L343

```solidity

File: PendlePowerFarmToken.sol

344: totalLpAssetsToDistribute -= additonalAssets;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L344

```solidity

File: PendlePowerFarmToken.sol

512: totalLpAssetsToDistribute += _amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L512

```solidity

File: PendlePowerFarmToken.sol

577: underlyingLpAssetsCurrent += _underlyingLpAssetAmount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L577

```solidity

File: PendlePowerFarmToken.sol

628: underlyingLpAssetsCurrent -= tokenAmount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L628

```solidity

File: PendlePowerFarmToken.sol

672: underlyingLpAssetsCurrent -= _underlyingLpAssetAmount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L672

```solidity

File: WiseSecurity.sol

484: overallETH += ethValue;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L484

```solidity

File: WiseSecurity.sol

541: overallETH += ethValue;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L541

```solidity

File: WiseSecurity.sol

614: totalETHSupply += ethValue;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L614

```solidity

File: WiseSecurityHelper.sol

48: unweightedAmount += amount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L48

### [G-33]<a name="g-33"></a> Structs can be packed into fewer storage slots by editing time variables

The following structs contain time variables that are unlikely to ever reach max `uint256` then it is possible to set them as `uint32`, saving gas slots. Max value of `uint32` is equal to Year 2016, which is more than enough.

*There are 1 instance(s) of this issue:*

```solidity

File: WiseLendingDeclaration.sol

232: struct TimestampsPoolEntry {
        uint256 timeStamp;
        uint256 timeStampScaling;
        uint256 initialTimeStamp;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L232

### [G-34]<a name="g-34"></a> Using `private` rather than `public` for constants, saves gas




*There are 61 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

18: uint256 public immutable FEE_MANAGER_NFT;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L18

```solidity

File: WiseLendingDeclaration.sol

165: address public immutable WETH_ADDRESS;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L165

```solidity

File: WiseLendingDeclaration.sol

180: IPositionNFTs public immutable POSITION_NFT;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L180

```solidity

File: WiseLendingDeclaration.sol

183: IWiseOracleHub public immutable WISE_ORACLE;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L183

```solidity

File: PendleLpOracle.sol

58: address public immutable PENDLE_MARKET_ADDRESS;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L58

```solidity

File: PendleLpOracle.sol

59: IPendleMarket public immutable PENDLE_MARKET;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L59

```solidity

File: PendleLpOracle.sol

62: IPendleSy public immutable PENDLE_SY;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L62

```solidity

File: PendleLpOracle.sol

63: IPriceFeed public immutable FEED_ASSET;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L63

```solidity

File: PendleLpOracle.sol

64: IOraclePendle public immutable ORACLE_PENDLE_PT;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L64

```solidity

File: PendleLpOracle.sol

73: uint32 public immutable TWAP_DURATION;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L73

```solidity

File: PtOracleDerivative.sol

50: IPriceFeed public immutable USD_FEED_ASSET;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L50

```solidity

File: PtOracleDerivative.sol

53: IPriceFeed public immutable ETH_FEED_ASSET;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L53

```solidity

File: PtOracleDerivative.sol

56: IOraclePendle public immutable ORACLE_PENDLE_PT;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L56

```solidity

File: PtOracleDerivative.sol

59: uint256 public immutable POW_USD_FEED;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L59

```solidity

File: PtOracleDerivative.sol

62: uint256 public immutable POW_ETH_USD_FEED;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L62

```solidity

File: PtOracleDerivative.sol

71: uint32 public immutable TWAP_DURATION;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L71

```solidity

File: PtOraclePure.sol

44: address public immutable PENDLE_MARKET_ADDRESS;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L44

```solidity

File: PtOraclePure.sol

47: IPriceFeed public immutable FEED_ASSET;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L47

```solidity

File: PtOraclePure.sol

48: IOraclePendle public immutable ORACLE_PENDLE_PT;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L48

```solidity

File: PtOraclePure.sol

57: uint32 public immutable DURATION;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L57

```solidity

File: DeclarationsFeeManager.sol

100: IAave public immutable AAVE;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L100

```solidity

File: DeclarationsFeeManager.sol

103: IWiseLending public immutable WISE_LENDING;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L103

```solidity

File: DeclarationsFeeManager.sol

106: IPositionNFTs public immutable POSITION_NFTS;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L106

```solidity

File: DeclarationsFeeManager.sol

109: IWiseSecurity public immutable WISE_SECURITY;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L109

```solidity

File: DeclarationsFeeManager.sol

112: IWiseOracleHub public immutable ORACLE_HUB;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L112

```solidity

File: DeclarationsFeeManager.sol

164: uint256 public immutable FEE_MANAGER_NFT;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L164

```solidity

File: DeclarationsFeeManager.sol

172: uint256 public constant INCENTIVE_PORTION = 5 * PRECISION_FACTOR_E15;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L172

```solidity

File: PendlePowerFarmDeclarations.sol

54: address public immutable aaveTokenAddresses;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L54

```solidity

File: PendlePowerFarmDeclarations.sol

55: address public immutable borrowTokenAddresses;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L55

```solidity

File: PendlePowerFarmDeclarations.sol

57: address public immutable ENTRY_ASSET;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L57

```solidity

File: PendlePowerFarmDeclarations.sol

58: address public immutable PENDLE_CHILD;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L58

```solidity

File: PendlePowerFarmDeclarations.sol

66: IAave public immutable AAVE;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L66

```solidity

File: PendlePowerFarmDeclarations.sol

67: IAaveHub public immutable AAVE_HUB;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L67

```solidity

File: PendlePowerFarmDeclarations.sol

68: IWiseLending public immutable WISE_LENDING;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L68

```solidity

File: PendlePowerFarmDeclarations.sol

69: IWiseOracleHub public immutable ORACLE_HUB;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L69

```solidity

File: PendlePowerFarmDeclarations.sol

70: IWiseSecurity public immutable WISE_SECURITY;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L70

```solidity

File: PendlePowerFarmDeclarations.sol

71: IBalancerVault public immutable BALANCER_VAULT;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L71

```solidity

File: PendlePowerFarmDeclarations.sol

72: IPositionNFTs public immutable POSITION_NFT;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L72

```solidity

File: PendlePowerFarmDeclarations.sol

73: IStETH public immutable ST_ETH;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L73

```solidity

File: PendlePowerFarmDeclarations.sol

74: ICurve public immutable CURVE;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L74

```solidity

File: PendlePowerFarmDeclarations.sol

75: IUniswapV3 public immutable UNISWAP_V3_ROUTER;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L75

```solidity

File: PendlePowerFarmDeclarations.sol

77: IPendleSy public immutable PENDLE_SY;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L77

```solidity

File: PendlePowerFarmDeclarations.sol

78: IPendleRouter public immutable PENDLE_ROUTER;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L78

```solidity

File: PendlePowerFarmDeclarations.sol

79: IPendleMarket public immutable PENDLE_MARKET;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L79

```solidity

File: PendlePowerFarmDeclarations.sol

80: IPendleRouterStatic public immutable PENDLE_ROUTER_STATIC;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L80

```solidity

File: PendlePowerFarmController.sol

10: PendlePowerFarmTokenFactory public immutable PENDLE_POWER_FARM_TOKEN_FACTORY;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L10

```solidity

File: PendlePowerFarmTokenFactory.sol

13: address public immutable IMPLEMENTATION_TARGET;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L13

```solidity

File: PendlePowerFarmTokenFactory.sol

14: address public immutable PENDLE_POWER_FARM_CONTROLLER;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L14

```solidity

File: Declarations.sol

76: address public immutable WETH_ADDRESS;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L76

```solidity

File: Declarations.sol

79: address public constant SEQUENCER_ADDRESS = 0xFdB631F5EE196F0ed6FAa767959853A9F217697D;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L79

```solidity

File: Declarations.sol

82: address public immutable ETH_USD_PLACEHOLDER;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L82

```solidity

File: Declarations.sol

88: IPriceFeed public immutable ETH_PRICE_FEED;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L88

```solidity

File: Declarations.sol

91: IPriceFeed public immutable SEQUENCER;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L91

```solidity

File: Declarations.sol

94: IUniswapV3Factory public immutable UNI_V3_FACTORY;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L94

```solidity

File: WiseSecurityDeclarations.sol

185: uint256 public constant BORROW_PERCENTAGE_CAP = 95 * PRECISION_FACTOR_E16;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L185

```solidity

File: WiseSecurityDeclarations.sol

186: address public immutable AAVE_HUB;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L186

```solidity

File: WiseSecurityDeclarations.sol

191: IFeeManager public immutable FEE_MANAGER;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L191

```solidity

File: WiseSecurityDeclarations.sol

194: IWiseLending public immutable WISE_LENDING;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L194

```solidity

File: WiseSecurityDeclarations.sol

197: IPositionNFTs public immutable POSITION_NFTS;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L197

```solidity

File: WiseSecurityDeclarations.sol

200: IWiseOracleHub public immutable WISE_ORACLE;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L200

```solidity

File: WiseSecurityDeclarations.sol

203: IWiseLiquidation public immutable WISE_LIQUIDATION;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L203

### [G-35]<a name="g-35"></a> Redundant state variable getters

Getters for public state variables are automatically generated so there is no need to code them manually and waste gas.

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmToken.sol

400: return totalLpAssetsToDistribute;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L400

### [G-36]<a name="g-36"></a> The result of a function call should be cached rather than re-calling the function

External calls are expensive. Results of external function calls should be cached rather than call them multiple times. Consider caching the following:

*There are 2 instance(s) of this issue:*

```solidity

File: PendlePowerFarmController.sol

374: syncAllSupply();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L374

```solidity

File: PendlePowerFarmController.sol

479: syncAllSupply();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L479

### [G-37]<a name="g-37"></a> Shorten the array rather than copying to a new one

When shortening an array in Solidity, it creates a new shorter array and copies the elements over. This wastes gas by duplicating
storage.

Use inline assembly to shorten the array in place by changing its length slot, avoiding the need to copy elements to a new
array.

Shortening a length-n array avoids ~n SSTORE operations to copy elements. Benchmarking shows savings of 5000-15000 gas depending
on original length.

```solidity
function shorten(uint[] storage array, uint newLen) internal {

  assembly {
    sstore(array_slot, newLen)
  }

}

// Rather than:
function shorten(uint[] storage array, uint newLen) internal {

  uint[] memory newArray = new uint[](newLen);

  for(uint i = 0; i < newLen; i++) {
    newArray[i] = array[i];
  }

  delete array;
  array = newArray;

}
```

Using inline assembly allows shortening arrays without copying elements to a new storage slot, providing significant gas
savings.

*There are 6 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

292: uint256[] memory tokenIds = new uint256[](



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L292

```solidity

File: WiseLending.sol

1373: address[] memory tokens = new address[](1);



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1373

```solidity

File: PendlePowerFarmLeverageLogic.sol

27: IERC20[] memory tokens = new IERC20[](1);

28: uint256[] memory amount = new uint256[](1);



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L27-L28

```solidity

File: PendlePowerFarmToken.sol

231: uint256[] memory rewardsOutsideArray = new uint256[](l);



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L231

```solidity

File: PowerFarmNFTs.sol

134: uint256[] memory tokenIds = new uint256[](



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L134

```solidity

File: OracleHelper.sol

413: uint32[] memory secondsAgo = new uint32[](



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L413

### [G-38]<a name="g-38"></a> State variables can be packed into fewer storage slots

If variables occupying the same slot are both written the same function or by the constructor, avoids a separate Gsset (20000 gas). Reads of the variables can also be cheaper

*There are 4 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {

    string public baseURI;
    string public baseExtension;

    address public feeManager;
    uint256 public totalReserved;
    uint256 public immutable FEE_MANAGER_NFT;

    mapping(address => uint256) public reserved;
    mapping(address => bool) public reserveRole;

    bool public reservePublicBlocked;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11

```solidity

File: CustomOracleSetup.sol

5: contract CustomOracleSetup {

    address public master;
    uint256 public lastUpdateGlobal;

    uint80 public globalRoundId;

    mapping(uint80 => uint256) public timeStampByRoundId;

    modifier onlyOwner() {
        require(
            msg.sender == master,
            "CustomOracleSetup: NOT_MASTER"
        );
        _;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L5

```solidity

File: PendlePowerFarmToken.sol

25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {

    // Pendle - LP token address
    address public UNDERLYING_PENDLE_MARKET;
    address public PENDLE_POWER_FARM_CONTROLLER;

    // Total balance of LPs backing at current compound distribution
    uint256 public underlyingLpAssetsCurrent;

    // Lp assets from compound left to distribute
    uint256 public totalLpAssetsToDistribute;

    // Interface Object for underlying Market
    IPendleMarket public PENDLE_MARKET;

    // InterfaceObject for pendle Sy
    IPendleSy public PENDLE_SY;

    // Interface for Pendle Controller
    IPendleController public PENDLE_CONTROLLER;

    // Max cardinality of Pendle Market
    uint16 public MAX_CARDINALITY;

    uint256 public mintFee;
    uint256 public lastInteraction;

    uint256 private constant ONE_WEEK = 7 days;
    uint256 internal constant ONE_YEAR = 365 days;
    uint256 private constant MAX_MINT_FEE = 10000;

    uint256 private constant PRECISION_FACTOR_E6 = 1E6;
    uint256 private constant PRECISION_FACTOR_E18 = 1E18;
    uint256 internal constant PRECISION_FACTOR_E36 = PRECISION_FACTOR_E18 * PRECISION_FACTOR_E18;
    uint256 internal constant PRECISION_FACTOR_YEAR = PRECISION_FACTOR_E18 * ONE_YEAR;

    uint256 private INITIAL_TIME_STAMP;

    uint256 internal constant RESTRICTION_FACTOR = 10
        * PRECISION_FACTOR_E36
        / PRECISION_FACTOR_YEAR;

    modifier onlyController() {
        _onlyController();
        _;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25

```solidity

File: Declarations.sol

21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {

    IAave internal immutable AAVE;

    bool public sendingProgressAaveHub;

    uint16 internal constant REF_CODE = 0;

    IWiseLending immutable public WISE_LENDING;
    IPositionNFTs immutable public POSITION_NFT;

    IWiseSecurity public WISE_SECURITY;

    address immutable public WETH_ADDRESS;
    address immutable public AAVE_ADDRESS;

    uint256 internal constant PRECISION_FACTOR_E9 = 1E9;
    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;
    uint256 internal constant MAX_AMOUNT = type(uint256).max;

    mapping(address => address) public aaveTokenAddress;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21

### [G-39]<a name="g-39"></a> State variables that are used multiple times in a function should be cached in stack variables

When performing multiple operations on a state variable in a function, it is recommended to cache it first. Either multiple reads or multiple writes to a state variable can save gas by caching it on the stack.
Caching of a state variable replaces each Gwarmaccess (100 gas) with a much cheaper stack read. Other less obvious fixes/optimizations include having local memory caches of state variable structs, or having local caches of state variable contracts/addresses.
*Saves 100 gas per instance*.

*There are 8 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

/// @audit Affected state variables: feeManager

72: function forwardFeeManagerNFT(
        address _feeManagerContract
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L72

```solidity

File: WiseLendingDeclaration.sol

/// @audit Affected state variables: WISE_SECURITY

141: function setSecurity(
        address _wiseSecurity
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141

```solidity

File: PendleChildLpOracle.sol

/// @audit Affected state variables: pendleChildToken

35: function latestAnswer()
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L35

```solidity

File: PendlePowerFarmToken.sol

/// @audit Affected state variables: totalLpAssetsToDistribute

386: function previewDistribution()
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L386

```solidity

File: PendlePowerFarmToken.sol

/// @audit Affected state variables: underlyingLpAssetsCurrent

479: function previewBurnShares(
        uint256 _underlyingAssetAmount,
        uint256 _underlyingLpAssetsCurrent
    )
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L479

```solidity

File: PendlePowerFarmToken.sol

/// @audit Affected state variables: PENDLE_POWER_FARM_CONTROLLER

530: function depositExactAmount(
        uint256 _underlyingLpAssetAmount
    )
        external
        syncSupply
        returns (
            uint256,
            uint256
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L530

```solidity

File: PendlePowerFarmToken.sol

/// @audit Affected state variables: PENDLE_MARKET

683: function initialize(
        address _underlyingPendleMarket,
        address _pendleController,
        string memory _tokenName,
        string memory _symbolName,
        uint16 _maxCardinality
    )
        external
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L683

```solidity

File: PowerFarmNFTs.sol

/// @audit Affected state variables: farmContract

52: function setFarmContract(
        address _farmContract
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52

### [G-40]<a name="g-40"></a> Structs can be packed into fewer storage slots

Each slot saved can avoid an extra Gsset (20000 gas) for the first setting of the struct. Subsequent reads as well as writes have smaller gas savings

*There are 1 instance(s) of this issue:*

```solidity

File: WiseLendingDeclaration.sol

238: struct CoreLiquidationStruct {
        uint256 nftId;
        uint256 nftIdLiquidator;
        address caller;
        address tokenToPayback;
        address tokenToRecieve;
        uint256 paybackAmount;
        uint256 shareAmountToPay;
        uint256 maxFeeETH;
        uint256 baseRewardLiquidation;
        address[] lendTokens;
        address[] borrowTokens;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L238

### [G-41]<a name="g-41"></a> Superfluous event fields

`block.number` and `block.timestamp` are added to the event information by default, so adding them manually will waste additional gas.

*There are 52 instance(s) of this issue:*

```solidity

File: WiseLendingDeclaration.sol

35: event FundsDeposited(
        address indexed sender,
        uint256 indexed nftId,
        address indexed token,
        uint256 amount,
        uint256 shares,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L35

```solidity

File: WiseLendingDeclaration.sol

44: event FundsSolelyDeposited(
        address indexed sender,
        uint256 indexed nftId,
        address indexed token,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L44

```solidity

File: WiseLendingDeclaration.sol

52: event FundsWithdrawn(
        address indexed sender,
        uint256 indexed nftId,
        address indexed token,
        uint256 amount,
        uint256 shares,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L52

```solidity

File: WiseLendingDeclaration.sol

61: event FundsWithdrawnOnBehalf(
        address indexed sender,
        uint256 indexed nftId,
        address indexed token,
        uint256 amount,
        uint256 shares,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L61

```solidity

File: WiseLendingDeclaration.sol

70: event FundsSolelyWithdrawn(
        address indexed sender,
        uint256 indexed nftId,
        address indexed token,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L70

```solidity

File: WiseLendingDeclaration.sol

78: event FundsBorrowed(
        address indexed borrower,
        uint256 indexed nftId,
        address indexed token,
        uint256 amount,
        uint256 shares,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L78

```solidity

File: WiseLendingDeclaration.sol

87: event FundsBorrowedOnBehalf(
        address indexed sender,
        uint256 indexed nftId,
        address indexed token,
        uint256 amount,
        uint256 shares,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L87

```solidity

File: WiseLendingDeclaration.sol

96: event FundsReturned(
        address indexed sender,
        address indexed token,
        uint256 indexed nftId,
        uint256 totalPayment,
        uint256 totalPaymentShares,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L96

```solidity

File: FeeManagerEvents.sol

7: event ClaimedFeesWiseBulk(
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L7

```solidity

File: FeeManagerEvents.sol

11: event PoolTokenRemoved(
        address indexed poolToken,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L11

```solidity

File: FeeManagerEvents.sol

16: event PoolTokenAdded(
        address indexed poolToken,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L16

```solidity

File: FeeManagerEvents.sol

21: event IncentiveOwnerBChanged(
        address indexed newIncentiveOwnerB,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L21

```solidity

File: FeeManagerEvents.sol

26: event IncentiveOwnerAChanged(
        address indexed newIncentiveOwnerA,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L26

```solidity

File: FeeManagerEvents.sol

31: event ClaimedOwnershipIncentiveMaster(
        address indexed newIncentiveMaster,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L31

```solidity

File: FeeManagerEvents.sol

36: event IncentiveMasterProposed(
        address indexed proposedIncentiveMaster,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L36

```solidity

File: FeeManagerEvents.sol

41: event PoolFeeChanged(
        address indexed poolToken,
        uint256 indexed newPoolFee,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L41

```solidity

File: FeeManagerEvents.sol

47: event ClaimedIncentives(
        address indexed sender,
        address indexed token,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L47

```solidity

File: FeeManagerEvents.sol

54: event ClaimedIncentivesBulk(
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L54

```solidity

File: FeeManagerEvents.sol

58: event IncentiveIncreasedB(
        uint256 indexed amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L58

```solidity

File: FeeManagerEvents.sol

63: event IncentiveIncreasedA(
        uint256 indexed amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L63

```solidity

File: FeeManagerEvents.sol

68: event BadDebtIncreasedLiquidation(
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L68

```solidity

File: FeeManagerEvents.sol

73: event TotalBadDebtIncreased(
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L73

```solidity

File: FeeManagerEvents.sol

78: event TotalBadDebtDecreased(
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L78

```solidity

File: FeeManagerEvents.sol

83: event SetBadDebtPosition(
        uint256 indexed nftId,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L83

```solidity

File: FeeManagerEvents.sol

89: event UpdateBadDebtPosition(
        uint256 indexed nftId,
        uint256 newAmount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L89

```solidity

File: FeeManagerEvents.sol

95: event SetBeneficial(
        address indexed user,
        address[] token,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L95

```solidity

File: FeeManagerEvents.sol

101: event RevokeBeneficial(
        address indexed user,
        address[] token,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L101

```solidity

File: FeeManagerEvents.sol

107: event ClaimedFeesWise(
        address indexed token,
        uint256 indexed amount,
        uint256 indexed timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L107

```solidity

File: FeeManagerEvents.sol

113: event ClaimedFeesBeneficial(
        address indexed user,
        address indexed token,
        uint256 amount,
        uint256 indexed timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L113

```solidity

File: FeeManagerEvents.sol

120: event PayedBackBadDebt(
        uint256 indexed nftId,
        address indexed sender,
        address indexed paybackToken,
        address receivingToken,
        uint256 paybackAmount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L120

```solidity

File: FeeManagerEvents.sol

129: event PayedBackBadDebtFree(
        uint256 indexed nftId,
        address indexed sender,
        address indexed paybackToken,
        uint256  paybackAmount,
        uint256 timestampp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L129

```solidity

File: PendlePowerFarmDeclarations.sol

110: event FarmEntry(
        uint256 indexed keyId,
        uint256 indexed wiseLendingNFT,
        uint256 indexed leverage,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L110

```solidity

File: PendlePowerFarmDeclarations.sol

118: event FarmExit(
        uint256 indexed keyId,
        uint256 indexed wiseLendingNFT,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L118

```solidity

File: PendlePowerFarmDeclarations.sol

125: event FarmStatus(
        bool indexed state,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L125

```solidity

File: PendlePowerFarmDeclarations.sol

130: event ManualPaybackShares(
        uint256 indexed keyId,
        uint256 indexed wiseLendingNFT,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L130

```solidity

File: PendlePowerFarmDeclarations.sol

137: event ManualWithdrawShares(
        uint256 indexed keyId,
        uint256 indexed wiseLendingNFT,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L137

```solidity

File: PendlePowerFarmDeclarations.sol

144: event MinDepositChange(
        uint256 minDepositEthAmount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L144

```solidity

File: PendlePowerFarmDeclarations.sol

154: event RegistrationFarm(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L154

```solidity

File: PendlePowerFarmControllerBase.sol

157: event ExchangeLpFeesForPendle(
        address indexed _pendleMarket,
        uint256 _pendleChildShares,
        uint256 _tokenAmountSend,
        uint256 _withdrawnAmount
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L157

```solidity

File: PendlePowerFarmControllerBase.sol

179: event LockPendle(
        uint256 _amount,
        uint128 _expiry,
        uint256 _newVeBalance,
        bool _fromInside,
        bool _sameExpiry,
        uint256 _timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L179

```solidity

File: PendlePowerFarmControllerBase.sol

188: event ClaimArb(
        uint256 _accrued,
        bytes32[] _proof,
        uint256 _timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L188

```solidity

File: PendlePowerFarmControllerBase.sol

194: event IncreaseReservedForCompound(
        address indexed _pendleMarket,
        uint256[] _amounts
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L194

```solidity

File: PendlePowerFarmControllerBase.sol

199: event ClaimVoteRewards(
        uint256 _amount,
        bytes32[] _merkleProof,
        uint256 _timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L199

```solidity

File: PendlePowerFarmControllerBase.sol

205: event WithdrawLock(
        uint256 _amount,
        uint256 _timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L205

```solidity

File: WiseSecurityDeclarations.sol

47: event SecurityShutdown(
        address indexed caller,
        uint256 indexed timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L47

```solidity

File: AaveEvents.sol

7: event SetAaveTokenAddress(
        address underlyingAsset,
        address aaveToken,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L7

```solidity

File: AaveEvents.sol

13: event IsDepositAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L13

```solidity

File: AaveEvents.sol

18: event IsWithdrawAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L18

```solidity

File: AaveEvents.sol

23: event IsBorrowAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L23

```solidity

File: AaveEvents.sol

28: event IsPaybackAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L28

```solidity

File: AaveEvents.sol

33: event IsSolelyDepositAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33

```solidity

File: AaveEvents.sol

38: event IsSolelyWithdrawAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38

### [G-42]<a name="g-42"></a> Usage of `uints`/`ints` smaller than 32 bytes (256 bits) incurs overhead

When using elements that are smaller than 32 bytes, your contract's gas usage may be higher. This is because the EVM operates on 32 bytes at a time. Therefore, if the element is smaller than that, the EVM must use more operations in order to reduce the size of the element from 32 bytes to the desired size.

https://docs.soliditylang.org/en/v0.8.23/internals/layout_in_storage.html
Each operation involving a `uint8` costs an extra 22-28 gas (depending on whether the other operand is also a variable of type `uint8`) as compared to ones involving `uint256`, due to the compiler having to clear the higher bits of the memory word before operating on the `uint8`, as well as the associated stack operations of doing so. Use a larger size then downcast where needed

*There are 9 instance(s) of this issue:*

```solidity

File: MainHelper.sol

690: uint8 i;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L690

```solidity

File: CustomOracleSetup.sol

10: uint80 public globalRoundId;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L10

```solidity

File: PendleLpOracle.sol

73: uint32 public immutable TWAP_DURATION;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L73

```solidity

File: PtOracleDerivative.sol

71: uint32 public immutable TWAP_DURATION;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L71

```solidity

File: PtOraclePure.sol

57: uint32 public immutable DURATION;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L57

```solidity

File: PendlePowerFarmControllerBase.sol

37: uint128[] lastIndex;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L37

```solidity

File: PendlePowerFarmToken.sol

47: uint16 public MAX_CARDINALITY;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L47

```solidity

File: PendlePowerFarmToken.sol

234: uint128 index;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L234

```solidity

File: Declarations.sol

85: uint8 internal immutable _decimalsWETH;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L85

### [G-43]<a name="g-43"></a> `unchecked {}` can be used on the division of two `uints` in order to save gas

Make such found divisions are unchecked when ensured it is safe to do so.

*There are 1 instance(s) of this issue:*

```solidity

File: WiseCore.sol

472: uint256 cashoutShares = product / PRECISION_FACTOR_E18 + 1;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L472

### [G-44]<a name="g-44"></a> `++i`/`i++` Should Be `unchecked{++i}`/`unchecked{i++}` When It Is Not Possible For Them To Overflow, As Is The Case When Used In For- And While-loops

The unchecked keyword is new in solidity version 0.8.0, so this only applies to that version or higher, which these instances are. This saves 30-40 gas PER LOOP

*There are 1 instance(s) of this issue:*

```solidity

File: AaveHub.sol

71: function setAaveTokenAddressBulk(
        address[] calldata _underlyingAssets,
        address[] calldata _aaveTokens
    )
        external
        onlyMaster
    {
        for (uint256 i = 0; i < _underlyingAssets.length; i++) {
            _setAaveTokenAddress(
                _underlyingAssets[i],
                _aaveTokens[i]
            );
        }
    }

    
    receive()
        external
        payable
    {
        if (msg.sender == WETH_ADDRESS) {
            return;
        }

        _sendValue(
            master,
            msg.value
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71

### [G-45]<a name="g-45"></a> Add `unchecked /{/}` for subtractions where the operands cannot underflow




*There are 31 instance(s) of this issue:*

```solidity

File: MainHelper.sol

44: : _product / _pseudo - 1;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L44

```solidity

File: MainHelper.sol

103: / lendingPoolData[_poolToken].totalDepositShares - 1;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L103

```solidity

File: MainHelper.sol

552: / (lendingPoolData[_poolToken].pseudoTotalPool - feeAmount);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L552

```solidity

File: MainHelper.sol

691: uint256 endPosition = length - 1;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L691

```solidity

File: MainHelper.sol

860: * (pole - utilization);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L860

```solidity

File: PoolManager.sol

301: return (_maxPole - _minPole) / NORMALISATION_FACTOR;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L301

```solidity

File: FeeManager.sol

446: uint256 lastEntry = len - 1;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L446

```solidity

File: FeeManagerHelper.sol

180: ? _increaseTotalBadDebt(newBadDebt - currentBadDebt)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L180

```solidity

File: FeeManagerHelper.sol

181: : _decreaseTotalBadDebt(currentBadDebt - newBadDebt);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L181

```solidity

File: FeeManagerHelper.sol

322: return _amount - reduceAmount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L322

```solidity

File: PendlePowerFarmMathLogic.sol

325: * (_leverage - PRECISION_FACTOR_E18)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L325

```solidity

File: PendlePowerFarmMathLogic.sol

332: : leveragedNegativeAPY - leveragedPositivAPY;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L332

```solidity

File: PendlePowerFarmMathLogic.sol

364: * (totalPool - _borrowAmount)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L364

```solidity

File: PendlePowerFarmMathLogic.sol

377: * (pole - newUtilization);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L377

```solidity

File: PendlePowerFarmControllerHelper.sol

82: * (PRECISION_FACTOR_E6 - exchangeIncentive)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L82

```solidity

File: PendlePowerFarmToken.sol

407: * (block.timestamp - lastInteraction);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L407

```solidity

File: PendlePowerFarmToken.sol

430: * (PRECISION_FACTOR_E6 - mintFee)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L430

```solidity

File: OracleHelper.sol

582: : block.timestamp - upd;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L582

```solidity

File: WiseOracleHub.sol

112: / 10 ** (tokenDecimals - _decimalsETH)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L112

```solidity

File: WiseOracleHub.sol

114: * 10 ** (_decimalsETH - tokenDecimals)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L114

```solidity

File: WiseOracleHub.sol

163: / 10 ** (tokenDecimals - _decimalsETH)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L163

```solidity

File: WiseOracleHub.sol

165: * 10 ** (_decimalsETH - tokenDecimals)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L165

```solidity

File: WiseOracleHub.sol

185: * 10 ** (tokenDecimals - _decimalsETH)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L185

```solidity

File: WiseOracleHub.sol

191: / 10 ** (_decimalsETH - tokenDecimals);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L191

```solidity

File: WiseOracleHub.sol

345: * 10 ** (tokenDecimals - _decimalsETH)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L345

```solidity

File: WiseOracleHub.sol

351: / 10 ** (_decimalsETH - tokenDecimals);


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L351

```solidity

File: WiseSecurity.sol

625: netAPY = (ethValueGain - ethValueDebt)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L625

```solidity

File: WiseSecurity.sol

631: netAPY = (ethValueDebt - ethValueGain)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L631

```solidity

File: WiseSecurity.sol

812: withdrawAmount = withdrawAmount - _solelyWithdrawAmount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L812

```solidity

File: WiseSecurity.sol

848: tokenAmount = tokenAmount - _poolWithdrawAmount;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L848

```solidity

File: AaveHub.sol

659: * (PRECISION_FACTOR_E18 - utilization)


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L659

### [G-46]<a name="g-46"></a> Use assembly to check for `address(0)`




*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmToken.sol

691: if (address(PENDLE_MARKET) != address(0)) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L691

### [G-47]<a name="g-47"></a> Use assembly in place of abi.decode to extract calldata values more efficiently

Instead of using `abi.decode` we can use assembly to decode our desired `calldata` values directly. This will allow us to avoid decoding `calldata` values that we will not use. we can use assembly to decode our desired `calldata` values directly. This will allow us to avoid decoding `calldata` values that we will not use

*There are 2 instance(s) of this issue:*

```solidity

File: PendlePowerFarmLeverageLogic.sol

93: ) = abi.decode(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L93

```solidity

File: CallOptionalReturn.sol

26: bool results = returndata.length == 0 || abi.decode(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L26

### [G-48]<a name="g-48"></a> Use assembly to validate `msg.sender`

We can use assembly to efficiently validate msg.sender with the least amount of opcodes necessary. 

*There are 18 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

25: if (msg.sender == master) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L25

```solidity

File: OwnableMaster.sol

41: if (msg.sender == proposedMaster) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L41

```solidity

File: WiseLendingDeclaration.sol

261: if (msg.sender != AAVE_HUB_ADDRESS) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L261

```solidity

File: WiseLowLevelHelper.sol

18: if (msg.sender == address(FEE_MANAGER)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L18

```solidity

File: DeclarationsFeeManager.sol

195: if (msg.sender == incentiveMaster) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L195

```solidity

File: DeclarationsFeeManager.sol

206: if (msg.sender == address(WISE_SECURITY)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L206

```solidity

File: DeclarationsFeeManager.sol

217: if (msg.sender == address(WISE_LENDING)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L217

```solidity

File: FeeManager.sol

197: if (msg.sender != proposedIncentiveMaster) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L197

```solidity

File: FeeManager.sol

320: if (msg.sender != incentiveOwnerA) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L320

```solidity

File: FeeManager.sol

357: if (msg.sender != incentiveOwnerB) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L357

```solidity

File: PendlePowerFarmLeverageLogic.sol

77: if (msg.sender != BALANCER_ADDRESS) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L77

```solidity

File: PendlePowerFarmControllerBase.sol

251: if (msg.sender != pendleChildAddress[_pendleMarket]) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L251

```solidity

File: PendlePowerFarmToken.sol

76: if (msg.sender != PENDLE_POWER_FARM_CONTROLLER) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L76

```solidity

File: PendlePowerFarmToken.sol

514: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L514

```solidity

File: PendlePowerFarmToken.sol

635: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L635

```solidity

File: PendlePowerFarmTokenFactory.sol

44: if (msg.sender != PENDLE_POWER_FARM_CONTROLLER) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L44

```solidity

File: WiseSecurity.sol

35: if (msg.sender == address(WISE_LENDING)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L35

```solidity

File: AaveHub.sol

87: if (msg.sender == WETH_ADDRESS) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L87

### [G-49]<a name="g-49"></a> Use do while loops instead of for loops

A do while loop will cost less gas since the condition is not being checked for the first iteration.

*There are 4 instance(s) of this issue:*

```solidity

File: PowerFarmNFTs.sol

109: function walletOfOwner

for (i; i < ownerTokenCount;) {
            tokenIds[i] = tokenOfOwnerByIndex(
                _owner,
                i
            );

            unchecked {
                ++i;
            }
for (i; i < ownerTokenCount;) {
            tokenIds[i] = tokenOfOwnerByIndex(
                _owner,
                i
            );

            unchecked {
                ++i;
            }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L109-L110

```solidity

File: AaveHelper.sol

243: function _prepareCollaterals

for (i; i < l;) {

            address currentAddress = WISE_LENDING.getPositionLendingTokenByIndex(
                _nftId,
                i
            );

            unchecked {
                ++i;
            }
for (i; i < l;) {

            address currentAddress = WISE_LENDING.getPositionLendingTokenByIndex(
                _nftId,
                i
            );

            unchecked {
                ++i;
            }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L243-L244

```solidity

File: AaveHelper.sol

279: function _prepareBorrows

for (i; i < l;) {

            address currentAddress = WISE_LENDING.getPositionBorrowTokenByIndex(
                _nftId,
                i
            );

            unchecked {
                ++i;
            }
for (i; i < l;) {

            address currentAddress = WISE_LENDING.getPositionBorrowTokenByIndex(
                _nftId,
                i
            );

            unchecked {
                ++i;
            }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L279-L280

```solidity

File: AaveHub.sol

64: function setAaveTokenAddressBulk

for (uint256 i = 0; i < _underlyingAssets.length; i++) {
            _setAaveTokenAddress(
                _underlyingAssets[i],
                _aaveTokens[i]
            );
        }
for (uint256 i = 0; i < _underlyingAssets.length; i++) {
            _setAaveTokenAddress(
                _underlyingAssets[i],
                _aaveTokens[i]
            );
        }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L64-L65

### [G-50]<a name="g-50"></a> Use `!= 0` or `== 0` for unsigned integer comparison

For uint comparison in `require()` statements prior to solidity 0.8.13, it is cheaper to use `!= 0` or `== 0` instead of `> 0` or `<= 0` for unsigned integer comparison in.

*There are 23 instance(s) of this issue:*

```solidity

File: PoolManager.sol

108: if (_maximumDeposit > 0) {

112: if (_collateralFactor > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L112, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L108

```solidity

File: PoolManager.sol

268: if (fetchBalance > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L268

```solidity

File: PositionNFTs.sol

203: if (nftId > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L203

```solidity

File: PositionNFTs.sol

288: if (reservedId > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L288

```solidity

File: WiseCore.sol

564: if (pureCollateral > 0 && userShares > 0) {

572: if (potentialPureExtraCashout > 0 && potentialPureExtraCashout <= pureCollateral) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L564, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L572

```solidity

File: WiseLending.sol

1147: if (refundAmount > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1147

```solidity

File: WiseLowLevelHelper.sol

464: if (_value > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L464

```solidity

File: FeeManager.sol

697: if (totalBadDebtETH > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L697

```solidity

File: PendlePowerFarmLeverageLogic.sol

107: if (initialAmount > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L107

```solidity

File: PendlePowerFarmMathLogic.sol

103: if (positionBorrowShares > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L103

```solidity

File: PendlePowerFarmMathLogic.sol

122: if (positionBorrowSharesAave > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L122

```solidity

File: PendlePowerFarmMathLogic.sol

186: if (borrowShares > 0) {

198: if (borrowSharesAave > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L186, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L198

```solidity

File: PendlePowerFarmController.sol

388: if (_amount > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L388

```solidity

File: PendlePowerFarmToken.sol

242: if (userReward.accrued > 0) {

255: if (lastIndex[i] == 0 && index > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L255, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L242

```solidity

File: PowerFarmNFTs.sol

130: if (reservedId > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L130

```solidity

File: CallOptionalReturn.sol

37: && token.code.length > 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L37

```solidity

File: OracleHelper.sol

161: if (fetchTwapValue > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L161

```solidity

File: OracleHelper.sol

439: if (tickCumulativesDelta < 0 && (tickCumulativesDelta % twapPeriodInt56 != 0)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L439

```solidity

File: AaveHub.sol

537: if (ethRefundAmount > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L537

### [G-51]<a name="g-51"></a> A modifier used only once and not being inherited should be inlined to save gas




*There are 10 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

34: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L34

```solidity

File: WiseLendingDeclaration.sol

110: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L110

```solidity

File: PendleChildLpOracle.sol

25: CustomOracleSetup()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L25

```solidity

File: DeclarationsFeeManager.sol

41: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L41

```solidity

File: PendlePowerFarmDeclarations.sol

170: WrapperHelper(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L170

```solidity

File: PendlePowerManager.sol

43: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L43

```solidity

File: PendlePowerFarmControllerBase.sol

86: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L86

```solidity

File: PowerFarmNFTs.sol

46: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L46

```solidity

File: WiseSecurityDeclarations.sol

57: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L57

```solidity

File: Declarations.sol

48: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L48

### [G-52]<a name="g-52"></a> Use v5.0.0 OpenZeppelin contracts




*There are 1 instance(s) of this issue:*

```solidity

File: package.json

        "@openzeppelin/contracts": "^4.9.3"

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/package.json#L82

### [G-53]<a name="g-53"></a> Use mappings instead of arrays

Arrays are useful when you need to maintain an ordered list of data that can be iterated over, but they have a higher gas cost for read and write operations, especially when the size of the array is large. This is because Solidity needs to iterate over the entire array to perform certain operations, such as finding a specific element or deleting an element. Mappings, on the other hand, are useful when you need to store and access data based on a key, rather than an index. Mappings have a lower gas cost for read and write operations, especially when the size of the mapping is large, since Solidity can perform these operations based on the key directly, without needing to iterate over the entire data structure.

*There are 2 instance(s) of this issue:*

```solidity

File: DeclarationsFeeManager.sol

123: address[] public poolTokenAddresses;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L123

```solidity

File: PendlePowerFarmControllerBase.sol

61: address[] public activePendleMarkets;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L61

### [G-54]<a name="g-54"></a> Use nested `if` and avoid multiple check combinations

Using nested `if`, is cheaper than using `&&` multiple check combinations. There are more advantages, such as easier to read code and better coverage reports.

*There are 5 instance(s) of this issue:*

```solidity

File: WiseCore.sol

564: if (pureCollateral > 0 && userShares > 0) {

572: if (potentialPureExtraCashout > 0 && potentialPureExtraCashout <= pureCollateral) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L564, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L572

```solidity

File: PendlePowerFarmToken.sol

255: if (lastIndex[i] == 0 && index > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L255

```solidity

File: OracleHelper.sol

315: if (_tokenAddress != _token0 && _tokenAddress != _token1) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L315

```solidity

File: OracleHelper.sol

439: if (tickCumulativesDelta < 0 && (tickCumulativesDelta % twapPeriodInt56 != 0)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L439

### [G-55]<a name="g-55"></a> Use of Custom Errors Instead of String

To save some gas the use of custom errors leads to cheaper deploy time cost and run time cost. The run time cost is only relevant when the revert condition is met.

*There are 4 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

        require(
            _exists(_tokenId) == true,
            "PositionNFTs: WRONG_TOKEN"
        );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L348

```solidity

File: CustomOracleSetup.sol

        require(
            msg.sender == master,
            "CustomOracleSetup: NOT_MASTER"
        );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L15

```solidity

File: PowerFarmNFTs.sol

        require(
            msg.sender == farmContract,
            "PowerFarmsNFTs: INVALID_FARM"
        );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L31

```solidity

File: PowerFarmNFTs.sol

        require(
            _exists(_tokenId) == true,
            "PowerFarmsNFTs: WRONG_TOKEN"
        );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L31

### [G-56]<a name="g-56"></a> Use `uint256(1)`/`uint256(2)` instead for `true` and `false` boolean states

If you don't use boolean for storage you will avoid Gwarmaccess 100 gas. In addition, state changes of boolean from `true` to `false` can cost up to ~20000 gas rather than `uint256(2)` to `uint256(1)` that would cost significantly less.

*There are 32 instance(s) of this issue:*

```solidity

File: MainHelper.sol

617: mapping(bytes32 => bool) storage hashMap,

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L617

```solidity

File: MainHelper.sol

631: hashMap[hashData] = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L631

```solidity

File: MainHelper.sol

745: ] = false;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L745

```solidity

File: MainHelper.sol

806: ] = false;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L806

```solidity

File: PositionNFTs.sol

21: mapping(address => bool) public reserveRole;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L21

```solidity

File: PositionNFTs.sol

68: reservePublicBlocked = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L68

```solidity

File: WiseLending.sol

88: powerFarmCheck = false;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L88

```solidity

File: WiseLending.sol

342: userLendingData[_nftId][_poolToken].unCollateralized = false;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L342

```solidity

File: WiseLending.sol

369: userLendingData[_nftId][_poolToken].unCollateralized = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L369

```solidity

File: WiseLendingDeclaration.sol

286: mapping(uint256 => bool) public positionLocked;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L286

```solidity

File: WiseLendingDeclaration.sol

287: mapping(address => bool) internal parametersLocked;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287

```solidity

File: WiseLendingDeclaration.sol

288: mapping(address => bool) public verifiedIsolationPool;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288

```solidity

File: WiseLendingDeclaration.sol

291: mapping(bytes32 => bool) internal hashMapPositionBorrow;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L291

```solidity

File: WiseLendingDeclaration.sol

292: mapping(bytes32 => bool) internal hashMapPositionLending;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L292

```solidity

File: DeclarationsFeeManager.sol

149: mapping(address => bool) public poolTokenAdded;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149

```solidity

File: DeclarationsFeeManager.sol

152: mapping(address => bool) public isAaveToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152

```solidity

File: DeclarationsFeeManager.sol

158: mapping(address => mapping(address => bool)) public allowedTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158

```solidity

File: FeeManager.sol

400: poolTokenAdded[_poolToken] = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L400

```solidity

File: FeeManager.sol

426: poolTokenAdded[_poolToken] = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L426

```solidity

File: FeeManager.sol

464: found = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L464

```solidity

File: FeeManager.sol

476: poolTokenAdded[_poolToken] = false;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L476

```solidity

File: FeeManagerHelper.sol

236: isAaveToken[_poolToken] = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L236

```solidity

File: PendlePowerFarmDeclarations.sol

108: mapping(uint256 => bool) public isAave;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L108

```solidity

File: PendlePowerFarmLeverageLogic.sol

35: allowEnter = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L35

```solidity

File: PendlePowerFarmLeverageLogic.sol

71: allowEnter = false;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L71

```solidity

File: SendValueHelper.sol

22: sendingProgress = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L22

```solidity

File: SendValueHelper.sol

31: sendingProgress = false;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L31

```solidity

File: WiseSecurityDeclarations.sol

69: securityWorker[_master] = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L69

```solidity

File: WiseSecurityDeclarations.sol

238: mapping(address => bool) public wasBlacklisted;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238

```solidity

File: WiseSecurityDeclarations.sol

247: mapping(address => bool) public securityWorker;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247

```solidity

File: AaveHelper.sol

206: sendingProgressAaveHub = true;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L206

```solidity

File: AaveHelper.sol

212: sendingProgressAaveHub = false;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L212

### [G-57]<a name="g-57"></a> Using XOR (^) and AND (&) bitwise equivalents for gas optimizations

Given 4 variables a, b, c and d represented as such:

    0 0 0 0 0 1 1 0 <- a
    0 1 1 0 0 1 1 0 <- b
    0 0 0 0 0 0 0 0 <- c
    1 1 1 1 1 1 1 1 <- d

To have a == b means that every 0 and 1 match on both variables. Meaning that a XOR (operator ^) would evaluate to 0 ((a ^ b) == 0), as it excludes by definition any equalities.Now, if a != b, this means that there’s at least somewhere a 1 and a 0 not matching between a and b, making (a ^ b) != 0.Both formulas are logically equivalent and using the XOR bitwise operator costs actually the same amount of gas.However, it is much cheaper to use the bitwise OR operator (|) than comparing the truthy or falsy values.These are logically equivalent too, as the OR bitwise operator (|) would result in a 1 somewhere if any value is not 0 between the XOR (^) statements, meaning if any XOR (^) statement verifies that its arguments are different.

*There are 137 instance(s) of this issue:*

```solidity

File: MainHelper.sol

42: return _maxSharePrice == true


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L42

```solidity

File: MainHelper.sol

269: if (_nftIdLiquidator == _nftId) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L269

```solidity

File: MainHelper.sol

436: if (currentAddress == _poolToken) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L436

```solidity

File: MainHelper.sol

542: if (feeAmount == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L542

```solidity

File: MainHelper.sol

554: if (feeShares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L554

```solidity

File: MainHelper.sol

681: if (length == 1) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L681

```solidity

File: MainHelper.sol

695: if (i == endPosition) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L695

```solidity

File: MainHelper.sol

716: isLending == true


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L716

```solidity

File: MainHelper.sol

838: return userLendingData[_nftId][_poolToken].shares == 0


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L838

```solidity

File: MainHelper.sol

1161: if (_nftId == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1161

```solidity

File: OwnableMaster.sol

25: if (msg.sender == master) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L25

```solidity

File: OwnableMaster.sol

41: if (msg.sender == proposedMaster) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L41

```solidity

File: OwnableMaster.sol

60: if (_master == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L60

```solidity

File: OwnableMaster.sol

76: if (_proposedOwner == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L76

```solidity

File: PoolManager.sol

174: if (_params.poolToken == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L174

```solidity

File: PositionNFTs.sol

230: if (_nftId == FEE_MANAGER_NFT) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L230

```solidity

File: PositionNFTs.sol

231: return feeManager == _owner;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L231

```solidity

File: PositionNFTs.sol

355: if (bytes(currentBaseURI).length == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L355

```solidity

File: PositionNFTs.sol

378: if (_tokenId == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L378

```solidity

File: WiseCore.sol

76: if (_onBehalf == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L76

```solidity

File: WiseCore.sol

278: if (_caller == AAVE_HUB_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L278

```solidity

File: WiseCore.sol

306: if (state == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L306

```solidity

File: WiseCore.sol

397: if (_onBehalf == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L397

```solidity

File: WiseCore.sol

588: if (userShares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L588

```solidity

File: WiseCore.sol

592: if (userLendingData[_nftId][_receiveTokens].unCollateralized == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L592

```solidity

File: WiseLending.sol

87: if (powerFarmCheck == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L87

```solidity

File: WiseLending.sol

1527: if (_onBehalf == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1527

```solidity

File: WiseLowLevelHelper.sol

18: if (msg.sender == address(FEE_MANAGER)) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L18

```solidity

File: WiseLowLevelHelper.sol

354: if (sendingProgress == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L354

```solidity

File: WiseLowLevelHelper.sol

453: if (_value == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L453

```solidity

File: PendleLpOracle.sol

104: if (increaseCardinalityRequired == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L104

```solidity

File: PendleLpOracle.sol

108: if (oldestObservationSatisfied == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L108

```solidity

File: PtOracleDerivative.sol

109: if (increaseCardinalityRequired == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L109

```solidity

File: PtOracleDerivative.sol

113: if (oldestObservationSatisfied == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L113

```solidity

File: PtOraclePure.sol

90: if (increaseCardinalityRequired == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L90

```solidity

File: PtOraclePure.sol

94: if (oldestObservationSatisfied == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L94

```solidity

File: DeclarationsFeeManager.sol

195: if (msg.sender == incentiveMaster) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L195

```solidity

File: DeclarationsFeeManager.sol

206: if (msg.sender == address(WISE_SECURITY)) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L206

```solidity

File: DeclarationsFeeManager.sol

217: if (msg.sender == address(WISE_LENDING)) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L217

```solidity

File: FeeManager.sol

179: if (_proposedIncentiveMaster == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L179

```solidity

File: FeeManager.sol

291: if (amount == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L291

```solidity

File: FeeManager.sol

324: if (_newOwner == incentiveOwnerA) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L324

```solidity

File: FeeManager.sol

328: if (_newOwner == incentiveOwnerB) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L328

```solidity

File: FeeManager.sol

361: if (_newOwner == incentiveOwnerA) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L361

```solidity

File: FeeManager.sol

365: if (_newOwner == incentiveOwnerB) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L365

```solidity

File: FeeManager.sol

473: if (found == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L473

```solidity

File: FeeManager.sol

640: if (shares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L640

```solidity

File: FeeManager.sol

663: if (totalBadDebtETH == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L663

```solidity

File: FeeManagerHelper.sol

352: if (reduceUSD == usdEquivalent) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L352

```solidity

File: PendlePowerFarm.sol

72: if (borrowShares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L72

```solidity

File: PendlePowerFarm.sol

80: if (totalCollateral == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L80

```solidity

File: PendlePowerFarm.sol

238: uint256 borrowShares = _isAave == false


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L238

```solidity

File: PendlePowerFarm.sol

246: uint256 borrowTokenAmount = _isAave == false


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L246

```solidity

File: PendlePowerFarmDeclarations.sol

279: if (block.chainid == ETH_CHAIN_ID) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L279

```solidity

File: PendlePowerFarmDeclarations.sol

287: if (block.chainid == ARB_CHAIN_ID) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L287

```solidity

File: PendlePowerFarmDeclarations.sol

365: if (isShutdown == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L365

```solidity

File: PendlePowerFarmLeverageLogic.sol

67: if (allowEnter == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L67

```solidity

File: PendlePowerFarmLeverageLogic.sol

73: if (_flashloanToken.length == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L73

```solidity

File: PendlePowerFarmLeverageLogic.sol

174: address tokenOut = block.chainid == 1


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L174

```solidity

File: PendlePowerFarmLeverageLogic.sol

174: block.chainid == 1


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L174

```solidity

File: PendlePowerFarmLeverageLogic.sol

215: if (_ethBack == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L215

```solidity

File: PendlePowerFarmLeverageLogic.sol

239: if (block.chainid == ETH_CHAIN_ID) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L239

```solidity

File: PendlePowerFarmLeverageLogic.sol

246: if (block.chainid == ARB_CHAIN_ID) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L246

```solidity

File: PendlePowerFarmLeverageLogic.sol

333: if (_isAave == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L333

```solidity

File: PendlePowerFarmLeverageLogic.sol

427: if (block.chainid == ARB_CHAIN_ID) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L427

```solidity

File: PendlePowerFarmLeverageLogic.sol

538: if (_isAave == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L538

```solidity

File: PendlePowerFarmMathLogic.sol

39: if (sendingProgress == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L39

```solidity

File: PendlePowerFarmMathLogic.sol

213: if (borrowTokenAmountAave == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L213

```solidity

File: PendlePowerFarmMathLogic.sol

330: uint256 netAPY = isPositive == true


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L330

```solidity

File: PendlePowerFarmMathLogic.sol

404: if (borrowShares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L404

```solidity

File: PendlePowerManager.sol

189: if (availableNFTCount == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L189

```solidity

File: PendlePowerFarmController.sol

124: if (_pendleChildShares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L124

```solidity

File: PendlePowerFarmController.sol

182: if (childMarket == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L182

```solidity

File: PendlePowerFarmController.sol

345: if (child == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L345

```solidity

File: PendlePowerFarmController.sol

396: if (_fromInside == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L396

```solidity

File: PendlePowerFarmController.sol

456: if (IS_ETH_MAIN == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L456

```solidity

File: PendlePowerFarmControllerBase.sol

265: if (child == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L265

```solidity

File: PendlePowerFarmToken.sol

154: if (_overWritten == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L154

```solidity

File: PendlePowerFarmToken.sol

266: if (index == lastIndex[i]) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L266

```solidity

File: PendlePowerFarmToken.sol

339: if (additonalAssets == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L339

```solidity

File: PendlePowerFarmToken.sol

391: if (totalLpAssetsToDistribute == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L391

```solidity

File: PendlePowerFarmToken.sol

395: if (block.timestamp == lastInteraction) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L395

```solidity

File: PendlePowerFarmToken.sol

489: return product % _underlyingLpAssetsCurrent == 0


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L489

```solidity

File: PendlePowerFarmToken.sol

508: if (_amount == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L508

```solidity

File: PendlePowerFarmToken.sol

514: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L514

```solidity

File: PendlePowerFarmToken.sol

539: if (_underlyingLpAssetAmount == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L539

```solidity

File: PendlePowerFarmToken.sol

548: if (shares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L548

```solidity

File: PendlePowerFarmToken.sol

559: if (feeShares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L559

```solidity

File: PendlePowerFarmToken.sol

563: if (reducedShares == feeShares) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L563

```solidity

File: PendlePowerFarmToken.sol

615: if (_shares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L615

```solidity

File: PendlePowerFarmToken.sol

635: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L635

```solidity

File: PendlePowerFarmToken.sol

654: if (_underlyingLpAssetAmount == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L654

```solidity

File: MinterReserver.sol

122: if (_keyId == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L122

```solidity

File: PowerFarmNFTs.sol

57: if (farmContract == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L57

```solidity

File: PowerFarmNFTs.sol

197: if (bytes(currentBaseURI).length == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L197

```solidity

File: PowerFarmNFTs.sol

220: if (_tokenId == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L220

```solidity

File: CallOptionalReturn.sol

26: bool results = returndata.length == 0 || abi.decode(


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L26

```solidity

File: CallOptionalReturn.sol

31: if (success == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L31

```solidity

File: SendValueHelper.sol

33: if (success == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L33

```solidity

File: OracleHelper.sol

74: if (size == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L74

```solidity

File: OracleHelper.sol

117: if (uniTwapPoolInfoStruct.isUniPool == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L117

```solidity

File: OracleHelper.sol

311: if (_tokenAddress == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L311

```solidity

File: OracleHelper.sol

331: if (_pool == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L331

```solidity

File: OracleHelper.sol

526: if (IS_ARBITRUM_CHAIN == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L526

```solidity

File: OracleHelper.sol

537: if (answer == 1) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L537

```solidity

File: WiseOracleHub.sol

151: if (_tokenAddress == WETH_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L151

```solidity

File: WiseOracleHub.sol

335: if (_tokenAddress == WETH_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L335

```solidity

File: WiseOracleHub.sol

455: if (length == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L455

```solidity

File: WiseOracleHub.sol

475: if (state == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L475

```solidity

File: WiseSecurity.sol

35: if (msg.sender == address(WISE_LENDING)) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L35

```solidity

File: WiseSecurity.sol

70: if (overallCollateral == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L70

```solidity

File: WiseSecurity.sol

170: if (curveMetaPool == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L170

```solidity

File: WiseSecurity.sol

201: if (curvePool == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L201

```solidity

File: WiseSecurity.sol

218: if (curveMeta == ZERO_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L218

```solidity

File: WiseSecurity.sol

453: if (len == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L453

```solidity

File: WiseSecurity.sol

510: if (len == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L510

```solidity

File: WiseSecurity.sol

652: if (len == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L652

```solidity

File: WiseSecurity.sol

924: if (currentTotalBorrowShares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L924

```solidity

File: WiseSecurity.sol

961: if (currentTotalLendingShares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L961

```solidity

File: WiseSecurity.sol

1100: if (minDepositEthValue == ONE_WEI) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1100

```solidity

File: WiseSecurity.sol

1117: if (_newMinDepositValue == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1117

```solidity

File: WiseSecurityDeclarations.sol

146: uint256 maxFee = IS_ETH_MAINNET == true


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L146

```solidity

File: WiseSecurityDeclarations.sol

150: uint256 minFee = IS_ETH_MAINNET == true


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L150

```solidity

File: WiseSecurityDeclarations.sol

164: uint256 maxFeeFarm = IS_ETH_MAINNET == true


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L164

```solidity

File: WiseSecurityDeclarations.sol

168: uint256 minFeeFarm = IS_ETH_MAINNET == true


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L168

```solidity

File: WiseSecurityHelper.sol

295: if (lendingShares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L295

```solidity

File: WiseSecurityHelper.sol

624: if (borrowShares == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L624

```solidity

File: WiseSecurityHelper.sol

678: if (WISE_LENDING.borrowPoolData(_poolAddress).allowBorrow == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L678

```solidity

File: WiseSecurityHelper.sol

818: if (borrowAmount == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L818

```solidity

File: WiseSecurityHelper.sol

822: uint256 overallCollateral = _powerFarm == true


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L822

```solidity

File: WiseSecurityHelper.sol

1010: if (pseudoTotalPool == 0) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1010

```solidity

File: WiseSecurityHelper.sol

1102: if (_success == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1102

```solidity

File: AaveHelper.sol

38: if (sendingProgressAaveHub == true) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L38

```solidity

File: AaveHelper.sol

214: if (success == false) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L214

```solidity

File: AaveHelper.sol

265: if (currentAddress == _poolToken) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L265

```solidity

File: AaveHelper.sol

301: if (currentAddress == _poolToken) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L301

```solidity

File: AaveHub.sol

87: if (msg.sender == WETH_ADDRESS) {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L87

### [G-58]<a name="g-58"></a> Using assembly to check for zero can save gas

Using assembly to check for zero can save gas by allowing more direct access to the evm and reducing some of the overhead associated with high-level operations in solidity.

*There are 52 instance(s) of this issue:*

```solidity

File: MainHelper.sol

542: if (feeAmount == 0) {

554: if (feeShares == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L554, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L542

```solidity

File: MainHelper.sol

1161: if (_nftId == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1161

```solidity

File: PositionNFTs.sol

355: if (bytes(currentBaseURI).length == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L355

```solidity

File: PositionNFTs.sol

378: if (_tokenId == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L378

```solidity

File: WiseCore.sol

588: if (userShares == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L588

```solidity

File: WiseLowLevelHelper.sol

453: if (_value == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L453

```solidity

File: FeeManager.sol

291: if (amount == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L291

```solidity

File: FeeManager.sol

640: if (shares == 0) {

663: if (totalBadDebtETH == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L663, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L640

```solidity

File: FeeManager.sol

746: if (badDebtPosition[_nftId] == 0) {

753: if (WISE_LENDING.getTotalDepositShares(_receivingToken) == 0) {

757: if (WISE_LENDING.getTotalDepositShares(_paybackToken) == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L746, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L757, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L753

```solidity

File: FeeManager.sol

828: if (badDebtPosition[_nftId] == 0) {

832: if (WISE_LENDING.getTotalDepositShares(_paybackToken) == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L832, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L828

```solidity

File: PendlePowerFarm.sol

72: if (borrowShares == 0) {

80: if (totalCollateral == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L80, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L72

```solidity

File: PendlePowerFarmLeverageLogic.sol

73: if (_flashloanToken.length == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L73

```solidity

File: PendlePowerFarmMathLogic.sol

213: if (borrowTokenAmountAave == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L213

```solidity

File: PendlePowerFarmMathLogic.sol

404: if (borrowShares == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L404

```solidity

File: PendlePowerManager.sol

189: if (availableNFTCount == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L189

```solidity

File: PendlePowerFarmController.sol

124: if (_pendleChildShares == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L124

```solidity

File: PendlePowerFarmToken.sol

255: if (lastIndex[i] == 0 && index > 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L255

```solidity

File: PendlePowerFarmToken.sol

339: if (additonalAssets == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L339

```solidity

File: PendlePowerFarmToken.sol

391: if (totalLpAssetsToDistribute == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L391

```solidity

File: PendlePowerFarmToken.sol

508: if (_amount == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L508

```solidity

File: PendlePowerFarmToken.sol

539: if (_underlyingLpAssetAmount == 0) {

548: if (shares == 0) {

559: if (feeShares == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L559, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L539, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L548

```solidity

File: PendlePowerFarmToken.sol

615: if (_shares == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L615

```solidity

File: PendlePowerFarmToken.sol

654: if (_underlyingLpAssetAmount == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L654

```solidity

File: MinterReserver.sol

122: if (_keyId == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L122

```solidity

File: PowerFarmNFTs.sol

197: if (bytes(currentBaseURI).length == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L197

```solidity

File: PowerFarmNFTs.sol

220: if (_tokenId == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L220

```solidity

File: OracleHelper.sol

74: if (size == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L74

```solidity

File: OracleHelper.sol

439: if (tickCumulativesDelta < 0 && (tickCumulativesDelta % twapPeriodInt56 != 0)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L439

```solidity

File: OracleHelper.sol

566: if (heartBeat[_tokenAddress] == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L566

```solidity

File: WiseOracleHub.sol

455: if (length == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L455

```solidity

File: WiseSecurity.sol

70: if (overallCollateral == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L70

```solidity

File: WiseSecurity.sol

267: if (WISE_LENDING.getPositionBorrowTokenLength(_nftId) == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L267

```solidity

File: WiseSecurity.sol

453: if (len == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L453

```solidity

File: WiseSecurity.sol

510: if (len == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L510

```solidity

File: WiseSecurity.sol

652: if (len == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L652

```solidity

File: WiseSecurity.sol

924: if (currentTotalBorrowShares == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L924

```solidity

File: WiseSecurity.sol

961: if (currentTotalLendingShares == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L961

```solidity

File: WiseSecurity.sol

1117: if (_newMinDepositValue == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1117

```solidity

File: WiseSecurityHelper.sol

210: if (WISE_LENDING.getPositionLendingShares(_nftId, _poolToken) == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L210

```solidity

File: WiseSecurityHelper.sol

295: if (lendingShares == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L295

```solidity

File: WiseSecurityHelper.sol

624: if (borrowShares == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L624

```solidity

File: WiseSecurityHelper.sol

818: if (borrowAmount == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L818

```solidity

File: WiseSecurityHelper.sol

1010: if (pseudoTotalPool == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1010

```solidity

File: AaveHelper.sol

29: if (WISE_LENDING.getTotalDepositShares(_poolToken) == 0) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L29

### [G-59]<a name="g-59"></a> Using Bools For Storage Incurs Overhead

Booleans are more expensive than uint256 or any type that takes up a full word because each write operation emits an extra SLOAD to first read the slot's contents, replace the bits taken up by the boolean, and then write back. This is the compiler's defense against contract upgrades and pointer aliasing, and it cannot be disabled.

*There are 17 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

21: mapping(address => bool) public reserveRole;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L21

```solidity

File: PositionNFTs.sol

23: bool public reservePublicBlocked;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L23

```solidity

File: WiseLendingDeclaration.sol

286: mapping(uint256 => bool) public positionLocked;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L286

```solidity

File: WiseLendingDeclaration.sol

287: mapping(address => bool) internal parametersLocked;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287

```solidity

File: WiseLendingDeclaration.sol

288: mapping(address => bool) public verifiedIsolationPool;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288

```solidity

File: WiseLendingDeclaration.sol

291: mapping(bytes32 => bool) internal hashMapPositionBorrow;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L291

```solidity

File: WiseLendingDeclaration.sol

292: mapping(bytes32 => bool) internal hashMapPositionLending;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L292

```solidity

File: DeclarationsFeeManager.sol

149: mapping(address => bool) public poolTokenAdded;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149

```solidity

File: DeclarationsFeeManager.sol

152: mapping(address => bool) public isAaveToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152

```solidity

File: DeclarationsFeeManager.sol

158: mapping(address => mapping(address => bool)) public allowedTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158

```solidity

File: PendlePowerFarmDeclarations.sol

43: bool public isShutdown;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L43

```solidity

File: PendlePowerFarmDeclarations.sol

46: bool public allowEnter;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L46

```solidity

File: PendlePowerFarmDeclarations.sol

108: mapping(uint256 => bool) public isAave;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L108

```solidity

File: SendValueHelper.sol

10: bool public sendingProgress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L10

```solidity

File: WiseSecurityDeclarations.sol

238: mapping(address => bool) public wasBlacklisted;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238

```solidity

File: WiseSecurityDeclarations.sol

247: mapping(address => bool) public securityWorker;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247

```solidity

File: Declarations.sol

25: bool public sendingProgressAaveHub;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L25

### [G-60]<a name="g-60"></a> Using `++X/`--X` instead of `X++`/`X--` can save gas

It can save 5 gas for each execution / per iteration.

*There are 7 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

208: totalReserved--;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L208

```solidity

File: PositionNFTs.sol

386: length++;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L386

```solidity

File: PendlePowerManager.sol

206: availableNFTCount--



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L206

```solidity

File: MinterReserver.sol

135: totalMinted++;

136: totalReserved--;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L135-L136

```solidity

File: PowerFarmNFTs.sol

228: length++;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L228

```solidity

File: OracleHelper.sol

440: tick--;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L440

```solidity

File: AaveHub.sol

71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71

### [G-61]<a name="g-61"></a> Using `this` to access functions results in an external call, wasting gas

External calls have an overhead of **100 gas**, which can be avoided by not referencing the function using `this`. Contracts [are allowed](https://docs.soliditylang.org/en/latest/contracts.html#function-overriding) to override their parents' functions and change the visibility from `external` to `public`, so make this change if it's required in order to call the function internally.

*There are 5 instance(s) of this issue:*

```solidity

File: PendlePowerFarmControllerHelper.sol

50: return _getPositionData(address(this)).expiry;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L50

```solidity

File: PendlePowerFarmControllerHelper.sol

58: return _getPositionData(address(this)).amount;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L58

```solidity

File: MinterReserver.sol

176: return this.onERC721Received.selector;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L176

```solidity

File: SendValueHelper.sol

18: if (address(this).balance < _amount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L18

```solidity

File: AaveHelper.sol

202: if (address(this).balance < _amount) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L202

### [G-62]<a name="g-62"></a> Write direct outcome, instead of performing mathematical operations

Write direct outcome instead ofperforming mathematical operations saves some gas

*There are 1 instance(s) of this issue:*

```solidity

File: WiseSecurityDeclarations.sol

185: uint256 public constant BORROW_PERCENTAGE_CAP = 95 * PRECISION_FACTOR_E16;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L185

### NonCritical Risk Issues

### [N-01]<a name="n-01"></a> The call `abi.encodeWithSelector` is not type safe

The call `abi.encodeCall` should be used instead. Note `abi.encodeCall` is only safe from typographical errors in solidity versions 0.8.13 and above

*There are 3 instance(s) of this issue:*

```solidity

File: ApprovalHelper.sol

22: abi.encodeWithSelector(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L22

```solidity

File: TransferHelper.sol

22: abi.encodeWithSelector(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L22

```solidity

File: TransferHelper.sol

44: abi.encodeWithSelector(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L44

### [N-02]<a name="n-02"></a> Add inline comments for unnamed variables in function declarations

Unnamed variables in function declarations can confuse developers. To enhance clarity, add inline comments next to each unnamed variable. E.g address, -> address /* to */,

*There are 2 instance(s) of this issue:*

```solidity

File: MainHelper.sol

667: function _removePositionData(
        uint256 _nftId,
        address _poolToken,
        function(uint256) view returns (uint256) _getPositionTokenLength,
        function(uint256, uint256) view returns (address) _getPositionTokenByIndex,
        function(uint256, address) internal _deleteLastPositionData,
        bool isLending
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L668

```solidity

File: MainHelper.sol

1184: function _updatePoolStorage(
        address _poolToken,
        uint256 _amount,
        uint256 _shares,
        function(address, uint256) functionAmountA,
        function(address, uint256) functionAmountB,
        function(address, uint256) functionSharesA
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1185

### [N-03]<a name="n-03"></a> `address` shouldn't be hard-coded

It is often better to declare `address`es as `immutable`, and assign them via constructor arguments. This allows the code to remain the same across deployments on different networks, and avoids recompilation when addresses need to change.

*There are 7 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

14: address internal constant ZERO_ADDRESS = address(0x0);



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L14

```solidity

File: CustomOracleSetup.sol

30: master = address(0x0);



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L30

```solidity

File: PendlePowerFarmDeclarations.sol

86: address internal constant BALANCER_ADDRESS = 0xBA12222222228d8Ba445958a75a0704d566BF2C8;

92: address internal constant ST_ETH_ADDRESS = 0xae7ab96520DE3A18E5e111B5EaAb095312D7fE84;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L92, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L86

```solidity

File: PendlePowerFarmControllerBase.sol

74: address internal constant ARB_REWARDS_ADDRESS = 0x23a102e78D1FF1645a3666691495174764a5FCAF;

75: address internal constant ARB_TOKEN_ADDRESS = 0x912CE59144191C1204E64559FE8253a0e49E6548;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L74-L75

```solidity

File: PendlePowerFarmTokenFactory.sol

11: address internal constant ZERO_ADDRESS = address(0x0);



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L11

```solidity

File: Declarations.sol

79: address public constant SEQUENCER_ADDRESS = 0xFdB631F5EE196F0ed6FAa767959853A9F217697D;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L79

### [N-04]<a name="n-04"></a> Array lengths not checked

If the length of the arrays are not required to be of the same length, user operations may not be fully executed

*There are 5 instance(s) of this issue:*

```solidity

File: MainHelper.sol


function _curveSecurityChecks(
        address[] memory _lendTokens,
        address[] memory _borrowTokens
    )
        internal
    {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L454-L455

```solidity

File: FeeManager.sol


function setAaveFlagBulk(
        address[] calldata _poolTokens,
        address[] calldata _underlyingTokens
    )
        external
        onlyMaster
    {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L82-L83

```solidity

File: FeeManager.sol


function setPoolFeeBulk(
        address[] calldata _poolTokens,
        uint256[] calldata _newFees
    )
        external
        onlyMaster
    {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L135-L136

```solidity

File: WiseOracleHub.sol


function addOracleBulk(
        address[] calldata _tokenAddresses,
        IPriceFeed[] calldata _priceFeedAddresses,
        address[][] calldata _underlyingFeedTokens
    )
        external
        onlyMaster
    {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L379-L380

```solidity

File: AaveHub.sol


function setAaveTokenAddressBulk(
        address[] calldata _underlyingAssets,
        address[] calldata _aaveTokens
    )
        external
        onlyMaster
    {


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L64-L65

### [N-05]<a name="n-05"></a> Assembly block creates dirty bits

Manipulating data directly at the free memory pointer location without subsequently adjusting the pointer can lead to unwanted data remnants, or "dirty bits", in that memory spot. This can cause challenges for the Solidity optimizer, making it difficult to determine if memory cleaning is required before reuse, potentially resulting in less efficient optimization. To mitigate this issue, it's advised to always update the free memory pointer following any data write operation. Furthermore, using the `assembly ("memory-safe") { ... }` annotation will clearly indicate to the optimizer the sections of your code that are memory-safe, improving code efficiency and reducing the potential for errors.

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmTokenFactory.sol

56: function _clone(
        address _underlyingPendleMarket,
        string memory _tokenName,
        string memory _symbolName,
        uint16 _maxCardinality
    )
        private
        returns (address pendlePowerFarmTokenAddress)
    {

		...

		assembly {

            let clone := mload(0x40)

            mstore(
                clone,
                0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000
            )

            mstore(
                add(clone, 0x14),
                targetBytes
            )

            mstore(
                add(clone, 0x28),
                0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000
            )

            pendlePowerFarmTokenAddress := create2(
                0,
                clone,
                0x37,
                salt
            )
        }

		...



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L57

### [N-06]<a name="n-06"></a> Avoid mutating function parameters

Function parameters in Solidity are passed by value, meaning they are essentially local copies. Mutating them can lead to confusion and errors because the changes don't persist outside the function. By keeping function parameters immutable, you ensure clarity in code behavior, preventing unintended side-effects. If you need to modify a value based on a parameter, use a local variable inside the function, leaving the original parameter unaltered. By adhering to this practice, you maintain a clear distinction between input data and the internal processing logic, improving code readability and reducing the potential for bugs.

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmLeverageLogic.sol

414: function _logicOpenPosition(
        bool _isAave,
        uint256 _nftId,
        uint256 _depositAmount, // @audit <--- 
        uint256 _totalDebtBalancer,
        uint256 _allowedSpread
    )
        internal
    {
        uint256 reverseAllowedSpread = 2
            * PRECISION_FACTOR_E18
            - _allowedSpread;

        if (block.chainid == ARB_CHAIN_ID) {

            _depositAmount = _getTokensUniV3(
                _depositAmount,
                _getEthInTokens(
                        ENTRY_ASSET,
                        _depositAmount
                    )
                * reverseAllowedSpread
                / PRECISION_FACTOR_E18,
                WETH_ADDRESS,
                ENTRY_ASSET
            );
        }

        uint256 syReceived = PENDLE_SY.deposit(
            {
                _receiver: address(this),
                _tokenIn: ENTRY_ASSET,
                _amountTokenToDeposit: _depositAmount,
                _minSharesOut: PENDLE_SY.previewDeposit(
                    ENTRY_ASSET,
                    _depositAmount
                )
            }
        );

        (   ,
            uint256 netPtFromSwap,
            ,
            ,
            ,
        ) = PENDLE_ROUTER_STATIC.addLiquiditySingleSyStatic(
            address(PENDLE_MARKET),
            syReceived
        );

        (
            uint256 netLpOut
            ,
        ) = PENDLE_ROUTER.addLiquiditySingleSy(
            {
                _receiver: address(this),
                _market: address(PENDLE_MARKET),
                _netSyIn: syReceived,
                _minLpOut: 0,
                _guessPtReceivedFromSy: ApproxParams(
                    {
                        guessMin: netPtFromSwap - 100,
                        guessMax: netPtFromSwap + 100,
                        guessOffchain: 0,
                        maxIteration: 50,
                        eps: 1e15
                    }
                )
            }
        );

        uint256 ethValueBefore = _getTokensInETH(
            ENTRY_ASSET,
            _depositAmount
        );

        (
            uint256 receivedShares
            ,
        ) = IPendleChild(PENDLE_CHILD).depositExactAmount(
            netLpOut
        );

        uint256 ethValueAfter = _getTokensInETH(
            PENDLE_CHILD,
            receivedShares
        )
            * _allowedSpread
            / PRECISION_FACTOR_E18;

        if (ethValueAfter < ethValueBefore) {
            revert TooMuchValueLost();
        }

        WISE_LENDING.depositExactAmount(
            _nftId,
            PENDLE_CHILD,
            receivedShares
        );

        _borrowExactAmount(
            _isAave,
            _nftId,
            _totalDebtBalancer
        );

        if (_checkDebtRatio(_nftId) == false) {
            revert DebtRatioTooHigh();
        }

        _safeTransfer(
            WETH_ADDRESS,
            BALANCER_ADDRESS,
            _totalDebtBalancer
        );
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L415

### [N-07]<a name="n-07"></a> Avoid the use of sensitive terms

Use <a href="https://www.zdnet.com/article/mysql-drops-master-slave-and-blacklist-whitelist-terminology/">alternative variants</a>, e.g. allowlist/denylist instead of whitelist/blacklist

*There are 24 instance(s) of this issue:*

```solidity

File: WiseSecurity.sol

246: if (_checkBlacklisted(_poolToken) == true) {

284: if (_checkBlacklisted(_poolToken) == true) {

367: if (_checkBlacklisted(_poolToken) == true) {

675: if (wasBlacklisted[token] == true) {

693: * locked due to blacklisted token.

695: function positionBlackListToken(

716: if (_checkBlacklisted(token) == true) {

741: if (_checkBlacklisted(token) == true) {

976: * @dev Set function for blacklisting token.

980: function setBlacklistToken(

987: wasBlacklisted[_tokenAddress] = _state;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L716, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L246, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L284, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L367, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L675, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L693, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L695, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L741, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L976, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L987

```solidity

File: WiseSecurityDeclarations.sol

21: error TokenBlackListed();

33: error Blacklisted();

237: // Mapping pool token to blacklist bool

238: mapping(address => bool) public wasBlacklisted;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L21, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L33, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L237

```solidity

File: WiseSecurityHelper.sol

357: * No heartbeat or blacklisted checks are

391: * No blacklisted check is included

468: * and blacklisted checks.

470: function _checkBlacklisted(

477: return wasBlacklisted[_poolToken] == true;

1067: wasBlacklisted[

1078: * @dev Wrapper for {_checkBlacklisted}.

1086: if (_checkBlacklisted(_poolToken) == true) {

1087: revert TokenBlackListed();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L468, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L391, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L357, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1067, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L477, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L470, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1087, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1086, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1078

### [N-08]<a name="n-08"></a> No need for `== true` or `== false` checks

There is no need to verify that `== true` or `== false` when the variable checked upon is a boolean as well.

*There are 90 instance(s) of this issue:*

```solidity

File: MainHelper.sol

223: if (verifiedIsolationPool[_poolAddress] == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L223

```solidity

File: MainHelper.sol

244: if (positionLocked[_nftId] == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L244

```solidity

File: MainHelper.sol

265: if (positionLocked[_nftIdLiquidator] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L265

```solidity

File: MainHelper.sol

627: if (hashMap[hashData] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L627

```solidity

File: MainHelper.sol

1165: if (_checkLendingDataEmpty(_nftId, _poolToken) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1165

```solidity

File: PoolManager.sol

36: if (parametersLocked[_poolToken] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L36

```solidity

File: PositionNFTs.sol

161: if (_exists(tokenId) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L161

```solidity

File: WiseCore.sol

76: if (_onBehalf == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L76

```solidity

File: WiseCore.sol

200: if (_byPassCase(_caller) == true) {

204: if (positionLocked[_nftId] == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L200, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L204

```solidity

File: WiseCore.sol

246: if (WISE_ORACLE.chainLinkIsDead(_poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L246

```solidity

File: WiseCore.sol

282: if (POSITION_NFT.isOwner(_nftId, _caller) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L282

```solidity

File: WiseCore.sol

306: if (state == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L306

```solidity

File: WiseCore.sol

397: if (_onBehalf == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L397

```solidity

File: WiseCore.sol

592: if (userLendingData[_nftId][_receiveTokens].unCollateralized == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L592

```solidity

File: WiseLending.sol

87: if (powerFarmCheck == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L87

```solidity

File: WiseLending.sol

290: if (_aboveThreshold(_poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L290

```solidity

File: WiseLending.sol

1527: if (_onBehalf == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1527

```solidity

File: WiseLowLevelHelper.sol

354: if (sendingProgress == true) {

358: if (_sendingProgressAaveHub() == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L354, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L358

```solidity

File: WiseLowLevelHelper.sol

400: if (verifiedIsolationPool[_sender] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L400

```solidity

File: PendleLpOracle.sol

104: if (increaseCardinalityRequired == true) {

108: if (oldestObservationSatisfied == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L104, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L108

```solidity

File: PtOracleDerivative.sol

109: if (increaseCardinalityRequired == true) {

113: if (oldestObservationSatisfied == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L113, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L109

```solidity

File: PtOraclePure.sol

90: if (increaseCardinalityRequired == true) {

94: if (oldestObservationSatisfied == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L94, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L90

```solidity

File: FeeManager.sol

261: if (isAaveToken[tokenAddress] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L261

```solidity

File: FeeManager.sol

418: if (poolTokenAdded[_poolToken] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L418

```solidity

File: FeeManager.sol

449: if (poolTokenAdded[_poolToken] == false) {

473: if (found == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L473, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L449

```solidity

File: FeeManager.sol

650: if (isAaveToken[_poolToken] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L650

```solidity

File: FeeManager.sol

701: if (allowedTokens[caller][_feeToken] == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L701

```solidity

File: PendlePowerFarm.sol

127: if (isAave[_nftId] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L127

```solidity

File: PendlePowerFarm.sol

203: if (_notBelowMinDepositAmount(leveragedAmount) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L203

```solidity

File: PendlePowerFarmDeclarations.sol

365: if (isShutdown == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L365

```solidity

File: PendlePowerFarmLeverageLogic.sol

67: if (allowEnter == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L67

```solidity

File: PendlePowerFarmLeverageLogic.sol

215: if (_ethBack == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L215

```solidity

File: PendlePowerFarmLeverageLogic.sol

333: if (_isAave == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L333

```solidity

File: PendlePowerFarmLeverageLogic.sol

520: if (_checkDebtRatio(_nftId) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L520

```solidity

File: PendlePowerFarmLeverageLogic.sol

538: if (_isAave == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L538

```solidity

File: PendlePowerFarmLeverageLogic.sol

571: if (_checkDebtRatio(_nftId) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L571

```solidity

File: PendlePowerFarmMathLogic.sol

39: if (sendingProgress == true) {

43: if (WISE_LENDING.sendingProgress() == true) {

47: if (AAVE_HUB.sendingProgressAaveHub() == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L43, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L39

```solidity

File: PendlePowerManager.sol

291: if (_checkDebtRatio(wiseLendingNFT) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L291

```solidity

File: PendlePowerFarmController.sol

304: if (_compareHashes(_pendleMarket, rewardTokens) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L304

```solidity

File: PendlePowerFarmController.sol

396: if (_fromInside == false) {

396: if (_fromInside == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L396, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L396

```solidity

File: PendlePowerFarmController.sol

456: if (IS_ETH_MAIN == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L456

```solidity

File: PendlePowerFarmToken.sol

154: if (_overWritten == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L154

```solidity

File: PendlePowerFarmToken.sol

699: if (PENDLE_MARKET.isExpired() == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L699

```solidity

File: CallOptionalReturn.sol

31: if (success == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L31

```solidity

File: SendValueHelper.sol

33: if (success == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L33

```solidity

File: OracleHelper.sol

45: if (_checkFunctionExistence(address(tokenAggregator)) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L45

```solidity

File: OracleHelper.sol

117: if (uniTwapPoolInfoStruct.isUniPool == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L117

```solidity

File: OracleHelper.sol

270: if (_chainLinkIsDead(ETH_USD_PLACEHOLDER) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L270

```solidity

File: OracleHelper.sol

526: if (IS_ARBITRUM_CHAIN == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L526

```solidity

File: WiseOracleHub.sol

76: if (chainLinkIsDead(_tokenAddress) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L76

```solidity

File: WiseOracleHub.sol

451: if (sequencerIsDead() == true) {

475: if (state == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L475, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L451

```solidity

File: WiseSecurity.sol

246: if (_checkBlacklisted(_poolToken) == true) {

255: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {

259: if (WISE_LENDING.positionLocked(_nftId) == true) {

263: if (_isUncollateralized(_nftId, _poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L259, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L255, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L246, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L263

```solidity

File: WiseSecurity.sol

284: if (_checkBlacklisted(_poolToken) == true) {

293: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {

297: if (WISE_LENDING.positionLocked(_nftId) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L293, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L297, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L284

```solidity

File: WiseSecurity.sol

323: if (WISE_LENDING.verifiedIsolationPool(_caller) == true) {

327: if (WISE_LENDING.positionLocked(_nftId) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L327, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L323

```solidity

File: WiseSecurity.sol

343: if (checkHeartbeat(_poolAddress) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L343

```solidity

File: WiseSecurity.sol

367: if (_checkBlacklisted(_poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L367

```solidity

File: WiseSecurity.sol

671: if (checkHeartbeat(token) == false) {

675: if (wasBlacklisted[token] == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L671, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L675

```solidity

File: WiseSecurity.sol

716: if (_checkBlacklisted(token) == true) {

716: if (_checkBlacklisted(token) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L716, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L716

```solidity

File: WiseSecurity.sol

792: if (_isUncollateralized(_nftId, _poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L792

```solidity

File: WiseSecurity.sol

842: if (_isUncollateralized(_nftId, _poolToken) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L842

```solidity

File: WiseSecurity.sol

1014: if (securityWorker[msg.sender] == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1014

```solidity

File: WiseSecurityHelper.sol

206: if (_isUncollateralized(_nftId, _poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L206

```solidity

File: WiseSecurityHelper.sol

263: if (_isUncollateralized(_nftId, _poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L263

```solidity

File: WiseSecurityHelper.sol

678: if (WISE_LENDING.borrowPoolData(_poolAddress).allowBorrow == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L678

```solidity

File: WiseSecurityHelper.sol

707: if (WISE_LENDING.positionLocked(_nftId) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L707

```solidity

File: WiseSecurityHelper.sol

801: if (_getState(_nftId, _powerFarm) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L801

```solidity

File: WiseSecurityHelper.sol

1086: if (_checkBlacklisted(_poolToken) == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1086

```solidity

File: WiseSecurityHelper.sol

1102: if (_success == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1102

```solidity

File: AaveHelper.sol

38: if (sendingProgressAaveHub == true) {

42: if (WISE_LENDING.sendingProgress() == true) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L38, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L42

```solidity

File: AaveHelper.sol

70: if (POSITION_NFT.isOwner(_nftId, msg.sender) == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L70

```solidity

File: AaveHelper.sol

214: if (success == false) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L214

### [N-09]<a name="n-09"></a> Condition will not revert when `block.timestamp` is `==` to the compared variable

The condition does not revert when block.timestamp is equal to the compared `>` or `<` variable. For example, if there is a check for `block.timestamp > expireTime` then there should be a check for cases where `block.timestamp` is `==` to `expireTime`
 

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmController.sol

475: if (_getExpiry() > block.timestamp) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L475

### [N-10]<a name="n-10"></a> Consider adding a deny-list

Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens

*There are 3 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11

```solidity

File: PendlePowerFarmToken.sol

25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25

```solidity

File: PowerFarmNFTs.sol

24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24

### [N-11]<a name="n-11"></a> Consider adding formal verification proofs

Formal verification is the act of proving or disproving the correctness of intended algorithms underlying a system with respect to a certain formal specification/property/invariant, using formal methods of mathematics.

Some tools that are currently available to perform these tests on smart contracts are [SMTChecker](https://docs.soliditylang.org/en/latest/smtchecker.html) and [Certora Prover](https://www.certora.com/).

There are 6 instances:

- [*DestinationBridge.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/bridge/DestinationBridge.sol)

- [*SourceBridge.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/bridge/SourceBridge.sol)

- [*IRWADynamicOracle.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/rwaOracles/IRWADynamicOracle.sol)

- [*RWADynamicOracle.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/rwaOracles/RWADynamicOracle.sol)

- [*rUSDY.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/usdy/rUSDY.sol)

- [*rUSDYFactory.sol*](https://github.com/code-423n4/2023-09-ondo/tree/623dd3c0ff3c4d8ce4ed563b96da50d08cd803c5/contracts/usdy/rUSDYFactory.sol)

*There are 1 instance(s) of this issue:*

All in-scope contracts

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0

### [N-12]<a name="n-12"></a> Consider emitting an event at the end of the constructor

This will allow users to easily exactly pinpoint when and by whom a contract was constructed

*There are 1 instance(s) of this issue:*

```solidity

File: CustomOracleSetup.sol

22: constructor() {
        master = msg.sender;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L22

### [N-13]<a name="n-13"></a> Consider making contracts `Upgradeable`

This allows for bugs to be fixed in production, at the expense of significantly increasing centralization.

*There are 52 instance(s) of this issue:*

```solidity

File: MainHelper.sol

7: abstract contract MainHelper is WiseLowLevelHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L7

```solidity

File: MainHelper.sol

292: * sent token are inside the contract for the pool with
     * {_poolToken}. If this is the case it adds those token

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L292

```solidity

File: OwnableMaster.sol

9: contract OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L9

```solidity

File: PoolManager.sol

8: abstract contract PoolManager is WiseCore {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L8

```solidity

File: PositionNFTs.sol

11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11

```solidity

File: WiseCore.sol

8: abstract contract WiseCore is MainHelper, TransferHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L8

```solidity

File: WiseLending.sol

43: contract WiseLending is PoolManager {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L43

```solidity

File: WiseLendingDeclaration.sol

30: contract WiseLendingDeclaration is
    OwnableMaster,
    WrapperHelper,
    SendValueHelper
{

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L30

```solidity

File: WiseLendingDeclaration.sol

179: // NFT contract interface for positions
    IPositionNFTs public immutable POSITION_NFT;

    // OraceHub interface
    IWiseOracleHub public immutable WISE_ORACLE;

    // check if it is a powerfarm
    bool internal powerFarmCheck;

    uint256 internal constant GHOST_AMOUNT = 1E3;

    // Structs ------------------------------------------

    struct LendingEntry {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L179

```solidity

File: WiseLowLevelHelper.sol

7: abstract contract WiseLowLevelHelper is WiseLendingDeclaration {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L7

```solidity

File: CustomOracleSetup.sol

5: contract CustomOracleSetup {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L5

```solidity

File: PendleChildLpOracle.sol

13: contract PendleChildLpOracle is CustomOracleSetup  {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L13

```solidity

File: PendleLpOracle.sol

10: * @dev PriceFeed contract for Lp-Token with USD
 * chainLink feed to get a feed measured in ETH.
 * Takes chainLink oracle value and multiplies it
 * with the corresponding TWAP and other chainLink oracles.
 */

import "../InterfaceHub/IPendle.sol";
import "../InterfaceHub/IPriceFeed.sol";
import "../InterfaceHub/IOraclePendle.sol";
import {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L10

```solidity

File: PendleLpOracle.sol

28: contract PendleLpOracle {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L28

```solidity

File: PtOracleDerivative.sol

10: * @dev Pricefeed contract for PtToken with USD
 * chainLink feed to get a feed measured in ETH.
 * Takes chainLink oracle value and multiplies it with
 * the corresponding TWAP and other chainLink oracles
 */

import "../InterfaceHub/IPriceFeed.sol";
import "../InterfaceHub/IOraclePendle.sol";

error CardinalityNotSatisfied();
error OldestObservationNotSatisfied();

contract PtOracleDerivative {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L10

```solidity

File: PtOraclePure.sol

10: * @dev PriceFeed contract for Pt-Token with USD
 * chainLink feed to get a feed measured in ETH.
 * Takes chainLink oracle value and multiplies it
 * with the corresponding TWAP and other chainLink oracles.
 */

import "../InterfaceHub/IPriceFeed.sol";
import "../InterfaceHub/IOraclePendle.sol";

error CardinalityNotSatisfied();
error OldestObservationNotSatisfied();

contract PtOraclePure {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L10

```solidity

File: DeclarationsFeeManager.sol

31: contract DeclarationsFeeManager is FeeManagerEvents, OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L31

```solidity

File: DeclarationsFeeManager.sol

99: // Interface aave V3 contract
    IAave public immutable AAVE;

    // Interface wiseLending contract
    IWiseLending public immutable WISE_LENDING;

    // Interface position NFT contract
    IPositionNFTs public immutable POSITION_NFTS;

    // Interface wiseSecurity contract
    IWiseSecurity public immutable WISE_SECURITY;

    // Interface wise oracleHub contract
    IWiseOracleHub public immutable ORACLE_HUB;

    // ---- Variables ----

    // Global total bad debt variable
    uint256 public totalBadDebtETH;

    // Incentive percentage for paying back bad debt
    uint256 public paybackIncentive;

    // Array of pool tokens in wiseLending
    address[] public poolTokenAddresses;

    // Address of incentive master
    address public incentiveMaster;

    // Proposed incentive master (for changing)
    address public proposedIncentiveMaster;

    // Address of incentive owner A
    address public incentiveOwnerA;

    // Address of incentive owner B
    address public incentiveOwnerB;

    // ---- Mappings ----

    // Bad debt of a specific position
    mapping(uint256 => uint256) public badDebtPosition;

    // Amount of fee token inside feeManager
    mapping(address => uint256) public feeTokens;

    // Open incetive amount for incentiveOwner in ETH
    mapping(address => uint256) public incentiveUSD;

    // Flag that specific token is already added
    mapping(address => bool) public poolTokenAdded;

    // Flag for token being aToken
    mapping(address => bool) public isAaveToken;

    // Getting underlying token of aave aToken
    mapping(address => address) public underlyingToken;

    // Showing which token are allowed to claim for beneficial address
    mapping(address => mapping(address => bool)) public allowedTokens;

    // Gives claimable token amount for incentiveOwner per token
    mapping(address => mapping(address => uint256)) public gatheredIncentiveToken;

    // Position NFT id of the feeManager
    uint256 public immutable FEE_MANAGER_NFT;

    // Precision factors for computations
    uint256 internal constant PRECISION_FACTOR_E15 = 1E15;
    uint256 internal constant PRECISION_FACTOR_E16 = 1E16;
    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;

    // Base portion from gathered fees for incentiveOwners (0.5%)
    uint256 public constant INCENTIVE_PORTION = 5 * PRECISION_FACTOR_E15;

    // ---- Modifier ----

    modifier onlyWiseSecurity() {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L99

```solidity

File: FeeManager.sol

14: * @dev Purpose of this contract is to organize fee distribution from wiseLending.
 * The feeManager aquires fee token in form of shares from each pool and can call them
 * with "claimWiseFees()" for each pool.
 *
 * Furthermore, this contracts has two different incentive
 * structures which can be used to bootstrap the WISE ecosystem (beneficial and incnetiveOwner roles).
 *
 * Additionally, this contract keeps track of the bad debt of each postion and has a simple mechanism
 * to pay them back via incentives. The incentive amount is funded by the gathered fees.
 */

contract FeeManager is FeeManagerHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L14

```solidity

File: FeeManager.sol

491: * wiseLending. Only callable by wiseSecurity contract
     * during liquidation.
     */
    function increaseTotalBadDebtLiquidation(
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L491

```solidity

File: FeeManager.sol

512: * Only callable by wiseSecurity contract during liquidation.
     */
    function setBadDebtUserLiquidation(
        uint256 _nftId,
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L512

```solidity

File: FeeManagerEvents.sol

5: contract FeeManagerEvents {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L5

```solidity

File: FeeManagerHelper.sol

8: abstract contract FeeManagerHelper is DeclarationsFeeManager, TransferHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L8

```solidity

File: PendlePowerFarm.sol

7: abstract contract PendlePowerFarm is PendlePowerFarmLeverageLogic {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L7

```solidity

File: PendlePowerFarmDeclarations.sol

36: contract PendlePowerFarmDeclarations is
    WrapperHelper,
    TransferHelper,
    ApprovalHelper,
    SendValueHelper
{

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L36

```solidity

File: PendlePowerFarmDeclarations.sol

51: // Adjustable by admin of the contract
    uint256 public minDepositEthAmount;

    address public immutable aaveTokenAddresses;
    address public immutable borrowTokenAddresses;

    address public immutable ENTRY_ASSET;
    address public immutable PENDLE_CHILD;

    // RESTRICTION VALUES

    uint256 internal constant MAX_COLLATERAL_FACTOR = 95 * PRECISION_FACTOR_E16;

    // Interfaces

    IAave public immutable AAVE;
    IAaveHub public immutable AAVE_HUB;
    IWiseLending public immutable WISE_LENDING;
    IWiseOracleHub public immutable ORACLE_HUB;
    IWiseSecurity public immutable WISE_SECURITY;
    IBalancerVault public immutable BALANCER_VAULT;
    IPositionNFTs public immutable POSITION_NFT;
    IStETH public immutable ST_ETH;
    ICurve public immutable CURVE;
    IUniswapV3 public immutable UNISWAP_V3_ROUTER;

    IPendleSy public immutable PENDLE_SY;
    IPendleRouter public immutable PENDLE_ROUTER;
    IPendleMarket public immutable PENDLE_MARKET;
    IPendleRouterStatic public immutable PENDLE_ROUTER_STATIC;

    address internal immutable WETH_ADDRESS;

    address immutable AAVE_ADDRESS;

    address internal constant BALANCER_ADDRESS = 0xBA12222222228d8Ba445958a75a0704d566BF2C8;

    address immutable AAVE_HUB_ADDRESS;

    address immutable AAVE_WETH_ADDRESS;

    address internal constant ST_ETH_ADDRESS = 0xae7ab96520DE3A18E5e111B5EaAb095312D7fE84;

    // Uniswap fee for arbitrum
    uint24 internal constant UNISWAP_V3_FEE = 100;

    // Math constant for computations
    uint256 internal constant MAX_AMOUNT = type(uint256).max;
    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;
    uint256 internal constant PRECISION_FACTOR_E16 = 1E16;
    uint256 internal constant MAX_LEVERAGE = 15 * PRECISION_FACTOR_E18;
    uint256 internal constant FIVTY_PERCENT = 0.5 ether;

    uint256 internal constant ETH_CHAIN_ID = 1;
    uint256 internal constant ARB_CHAIN_ID = 42161;

    // Mapping of {keyNFT} to type of pool

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L51

```solidity

File: PendlePowerFarmLeverageLogic.sol

7: abstract contract PendlePowerFarmLeverageLogic is
    PendlePowerFarmMathLogic,
    IFlashLoanRecipient
{

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L7

```solidity

File: PendlePowerFarmMathLogic.sol

7: abstract contract PendlePowerFarmMathLogic is PendlePowerFarmDeclarations {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L7

```solidity

File: PendlePowerManager.sol

15: contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L15

```solidity

File: PendlePowerFarmController.sol

8: contract PendlePowerFarmController is PendlePowerFarmControllerHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L8

```solidity

File: PendlePowerFarmControllerBase.sol

30: contract PendlePowerFarmControllerBase is
    OwnableMaster,
    TransferHelper,
    ApprovalHelper
{

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L30

```solidity

File: PendlePowerFarmControllerHelper.sol

7: abstract contract PendlePowerFarmControllerHelper is PendlePowerFarmControllerBase {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L7

```solidity

File: PendlePowerFarmToken.sol

25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25

```solidity

File: PendlePowerFarmTokenFactory.sol

9: contract PendlePowerFarmTokenFactory {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L9

```solidity

File: MinterReserver.sol

10: contract MinterReserver {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L10

```solidity

File: PowerFarmNFTs.sol

24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24

```solidity

File: ApprovalHelper.sol

7: contract ApprovalHelper is CallOptionalReturn {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L7

```solidity

File: CallOptionalReturn.sol

7: contract CallOptionalReturn {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L7

```solidity

File: SendValueHelper.sol

8: contract SendValueHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L8

```solidity

File: TransferHelper.sol

7: contract TransferHelper is CallOptionalReturn {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L7

```solidity

File: WrapperHelper.sol

7: contract WrapperHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L7

```solidity

File: Declarations.sol

33: abstract contract Declarations is OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L33

```solidity

File: OracleHelper.sol

7: abstract contract OracleHelper is Declarations {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L7

```solidity

File: WiseOracleHub.sol

15: * The master address is owned by a timelock contract which itself is secured by a
 * multisig. Only the master can add new price feed <-> address pairs to the contract.
 *
 * One advantage is the linking of price feeds to their underlying token address.
 * Therefore, users can get the current ETH value of a token by just knowing the token
 * address when calling {latestResolver}. It takes the answer from {latestRoundData}

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L15

```solidity

File: WiseOracleHub.sol

31: contract WiseOracleHub is OracleHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L31

```solidity

File: WiseSecurity.sol

15: * @dev WiseSecurity is a core contract for wiseLending including most of
 * the performed security checks for withdraws, borrows, paybacks and liquidations.
 * It also has several read only functions providing UI data for a better user
 * experiencne.
 *
 */

error NotWiseLendingSecurity();

contract WiseSecurity is WiseSecurityHelper, ApprovalHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L15

```solidity

File: WiseSecurityDeclarations.sol

45: contract WiseSecurityDeclarations is OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L45

```solidity

File: WiseSecurityHelper.sol

7: abstract contract WiseSecurityHelper is WiseSecurityDeclarations {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L7

```solidity

File: AaveEvents.sol

5: contract AaveEvents {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L5

```solidity

File: AaveHelper.sol

7: abstract contract AaveHelper is Declarations {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L7

```solidity

File: AaveHub.sol

16: * @dev Purpose of this contract is to optimize capital efficency by using
 * aave pools. Not borrowed funds are deposited into correspoding aave pools
 * to earn supply APY.
 *
 * The aToken are holded by the wiseLending contract but the accounting
 * is managed by the position NFTs. This is possible due to the included
 * onBehlaf functionallity inside wiseLending.
 */

contract AaveHub is AaveHelper, TransferHelper, ApprovalHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L16

```solidity

File: Declarations.sol

21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21

### [N-14]<a name="n-14"></a> Consider using named mappings

Consider moving to solidity version 0.8.18 or later, and using <a href='https://ethereum.stackexchange.com/a/145555'>named mappings</a> to make it easier to understand the purpose of each mapping

*There are 45 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

20: mapping(address => uint256) public reserved;

21: mapping(address => bool) public reserveRole;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L20-L21

```solidity

File: WiseLendingDeclaration.sol

267: mapping(address => uint256) internal bufferIncrease;

268: mapping(address => uint256) public maxDepositValueToken;

270: mapping(uint256 => address[]) public positionLendTokenData;

271: mapping(uint256 => address[]) public positionBorrowTokenData;

273: mapping(uint256 => mapping(address => uint256)) public userBorrowShares;

274: mapping(uint256 => mapping(address => uint256)) public pureCollateralAmount;

275: mapping(uint256 => mapping(address => LendingEntry)) public userLendingData;

278: mapping(address => BorrowRatesEntry) public borrowRatesData;

279: mapping(address => AlgorithmEntry) public algorithmData;

280: mapping(address => GlobalPoolEntry) public globalPoolData;

281: mapping(address => LendingPoolEntry) public lendingPoolData;

282: mapping(address => BorrowPoolEntry) public borrowPoolData;

283: mapping(address => TimestampsPoolEntry) public timestampsPoolData;

286: mapping(uint256 => bool) public positionLocked;

287: mapping(address => bool) internal parametersLocked;

288: mapping(address => bool) public verifiedIsolationPool;

291: mapping(bytes32 => bool) internal hashMapPositionBorrow;

292: mapping(bytes32 => bool) internal hashMapPositionLending;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L291, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L273, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L274, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L275, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L278, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L279, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L280, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L281, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L282, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L283, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L286, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L292, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L267, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L268, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L270, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L271

```solidity

File: CustomOracleSetup.sol

12: mapping(uint80 => uint256) public timeStampByRoundId;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L12

```solidity

File: DeclarationsFeeManager.sol

140: mapping(uint256 => uint256) public badDebtPosition;

143: mapping(address => uint256) public feeTokens;

146: mapping(address => uint256) public incentiveUSD;

149: mapping(address => bool) public poolTokenAdded;

152: mapping(address => bool) public isAaveToken;

155: mapping(address => address) public underlyingToken;

158: mapping(address => mapping(address => bool)) public allowedTokens;

161: mapping(address => mapping(address => uint256)) public gatheredIncentiveToken;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L161, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L155, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L143, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L140, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L146

```solidity

File: PendlePowerFarmDeclarations.sol

108: mapping(uint256 => bool) public isAave;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L108

```solidity

File: PendlePowerFarmControllerBase.sol

58: mapping(address => address) public pendleChildAddress;

59: mapping(address => CompoundStruct) pendleChildCompoundInfo;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L58-L59

```solidity

File: MinterReserver.sol

24: mapping(uint256 => uint256) public farmingKeys;

27: mapping(address => uint256) public reservedKeys;

30: mapping(uint256 => uint256) public availableNFTs;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L27, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L24, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L30

```solidity

File: Declarations.sol

139: mapping(address => uint8) _tokenDecimals;

142: mapping(address => IPriceFeed) public priceFeed;

145: mapping(address => uint256) public heartBeat;

148: mapping(address => IAggregator) public tokenAggregatorFromTokenAddress;

151: mapping(address => address[]) public underlyingFeedTokens;

154: mapping(address => UniTwapPoolInfo) public uniTwapPoolInfo;

157: mapping(address => DerivativePartnerInfo) public derivativePartnerTwap;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L145, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L148, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L157, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L154, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L151, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L139, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L142

```solidity

File: WiseSecurityDeclarations.sol

238: mapping(address => bool) public wasBlacklisted;

241: mapping(address => CurveSwapStructData) public curveSwapInfoData;

244: mapping(address => CurveSwapStructToken) public curveSwapInfoToken;

247: mapping(address => bool) public securityWorker;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L244, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L241, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247

```solidity

File: Declarations.sol

41: mapping(address => address) public aaveTokenAddress;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L41

### [N-15]<a name="n-15"></a> Constant redefined elsewhere

Consider defining in only one contract so that values cannot become out of sync when only one location is updated. A <a href="https://medium.com/coinmonks/gas-cost-of-solidity-library-functions-dbe0cedd4678">cheap way</a> to store constants in a single location is to create an `internal constant` in a `library`. If the variable is a local cache of another contract's value, consider making the cache variable internal or private, which will require external users to query the contract with the source of truth, so that callers don't get out of sync.

*There are 42 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

18: uint256 public immutable FEE_MANAGER_NFT;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L18

```solidity

File: WiseLendingDeclaration.sol

165: address public immutable WETH_ADDRESS;

180: IPositionNFTs public immutable POSITION_NFT;

183: IWiseOracleHub public immutable WISE_ORACLE;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L180, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L165, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L183

```solidity

File: PendleLpOracle.sol

58: address public immutable PENDLE_MARKET_ADDRESS;

59: IPendleMarket public immutable PENDLE_MARKET;

62: IPendleSy public immutable PENDLE_SY;

63: IPriceFeed public immutable FEED_ASSET;

64: IOraclePendle public immutable ORACLE_PENDLE_PT;

73: uint32 public immutable TWAP_DURATION;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L63, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L73, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L58, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L59, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L62, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L64

```solidity

File: PtOracleDerivative.sol

56: IOraclePendle public immutable ORACLE_PENDLE_PT;

71: uint32 public immutable TWAP_DURATION;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L71, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L56

```solidity

File: PtOraclePure.sol

44: address public immutable PENDLE_MARKET_ADDRESS;

47: IPriceFeed public immutable FEED_ASSET;

48: IOraclePendle public immutable ORACLE_PENDLE_PT;

57: uint32 public immutable DURATION;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L48, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L57, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L44, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L47

```solidity

File: DeclarationsFeeManager.sol

100: IAave public immutable AAVE;

103: IWiseLending public immutable WISE_LENDING;

106: IPositionNFTs public immutable POSITION_NFTS;

109: IWiseSecurity public immutable WISE_SECURITY;

112: IWiseOracleHub public immutable ORACLE_HUB;

164: uint256 public immutable FEE_MANAGER_NFT;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L112, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L164, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L103, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L100, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L106, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L109

```solidity

File: PendlePowerFarmDeclarations.sol

66: IAave public immutable AAVE;

67: IAaveHub public immutable AAVE_HUB;

68: IWiseLending public immutable WISE_LENDING;

69: IWiseOracleHub public immutable ORACLE_HUB;

70: IWiseSecurity public immutable WISE_SECURITY;

72: IPositionNFTs public immutable POSITION_NFT;

77: IPendleSy public immutable PENDLE_SY;

79: IPendleMarket public immutable PENDLE_MARKET;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L72, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L66, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L67, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L68, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L69, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L70, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L77, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L79

```solidity

File: PendlePowerFarmTokenFactory.sol

14: address public immutable PENDLE_POWER_FARM_CONTROLLER;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L14

```solidity

File: Declarations.sol

76: address public immutable WETH_ADDRESS;

79: address public constant SEQUENCER_ADDRESS = 0xFdB631F5EE196F0ed6FAa767959853A9F217697D;

82: address public immutable ETH_USD_PLACEHOLDER;

88: IPriceFeed public immutable ETH_PRICE_FEED;

91: IPriceFeed public immutable SEQUENCER;

94: IUniswapV3Factory public immutable UNI_V3_FACTORY;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L91, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L82, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L88, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L76, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L79, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L94

```solidity

File: WiseSecurityDeclarations.sol

186: address public immutable AAVE_HUB;

191: IFeeManager public immutable FEE_MANAGER;

194: IWiseLending public immutable WISE_LENDING;

197: IPositionNFTs public immutable POSITION_NFTS;

200: IWiseOracleHub public immutable WISE_ORACLE;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L197, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L194, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L191, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L186, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L200

### [N-16]<a name="n-16"></a> Constants Should Be Defined Rather Than Using Magic Numbers

Even <a href="https://github.com/code-423n4/2022-05-opensea-seaport/blob/9d7ce4d08bf3c3010304a0476a785c70c0e90ae7/contracts/lib/TokenTransferrer.sol#L35-L39">assembly</a> can benefit from using readable constants instead of hex/numeric literals

*There are 4 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

387: j /= 10;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L387

```solidity

File: PositionNFTs.sol

400: 48 + (j % 10)

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L400

```solidity

File: PendlePowerFarmLeverageLogic.sol

479: eps: 1e15

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L479

```solidity

File: PowerFarmNFTs.sol

229: j /= 10;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L229

### [N-17]<a name="n-17"></a> Constants in comparisons should appear on the left side

Putting constants on the left side of a comparison operator like `==` or `<` is a best practice known as "Yoda conditions", which can help prevent accidental assignment instead of comparison. In some programming languages, if a variable is mistakenly put on the left with a single `=` instead of `==`, it assigns the constant's value to the variable without any compiler error. However, doing this with the constant on the left would generate an error, as constants cannot be assigned values. Although Solidity's static typing system prevents accidental assignments within conditionals, adopting this practice enhances code readability and consistency, especially when developers are working across multiple languages that support this convention.

*There are 48 instance(s) of this issue:*

```solidity

File: MainHelper.sol

542: if (feeAmount == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L542

```solidity

File: MainHelper.sol

554: if (feeShares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L554

```solidity

File: MainHelper.sol

681: if (length == 1) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L681

```solidity

File: MainHelper.sol

838: return userLendingData[_nftId][_poolToken].shares == 0

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L838

```solidity

File: MainHelper.sol

1161: if (_nftId == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1161

```solidity

File: PositionNFTs.sol

355: if (bytes(currentBaseURI).length == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L355

```solidity

File: PositionNFTs.sol

378: if (_tokenId == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L378

```solidity

File: WiseCore.sol

588: if (userShares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L588

```solidity

File: WiseLowLevelHelper.sol

453: if (_value == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L453

```solidity

File: FeeManager.sol

291: if (amount == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L291

```solidity

File: FeeManager.sol

640: if (shares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L640

```solidity

File: FeeManager.sol

663: if (totalBadDebtETH == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L663

```solidity

File: PendlePowerFarm.sol

72: if (borrowShares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L72

```solidity

File: PendlePowerFarm.sol

80: if (totalCollateral == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L80

```solidity

File: PendlePowerFarmLeverageLogic.sol

73: if (_flashloanToken.length == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L73

```solidity

File: PendlePowerFarmLeverageLogic.sol

174: address tokenOut = block.chainid == 1

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L174

```solidity

File: PendlePowerFarmLeverageLogic.sol

174: block.chainid == 1

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L174

```solidity

File: PendlePowerFarmMathLogic.sol

213: if (borrowTokenAmountAave == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L213

```solidity

File: PendlePowerFarmMathLogic.sol

404: if (borrowShares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L404

```solidity

File: PendlePowerManager.sol

189: if (availableNFTCount == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L189

```solidity

File: PendlePowerFarmController.sol

124: if (_pendleChildShares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L124

```solidity

File: PendlePowerFarmToken.sol

339: if (additonalAssets == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L339

```solidity

File: PendlePowerFarmToken.sol

391: if (totalLpAssetsToDistribute == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L391

```solidity

File: PendlePowerFarmToken.sol

489: return product % _underlyingLpAssetsCurrent == 0

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L489

```solidity

File: PendlePowerFarmToken.sol

508: if (_amount == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L508

```solidity

File: PendlePowerFarmToken.sol

539: if (_underlyingLpAssetAmount == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L539

```solidity

File: PendlePowerFarmToken.sol

548: if (shares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L548

```solidity

File: PendlePowerFarmToken.sol

559: if (feeShares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L559

```solidity

File: PendlePowerFarmToken.sol

615: if (_shares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L615

```solidity

File: PendlePowerFarmToken.sol

654: if (_underlyingLpAssetAmount == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L654

```solidity

File: MinterReserver.sol

122: if (_keyId == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L122

```solidity

File: PowerFarmNFTs.sol

197: if (bytes(currentBaseURI).length == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L197

```solidity

File: PowerFarmNFTs.sol

220: if (_tokenId == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L220

```solidity

File: CallOptionalReturn.sol

26: bool results = returndata.length == 0 || abi.decode(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L26

```solidity

File: OracleHelper.sol

74: if (size == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L74

```solidity

File: OracleHelper.sol

537: if (answer == 1) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L537

```solidity

File: WiseOracleHub.sol

455: if (length == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L455

```solidity

File: WiseSecurity.sol

70: if (overallCollateral == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L70

```solidity

File: WiseSecurity.sol

453: if (len == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L453

```solidity

File: WiseSecurity.sol

510: if (len == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L510

```solidity

File: WiseSecurity.sol

652: if (len == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L652

```solidity

File: WiseSecurity.sol

924: if (currentTotalBorrowShares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L924

```solidity

File: WiseSecurity.sol

961: if (currentTotalLendingShares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L961

```solidity

File: WiseSecurity.sol

1117: if (_newMinDepositValue == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1117

```solidity

File: WiseSecurityHelper.sol

295: if (lendingShares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L295

```solidity

File: WiseSecurityHelper.sol

624: if (borrowShares == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L624

```solidity

File: WiseSecurityHelper.sol

818: if (borrowAmount == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L818

```solidity

File: WiseSecurityHelper.sol

1010: if (pseudoTotalPool == 0) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1010

### [N-18]<a name="n-18"></a> Constructor declarations should have NatSpec descriptions




*There are 25 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

57: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L57

```solidity

File: PositionNFTs.sol

25: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L25

```solidity

File: WiseLending.sol

116: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L116

```solidity

File: WiseLendingDeclaration.sol

105: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L105

```solidity

File: CustomOracleSetup.sol

22: constructor() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L22

```solidity

File: PendleChildLpOracle.sol

21: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L21

```solidity

File: PendleLpOracle.sol

32: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L32

```solidity

File: PtOracleDerivative.sol

24: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L24

```solidity

File: PtOraclePure.sol

24: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L24

```solidity

File: DeclarationsFeeManager.sol

33: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L33

```solidity

File: FeeManager.sol

27: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L27

```solidity

File: PendlePowerFarmDeclarations.sol

159: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L159

```solidity

File: PendlePowerManager.sol

31: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L31

```solidity

File: PendlePowerFarmController.sol

12: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L12

```solidity

File: PendlePowerFarmControllerBase.sol

79: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L79

```solidity

File: PendlePowerFarmTokenFactory.sol

16: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L16

```solidity

File: MinterReserver.sol

55: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L55

```solidity

File: PowerFarmNFTs.sol

38: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L38

```solidity

File: WrapperHelper.sol

11: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L11

```solidity

File: Declarations.sol

45: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L45

```solidity

File: WiseOracleHub.sol

33: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L33

```solidity

File: WiseSecurity.sol

42: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L42

```solidity

File: WiseSecurityDeclarations.sol

52: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L52

```solidity

File: AaveHub.sol

27: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L27

```solidity

File: Declarations.sol

43: constructor(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L43

### [N-19]<a name="n-19"></a> Contract declarations should have NatSpec `@author` annotations




*There are 34 instance(s) of this issue:*

```solidity

File: 

MainHelper.sol

MainHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L0-L0

```solidity

File: 

OwnableMaster.sol

OwnableMaster.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L0-L0

```solidity

File: 

PoolManager.sol

PoolManager.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L0-L0

```solidity

File: 

PositionNFTs.sol

PositionNFTs.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L0-L0

```solidity

File: 

WiseCore.sol

WiseCore.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L0-L0

```solidity

File: 

WiseLendingDeclaration.sol

WiseLendingDeclaration.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L0-L0

```solidity

File: 

WiseLowLevelHelper.sol

WiseLowLevelHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L0-L0

```solidity

File: 

CustomOracleSetup.sol

DerivativeOracles/CustomOracleSetup.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L0-L0

```solidity

File: 

PendleChildLpOracle.sol

DerivativeOracles/PendleChildLpOracle.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L0-L0

```solidity

File: 

DeclarationsFeeManager.sol

FeeManager/DeclarationsFeeManager.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L0-L0

```solidity

File: 

FeeManagerEvents.sol

FeeManager/FeeManagerEvents.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L0-L0

```solidity

File: 

FeeManagerHelper.sol

FeeManager/FeeManagerHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L0-L0

```solidity

File: 

PendlePowerFarm.sol

PowerFarms/PendlePowerFarm/PendlePowerFarm.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L0-L0

```solidity

File: 

PendlePowerFarmDeclarations.sol

PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L0-L0

```solidity

File: 

PendlePowerFarmLeverageLogic.sol

PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L0-L0

```solidity

File: 

PendlePowerFarmMathLogic.sol

PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L0-L0

```solidity

File: 

PendlePowerFarmController.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L0-L0

```solidity

File: 

PendlePowerFarmControllerBase.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L0-L0

```solidity

File: 

PendlePowerFarmControllerHelper.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L0-L0

```solidity

File: 

PendlePowerFarmToken.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L0-L0

```solidity

File: 

PendlePowerFarmTokenFactory.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L0-L0

```solidity

File: 

MinterReserver.sol

PowerFarms/PowerFarmNFTs/MinterReserver.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L0-L0

```solidity

File: 

ApprovalHelper.sol

TransferHub/ApprovalHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L0-L0

```solidity

File: 

CallOptionalReturn.sol

TransferHub/CallOptionalReturn.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L0-L0

```solidity

File: 

SendValueHelper.sol

TransferHub/SendValueHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L0-L0

```solidity

File: 

TransferHelper.sol

TransferHub/TransferHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L0-L0

```solidity

File: 

WrapperHelper.sol

TransferHub/WrapperHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L0-L0

```solidity

File: 

Declarations.sol

WiseOracleHub/Declarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L0-L0

```solidity

File: 

OracleHelper.sol

WiseOracleHub/OracleHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L0-L0

```solidity

File: 

WiseSecurityDeclarations.sol

WiseSecurity/WiseSecurityDeclarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L0-L0

```solidity

File: 

WiseSecurityHelper.sol

WiseSecurity/WiseSecurityHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L0-L0

```solidity

File: 

AaveEvents.sol

WrapperHub/AaveEvents.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L0-L0

```solidity

File: 

AaveHelper.sol

WrapperHub/AaveHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L0-L0

```solidity

File: 

Declarations.sol

WrapperHub/Declarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L0-L0

### [N-20]<a name="n-20"></a> Contracts should have NatSpec `@dev` tags




*There are 28 instance(s) of this issue:*

```solidity

File: MainHelper.sol

7: abstract contract MainHelper is WiseLowLevelHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L7

```solidity

File: PoolManager.sol

8: abstract contract PoolManager is WiseCore {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L8

```solidity

File: PositionNFTs.sol

11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11

```solidity

File: WiseCore.sol

8: abstract contract WiseCore is MainHelper, TransferHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L8

```solidity

File: WiseLending.sol

43: contract WiseLending is PoolManager {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L43

```solidity

File: WiseLowLevelHelper.sol

7: abstract contract WiseLowLevelHelper is WiseLendingDeclaration {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L7

```solidity

File: PendleChildLpOracle.sol

13: contract PendleChildLpOracle is CustomOracleSetup  {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L13

```solidity

File: DeclarationsFeeManager.sol

31: contract DeclarationsFeeManager is FeeManagerEvents, OwnableMaster {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L31

```solidity

File: FeeManager.sol

25: contract FeeManager is FeeManagerHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L25

```solidity

File: FeeManagerHelper.sol

8: abstract contract FeeManagerHelper is DeclarationsFeeManager, TransferHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L8

```solidity

File: PendlePowerFarm.sol

7: abstract contract PendlePowerFarm is PendlePowerFarmLeverageLogic {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L7

```solidity

File: PendlePowerFarmMathLogic.sol

7: abstract contract PendlePowerFarmMathLogic is PendlePowerFarmDeclarations {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L7

```solidity

File: PendlePowerManager.sol

15: contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L15

```solidity

File: PendlePowerFarmController.sol

8: contract PendlePowerFarmController is PendlePowerFarmControllerHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L8

```solidity

File: PendlePowerFarmControllerHelper.sol

7: abstract contract PendlePowerFarmControllerHelper is PendlePowerFarmControllerBase {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L7

```solidity

File: PendlePowerFarmToken.sol

25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25

```solidity

File: PowerFarmNFTs.sol

24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24

```solidity

File: ApprovalHelper.sol

7: contract ApprovalHelper is CallOptionalReturn {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L7

```solidity

File: TransferHelper.sol

7: contract TransferHelper is CallOptionalReturn {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L7

```solidity

File: Declarations.sol

33: abstract contract Declarations is OwnableMaster {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L33

```solidity

File: OracleHelper.sol

7: abstract contract OracleHelper is Declarations {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L7

```solidity

File: WiseOracleHub.sol

31: contract WiseOracleHub is OracleHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L31

```solidity

File: WiseSecurity.sol

24: contract WiseSecurity is WiseSecurityHelper, ApprovalHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L24

```solidity

File: WiseSecurityDeclarations.sol

45: contract WiseSecurityDeclarations is OwnableMaster {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L45

```solidity

File: WiseSecurityHelper.sol

7: abstract contract WiseSecurityHelper is WiseSecurityDeclarations {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L7

```solidity

File: AaveHelper.sol

7: abstract contract AaveHelper is Declarations {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L7

```solidity

File: AaveHub.sol

25: contract AaveHub is AaveHelper, TransferHelper, ApprovalHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L25

```solidity

File: Declarations.sol

21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21

### [N-21]<a name="n-21"></a> Contract declarations should have NatSpec `@title` annotations




*There are 44 instance(s) of this issue:*

```solidity

File: 

MainHelper.sol

MainHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L0-L0

```solidity

File: 

OwnableMaster.sol

OwnableMaster.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L0-L0

```solidity

File: 

PoolManager.sol

PoolManager.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L0-L0

```solidity

File: 

PositionNFTs.sol

PositionNFTs.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L0-L0

```solidity

File: 

WiseCore.sol

WiseCore.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L0-L0

```solidity

File: 

WiseLending.sol

WiseLending.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L0-L0

```solidity

File: 

WiseLendingDeclaration.sol

WiseLendingDeclaration.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L0-L0

```solidity

File: 

WiseLowLevelHelper.sol

WiseLowLevelHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L0-L0

```solidity

File: 

CustomOracleSetup.sol

DerivativeOracles/CustomOracleSetup.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L0-L0

```solidity

File: 

PendleChildLpOracle.sol

DerivativeOracles/PendleChildLpOracle.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L0-L0

```solidity

File: 

PendleLpOracle.sol

DerivativeOracles/PendleLpOracle.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L0-L0

```solidity

File: 

PtOracleDerivative.sol

DerivativeOracles/PtOracleDerivative.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L0-L0

```solidity

File: 

PtOraclePure.sol

DerivativeOracles/PtOraclePure.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L0-L0

```solidity

File: 

DeclarationsFeeManager.sol

FeeManager/DeclarationsFeeManager.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L0-L0

```solidity

File: 

FeeManager.sol

FeeManager/FeeManager.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L0-L0

```solidity

File: 

FeeManagerEvents.sol

FeeManager/FeeManagerEvents.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L0-L0

```solidity

File: 

FeeManagerHelper.sol

FeeManager/FeeManagerHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L0-L0

```solidity

File: 

PendlePowerFarm.sol

PowerFarms/PendlePowerFarm/PendlePowerFarm.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L0-L0

```solidity

File: 

PendlePowerFarmDeclarations.sol

PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L0-L0

```solidity

File: 

PendlePowerFarmLeverageLogic.sol

PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L0-L0

```solidity

File: 

PendlePowerFarmMathLogic.sol

PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L0-L0

```solidity

File: 

PendlePowerManager.sol

PowerFarms/PendlePowerFarm/PendlePowerManager.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L0-L0

```solidity

File: 

PendlePowerFarmController.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L0-L0

```solidity

File: 

PendlePowerFarmControllerBase.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L0-L0

```solidity

File: 

PendlePowerFarmControllerHelper.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L0-L0

```solidity

File: 

PendlePowerFarmToken.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L0-L0

```solidity

File: 

PendlePowerFarmTokenFactory.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L0-L0

```solidity

File: 

MinterReserver.sol

PowerFarms/PowerFarmNFTs/MinterReserver.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L0-L0

```solidity

File: 

PowerFarmNFTs.sol

PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L0-L0

```solidity

File: 

ApprovalHelper.sol

TransferHub/ApprovalHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L0-L0

```solidity

File: 

CallOptionalReturn.sol

TransferHub/CallOptionalReturn.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L0-L0

```solidity

File: 

SendValueHelper.sol

TransferHub/SendValueHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L0-L0

```solidity

File: 

TransferHelper.sol

TransferHub/TransferHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L0-L0

```solidity

File: 

WrapperHelper.sol

TransferHub/WrapperHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L0-L0

```solidity

File: 

Declarations.sol

WiseOracleHub/Declarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L0-L0

```solidity

File: 

OracleHelper.sol

WiseOracleHub/OracleHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L0-L0

```solidity

File: 

WiseOracleHub.sol

WiseOracleHub/WiseOracleHub.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L0-L0

```solidity

File: 

WiseSecurity.sol

WiseSecurity/WiseSecurity.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L0-L0

```solidity

File: 

WiseSecurityDeclarations.sol

WiseSecurity/WiseSecurityDeclarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L0-L0

```solidity

File: 

WiseSecurityHelper.sol

WiseSecurity/WiseSecurityHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L0-L0

```solidity

File: 

AaveEvents.sol

WrapperHub/AaveEvents.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L0-L0

```solidity

File: 

AaveHelper.sol

WrapperHub/AaveHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L0-L0

```solidity

File: 

AaveHub.sol

WrapperHub/AaveHub.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L0-L0

```solidity

File: 

Declarations.sol

WrapperHub/Declarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L0-L0

### [N-22]<a name="n-22"></a> Contract does not follow the Solidity style guide's suggested layout ordering

The <a href="https://docs.soliditylang.org/en/v0.8.20/style-guide.html#order-of-layout">style guide</a> says that, within a contract, the ordering should be 1) Type declarations, 2) State variables, 3) Events, 4) Errors 5) Modifiers, and 6) Functions, but the contract(s) below do not follow this ordering

*There are 15 instance(s) of this issue:*

```solidity

File: 

OwnableMaster.sol

OwnableMaster.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L0-L0

```solidity

File: 

WiseLending.sol

WiseLending.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L0-L0

```solidity

File: 

WiseLendingDeclaration.sol

WiseLendingDeclaration.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L0-L0

```solidity

File: 

PendleLpOracle.sol

DerivativeOracles/PendleLpOracle.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L0-L0

```solidity

File: 

PtOracleDerivative.sol

DerivativeOracles/PtOracleDerivative.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L0-L0

```solidity

File: 

PtOraclePure.sol

DerivativeOracles/PtOraclePure.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L0-L0

```solidity

File: 

DeclarationsFeeManager.sol

FeeManager/DeclarationsFeeManager.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L0-L0

```solidity

File: 

PendlePowerFarmDeclarations.sol

PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L0-L0

```solidity

File: 

PendlePowerFarmControllerBase.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L0-L0

```solidity

File: 

PendlePowerFarmToken.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L0-L0

```solidity

File: 

PendlePowerFarmTokenFactory.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L0-L0

```solidity

File: 

MinterReserver.sol

PowerFarms/PowerFarmNFTs/MinterReserver.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L0-L0

```solidity

File: 

Declarations.sol

WiseOracleHub/Declarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L0-L0

```solidity

File: 

WiseSecurityDeclarations.sol

WiseSecurity/WiseSecurityDeclarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L0-L0

```solidity

File: 

Declarations.sol

WrapperHub/Declarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L0-L0

### [N-23]<a name="n-23"></a> Contracts with only unimplemented functions can be labeled as abstract

In Solidity, a contract that's not meant to be deployed on its own but is intended to be inherited by other contracts should be marked `abstract`. This ensures that developers recognize the contract's incomplete or intended-to-be-extended nature. If a contract has unimplemented functions or is designed with the intention that another contract should extend its functionality, it should be explicitly labeled as `abstract`. 
This helps prevent inadvertent deployments and clearly communicates the contract's purpose to other developers. Resolution: Review the contract, and if it's not supposed to function standalone, mark it as `abstract` to make the intention clear.

*There are 28 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

9: contract OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L9

```solidity

File: PositionNFTs.sol

11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11

```solidity

File: WiseLending.sol

43: contract WiseLending is PoolManager {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L43

```solidity

File: WiseLendingDeclaration.sol

30: contract WiseLendingDeclaration is
    OwnableMaster,
    WrapperHelper,
    SendValueHelper
{

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L30

```solidity

File: CustomOracleSetup.sol

5: contract CustomOracleSetup {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L5

```solidity

File: PendleChildLpOracle.sol

13: contract PendleChildLpOracle is CustomOracleSetup  {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L13

```solidity

File: PendleLpOracle.sol

28: contract PendleLpOracle {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L28

```solidity

File: PtOracleDerivative.sol

22: contract PtOracleDerivative {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L22

```solidity

File: PtOraclePure.sol

22: contract PtOraclePure {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L22

```solidity

File: DeclarationsFeeManager.sol

31: contract DeclarationsFeeManager is FeeManagerEvents, OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L31

```solidity

File: FeeManager.sol

25: contract FeeManager is FeeManagerHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L25

```solidity

File: FeeManagerEvents.sol

5: contract FeeManagerEvents {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L5

```solidity

File: PendlePowerFarmDeclarations.sol

36: contract PendlePowerFarmDeclarations is
    WrapperHelper,
    TransferHelper,
    ApprovalHelper,
    SendValueHelper
{

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L36

```solidity

File: PendlePowerManager.sol

15: contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L15

```solidity

File: PendlePowerFarmControllerBase.sol

30: contract PendlePowerFarmControllerBase is
    OwnableMaster,
    TransferHelper,
    ApprovalHelper
{

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L30

```solidity

File: PendlePowerFarmToken.sol

25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25

```solidity

File: MinterReserver.sol

10: contract MinterReserver {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L10

```solidity

File: PowerFarmNFTs.sol

24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24

```solidity

File: ApprovalHelper.sol

7: contract ApprovalHelper is CallOptionalReturn {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L7

```solidity

File: CallOptionalReturn.sol

7: contract CallOptionalReturn {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L7

```solidity

File: SendValueHelper.sol

8: contract SendValueHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L8

```solidity

File: TransferHelper.sol

7: contract TransferHelper is CallOptionalReturn {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L7

```solidity

File: WrapperHelper.sol

7: contract WrapperHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L7

```solidity

File: WiseSecurity.sol

24: contract WiseSecurity is WiseSecurityHelper, ApprovalHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L24

```solidity

File: WiseSecurityDeclarations.sol

45: contract WiseSecurityDeclarations is OwnableMaster {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L45

```solidity

File: AaveEvents.sol

5: contract AaveEvents {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L5

```solidity

File: AaveHub.sol

25: contract AaveHub is AaveHelper, TransferHelper, ApprovalHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L25

```solidity

File: Declarations.sol

21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21

### [N-24]<a name="n-24"></a> Critical Changes Should Use Two-step Procedure

The critical procedures should be two step process.

*There are 68 instance(s) of this issue:*

```solidity

File: PoolManager.sol

25: function setParamsLASA(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25

```solidity

File: PoolManager.sol

26: function setParamsLASA(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26

```solidity

File: PoolManager.sol

100: function setPoolParameters(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L100

```solidity

File: PoolManager.sol

101: function setPoolParameters(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L101

```solidity

File: PoolManager.sol

125: function setVerifiedIsolationPool(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L125

```solidity

File: PoolManager.sol

126: function setVerifiedIsolationPool(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126

```solidity

File: PositionNFTs.sol

319: function setBaseURI(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L319

```solidity

File: PositionNFTs.sol

320: function setBaseURI(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320

```solidity

File: PositionNFTs.sol

328: function setBaseExtension(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328

```solidity

File: PositionNFTs.sol

329: function setBaseExtension(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329

```solidity

File: WiseLending.sol

1386: function setRegistrationIsolationPool(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386

```solidity

File: WiseLending.sol

1387: function setRegistrationIsolationPool(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387

```solidity

File: WiseLendingDeclaration.sol

140: function setSecurity(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L140

```solidity

File: WiseLendingDeclaration.sol

141: function setSecurity(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141

```solidity

File: WiseLowLevelHelper.sol

424: function setPoolFee(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424

```solidity

File: WiseLowLevelHelper.sol

425: function setPoolFee(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425

```solidity

File: CustomOracleSetup.sol

33: function setLastUpdateGlobal(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33

```solidity

File: CustomOracleSetup.sol

34: function setLastUpdateGlobal(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34

```solidity

File: CustomOracleSetup.sol

42: function setRoundData(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42

```solidity

File: CustomOracleSetup.sol

43: function setRoundData(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43

```solidity

File: CustomOracleSetup.sol

52: function setGlobalAggregatorRoundId(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L52

```solidity

File: CustomOracleSetup.sol

53: function setGlobalAggregatorRoundId(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53

```solidity

File: FeeManager.sol

49: function setRepayBadDebtIncentive(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49

```solidity

File: FeeManager.sol

50: function setRepayBadDebtIncentive(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50

```solidity

File: FeeManager.sol

66: function setAaveFlag(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L66

```solidity

File: FeeManager.sol

67: function setAaveFlag(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L67

```solidity

File: FeeManager.sol

82: function setAaveFlagBulk(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L82

```solidity

File: FeeManager.sol

83: function setAaveFlagBulk(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83

```solidity

File: FeeManager.sol

108: function setPoolFee(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108

```solidity

File: FeeManager.sol

109: function setPoolFee(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109

```solidity

File: FeeManager.sol

135: function setPoolFeeBulk(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L135

```solidity

File: FeeManager.sol

136: function setPoolFeeBulk(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L136

```solidity

File: FeeManager.sol

315: function changeIncentiveUSDA(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L315

```solidity

File: FeeManager.sol

316: function changeIncentiveUSDA(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L316

```solidity

File: FeeManager.sol

352: function changeIncentiveUSDB(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L352

```solidity

File: FeeManager.sol

353: function changeIncentiveUSDB(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L353

```solidity

File: FeeManager.sol

514: function setBadDebtUserLiquidation(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514

```solidity

File: FeeManager.sol

515: function setBadDebtUserLiquidation(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L515

```solidity

File: FeeManager.sol

538: function setBeneficial(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L538

```solidity

File: FeeManager.sol

539: function setBeneficial(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L539

```solidity

File: PendlePowerManager.sol

63: function changeMinDeposit(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63

```solidity

File: PendlePowerManager.sol

64: function changeMinDeposit(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L64

```solidity

File: PendlePowerFarmController.sol

321: function changeExchangeIncentive(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321

```solidity

File: PendlePowerFarmController.sol

322: function changeExchangeIncentive(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L322

```solidity

File: PendlePowerFarmController.sol

334: function changeMintFee(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334

```solidity

File: PendlePowerFarmController.sol

335: function changeMintFee(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335

```solidity

File: PendlePowerFarmToken.sol

592: function changeMintFee(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592

```solidity

File: PendlePowerFarmToken.sol

593: function changeMintFee(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593

```solidity

File: PowerFarmNFTs.sol

51: function setFarmContract(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51

```solidity

File: PowerFarmNFTs.sol

52: function setFarmContract(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52

```solidity

File: PowerFarmNFTs.sol

161: function setBaseURI(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L161

```solidity

File: PowerFarmNFTs.sol

162: function setBaseURI(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162

```solidity

File: PowerFarmNFTs.sol

170: function setBaseExtension(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170

```solidity

File: PowerFarmNFTs.sol

171: function setBaseExtension(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171

```solidity

File: WiseSecurity.sol

85: function setLiquidationSettings(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L85

```solidity

File: WiseSecurity.sol

86: function setLiquidationSettings(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L86

```solidity

File: WiseSecurity.sol

980: function setBlacklistToken(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980

```solidity

File: WiseSecurity.sol

981: function setBlacklistToken(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981

```solidity

File: WiseSecurity.sol

995: function setSecurityWorker(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L995

```solidity

File: WiseSecurity.sol

996: function setSecurityWorker(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996

```solidity

File: WiseSecurity.sol

1111: function changeMinDepositValue(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111

```solidity

File: WiseSecurity.sol

1112: function changeMinDepositValue(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112

```solidity

File: AaveHub.sol

44: function setAaveTokenAddress(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L44

```solidity

File: AaveHub.sol

45: function setAaveTokenAddress(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L45

```solidity

File: AaveHub.sol

64: function setAaveTokenAddressBulk(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L64

```solidity

File: AaveHub.sol

65: function setAaveTokenAddressBulk(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L65

```solidity

File: Declarations.sol

105: function setWiseSecurity(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105

```solidity

File: Declarations.sol

106: function setWiseSecurity(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106

### [N-25]<a name="n-25"></a> Custom error has no error details

Consider adding parameters to the error to indicate which user or values caused the failure

*There are 29 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

5: error NoValue();

6: error NotMaster();

7: error NotProposed();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L5-L7

```solidity

File: PositionNFTs.sol

9: error NotPermitted();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L9

```solidity

File: WiseLendingDeclaration.sol

16: error DeadOracle();

17: error NotPowerFarm();

18: error InvalidAction();

19: error InvalidCaller();

20: error PositionLocked();

21: error LiquidatorIsInPowerFarm();

22: error PositionHasCollateral();

23: error PositionHasBorrow();

24: error InvalidAddress();

25: error InvalidLiquidator();

26: error ValueIsZero();

27: error ValueNotZero();

28: error TooManyTokens();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L16-L28

```solidity

File: PendleLpOracle.sol

24: error InvalidDecimals();

25: error CardinalityNotSatisfied();

26: error OldestObservationNotSatisfied();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L24-L26

```solidity

File: PtOracleDerivative.sol

19: error CardinalityNotSatisfied();

20: error OldestObservationNotSatisfied();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L19-L20

```solidity

File: PtOraclePure.sol

19: error CardinalityNotSatisfied();

20: error OldestObservationNotSatisfied();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L19-L20

```solidity

File: DeclarationsFeeManager.sol

16: error NotWiseLiquidation();

17: error AlreadySet();

18: error ExistingBadDebt();

19: error NotWiseLending();

20: error NotIncentiveMaster();

21: error PoolAlreadyAdded();

22: error TooHighValue();

23: error TooLowValue();

24: error NotAllowed();

25: error PoolNotPresent();

26: error ZeroAddress();

27: error NoIncentive();

28: error Reentered();

29: error PoolNotActive();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L16-L29

```solidity

File: PendlePowerFarmDeclarations.sol

23: error Deactivated();

24: error InvalidParam();

25: error AccessDenied();

26: error LeverageTooHigh();

27: error DebtRatioTooLow();

28: error NotBalancerVault();

29: error DebtRatioTooHigh();

30: error ResultsInBadDebt();

31: error TooMuchValueLost();

32: error CollateralFactorTooHigh();

33: error TooMuchShares();

34: error WrongChainId();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L23-L34

```solidity

File: PendlePowerFarmControllerBase.sol

16: error NotAllowed();

17: error AlreadySet();

18: error NotExpired();

19: error LockTimeTooShort();

20: error ZeroShares();

21: error ValueTooSmall();

22: error InvalidLength();

23: error InvalidWeightSum();

24: error WrongAddress();

25: error NothingToSkim();

26: error NotFound();

27: error NotEnoughCompound();

28: error NotArbitrum();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L16-L28

```solidity

File: PendlePowerFarmToken.sol

12: error MarketExpired();

13: error NotController();

14: error ZeroFee();

15: error TooMuchFee();

16: error NotEnoughLpAssetsTransferred();

17: error InsufficientShares();

18: error ZeroAmount();

19: error FeeTooHigh();

20: error NotEnoughShares();

21: error InvalidSharePriceGrowth();

22: error InvalidSharePrice();

23: error AlreadyInitialized();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L12-L23

```solidity

File: PendlePowerFarmTokenFactory.sol

7: error DeployForbidden();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L7

```solidity

File: MinterReserver.sol

7: error InvalidKey();

8: error AlreadyReserved();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L7-L8

```solidity

File: SendValueHelper.sol

5: error AmountTooSmall();

6: error SendValueFailed();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L5-L6

```solidity

File: Declarations.sol

14: error OracleIsDead();

15: error OraclesDeviate();

16: error OracleAlreadySet();

17: error ChainLinkOracleNotSet();

23: error HeartBeatNotSet();

24: error PoolDoesNotExist();

25: error PoolAddressMismatch();

26: error TokenAddressMismatch();

27: error TwapOracleAlreadySet();

28: error ZeroAddressNotAllowed();

29: error FunctionDoesntExist();

30: error AggregatorNotNecessary();

31: error AggregatorAlreadySet();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L31, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L14, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L15, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L16, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L17, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L23, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L24, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L25, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L26, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L27, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L28, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L29, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L30

```solidity

File: WiseSecurity.sol

22: error NotWiseLendingSecurity();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L22

```solidity

File: WiseSecurityDeclarations.sol

19: error NotAllowedEntity();

20: error ChainlinkDead();

21: error TokenBlackListed();

22: error NotAllowedWiseSecurity();

23: error PositionLockedWiseSecurity();

24: error ResultsInBadDebt();

25: error NotEnoughCollateral();

26: error NotAllowedToBorrow();

27: error OpenBorrowPosition();

28: error NonVerifiedPool();

29: error NotOwner();

30: error LiquidationDenied();

31: error TooManyShares();

32: error NotRegistered();

33: error Blacklisted();

34: error SecuritySwapFailed();

35: error BaseRewardTooHigh();

36: error BaseRewardTooLow();

37: error BaseRewardFarmTooHigh();

38: error BaseRewardFarmTooLow();

39: error MaxFeeEthTooHigh();

40: error MaxFeeEthTooLow();

41: error MaxFeeFarmEthTooHigh();

42: error MaxFeeFarmEthTooLow();

43: error DepositAmountTooSmall();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L19-L43

```solidity

File: Declarations.sol

15: error AlreadySet();

16: error InvalidValue();

17: error InvalidAction();

18: error FailedInnerCall();

19: error InvalidToken();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L15-L19

### [N-26]<a name="n-26"></a> Custom errors should be used rather than `revert()`/`require()`

Custom errors are available from solidity version 0.8.4. Custom errors are more easily processed in try-catch blocks, and are easier to re-use and maintain.

*There are 2 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

348: require(
            _exists(_tokenId) == true,
            "PositionNFTs: WRONG_TOKEN"
        );



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L348

```solidity

File: PowerFarmNFTs.sol

190: require(
            _exists(_tokenId) == true,
            "PowerFarmsNFTs: WRONG_TOKEN"
        );



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L190

### [N-27]<a name="n-27"></a> Declare interfaces on separate files

Interfaces should be declared on a separate file and not on the same file where the contract resides in.

*There are 1 instance(s) of this issue:*

```solidity

File: PowerFarmNFTs.sol

14: interface IFarmContract {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L14

### [N-28]<a name="n-28"></a> Default `address(0)` can be returned

Allowing a function in Solidity to return the default address (address(0)) can be problematic as it can represent uninitialized or invalid addresses. If such an address is utilized in transfer operations or other sensitive actions, it could lead to loss of funds or unpredicted behavior. It's prudent to include checks in your functions to prevent the return of the zero address, enhancing contract security.

*There are 12 instance(s) of this issue:*

```solidity

File: MainHelper.sol

408: return tokens;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L408

```solidity

File: PositionNFTs.sol

162: return ZERO_ADDRESS;

165: return getApproved(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L165, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L162

```solidity

File: WiseCore.sol

26: return (



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L26

```solidity

File: WiseLowLevelHelper.sol

152: return positionLendTokenData[_nftId][_index];



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L152

```solidity

File: WiseLowLevelHelper.sol

173: return positionBorrowTokenData[_nftId][_index];



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L173

```solidity

File: FeeManager.sol

891: return poolTokenAddresses[_index];



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L891

```solidity

File: PendlePowerFarmControllerHelper.sol

122: return pendleChildCompoundInfo[_pendleMarket].rewardTokens;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L122

```solidity

File: PendlePowerFarmControllerHelper.sol

151: return IPendleMarket(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L151

```solidity

File: PendlePowerFarmTokenFactory.sol

48: return _clone(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L48

```solidity

File: OracleHelper.sol

292: return UNI_V3_FACTORY.getPool(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L292

```solidity

File: WiseSecurity.sol

717: return (



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L717

### [N-29]<a name="n-29"></a> Defined named returns not used within function

Such instances can be replaced with unnamed returns

*There are 26 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

356: return "";

359: return string(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L359, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L356

```solidity

File: PositionNFTs.sol

379: return "0";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L379

```solidity

File: WiseCore.sol

596: return _withdrawOrAllocateSharesLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L596

```solidity

File: PendleChildLpOracle.sol

69: return (



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L69

```solidity

File: PendleChildLpOracle.sol

95: return (



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L95

```solidity

File: PendleLpOracle.sol

162: return (



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L162

```solidity

File: PtOracleDerivative.sol

157: return (



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L157

```solidity

File: PtOraclePure.sol

136: return (



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L136

```solidity

File: FeeManager.sol

747: return (



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L747

```solidity

File: FeeManager.sol

829: return 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L829

```solidity

File: FeeManagerHelper.sol

257: return ORACLE_HUB.getTokensFromETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L257

```solidity

File: PendlePowerFarm.sol

105: return _coreLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L105

```solidity

File: PendlePowerFarmLeverageLogic.sol

317: return IPendleChild(PENDLE_CHILD).withdrawExactShares(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L317

```solidity

File: PendlePowerFarmControllerHelper.sol

68: return PENDLE_LOCK.positionData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L68

```solidity

File: PendlePowerFarmControllerHelper.sol

165: return IPendleMarket(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L165

```solidity

File: PendlePowerFarmToken.sol

380: return PENDLE_MARKET.userReward(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L380

```solidity

File: PowerFarmNFTs.sol

198: return "";

201: return string(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L201, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L198

```solidity

File: PowerFarmNFTs.sol

221: return "0";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L221

```solidity

File: OracleHelper.sol

292: return UNI_V3_FACTORY.getPool(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L292

```solidity

File: WiseOracleHub.sol

452: return true;

456: return _chainLinkIsDead(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L452, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L456

```solidity

File: WiseSecurity.sol

252: return true;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L252

```solidity

File: WiseSecurity.sol

290: return true;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L290

```solidity

File: WiseSecurity.sol

324: return true;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L324

### [N-30]<a name="n-30"></a> Dependence on external protocols

External protocols should be monitored as such dependencies may introduce vulnerabilities if a vulnerability is found /introduced in the external protocol

*There are 2 instance(s) of this issue:*

```solidity

File: PendlePowerFarmDeclarations.sol

16: import "../../InterfaceHub/IUniswapV3.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L16

```solidity

File: Declarations.sol

9: import "./Libraries/IUniswapV3Factory.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L9

### [N-31]<a name="n-31"></a> Do not cache immutable variables

Instead of caching immutable variables, using them directly can make code more consistent and less prone to errors.

*There are 4 instance(s) of this issue:*

```solidity

File: WiseSecurityDeclarations.sol

146: uint256 maxFee = IS_ETH_MAINNET == true // @audit Cached immutable IS_ETH_MAINNET

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L146

```solidity

File: WiseSecurityDeclarations.sol

150: uint256 minFee = IS_ETH_MAINNET == true // @audit Cached immutable IS_ETH_MAINNET

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L150

```solidity

File: WiseSecurityDeclarations.sol

164: uint256 maxFeeFarm = IS_ETH_MAINNET == true // @audit Cached immutable IS_ETH_MAINNET

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L164

```solidity

File: WiseSecurityDeclarations.sol

168: uint256 minFeeFarm = IS_ETH_MAINNET == true // @audit Cached immutable IS_ETH_MAINNET

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L168

### [N-32]<a name="n-32"></a> Don't use assembly for `create2`

Using assembly for `create2` is error-prone and harder to read than higher-level Solidity. With the evolution of the Solidity language, a more abstracted and clear syntax for salted contract creation, which leverages the `create2` opcode, has been introduced. Instead of manually managing assembly code, developers are encouraged to use the modern syntax, ensuring better readability, maintainability, and reduced chances of mistakes.

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmTokenFactory.sol

94: assembly {

            let clone := mload(0x40)

            mstore(
                clone,
                0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000
            )

            mstore(
                add(clone, 0x14),
                targetBytes
            )

            mstore(
                add(clone, 0x28),
                0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000
            )

            pendlePowerFarmTokenAddress := create2(
                0,
                clone,
                0x37,
                salt
            )
        }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L94

### [N-33]<a name="n-33"></a> Complex casting

Consider whether the number of casts is really necessary, or whether using a different type would be more appropriate. Alternatively, add comments to explain in detail why the casts are necessary, and any implicit reasons why the cast does not introduce an overflow.

*There are 1 instance(s) of this issue:*

```solidity

File: OracleHelper.sol

157: int192(uint192(answer))



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L157

### [N-34]<a name="n-34"></a> Empty `bytes` check is missing

To avoid mistakenly accepting empty `bytes` as a valid value, consider to check for empty `bytes`. This helps ensure that empty `bytes` are not treated as valid inputs, preventing potential issues.

*There are 6 instance(s) of this issue:*

```solidity

File: MainHelper.sol

614: function _addPositionTokenData(
        uint256 _nftId,
        address _poolToken,
        mapping(bytes32 => bool) storage hashMap,
        mapping(uint256 => address[]) storage userTokenData
    )
        internal
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L614

```solidity

File: PendlePowerFarmLeverageLogic.sol

59: function receiveFlashLoan(
        IERC20[] memory _flashloanToken,
        uint256[] memory _flashloanAmounts,
        uint256[] memory _feeAmounts,
        bytes memory _userData
    )
        external
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L59

```solidity

File: PendlePowerFarmController.sol

431: function claimArb(
        uint256 _accrued,
        bytes32[] calldata _proof
    )
        external
        onlyArbitrum
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L431

```solidity

File: PendlePowerFarmController.sol

581: function claimVoteRewards(
        uint256 _amount,
        bytes32[] calldata _merkleProof
    )
        external
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L581

```solidity

File: MinterReserver.sol

160: function onERC721Received(
        address _operator,
        address _from,
        uint256 _tokenId,
        bytes calldata _data
    )
        external
        returns (bytes4)
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L160

```solidity

File: CallOptionalReturn.sol

12: function _callOptionalReturn(
        address token,
        bytes memory data
    )
        internal
        returns (bool call)
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L12

### [N-35]<a name="n-35"></a> Enable IR-based code generation

The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions.
You can enable it on the command line using `--via-ir` or with the option `{"viaIR": true}`.
This will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command
More on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html

*There are 1 instance(s) of this issue:*

All in-scope contracts

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0

### [N-36]<a name="n-36"></a> Enum values should be used in place of constant array indexes

Create a commented enum value to use in place of constant array indexes, this makes the code far easier to understand

*There are 6 instance(s) of this issue:*

```solidity

File: WiseLending.sol

1374: tokens[0] = _poolToken;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1374

```solidity

File: PendlePowerFarmLeverageLogic.sol

32: tokens[0] = IERC20(flashAsset);

33: amount[0] = _flashAmount;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L32-L33

```solidity

File: PendlePowerFarmLeverageLogic.sol

81: uint256 totalDebtBalancer = _flashloanAmounts[0]



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L81

```solidity

File: OracleHelper.sol

417: secondsAgo[0] = TWAP_PERIOD;

418: secondsAgo[1] = 0;

431: int56 tickCumulativesDelta = tickCumulatives[1]



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L418, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L431, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L417

### [N-37]<a name="n-37"></a> `Event` declarations should have NatSpec descriptions




*There are 63 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

48: event MasterProposed(

53: event RenouncedOwnership(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L53, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L48

```solidity

File: WiseLendingDeclaration.sol

35: event FundsDeposited(

44: event FundsSolelyDeposited(

52: event FundsWithdrawn(

61: event FundsWithdrawnOnBehalf(

70: event FundsSolelyWithdrawn(

78: event FundsBorrowed(

87: event FundsBorrowedOnBehalf(

96: event FundsReturned(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L35, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L96, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L87, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L78, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L70, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L61, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L52, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L44

```solidity

File: FeeManagerEvents.sol

7: event ClaimedFeesWiseBulk(

11: event PoolTokenRemoved(

16: event PoolTokenAdded(

21: event IncentiveOwnerBChanged(

26: event IncentiveOwnerAChanged(

31: event ClaimedOwnershipIncentiveMaster(

36: event IncentiveMasterProposed(

41: event PoolFeeChanged(

47: event ClaimedIncentives(

54: event ClaimedIncentivesBulk(

58: event IncentiveIncreasedB(

63: event IncentiveIncreasedA(

68: event BadDebtIncreasedLiquidation(

73: event TotalBadDebtIncreased(

78: event TotalBadDebtDecreased(

83: event SetBadDebtPosition(

89: event UpdateBadDebtPosition(

95: event SetBeneficial(

101: event RevokeBeneficial(

107: event ClaimedFeesWise(

113: event ClaimedFeesBeneficial(

120: event PayedBackBadDebt(

129: event PayedBackBadDebtFree(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L83, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L129, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L120, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L113, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L107, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L101, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L95, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L54, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L58, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L63, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L68, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L73, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L78, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L89, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L16, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L21, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L26, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L31, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L36, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L41

```solidity

File: PendlePowerFarmDeclarations.sol

110: event FarmEntry(

118: event FarmExit(

125: event FarmStatus(

130: event ManualPaybackShares(

137: event ManualWithdrawShares(

144: event MinDepositChange(

149: event ETHReceived(

154: event RegistrationFarm(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L110, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L118, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L125, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L130, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L137, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L149, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L154

```solidity

File: PendlePowerFarmControllerBase.sol

135: event ETHReceived(

140: event ChangeExchangeIncentive(

144: event WithdrawLp(

150: event ExchangeRewardsForCompounding(

157: event ExchangeLpFeesForPendle(

164: event AddPendleMarket(

169: event UpdateRewardTokens(

174: event ChangeMintFee(

179: event LockPendle(

188: event ClaimArb(

194: event IncreaseReservedForCompound(

199: event ClaimVoteRewards(

205: event WithdrawLock(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L135, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L140, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L150, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L157, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L164, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L169, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L174, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L179, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L188, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L194, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L199, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L205

```solidity

File: MinterReserver.sol

153: event ERC721Received(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L153

```solidity

File: WiseSecurityDeclarations.sol

47: event SecurityShutdown(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L47

```solidity

File: AaveEvents.sol

7: event SetAaveTokenAddress(

13: event IsDepositAave(

18: event IsWithdrawAave(

23: event IsBorrowAave(

28: event IsPaybackAave(

33: event IsSolelyDepositAave(

38: event IsSolelyWithdrawAave(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L28, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L23, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L18, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L13

### [N-38]<a name="n-38"></a> Event Is Missing Indexed Fields

Index event fields make the field more quickly accessible [to off-chain tools](https://ethereum.stackexchange.com/questions/40396/can-somebody-please-explain-the-concept-of-event-indexing) that parse events. This is especially useful when it comes to filtering based on an address. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Where applicable, each `event` should use three `indexed` fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three applicable fields, all of the applicable fields should be indexed.

*There are 43 instance(s) of this issue:*

```solidity

File: FeeManagerEvents.sol

event PoolTokenRemoved(
        address indexed poolToken,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L11

```solidity

File: FeeManagerEvents.sol

event PoolTokenAdded(
        address indexed poolToken,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L16

```solidity

File: FeeManagerEvents.sol

event IncentiveOwnerBChanged(
        address indexed newIncentiveOwnerB,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L21

```solidity

File: FeeManagerEvents.sol

event IncentiveOwnerAChanged(
        address indexed newIncentiveOwnerA,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L26

```solidity

File: FeeManagerEvents.sol

event ClaimedOwnershipIncentiveMaster(
        address indexed newIncentiveMaster,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L31

```solidity

File: FeeManagerEvents.sol

event IncentiveMasterProposed(
        address indexed proposedIncentiveMaster,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L36

```solidity

File: FeeManagerEvents.sol

event PoolFeeChanged(
        address indexed poolToken,
        uint256 indexed newPoolFee,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L41

```solidity

File: FeeManagerEvents.sol

event ClaimedIncentives(
        address indexed sender,
        address indexed token,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L47

```solidity

File: FeeManagerEvents.sol

event IncentiveIncreasedB(
        uint256 indexed amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L58

```solidity

File: FeeManagerEvents.sol

event IncentiveIncreasedA(
        uint256 indexed amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L63

```solidity

File: FeeManagerEvents.sol

event BadDebtIncreasedLiquidation(
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L68

```solidity

File: FeeManagerEvents.sol

event TotalBadDebtIncreased(
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L73

```solidity

File: FeeManagerEvents.sol

event TotalBadDebtDecreased(
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L78

```solidity

File: FeeManagerEvents.sol

event SetBadDebtPosition(
        uint256 indexed nftId,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L83

```solidity

File: FeeManagerEvents.sol

event UpdateBadDebtPosition(
        uint256 indexed nftId,
        uint256 newAmount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L89

```solidity

File: FeeManagerEvents.sol

event SetBeneficial(
        address indexed user,
        address[] token,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L95

```solidity

File: FeeManagerEvents.sol

event RevokeBeneficial(
        address indexed user,
        address[] token,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L101

```solidity

File: PendlePowerFarmDeclarations.sol

event FarmExit(
        uint256 indexed keyId,
        uint256 indexed wiseLendingNFT,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L118

```solidity

File: PendlePowerFarmDeclarations.sol

event FarmStatus(
        bool indexed state,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L125

```solidity

File: PendlePowerFarmDeclarations.sol

event ManualPaybackShares(
        uint256 indexed keyId,
        uint256 indexed wiseLendingNFT,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L130

```solidity

File: PendlePowerFarmDeclarations.sol

event ManualWithdrawShares(
        uint256 indexed keyId,
        uint256 indexed wiseLendingNFT,
        uint256 amount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L137

```solidity

File: PendlePowerFarmDeclarations.sol

event MinDepositChange(
        uint256 minDepositEthAmount,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L144

```solidity

File: PendlePowerFarmDeclarations.sol

event ETHReceived(
        uint256 amount,
        address from
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L149

```solidity

File: PendlePowerFarmDeclarations.sol

event RegistrationFarm(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L154

```solidity

File: PendlePowerFarmControllerBase.sol

event ETHReceived(
        uint256 _amount,
        address _sender
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L135

```solidity

File: PendlePowerFarmControllerBase.sol

event WithdrawLp(
        address indexed _pendleMarket,
        address indexed _to,
        uint256 _amount
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L144

```solidity

File: PendlePowerFarmControllerBase.sol

event ExchangeRewardsForCompounding(
        address indexed _pendleMarket,
        address indexed _rewardToken,
        uint256 _rewardAmount,
        uint256 _sendingAmount
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L150

```solidity

File: PendlePowerFarmControllerBase.sol

event ExchangeLpFeesForPendle(
        address indexed _pendleMarket,
        uint256 _pendleChildShares,
        uint256 _tokenAmountSend,
        uint256 _withdrawnAmount
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L157

```solidity

File: PendlePowerFarmControllerBase.sol

event UpdateRewardTokens(
        address indexed _pendleMarket,
        address[] _rewardTokens
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L169

```solidity

File: PendlePowerFarmControllerBase.sol

event ChangeMintFee(
        address indexed _pendleMarket,
        uint256 _newFee
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L174

```solidity

File: PendlePowerFarmControllerBase.sol

event LockPendle(
        uint256 _amount,
        uint128 _expiry,
        uint256 _newVeBalance,
        bool _fromInside,
        bool _sameExpiry,
        uint256 _timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L179

```solidity

File: PendlePowerFarmControllerBase.sol

event ClaimArb(
        uint256 _accrued,
        bytes32[] _proof,
        uint256 _timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L188

```solidity

File: PendlePowerFarmControllerBase.sol

event IncreaseReservedForCompound(
        address indexed _pendleMarket,
        uint256[] _amounts
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L194

```solidity

File: PendlePowerFarmControllerBase.sol

event ClaimVoteRewards(
        uint256 _amount,
        bytes32[] _merkleProof,
        uint256 _timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L199

```solidity

File: PendlePowerFarmControllerBase.sol

event WithdrawLock(
        uint256 _amount,
        uint256 _timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L205

```solidity

File: MinterReserver.sol

event ERC721Received(
        address operator,
        address from,
        uint256 tokenId,
        bytes _data
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L153

```solidity

File: AaveEvents.sol

event SetAaveTokenAddress(
        address underlyingAsset,
        address aaveToken,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L7

```solidity

File: AaveEvents.sol

event IsDepositAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L13

```solidity

File: AaveEvents.sol

event IsWithdrawAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L18

```solidity

File: AaveEvents.sol

event IsBorrowAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L23

```solidity

File: AaveEvents.sol

event IsPaybackAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L28

```solidity

File: AaveEvents.sol

event IsSolelyDepositAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33

```solidity

File: AaveEvents.sol

event IsSolelyWithdrawAave(
        uint256 nftId,
        uint256 timestamp
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38

### [N-39]<a name="n-39"></a> Events should be emitted before external calls

Ensure that events follow the best practice of check-effects-interaction, and are emitted before external calls.

*There are 8 instance(s) of this issue:*

```solidity

File: FeeManager.sol

478: emit PoolTokenRemoved(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L478

```solidity

File: FeeManager.sol

801: emit PayedBackBadDebt(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L801

```solidity

File: FeeManager.sol

852: emit PayedBackBadDebtFree(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L852

```solidity

File: PendlePowerFarm.sol

284: emit RegistrationFarm(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L284

```solidity

File: PendlePowerManager.sol

246: emit FarmExit(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L246

```solidity

File: PendlePowerFarmController.sol

593: emit ClaimVoteRewards(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L593

```solidity

File: AaveHub.sol

544: emit IsPaybackAave(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L544

```solidity

File: AaveHub.sol

603: emit IsPaybackAave(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L603

### [N-40]<a name="n-40"></a> Expressions for constant values should use `immutable` rather than `constant`

While it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.

*There are 4 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

14: address internal constant ZERO_ADDRESS = address(0x0);

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L14

```solidity

File: PendlePowerFarmTokenFactory.sol

11: address internal constant ZERO_ADDRESS = address(0x0);

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L11

```solidity

File: Declarations.sol

124: IPriceFeed internal constant ZERO_FEED = IPriceFeed(
        address(0x0)
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L124

```solidity

File: Declarations.sol

129: IAggregator internal constant ZERO_AGGREGATOR = IAggregator(
        address(0x0)
    );

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L129

### [N-41]<a name="n-41"></a> For extended 'using-for' usage, use the latest pragma version 

Solidity versions of 0.8.13 or above can make use of enhanced using-for notation within contracts.

*There are 1 instance(s) of this issue:*

```solidity

File: PoolManager.sol

10: using Babylonian for uint256;


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L10

### [N-42]<a name="n-42"></a> File is missing NatSpec




*There are 17 instance(s) of this issue:*

```solidity

File: 

WiseLendingDeclaration.sol

WiseLendingDeclaration.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L0-L0

```solidity

File: 

WiseLowLevelHelper.sol

WiseLowLevelHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L0-L0

```solidity

File: 

CustomOracleSetup.sol

DerivativeOracles/CustomOracleSetup.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L0-L0

```solidity

File: 

PendleChildLpOracle.sol

DerivativeOracles/PendleChildLpOracle.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L0-L0

```solidity

File: 

DeclarationsFeeManager.sol

FeeManager/DeclarationsFeeManager.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L0-L0

```solidity

File: 

FeeManagerEvents.sol

FeeManager/FeeManagerEvents.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L0-L0

```solidity

File: 

PendlePowerFarmDeclarations.sol

PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L0-L0

```solidity

File: 

PendlePowerFarmControllerBase.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L0-L0

```solidity

File: 

PendlePowerFarmControllerHelper.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L0-L0

```solidity

File: 

PendlePowerFarmTokenFactory.sol

PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L0-L0

```solidity

File: 

MinterReserver.sol

PowerFarms/PowerFarmNFTs/MinterReserver.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L0-L0

```solidity

File: 

SendValueHelper.sol

TransferHub/SendValueHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L0-L0

```solidity

File: 

Declarations.sol

WiseOracleHub/Declarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L0-L0

```solidity

File: 

WiseSecurityDeclarations.sol

WiseSecurity/WiseSecurityDeclarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L0-L0

```solidity

File: 

AaveEvents.sol

WrapperHub/AaveEvents.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L0-L0

```solidity

File: 

AaveHelper.sol

WrapperHub/AaveHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L0-L0

```solidity

File: 

Declarations.sol

WrapperHub/Declarations.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L0-L0

### [N-43]<a name="n-43"></a> Function names should differ to make the code more readable

In Solidity, while function overriding allows for functions with the same name to coexist, it is advisable to avoid this practice to enhance code readability and maintainability. Having multiple functions with the same name, even with different parameters or in inherited contracts, can cause confusion and increase the likelihood of errors during development, testing, and debugging. Using distinct and descriptive function names not only clarifies the purpose and behavior of each function, but also helps prevent unintended function calls or incorrect overriding. By adopting a clear and consistent naming convention, developers can create more comprehensible and maintainable smart contracts.

*There are 95 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

103: function renounceOwnership(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L103

```solidity

File: PositionNFTs.sol

222: function isOwner(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L223

```solidity

File: PositionNFTs.sol

271: function walletOfOwner(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L272

```solidity

File: PositionNFTs.sol

319: function setBaseURI(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320

```solidity

File: PositionNFTs.sol

328: function setBaseExtension(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329

```solidity

File: PositionNFTs.sol

340: function tokenURI(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L341

```solidity

File: PositionNFTs.sol

371: function _toString(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L372

```solidity

File: WiseCore.sol

193: function _checkPositionLocked(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L194

```solidity

File: WiseCore.sol

625: function _coreLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L626

```solidity

File: WiseLending.sol

165: function _getSharePrice(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L166

```solidity

File: WiseLending.sol

192: function _checkHealthState(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L193

```solidity

File: WiseLending.sol

388: function depositExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L389

```solidity

File: WiseLending.sol

426: function depositExactAmountETHMint(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L426

```solidity

File: WiseLending.sol

442: function depositExactAmountMint(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L443

```solidity

File: WiseLending.sol

460: function depositExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L461

```solidity

File: WiseLending.sol

636: function withdrawExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L637

```solidity

File: WiseLending.sol

675: function withdrawExactSharesETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L676

```solidity

File: WiseLending.sol

714: function withdrawExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L715

```solidity

File: WiseLending.sol

902: function withdrawExactShares(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L903

```solidity

File: WiseLending.sol

975: function borrowExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L976

```solidity

File: WiseLending.sol

1016: function borrowExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1017

```solidity

File: WiseLending.sol

1088: function paybackExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1089

```solidity

File: WiseLending.sol

1161: function paybackExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1162

```solidity

File: WiseLending.sol

1204: function paybackExactShares(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1205

```solidity

File: WiseLending.sol

1588: function _reservePosition(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1588

```solidity

File: WiseLowLevelHelper.sol

134: function getTimeStamp(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L135

```solidity

File: WiseLowLevelHelper.sol

350: function _checkReentrancy(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L350

```solidity

File: WiseLowLevelHelper.sol

424: function setPoolFee(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425

```solidity

File: CustomOracleSetup.sol

26: function renounceOwnership(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L26

```solidity

File: CustomOracleSetup.sol

61: function getTimeStamp(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L61

```solidity

File: PendleChildLpOracle.sol

35: function latestAnswer(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L35

```solidity

File: PendleChildLpOracle.sol

47: function decimals(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L47

```solidity

File: PendleChildLpOracle.sol

55: function latestRoundData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L55

```solidity

File: PendleLpOracle.sol

83: function latestAnswer(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L83

```solidity

File: PendleLpOracle.sol

139: function decimals(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L139

```solidity

File: PendleLpOracle.sol

151: function latestRoundData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L151

```solidity

File: PtOracleDerivative.sol

81: function latestAnswer(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L81

```solidity

File: PtOracleDerivative.sol

134: function decimals(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L134

```solidity

File: PtOracleDerivative.sol

146: function latestRoundData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L146

```solidity

File: PtOraclePure.sol

68: function latestAnswer(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L68

```solidity

File: PtOraclePure.sol

113: function decimals(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L113

```solidity

File: PtOraclePure.sol

125: function latestRoundData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L125

```solidity

File: DeclarationsFeeManager.sol

213: function _onlyWiseLending(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L213

```solidity

File: FeeManager.sol

108: function setPoolFee(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109

```solidity

File: FeeManagerHelper.sol

15: function _prepareBorrows(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L16

```solidity

File: FeeManagerHelper.sol

47: function _prepareCollaterals(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L48

```solidity

File: PendlePowerFarm.sol

57: function getLiveDebtRatio(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L58

```solidity

File: PendlePowerFarmLeverageLogic.sol

560: function _coreLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L561

```solidity

File: PendlePowerFarmMathLogic.sol

35: function _checkReentrancy(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L35

```solidity

File: PendlePowerFarmMathLogic.sol

244: function _getTokensInETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L245

```solidity

File: PendlePowerFarmController.sol

334: function changeMintFee(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335

```solidity

File: PendlePowerFarmControllerBase.sol

256: function _syncSupply(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L257

```solidity

File: PendlePowerFarmControllerHelper.sol

156: function _getUserReward(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L157

```solidity

File: PendlePowerFarmControllerHelper.sol

189: function _getTokensInETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L190

```solidity

File: PendlePowerFarmToken.sol

325: function _getSharePrice(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L325

```solidity

File: PendlePowerFarmToken.sol

334: function _syncSupply(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L334

```solidity

File: PendlePowerFarmToken.sol

372: function _getUserReward(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L373

```solidity

File: PendlePowerFarmToken.sol

529: function depositExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L530

```solidity

File: PendlePowerFarmToken.sol

592: function changeMintFee(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593

```solidity

File: PendlePowerFarmToken.sol

608: function withdrawExactShares(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L609

```solidity

File: PendlePowerFarmToken.sol

647: function withdrawExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L648

```solidity

File: MinterReserver.sol

96: function isOwner(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L97

```solidity

File: PowerFarmNFTs.sol

109: function walletOfOwner(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L110

```solidity

File: PowerFarmNFTs.sol

161: function setBaseURI(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162

```solidity

File: PowerFarmNFTs.sol

170: function setBaseExtension(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171

```solidity

File: PowerFarmNFTs.sol

182: function tokenURI(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L183

```solidity

File: PowerFarmNFTs.sol

213: function _toString(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L214

```solidity

File: SendValueHelper.sol

12: function _sendValue(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L13

```solidity

File: OracleHelper.sol

450: function decimals(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L451

```solidity

File: WiseSecurity.sol

31: function _onlyWiseLending(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L31

```solidity

File: WiseSecurity.sol

59: function getLiveDebtRatio(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L60

```solidity

File: WiseSecurityHelper.sol

701: function _checkPositionLocked(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L702

```solidity

File: WiseSecurityHelper.sol

794: function _checkHealthState(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L795

```solidity

File: WiseSecurityHelper.sol

999: function getLendingRate(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1000

```solidity

File: AaveHelper.sol

47: function _reservePosition(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L47

```solidity

File: AaveHelper.sol

196: function _sendValue(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L197

```solidity

File: AaveHelper.sol

243: function _prepareCollaterals(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L244

```solidity

File: AaveHelper.sol

279: function _prepareBorrows(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L280

```solidity

File: AaveHub.sol

103: function depositExactAmountMint(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L104

```solidity

File: AaveHub.sol

122: function depositExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L123

```solidity

File: AaveHub.sol

158: function depositExactAmountETHMint(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L158

```solidity

File: AaveHub.sol

172: function depositExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L173

```solidity

File: AaveHub.sol

202: function withdrawExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L203

```solidity

File: AaveHub.sol

238: function withdrawExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L239

```solidity

File: AaveHub.sol

281: function withdrawExactShares(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L282

```solidity

File: AaveHub.sol

314: function withdrawExactSharesETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L315

```solidity

File: AaveHub.sol

357: function borrowExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L358

```solidity

File: AaveHub.sol

393: function borrowExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L394

```solidity

File: AaveHub.sol

433: function paybackExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L434

```solidity

File: AaveHub.sol

482: function paybackExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L483

```solidity

File: AaveHub.sol

556: function paybackExactShares(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L557

```solidity

File: AaveHub.sol

635: function getLendingRate(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L636

```solidity

File: Declarations.sol

81: function _checkOwner(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L82

```solidity

File: Declarations.sol

93: function _checkPositionLocked(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L94

```solidity

File: Declarations.sol

105: function setWiseSecurity(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106

### [N-44]<a name="n-44"></a> Function must not be longer than 50 lines




*There are 35 instance(s) of this issue:*

```solidity

File: MainHelper.sol

500: function _updatePseudoTotalAmounts(

501: function _updatePseudoTotalAmounts(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L500-L501

```solidity

File: MainHelper.sol

667: function _removePositionData(

668: function _removePositionData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L667-L668

```solidity

File: PoolManager.sol

25: function setParamsLASA(

26: function setParamsLASA(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25-L26

```solidity

File: PoolManager.sol

164: function _createPool(

165: function _createPool(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L164-L165

```solidity

File: WiseCore.sol

44: function _coreWithdrawToken(

45: function _coreWithdrawToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L44-L45

```solidity

File: WiseCore.sol

106: function _handleDeposit(

107: function _handleDeposit(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L106-L107

```solidity

File: WiseCore.sol

349: function _coreBorrowTokens(

350: function _coreBorrowTokens(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L349-L350

```solidity

File: WiseCore.sol

460: function _withdrawOrAllocateSharesLiquidation(

461: function _withdrawOrAllocateSharesLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L460-L461

```solidity

File: WiseCore.sol

543: function _calculateReceiveAmount(

544: function _calculateReceiveAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L543-L544

```solidity

File: WiseCore.sol

625: function _coreLiquidation(

626: function _coreLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L625-L626

```solidity

File: WiseLending.sol

1088: function paybackExactAmountETH(

1089: function paybackExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1088-L1089

```solidity

File: WiseLending.sol

1250: function liquidatePartiallyFromTokens(

1251: function liquidatePartiallyFromTokens(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1250-L1251

```solidity

File: WiseLendingDeclaration.sol

140: function setSecurity(

141: function setSecurity(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L140-L141

```solidity

File: WiseLendingDeclaration.sol

257: function _onlyAaveHub(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L257

```solidity

File: FeeManager.sol

628: function claimWiseFees(

629: function claimWiseFees(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L628-L629

```solidity

File: FeeManager.sol

730: function paybackBadDebtForToken(

731: function paybackBadDebtForToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L730-L731

```solidity

File: FeeManagerHelper.sol

134: function _updateUserBadDebt(

135: function _updateUserBadDebt(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L134-L135

```solidity

File: PendlePowerFarmDeclarations.sol

274: function _doApprovals(

275: function _doApprovals(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L274-L275

```solidity

File: PendlePowerFarmLeverageLogic.sol

59: function receiveFlashLoan(

60: function receiveFlashLoan(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L59-L60

```solidity

File: PendlePowerFarmLeverageLogic.sol

134: function _logicClosePosition(

135: function _logicClosePosition(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L134-L135

```solidity

File: PendlePowerFarmLeverageLogic.sol

414: function _logicOpenPosition(

415: function _logicOpenPosition(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L414-L415

```solidity

File: PendlePowerFarmController.sol

53: function exchangeRewardsForCompoundingWithIncentive(

54: function exchangeRewardsForCompoundingWithIncentive(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L53-L54

```solidity

File: PendlePowerFarmController.sol

113: function exchangeLpFeesForPendleWithIncentive(

114: function exchangeLpFeesForPendleWithIncentive(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L113-L114

```solidity

File: PendlePowerFarmController.sol

211: function addPendleMarket(

212: function addPendleMarket(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L211-L212

```solidity

File: PendlePowerFarmController.sol

364: function lockPendle(

365: function lockPendle(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L364-L365

```solidity

File: PendlePowerFarmToken.sol

218: function _calculateRewardsClaimedOutside(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L218

```solidity

File: PendlePowerFarmToken.sol

529: function depositExactAmount(

530: function depositExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L529-L530

```solidity

File: PendlePowerFarmTokenFactory.sol

56: function _clone(

57: function _clone(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L56-L57

```solidity

File: OracleHelper.sol

592: function _recalibratePreview(

593: function _recalibratePreview(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L592-L593

```solidity

File: WiseOracleHub.sol

266: function addTwapOracleDerivative(

267: function addTwapOracleDerivative(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L266-L267

```solidity

File: WiseSecurity.sol

556: function overallNetAPY(

557: function overallNetAPY(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L556-L557

```solidity

File: WiseSecurity.sol

695: function positionBlackListToken(

696: function positionBlackListToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L695-L696

```solidity

File: WiseSecurity.sol

764: function maximumWithdrawToken(

765: function maximumWithdrawToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L764-L765

```solidity

File: WiseSecurityDeclarations.sol

118: function _setLiquidationSettings(

119: function _setLiquidationSettings(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L118-L119

```solidity

File: AaveHub.sol

482: function paybackExactAmountETH(

483: function paybackExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L482-L483

### [N-45]<a name="n-45"></a> Functions that alter state should emit events containing both the old and the new value




*There are 22 instance(s) of this issue:*

```solidity

File: PoolManager.sol

25: function setParamsLASA(
        address _poolToken,
        uint256 _poolMulFactor,
        uint256 _upperBoundMaxRate,
        uint256 _lowerBoundMaxRate,
        bool _steppingDirection,
        bool _isFinal
    )
        external
        onlyMaster
    {
        if (parametersLocked[_poolToken] == true) {
            revert InvalidAction();
        }

        parametersLocked[_poolToken] = _isFinal;

        AlgorithmEntry storage algoData = algorithmData[
            _poolToken
        ];

        algoData.increasePole = _steppingDirection;

        _validateParameter(
            _upperBoundMaxRate,
            UPPER_BOUND_MAX_RATE
        );

        _validateParameter(
            _lowerBoundMaxRate,
            LOWER_BOUND_MAX_RATE
        );

        _validateParameter(
            _lowerBoundMaxRate,
            _upperBoundMaxRate
        );

        uint256 staticMinPole = _getPoleValue(
            _poolMulFactor,
            _upperBoundMaxRate
        );

        uint256 staticMaxPole = _getPoleValue(
            _poolMulFactor,
            _lowerBoundMaxRate
        );

        uint256 staticDeltaPole = _getDeltaPole(
            staticMaxPole,
            staticMinPole
        );

        uint256 startValuePole = _getStartValue(
            staticMaxPole,
            staticMinPole
        );

        _validateParameter(
            _poolMulFactor,
            PRECISION_FACTOR_E18
        );

        borrowRatesData[_poolToken] = BorrowRatesEntry(
            startValuePole,
            staticDeltaPole,
            staticMinPole,
            staticMaxPole,
            _poolMulFactor
        );

        algoData.bestPole = startValuePole;
        algoData.maxValue = lendingPoolData[_poolToken].totalDepositShares;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26

```solidity

File: PoolManager.sol

100: function setPoolParameters(
        address _poolToken,
        uint256 _collateralFactor,
        uint256 _maximumDeposit
    )
        external
        onlyMaster
    {
        if (_maximumDeposit > 0) {
            maxDepositValueToken[_poolToken] = _maximumDeposit;
        }

        if (_collateralFactor > 0) {
            lendingPoolData[_poolToken].collateralFactor = _collateralFactor;
        }

        _validateParameter(
            _collateralFactor,
            PRECISION_FACTOR_E18
        );
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L101

```solidity

File: PoolManager.sol

125: function setVerifiedIsolationPool(
        address _isolationPool,
        bool _state
    )
        external
        onlyMaster
    {
        verifiedIsolationPool[_isolationPool] = _state;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126

```solidity

File: PositionNFTs.sol

319: function setBaseURI(
        string memory _newBaseURI
    )
        external
        onlyMaster
    {
        baseURI = _newBaseURI;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320

```solidity

File: PositionNFTs.sol

328: function setBaseExtension(
        string memory _newBaseExtension
    )
        external
        onlyMaster
    {
        baseExtension = _newBaseExtension;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329

```solidity

File: WiseLending.sol

1386: function setRegistrationIsolationPool(
        uint256 _nftId,
        bool _registerState
    )
        external
    {
        _onlyIsolationPool(
            msg.sender
        );

        _validateZero(
            WISE_SECURITY.overallETHCollateralsBare(_nftId)
        );

        _validateZero(
            WISE_SECURITY.overallETHBorrowBare(_nftId)
        );

        positionLocked[_nftId] = _registerState;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387

```solidity

File: WiseLendingDeclaration.sol

140: function setSecurity(
        address _wiseSecurity
    )
        external
        onlyMaster
    {
        if (address(WISE_SECURITY) > ZERO_ADDRESS) {
            revert InvalidAction();
        }

        WISE_SECURITY = IWiseSecurity(
            _wiseSecurity
        );

        FEE_MANAGER = IFeeManagerLight(
            WISE_SECURITY.FEE_MANAGER()
        );

        AAVE_HUB_ADDRESS = WISE_SECURITY.AAVE_HUB();
    }

    
    address internal AAVE_HUB_ADDRESS;

    
    address public immutable WETH_ADDRESS;

    
    uint256 immutable FEE_MANAGER_NFT;

    uint256 internal constant MIN_BORROW_SHARE_PRICE = 5 * PRECISION_FACTOR_E18
        / 10;

    
    IWiseSecurity public WISE_SECURITY;

    
    IFeeManagerLight internal FEE_MANAGER;

    
    IPositionNFTs public immutable POSITION_NFT;

    
    IWiseOracleHub public immutable WISE_ORACLE;

    
    bool internal powerFarmCheck;

    uint256 internal constant GHOST_AMOUNT = 1E3;

    

    struct LendingEntry {
        bool unCollateralized;
        uint256 shares;
    }

    struct BorrowRatesEntry {
        uint256 pole;
        uint256 deltaPole;
        uint256 minPole;
        uint256 maxPole;
        uint256 multiplicativeFactor;
    }

    struct AlgorithmEntry {
        bool increasePole;
        uint256 bestPole;
        uint256 maxValue;
        uint256 previousValue;
    }

    struct GlobalPoolEntry {
        uint256 totalPool;
        uint256 utilization;
        uint256 totalBareToken;
        uint256 poolFee;
    }

    struct LendingPoolEntry {
        uint256 pseudoTotalPool;
        uint256 totalDepositShares;
        uint256 collateralFactor;
    }

    struct BorrowPoolEntry {
        bool allowBorrow;
        uint256 pseudoTotalBorrowAmount;
        uint256 totalBorrowShares;
        uint256 borrowRate;
    }

    struct TimestampsPoolEntry {
        uint256 timeStamp;
        uint256 timeStampScaling;
        uint256 initialTimeStamp;
    }

    struct CoreLiquidationStruct {
        uint256 nftId;
        uint256 nftIdLiquidator;
        address caller;
        address tokenToPayback;
        address tokenToRecieve;
        uint256 paybackAmount;
        uint256 shareAmountToPay;
        uint256 maxFeeETH;
        uint256 baseRewardLiquidation;
        address[] lendTokens;
        address[] borrowTokens;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141

```solidity

File: WiseLowLevelHelper.sol

424: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyFeeManager
    {
        globalPoolData[_poolToken].poolFee = _newFee;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425

```solidity

File: CustomOracleSetup.sol

33: function setLastUpdateGlobal(
        uint256 _time
    )
        external
        onlyOwner
    {
        lastUpdateGlobal = _time;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34

```solidity

File: CustomOracleSetup.sol

42: function setRoundData(
        uint80 _roundId,
        uint256 _updateTime
    )
        external
        onlyOwner
    {
        timeStampByRoundId[_roundId] = _updateTime;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43

```solidity

File: CustomOracleSetup.sol

52: function setGlobalAggregatorRoundId(
        uint80 _aggregatorRoundId
    )
        external
        onlyOwner
    {
        globalRoundId = _aggregatorRoundId;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53

```solidity

File: FeeManager.sol

49: function setRepayBadDebtIncentive(
        uint256 _percent
    )
        external
        onlyMaster
    {
        _checkValue(
            _percent
        );

        paybackIncentive = _percent;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50

```solidity

File: FeeManager.sol

82: function setAaveFlagBulk(
        address[] calldata _poolTokens,
        address[] calldata _underlyingTokens
    )
        external
        onlyMaster
    {
        uint256 i;
        uint256 l = _poolTokens.length;

        while (i < l) {
            _setAaveFlag(
                _poolTokens[i],
                _underlyingTokens[i]
            );

            unchecked {
                ++i;
            }
        }
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83

```solidity

File: PendlePowerFarmToken.sol

592: function changeMintFee(
        uint256 _newFee
    )
        external
        onlyController
    {
        if (_newFee > MAX_MINT_FEE) {
            revert FeeTooHigh();
        }

        mintFee = _newFee;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593

```solidity

File: PowerFarmNFTs.sol

51: function setFarmContract(
        address _farmContract
    )
        external
        onlyMaster
    {
        if (farmContract == ZERO_ADDRESS) {
            farmContract = _farmContract;
        }
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52

```solidity

File: PowerFarmNFTs.sol

161: function setBaseURI(
        string calldata _newBaseURI
    )
        external
        onlyMaster
    {
        baseURI = _newBaseURI;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162

```solidity

File: PowerFarmNFTs.sol

170: function setBaseExtension(
        string calldata _newBaseExtension
    )
        external
        onlyMaster
    {
        baseExtension = _newBaseExtension;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171

```solidity

File: WiseSecurity.sol

980: function setBlacklistToken(
        address _tokenAddress,
        bool _state
    )
        external
        onlyMaster()
    {
        wasBlacklisted[_tokenAddress] = _state;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981

```solidity

File: WiseSecurity.sol

995: function setSecurityWorker(
        address _entitiy,
        bool _state
    )
        external
        onlyMaster
    {
        securityWorker[_entitiy] = _state;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996

```solidity

File: WiseSecurity.sol

1111: function changeMinDepositValue(
        uint256 _newMinDepositValue
    )
        external
        onlyMaster
    {
        if (_newMinDepositValue == 0) {
            revert NoValue();
        }

        minDepositEthValue = _newMinDepositValue;
    }
}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112

```solidity

File: AaveHub.sol

64: function setAaveTokenAddressBulk(
        address[] calldata _underlyingAssets,
        address[] calldata _aaveTokens
    )
        external
        onlyMaster
    {
        for (uint256 i = 0; i < _underlyingAssets.length; i++) {
            _setAaveTokenAddress(
                _underlyingAssets[i],
                _aaveTokens[i]
            );
        }
    }

    
    receive()
        external
        payable
    {
        if (msg.sender == WETH_ADDRESS) {
            return;
        }

        _sendValue(
            master,
            msg.value
        );
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L65

```solidity

File: Declarations.sol

105: function setWiseSecurity(
        address _securityAddress
    )
        external
        onlyMaster
    {
        if (address(WISE_SECURITY) > ZERO_ADDRESS) {
            revert AlreadySet();
        }

        WISE_SECURITY = IWiseSecurity(
            _securityAddress
        );
    }
}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106

### [N-46]<a name="n-46"></a> Some functions contain the same exact logic

These functions have the exact same code logic. Consider using a single function instead of duplicating the code, for example by using a `library`, or through inheritance.

*There are 10 instance(s) of this issue:*

```solidity

File: PendleLpOracle.sol

139: function decimals()
        external
        pure
        returns (uint8)
    {
        return FEED_DECIMALS;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L139

```solidity

File: PtOracleDerivative.sol

134: function decimals()
        external
        pure
        returns (uint8)
    {
        return FEED_DECIMALS;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L134

```solidity

File: PtOracleDerivative.sol

146: function latestRoundData()
        public
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {
        return (
            roundId,
            int256(latestAnswer()),
            startedAt,
            updatedAt,
            answeredInRound
        );
    }
}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L146

```solidity

File: PtOraclePure.sol

113: function decimals()
        external
        pure
        returns (uint8)
    {
        return FEED_DECIMALS;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L113

```solidity

File: PtOraclePure.sol

125: function latestRoundData()
        public
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {
        return (
            roundId,
            int256(latestAnswer()),
            startedAt,
            updatedAt,
            answeredInRound
        );
    }
}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L125

```solidity

File: PendlePowerFarmMathLogic.sol

245: function _getTokensInETH(
        address _tokenAddress,
        uint256 _tokenAmount
    )
        internal
        view
        returns (uint256)
    {
        return ORACLE_HUB.getTokensInETH(
            _tokenAddress,
            _tokenAmount
        );
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L245

```solidity

File: PendlePowerFarmControllerHelper.sol

190: function _getTokensInETH(
        address _tokenAddress,
        uint256 _tokenAmount
    )
        internal
        view
        returns (uint256)
    {
        return ORACLE_HUB.getTokensInETH(
            _tokenAddress,
            _tokenAmount
        );
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L190

```solidity

File: Declarations.sol

82: function _checkOwner(
        uint256 _nftId
    )
        internal
        view
    {
        WISE_SECURITY.checkOwnerPosition(
            _nftId,
            msg.sender
        );
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L82

```solidity

File: Declarations.sol

94: function _checkPositionLocked(
        uint256 _nftId
    )
        internal
        view
    {
        WISE_LENDING.checkPositionLocked(
            _nftId,
            msg.sender
        );
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L94

```solidity

File: Declarations.sol

106: function setWiseSecurity(
        address _securityAddress
    )
        external
        onlyMaster
    {
        if (address(WISE_SECURITY) > ZERO_ADDRESS) {
            revert AlreadySet();
        }

        WISE_SECURITY = IWiseSecurity(
            _securityAddress
        );
    }
}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106

### [N-47]<a name="n-47"></a> Functions should be marked as `payable` when interacting with `ETH` like for transfering `ETH` to other contracts




*There are 1 instance(s) of this issue:*

```solidity

File: WiseSecurity.sol

194: function curveSecurityCheck(
        address _poolToken
    )
        external
        onlyWiseLending
    {
        address curvePool = curveSwapInfoData[_poolToken].curvePool;

        if (curvePool == ZERO_ADDRESS) {
            return;
        }

        (
            bool success
            ,
        ) = curvePool.call{value: 0} (
            curveSwapInfoData[_poolToken].swapBytesPool
        );

        _checkSuccess(
            success
        );

        address curveMeta = curveSwapInfoData[_poolToken].curveMetaPool;

        if (curveMeta == ZERO_ADDRESS) {
            return;
        }

        (
            success
            ,
        ) = curveMeta.call{value: 0} (
            curveSwapInfoData[_poolToken].swapBytesMeta
        );

        _checkSuccess(
            success
        );
    }


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L194

### [N-48]<a name="n-48"></a> Functions should have `@notice` tags

The `@notice` is used to explain to users what the function does. The compiler interprets `///` or `/**` comments [as this tag](https://docs.soliditylang.org/en/latest/natspec-format.html#tags) if one wasn't explicitly provided.

*There are 239 instance(s) of this issue:*

```solidity

File: MainHelper.sol

33: function _calculateShares(

93: function _cashoutAmount(

258: function _checkLiquidatorNft(

278: function _getBalance(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L258, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L33, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L93, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L278

```solidity

File: OwnableMaster.sol

21: function _onlyMaster()

37: function _onlyProposed()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L37, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L21

```solidity

File: PoolManager.sol

25: function setParamsLASA(

100: function setPoolParameters(

135: function createPool(

146: function createCurvePool(

164: function _createPool(

277: function _getPoleValue(

293: function _getDeltaPole(

304: function _getStartValue(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L164, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L100, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L135, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L146, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L277, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L293, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L304

```solidity

File: PositionNFTs.sol

54: function assignReserveRole(

64: function blockReservePublic()

71: function forwardFeeManagerNFT(

90: function reservePosition()

99: function reservePositionForUser(

111: function _reservePositionForUser(

130: function getNextExpectedId()

193: function _mintPositionForUser(

222: function isOwner(

245: function approveMint(

328: function setBaseExtension(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L193, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L222, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L54, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L64, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L245, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L130, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L71, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L90, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L99, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L111

```solidity

File: WiseCore.sol

271: function _checkAllowDeposit(

604: function _calculatePotentialPureExtraCashout(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L604, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L271

```solidity

File: WiseLending.sol

77: function _healthStateCheck(

128: function _emitFundsSolelyWithdrawn(

145: function _emitFundsSolelyDeposited(

192: function _checkHealthState(

401: function _depositExactAmountETH(

1460: function _handleWithdrawAmount(

1489: function _handleSolelyWithdraw(

1517: function _handleWithdrawShares(

1553: function _handleBorrowExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1460, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L192, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L145, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L128, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L77, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1489, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L401, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1553, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1517

```solidity

File: WiseLendingDeclaration.sol

140: function setSecurity(

257: function _onlyAaveHub()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L257, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L140

```solidity

File: WiseLowLevelHelper.sol

14: function _onlyFeeManager()

25: function _validateParameter(

49: function getPseudoTotalPool(

59: function getTotalBareToken(

69: function getPseudoTotalBorrowAmount(

79: function getTotalDepositShares(

89: function getTotalBorrowShares(

99: function getPositionLendingShares(

110: function getPositionBorrowShares(

121: function getPureCollateralAmount(

144: function getPositionLendingTokenByIndex(

155: function getPositionLendingTokenLength(

165: function getPositionBorrowTokenByIndex(

176: function getPositionBorrowTokenLength(

197: function _setBestPole(

206: function _setIncreasePole(

215: function _setPole(

224: function _increaseTotalPool(

233: function _decreaseTotalPool(

242: function _increaseTotalDepositShares(

251: function _decreaseTotalDepositShares(

260: function _increasePseudoTotalBorrowAmount(

269: function _decreasePseudoTotalBorrowAmount(

278: function _increaseTotalBorrowShares(

287: function _decreaseTotalBorrowShares(

296: function _increasePseudoTotalPool(

305: function _decreasePseudoTotalPool(

314: function _setTimeStamp(

323: function _setTimeStampScaling(

332: function _increaseTotalBareToken(

341: function _decreaseTotalBareToken(

350: function _checkReentrancy()

363: function _sendingProgressAaveHub()

371: function _decreasePositionMappingValue(

382: function _increaseMappingValue(

393: function _byPassCase(

407: function _increaseTotalAndPseudoTotalPool(

424: function setPoolFee(

434: function _checkOwnerPosition(

447: function _validateNonZero(

458: function _validateZero(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L14, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L25, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L49, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L59, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L69, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L79, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L89, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L99, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L110, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L121, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L155, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L165, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L176, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L197, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L206, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L215, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L224, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L233, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L242, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L251, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L260, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L269, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L278, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L287, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L296, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L305, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L314, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L323, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L332, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L341, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L350, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L363, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L371, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L382, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L393, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L407, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L434, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L447, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L458

```solidity

File: CustomOracleSetup.sol

26: function renounceOwnership()

33: function setLastUpdateGlobal(

42: function setRoundData(

52: function setGlobalAggregatorRoundId(

61: function getTimeStamp()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L26, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L61, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L52, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33

```solidity

File: PendleChildLpOracle.sol

35: function latestAnswer()

47: function decimals()

55: function latestRoundData()

78: function getRoundData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L35, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L78, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L55, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L47

```solidity

File: PendleLpOracle.sol

122: function _getLpToAssetRateWrapper(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L122

```solidity

File: DeclarationsFeeManager.sol

191: function _onlyIncentiveMaster()

202: function _onlyWiseSecurity()

213: function _onlyWiseLending()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L213, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L191, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L202

```solidity

File: FeeManagerHelper.sol

230: function _setAaveFlag(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L230

```solidity

File: PendlePowerFarmDeclarations.sol

266: function doApprovals()

274: function _doApprovals(

361: function _isActive()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L266, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L361, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L274

```solidity

File: PendlePowerFarmLeverageLogic.sol

232: function _getEthBack(

264: function _getTokensUniV3(

310: function _withdrawPendleLPs(

326: function _paybackExactShares(

531: function _borrowExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L310, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L326, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L531, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L232, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L264

```solidity

File: PendlePowerFarmMathLogic.sol

35: function _checkReentrancy()

111: function _getPositionBorrowTokenAmountAave(

244: function _getTokensInETH(

258: function _getEthInTokens(

272: function getLeverageAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L244, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L258, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L272, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L35, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L111

```solidity

File: PendlePowerManager.sol

63: function changeMinDeposit(

96: function enterFarm(

142: function enterFarmETH(

185: function _getWiseLendingNFT()

210: function exitFarm(

254: function manuallyPaybackShares(

274: function manuallyWithdrawShares(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L96, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L142, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L185, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L210, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L254, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L274

```solidity

File: PendlePowerFarmController.sol

32: function withdrawLp(

53: function exchangeRewardsForCompoundingWithIncentive(

113: function exchangeLpFeesForPendleWithIncentive(

172: function skim(

211: function addPendleMarket(

293: function updateRewardTokens(

321: function changeExchangeIncentive(

334: function changeMintFee(

431: function claimArb(

451: function withdrawLock()

497: function increaseReservedForCompound(

526: function overWriteIndex(

544: function overWriteIndexAll(

566: function overWriteAmounts(

581: function claimVoteRewards(

600: function forwardETH(

612: function vote(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L544, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L581, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L600, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L612, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L451, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L497, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L526, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L566, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L32, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L53, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L113, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L172, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L211, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L293, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L431

```solidity

File: PendlePowerFarmControllerBase.sol

236: function _onlyArbitrum()

245: function _onlyChildContract(

256: function _syncSupply(

272: function syncAllSupply()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L236, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L245, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L256, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L272

```solidity

File: PendlePowerFarmControllerHelper.sol

9: function _findIndex(

32: function _calcExpiry(

45: function _getExpiry()

53: function _getLockAmount()

61: function _getPositionData(

73: function _getAmountToSend(

95: function pendleChildCompoundInfoReservedForCompound(

105: function pendleChildCompoundInfoLastIndex(

115: function pendleChildCompoundInfoRewardTokens(

125: function activePendleMarketsLength()

133: function _checkFeed(

144: function _getRewardTokens(

156: function _getUserReward(

173: function _getUserRewardIndex(

189: function _getTokensInETH(

203: function _getTokensFromETH(

217: function _compareHashes(

236: function _setRewardTokens(

245: function getExpiry()

253: function getLockAmount()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L253, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L32, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L45, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L53, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L61, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L73, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L95, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L105, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L115, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L125, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L133, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L156, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L173, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L189, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L203, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L217, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L236, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L245

```solidity

File: PendlePowerFarmToken.sol

72: function _onlyController()

98: function _validateSharePrice(

114: function _validateSharePriceGrowth(

132: function _overWriteCheck()

140: function _triggerIndexUpdate()

149: function _wrapOverWrites(

160: function _updateRewardTokens()

169: function _overWriteIndexAll()

177: function _overWriteIndex(

188: function _overWriteAmounts()

196: function _updateRewards()

218: function _calculateRewardsClaimedOutside()

305: function _getBalanceLpBalanceController()

315: function _getActiveBalance()

325: function _getSharePrice()

334: function _syncSupply()

347: function _increaseCardinalityNext()

359: function _withdrawLp(

372: function _getUserReward(

386: function previewDistribution()

416: function _setLastInteraction()

422: function _applyMintFee(

434: function totalLpAssets()

443: function previewUnderlyingLpAssets()

452: function previewMintShares(

465: function previewAmountWithdrawShares(

478: function previewBurnShares(

494: function manualSync()

502: function addCompoundRewards(

592: function changeMintFee(

647: function withdrawExactAmount(

682: function initialize(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L359, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L386, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L347, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L372, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L682, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L647, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L502, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L494, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L478, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L465, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L452, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L443, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L434, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L422, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L416, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L72, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L98, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L114, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L132, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L140, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L149, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L160, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L169, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L177, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L188, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L196, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L218, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L305, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L315, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L325, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L334

```solidity

File: PendlePowerFarmTokenFactory.sol

35: function deploy(

56: function _clone(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L35, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L56

```solidity

File: MinterReserver.sol

41: function _onlyKeyOwner(

63: function _incrementReserved()

70: function _getNextReserveKey()

77: function _reserveKey(

96: function isOwner(

115: function _mintKeyForUser(

141: function mintReserved()

160: function onERC721Received(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L70, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L141, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L41, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L63, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L77, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L96, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L115, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L160

```solidity

File: PowerFarmNFTs.sol

16: function reservedKeys(

51: function setFarmContract(

93: function checkOwner(

170: function setBaseExtension(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L93, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L16, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51

```solidity

File: SendValueHelper.sol

12: function _sendValue(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L12

```solidity

File: OracleHelper.sol

32: function _addAggregator(

60: function _checkFunctionExistence(

87: function _compareMinMax(

131: function _validateAnswer(

216: function _getRelativeDifference(

235: function _compareDifference(

246: function _getChainlinkAnswer(

265: function getETHPriceInUSD()

394: function _getOneUnit(

406: function _getAverageTick(

460: function _getTwapDerivatePrice(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L246, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L394, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L406, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L460, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L32, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L235, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L265, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L60, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L87, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L131, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L216

```solidity

File: WiseOracleHub.sol

85: function getTokenDecimals(

403: function addAggregator(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L403, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L85

```solidity

File: WiseSecurity.sol

31: function _onlyWiseLending()

1078: function checkMinDepositValue(

1092: function _checkMinDepositValue(

1111: function changeMinDepositValue(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1078, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1092, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L31

```solidity

File: WiseSecurityDeclarations.sol

118: function _setLiquidationSettings(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L118

```solidity

File: WiseSecurityHelper.sol

340: function _getTokensInEth(

806: function _getState(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L806, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L340

```solidity

File: AaveHelper.sol

23: function _validToken(

34: function _nonReentrantCheck()

47: function _reservePosition()

56: function _wrapDepositExactAmount(

83: function _wrapWithdrawExactAmount(

113: function _wrapWithdrawExactShares(

141: function _wrapBorrowExactAmount(

165: function _wrapAaveReturnValueDeposit(

196: function _sendValue(

219: function _getInfoPayback(

243: function _prepareCollaterals(

279: function _prepareBorrows(

315: function getAavePoolAPY(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L196, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L141, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L113, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L83, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L56, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L34, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L23, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L315, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L279, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L243, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L219, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L165

```solidity

File: AaveHub.sol

611: function skimAave(

664: function _setAaveTokenAddress(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L664, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L611

```solidity

File: Declarations.sol

81: function _checkOwner(

93: function _checkPositionLocked(

105: function setWiseSecurity(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L81, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L93

### [N-49]<a name="n-49"></a> A function which defines named returns in it's declaration doesn't need to use return

Remove the return statement once ensuring it is safe to do so

*There are 23 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

379: return "0";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L379

```solidity

File: WiseCore.sol

585: return receiveAmount + potentialPureExtraCashout;

589: return receiveAmount;

596: return _withdrawOrAllocateSharesLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L596, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L589, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L585

```solidity

File: FeeManager.sol

829: return 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L829

```solidity

File: FeeManagerHelper.sol

257: return ORACLE_HUB.getTokensFromETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L257

```solidity

File: PendlePowerFarm.sol

105: return _coreLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L105

```solidity

File: PendlePowerFarmLeverageLogic.sol

317: return IPendleChild(PENDLE_CHILD).withdrawExactShares(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L317

```solidity

File: PendlePowerFarmController.sol

414: return newVeBalance;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L414

```solidity

File: PendlePowerFarmController.sol

472: return amount;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L472

```solidity

File: PendlePowerFarmControllerHelper.sol

68: return PENDLE_LOCK.positionData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L68

```solidity

File: PendlePowerFarmControllerHelper.sol

165: return IPendleMarket(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L165

```solidity

File: PendlePowerFarmToken.sol

380: return PENDLE_MARKET.userReward(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L380

```solidity

File: PowerFarmNFTs.sol

221: return "0";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L221

```solidity

File: OracleHelper.sol

292: return UNI_V3_FACTORY.getPool(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L292

```solidity

File: WiseOracleHub.sol

452: return true;

456: return _chainLinkIsDead(

480: return state;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L456, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L480, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L452

```solidity

File: WiseSecurity.sol

252: return true;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L252

```solidity

File: WiseSecurity.sol

290: return true;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L290

```solidity

File: WiseSecurity.sol

324: return true;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L324

```solidity

File: WiseSecurityHelper.sol

207: return ethCollateral;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L207

```solidity

File: WiseSecurityHelper.sol

264: return ethCollateral;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L264

### [N-50]<a name="n-50"></a> Function writing that does not comply with the Solidity Style Guide

Order of Functions; ordering helps readers identify which functions they can call and to find the constructor and fallback definitions easier. But there are contracts in the project that do not comply with this.

https://docs.soliditylang.org/en/v0.8.23/style-guide.html

Functions should be grouped according to their visibility and ordered:
- constructor
- receive function (if exists)
- fallback function (if exists)
- external
- public
- internal
- private
- within a grouping, place the view and pure functions last

*There are 1 instance(s) of this issue:*

```solidity

File: 

WiseSecurityHelper.sol

WiseSecurity/WiseSecurityHelper.sol

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L0-L0

### [N-51]<a name="n-51"></a> Large or complicated code bases should implement fuzzing tests

Large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts, should implement <a href="https://medium.com/coinmonks/smart-contract-fuzzing-d9b88e0b0a05">fuzzing tests</a>. Fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and fuzzers, with properly and extensively-written invariants, can close this testing gap significantly.

*There are 1 instance(s) of this issue:*

Various in-scope contract files

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0

### [N-52]<a name="n-52"></a> Use `delete` to Clear Variables

`delete a` assigns the initial value for the type to `a`. i.e. for integers it is equivalent to `a = 0`, but it can also be used on arrays, where it assigns a dynamic array of length zero or a static array of the same length with all elements reset. For structs, it assigns a struct with all members reset. Similarly, it can also be used to set an address to zero address. It has no effect on whole mappings though (as the keys of mappings may be arbitrary and are generally unknown). However, individual keys and what they map to can be deleted: If `a` is a mapping, then `delete a[x]` will delete the value stored at `x`.

The `delete` key better conveys the intention and is also more idiomatic. Consider replacing assignments of zero with `delete` statements.

*There are 7 instance(s) of this issue:*

```solidity

File: PendlePowerManager.sol

228: reservedKeys[msg.sender] = 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L228

```solidity

File: PendlePowerFarmController.sol

268: childInfo.reservedForCompound[i] = 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L268

```solidity

File: PendlePowerFarmController.sol

459: reservedPendleForLocking = 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L459

```solidity

File: PendlePowerFarmToken.sol

256: rewardsOutsideArray[i] = 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L256

```solidity

File: OracleHelper.sol

418: secondsAgo[1] = 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L418

```solidity

File: WiseSecurity.sol

600: i = 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L600

```solidity

File: WiseSecurity.sol

732: i = 0;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L732

### [N-53]<a name="n-53"></a> `if`-statement can be converted to a ternary

The code can be made more compact while also increasing readability by converting the following `if`-statements to ternaries (e.g. `foo += (x > y) ? a : b`)

*There are 4 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

203: if (nftId > 0) {
            delete reserved[
                _user
            ];

            totalReserved--;

        } else {
            nftId = getNextExpectedId();
        }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L203

```solidity

File: WiseCore.sol

76: if (_onBehalf == true) {
            emit FundsWithdrawnOnBehalf(
                _caller,
                _nftId,
                _poolToken,
                _amount,
                _shares,
                block.timestamp
            );
        } else {
            emit FundsWithdrawn(
                _caller,
                _nftId,
                _poolToken,
                _amount,
                _shares,
                block.timestamp
            );
        }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L76

```solidity

File: WiseCore.sol

397: if (_onBehalf == true) {
            emit FundsBorrowedOnBehalf(
                _caller,
                _nftId,
                _poolToken,
                _amount,
                _shares,
                block.timestamp
            );
        } else {
            emit FundsBorrowed(
                _caller,
                _nftId,
                _poolToken,
                _amount,
                _shares,
                block.timestamp
            );
        }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L397

```solidity

File: PendlePowerManager.sol

227: if (reservedKeys[msg.sender] == _keyId) {
            reservedKeys[msg.sender] = 0;
        } else {
            FARMS_NFTS.burnKey(
                _keyId
            );
        }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L227

### [N-54]<a name="n-54"></a> Immutables can be named using the same convention

Immutables should be in uppercase per naming convention.
As shown below, some immutables are named using capital letters and underscores while some are not. For a better code quality, please consider naming these immutables using the same naming convention.

*There are 29 instance(s) of this issue:*

```solidity

File: PendlePowerFarmDeclarations.sol

54: address public immutable aaveTokenAddresses;

55: address public immutable borrowTokenAddresses;

57: address public immutable ENTRY_ASSET;

58: address public immutable PENDLE_CHILD;

66: IAave public immutable AAVE;

67: IAaveHub public immutable AAVE_HUB;

68: IWiseLending public immutable WISE_LENDING;

69: IWiseOracleHub public immutable ORACLE_HUB;

70: IWiseSecurity public immutable WISE_SECURITY;

71: IBalancerVault public immutable BALANCER_VAULT;

72: IPositionNFTs public immutable POSITION_NFT;

73: IStETH public immutable ST_ETH;

74: ICurve public immutable CURVE;

75: IUniswapV3 public immutable UNISWAP_V3_ROUTER;

77: IPendleSy public immutable PENDLE_SY;

78: IPendleRouter public immutable PENDLE_ROUTER;

79: IPendleMarket public immutable PENDLE_MARKET;

80: IPendleRouterStatic public immutable PENDLE_ROUTER_STATIC;

82: address internal immutable WETH_ADDRESS;

84: address immutable AAVE_ADDRESS;

88: address immutable AAVE_HUB_ADDRESS;

90: address immutable AAVE_WETH_ADDRESS;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L74, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L58, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L66, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L67, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L68, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L69, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L70, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L71, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L72, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L73, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L75, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L77, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L78, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L79, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L80, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L82, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L84, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L88, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L90, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L54, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L55, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L57

```solidity

File: Declarations.sol

76: address public immutable WETH_ADDRESS;

82: address public immutable ETH_USD_PLACEHOLDER;

85: uint8 internal immutable _decimalsWETH;

88: IPriceFeed public immutable ETH_PRICE_FEED;

91: IPriceFeed public immutable SEQUENCER;

94: IUniswapV3Factory public immutable UNI_V3_FACTORY;

133: bool internal immutable IS_ARBITRUM_CHAIN;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L91, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L94, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L133, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L88, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L76, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L82, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L85

### [N-55]<a name="n-55"></a> Imports can be grouped together

Consider importing OZ first, then all interfaces, then all utils.

*There are 31 instance(s) of this issue:*

```solidity

File: WiseLendingDeclaration.sol

5: import "./OwnableMaster.sol";

7: import "./InterfaceHub/IAaveHubLite.sol";

8: import "./InterfaceHub/IPositionNFTs.sol";

9: import "./InterfaceHub/IWiseSecurity.sol";

10: import "./InterfaceHub/IWiseOracleHub.sol";

11: import "./InterfaceHub/IFeeManagerLight.sol";

13: import "./TransferHub/WrapperHelper.sol";

14: import "./TransferHub/SendValueHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L14, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L8, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L5

```solidity

File: PendleChildLpOracle.sol

3: import "./CustomOracleSetup.sol";

5: import "../InterfaceHub/IPendle.sol";

6: import "../InterfaceHub/IPriceFeed.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L3, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L6

```solidity

File: PendlePowerFarmControllerBase.sol

5: import "../../OwnableMaster.sol";

7: import "../../TransferHub/TransferHelper.sol";

8: import "../../TransferHub/ApprovalHelper.sol";

10: import "../../InterfaceHub/IPendle.sol";

11: import "../../InterfaceHub/IArbRewardsClaimer.sol";

12: import "../../InterfaceHub/IWiseOracleHub.sol";

13: import "../../InterfaceHub/IPendlePowerFarmToken.sol";

14: import "../../InterfaceHub/IPendlePowerFarmTokenFactory.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L8, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L12, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L14

```solidity

File: PendlePowerFarmToken.sol

5: import "./SimpleERC20Clone.sol";

7: import "../../InterfaceHub/IPendle.sol";

8: import "../../InterfaceHub/IPendleController.sol";

10: import "../../TransferHub/TransferHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L8

```solidity

File: PowerFarmNFTs.sol

11: import "../../OwnableMaster.sol";

12: import "@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L11-L12

```solidity

File: Declarations.sol

5: import "./AaveEvents.sol";

7: import "../InterfaceHub/IAave.sol";

8: import "../InterfaceHub/IWiseLending.sol";

9: import "../InterfaceHub/IWiseSecurity.sol";

10: import "../InterfaceHub/IPositionNFTs.sol";

12: import "../OwnableMaster.sol";

13: import "../TransferHub/WrapperHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L8, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L12

### [N-56]<a name="n-56"></a> Incorrect withdraw declaration

In Solidity, it's essential for clarity and interoperability to correctly specify return types in function declarations. If the `withdraw` function is expected to return a `bool` to indicate success or failure, its omission could lead to ambiguity or unexpected behavior when interacting with or calling this function from other contracts or off-chain systems. Missing return values can mislead developers and potentially lead to contract integrations built on incorrect assumptions. To resolve this, the function declaration for `withdraw` should be modified to explicitly include the `bool` return type, ensuring clarity and correctness in contract interactions.

*There are 18 instance(s) of this issue:*

```solidity

File: WiseCore.sol

428: function _withdrawPureCollateralLiquidation(
        uint256 _nftId,
        address _poolToken,
        uint256 _percentLiquidation
    )
        private
        returns (uint256 transferAmount)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L429

```solidity

File: WiseCore.sol

460: function _withdrawOrAllocateSharesLiquidation(
        uint256 _nftId,
        uint256 _nftIdLiquidator,
        address _poolToken,
        uint256 _percentWishCollateral
    )
        private
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L461

```solidity

File: WiseLending.sol

636: function withdrawExactAmountETH(
        uint256 _nftId,
        uint256 _amount
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L637

```solidity

File: WiseLending.sol

675: function withdrawExactSharesETH(
        uint256 _nftId,
        uint256 _shares
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L676

```solidity

File: WiseLending.sol

714: function withdrawExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _withdrawAmount
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L715

```solidity

File: WiseLending.sol

859: function withdrawOnBehalfExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _withdrawAmount
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L860

```solidity

File: WiseLending.sol

902: function withdrawExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L903

```solidity

File: WiseLending.sol

939: function withdrawOnBehalfExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L940

```solidity

File: PendlePowerFarmLeverageLogic.sol

310: function _withdrawPendleLPs(
        uint256 _nftId,
        uint256 _lendingShares
    )
        private
        returns (uint256 withdrawnLpsAmount)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L311

```solidity

File: PendlePowerFarmController.sol

32: function withdrawLp(
        address _pendleMarket,
        address _to,
        uint256 _amount
    )
        external
        onlyChildContract(_pendleMarket)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L33

```solidity

File: PendlePowerFarmController.sol

451: function withdrawLock()
        external
        onlyMaster
        returns (uint256 amount)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L451

```solidity

File: PendlePowerFarmToken.sol

359: function _withdrawLp(
        address _to,
        uint256 _amount
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L360

```solidity

File: PendlePowerFarmToken.sol

608: function withdrawExactShares(
        uint256 _shares
    )
        external
        syncSupply
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L609

```solidity

File: PendlePowerFarmToken.sol

647: function withdrawExactAmount(
        uint256 _underlyingLpAssetAmount
    )
        external
        syncSupply
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L648

```solidity

File: AaveHub.sol

202: function withdrawExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _withdrawAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L203

```solidity

File: AaveHub.sol

238: function withdrawExactAmountETH(
        uint256 _nftId,
        uint256 _withdrawAmount
    )
        external
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L239

```solidity

File: AaveHub.sol

281: function withdrawExactShares(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _shareAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L282

```solidity

File: AaveHub.sol

314: function withdrawExactSharesETH(
        uint256 _nftId,
        uint256 _shareAmount
    )
        external
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L315

### [N-57]<a name="n-57"></a> No need to initialize uints to zero

There is no need to initialize `uint` variables to zero as their default value is `0`

*There are 1 instance(s) of this issue:*

```solidity

File: AaveHub.sol

71: for (uint256 i = 0; i < _underlyingAssets.length; i++) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L71

### [N-58]<a name="n-58"></a> Initial value check is missing in Set Functions

A check regarding whether the current value and the new value are the same should be added

*There are 50 instance(s) of this issue:*

```solidity

File: PoolManager.sol

125: function setVerifiedIsolationPool(
        address _isolationPool,
        bool _state
    )
        external
        onlyMaster
    {
        verifiedIsolationPool[_isolationPool] = _state;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L125

```solidity

File: PoolManager.sol

126: function setVerifiedIsolationPool(
        address _isolationPool,
        bool _state
    )
        external
        onlyMaster
    {
        verifiedIsolationPool[_isolationPool] = _state;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126

```solidity

File: PositionNFTs.sol

319: function setBaseURI(
        string memory _newBaseURI
    )
        external
        onlyMaster
    {
        baseURI = _newBaseURI;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L319

```solidity

File: PositionNFTs.sol

320: function setBaseURI(
        string memory _newBaseURI
    )
        external
        onlyMaster
    {
        baseURI = _newBaseURI;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320

```solidity

File: PositionNFTs.sol

328: function setBaseExtension(
        string memory _newBaseExtension
    )
        external
        onlyMaster
    {
        baseExtension = _newBaseExtension;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328

```solidity

File: PositionNFTs.sol

329: function setBaseExtension(
        string memory _newBaseExtension
    )
        external
        onlyMaster
    {
        baseExtension = _newBaseExtension;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329

```solidity

File: WiseLending.sol

1386: function setRegistrationIsolationPool(
        uint256 _nftId,
        bool _registerState
    )
        external
    {
        _onlyIsolationPool(
            msg.sender
        );

        _validateZero(
            WISE_SECURITY.overallETHCollateralsBare(_nftId)
        );

        _validateZero(
            WISE_SECURITY.overallETHBorrowBare(_nftId)
        );

        positionLocked[_nftId] = _registerState;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386

```solidity

File: WiseLending.sol

1387: function setRegistrationIsolationPool(
        uint256 _nftId,
        bool _registerState
    )
        external
    {
        _onlyIsolationPool(
            msg.sender
        );

        _validateZero(
            WISE_SECURITY.overallETHCollateralsBare(_nftId)
        );

        _validateZero(
            WISE_SECURITY.overallETHBorrowBare(_nftId)
        );

        positionLocked[_nftId] = _registerState;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387

```solidity

File: WiseLowLevelHelper.sol

424: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyFeeManager
    {
        globalPoolData[_poolToken].poolFee = _newFee;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424

```solidity

File: WiseLowLevelHelper.sol

425: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyFeeManager
    {
        globalPoolData[_poolToken].poolFee = _newFee;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425

```solidity

File: CustomOracleSetup.sol

33: function setLastUpdateGlobal(
        uint256 _time
    )
        external
        onlyOwner
    {
        lastUpdateGlobal = _time;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33

```solidity

File: CustomOracleSetup.sol

34: function setLastUpdateGlobal(
        uint256 _time
    )
        external
        onlyOwner
    {
        lastUpdateGlobal = _time;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34

```solidity

File: CustomOracleSetup.sol

42: function setRoundData(
        uint80 _roundId,
        uint256 _updateTime
    )
        external
        onlyOwner
    {
        timeStampByRoundId[_roundId] = _updateTime;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42

```solidity

File: CustomOracleSetup.sol

43: function setRoundData(
        uint80 _roundId,
        uint256 _updateTime
    )
        external
        onlyOwner
    {
        timeStampByRoundId[_roundId] = _updateTime;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43

```solidity

File: FeeManager.sol

49: function setRepayBadDebtIncentive(
        uint256 _percent
    )
        external
        onlyMaster
    {
        _checkValue(
            _percent
        );

        paybackIncentive = _percent;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49

```solidity

File: FeeManager.sol

50: function setRepayBadDebtIncentive(
        uint256 _percent
    )
        external
        onlyMaster
    {
        _checkValue(
            _percent
        );

        paybackIncentive = _percent;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50

```solidity

File: FeeManager.sol

66: function setAaveFlag(
        address _poolToken,
        address _underlyingToken
    )
        external
        onlyMaster
    {
        _setAaveFlag(
            _poolToken,
            _underlyingToken
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L66

```solidity

File: FeeManager.sol

67: function setAaveFlag(
        address _poolToken,
        address _underlyingToken
    )
        external
        onlyMaster
    {
        _setAaveFlag(
            _poolToken,
            _underlyingToken
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L67

```solidity

File: FeeManager.sol

82: function setAaveFlagBulk(
        address[] calldata _poolTokens,
        address[] calldata _underlyingTokens
    )
        external
        onlyMaster
    {
        uint256 i;
        uint256 l = _poolTokens.length;

        while (i < l) {
            _setAaveFlag(
                _poolTokens[i],
                _underlyingTokens[i]
            );

            unchecked {
                ++i;
            }
        }
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L82

```solidity

File: FeeManager.sol

83: function setAaveFlagBulk(
        address[] calldata _poolTokens,
        address[] calldata _underlyingTokens
    )
        external
        onlyMaster
    {
        uint256 i;
        uint256 l = _poolTokens.length;

        while (i < l) {
            _setAaveFlag(
                _poolTokens[i],
                _underlyingTokens[i]
            );

            unchecked {
                ++i;
            }
        }
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83

```solidity

File: FeeManager.sol

108: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyMaster
    {
        _checkValue(
            _newFee
        );

        WISE_LENDING.setPoolFee(
            _poolToken,
            _newFee
        );

        emit PoolFeeChanged(
            _poolToken,
            _newFee,
            block.timestamp
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108

```solidity

File: FeeManager.sol

109: function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyMaster
    {
        _checkValue(
            _newFee
        );

        WISE_LENDING.setPoolFee(
            _poolToken,
            _newFee
        );

        emit PoolFeeChanged(
            _poolToken,
            _newFee,
            block.timestamp
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L109

```solidity

File: FeeManager.sol

514: function setBadDebtUserLiquidation(
        uint256 _nftId,
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {
        _setBadDebtPosition(
            _nftId,
            _amount
        );

        emit SetBadDebtPosition(
            _nftId,
            _amount,
            block.timestamp
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514

```solidity

File: FeeManager.sol

515: function setBadDebtUserLiquidation(
        uint256 _nftId,
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {
        _setBadDebtPosition(
            _nftId,
            _amount
        );

        emit SetBadDebtPosition(
            _nftId,
            _amount,
            block.timestamp
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L515

```solidity

File: PendlePowerManager.sol

63: function changeMinDeposit(
        uint256 _newMinDeposit
    )
        external
        onlyMaster
    {
        minDepositEthAmount = _newMinDeposit;

        emit MinDepositChange(
            _newMinDeposit,
            block.timestamp
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63

```solidity

File: PendlePowerManager.sol

64: function changeMinDeposit(
        uint256 _newMinDeposit
    )
        external
        onlyMaster
    {
        minDepositEthAmount = _newMinDeposit;

        emit MinDepositChange(
            _newMinDeposit,
            block.timestamp
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L64

```solidity

File: PendlePowerFarmController.sol

321: function changeExchangeIncentive(
        uint256 _newExchangeIncentive
    )
        external
        onlyMaster
    {
        exchangeIncentive = _newExchangeIncentive;

        emit ChangeExchangeIncentive(
            _newExchangeIncentive
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321

```solidity

File: PendlePowerFarmController.sol

322: function changeExchangeIncentive(
        uint256 _newExchangeIncentive
    )
        external
        onlyMaster
    {
        exchangeIncentive = _newExchangeIncentive;

        emit ChangeExchangeIncentive(
            _newExchangeIncentive
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L322

```solidity

File: PendlePowerFarmController.sol

334: function changeMintFee(
        address _pendleMarket,
        uint256 _newFee
    )
        external
        onlyMaster
    {
        address child = pendleChildAddress[
            _pendleMarket
        ];

        if (child == ZERO_ADDRESS) {
            revert WrongAddress();
        }

        IPendlePowerFarmToken(
            child
        ).changeMintFee(
            _newFee
        );

        emit ChangeMintFee(
            _pendleMarket,
            _newFee
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334

```solidity

File: PendlePowerFarmController.sol

335: function changeMintFee(
        address _pendleMarket,
        uint256 _newFee
    )
        external
        onlyMaster
    {
        address child = pendleChildAddress[
            _pendleMarket
        ];

        if (child == ZERO_ADDRESS) {
            revert WrongAddress();
        }

        IPendlePowerFarmToken(
            child
        ).changeMintFee(
            _newFee
        );

        emit ChangeMintFee(
            _pendleMarket,
            _newFee
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L335

```solidity

File: PendlePowerFarmToken.sol

592: function changeMintFee(
        uint256 _newFee
    )
        external
        onlyController
    {
        if (_newFee > MAX_MINT_FEE) {
            revert FeeTooHigh();
        }

        mintFee = _newFee;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592

```solidity

File: PendlePowerFarmToken.sol

593: function changeMintFee(
        uint256 _newFee
    )
        external
        onlyController
    {
        if (_newFee > MAX_MINT_FEE) {
            revert FeeTooHigh();
        }

        mintFee = _newFee;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593

```solidity

File: PowerFarmNFTs.sol

51: function setFarmContract(
        address _farmContract
    )
        external
        onlyMaster
    {
        if (farmContract == ZERO_ADDRESS) {
            farmContract = _farmContract;
        }
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51

```solidity

File: PowerFarmNFTs.sol

52: function setFarmContract(
        address _farmContract
    )
        external
        onlyMaster
    {
        if (farmContract == ZERO_ADDRESS) {
            farmContract = _farmContract;
        }
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52

```solidity

File: PowerFarmNFTs.sol

161: function setBaseURI(
        string calldata _newBaseURI
    )
        external
        onlyMaster
    {
        baseURI = _newBaseURI;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L161

```solidity

File: PowerFarmNFTs.sol

162: function setBaseURI(
        string calldata _newBaseURI
    )
        external
        onlyMaster
    {
        baseURI = _newBaseURI;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162

```solidity

File: PowerFarmNFTs.sol

170: function setBaseExtension(
        string calldata _newBaseExtension
    )
        external
        onlyMaster
    {
        baseExtension = _newBaseExtension;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170

```solidity

File: PowerFarmNFTs.sol

171: function setBaseExtension(
        string calldata _newBaseExtension
    )
        external
        onlyMaster
    {
        baseExtension = _newBaseExtension;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171

```solidity

File: WiseSecurity.sol

85: function setLiquidationSettings(
        uint256 _baseReward,
        uint256 _baseRewardFarm,
        uint256 _newMaxFeeETH,
        uint256 _newMaxFeeFarmETH
    )
        external
        onlyMaster
    {
        _setLiquidationSettings(
            _baseReward,
            _baseRewardFarm,
            _newMaxFeeETH,
            _newMaxFeeFarmETH
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L85

```solidity

File: WiseSecurity.sol

86: function setLiquidationSettings(
        uint256 _baseReward,
        uint256 _baseRewardFarm,
        uint256 _newMaxFeeETH,
        uint256 _newMaxFeeFarmETH
    )
        external
        onlyMaster
    {
        _setLiquidationSettings(
            _baseReward,
            _baseRewardFarm,
            _newMaxFeeETH,
            _newMaxFeeFarmETH
        );
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L86

```solidity

File: WiseSecurity.sol

980: function setBlacklistToken(
        address _tokenAddress,
        bool _state
    )
        external
        onlyMaster()
    {
        wasBlacklisted[_tokenAddress] = _state;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980

```solidity

File: WiseSecurity.sol

981: function setBlacklistToken(
        address _tokenAddress,
        bool _state
    )
        external
        onlyMaster()
    {
        wasBlacklisted[_tokenAddress] = _state;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981

```solidity

File: WiseSecurity.sol

995: function setSecurityWorker(
        address _entitiy,
        bool _state
    )
        external
        onlyMaster
    {
        securityWorker[_entitiy] = _state;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L995

```solidity

File: WiseSecurity.sol

996: function setSecurityWorker(
        address _entitiy,
        bool _state
    )
        external
        onlyMaster
    {
        securityWorker[_entitiy] = _state;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996

```solidity

File: WiseSecurity.sol

1111: function changeMinDepositValue(
        uint256 _newMinDepositValue
    )
        external
        onlyMaster
    {
        if (_newMinDepositValue == 0) {
            revert NoValue();
        }

        minDepositEthValue = _newMinDepositValue;
    }
}

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111

```solidity

File: WiseSecurity.sol

1112: function changeMinDepositValue(
        uint256 _newMinDepositValue
    )
        external
        onlyMaster
    {
        if (_newMinDepositValue == 0) {
            revert NoValue();
        }

        minDepositEthValue = _newMinDepositValue;
    }
}

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112

```solidity

File: AaveHub.sol

44: function setAaveTokenAddress(
        address _underlyingAsset,
        address _aaveToken
    )
        external
        onlyMaster
    {
        _setAaveTokenAddress(
            _underlyingAsset,
            _aaveToken
        );

    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L44

```solidity

File: AaveHub.sol

45: function setAaveTokenAddress(
        address _underlyingAsset,
        address _aaveToken
    )
        external
        onlyMaster
    {
        _setAaveTokenAddress(
            _underlyingAsset,
            _aaveToken
        );

    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L45

```solidity

File: Declarations.sol

105: function setWiseSecurity(
        address _securityAddress
    )
        external
        onlyMaster
    {
        if (address(WISE_SECURITY) > ZERO_ADDRESS) {
            revert AlreadySet();
        }

        WISE_SECURITY = IWiseSecurity(
            _securityAddress
        );
    }
}

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105

```solidity

File: Declarations.sol

106: function setWiseSecurity(
        address _securityAddress
    )
        external
        onlyMaster
    {
        if (address(WISE_SECURITY) > ZERO_ADDRESS) {
            revert AlreadySet();
        }

        WISE_SECURITY = IWiseSecurity(
            _securityAddress
        );
    }
}

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106

### [N-59]<a name="n-59"></a> Contracts should have full test coverage

While a code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.

*There are 1 instance(s) of this issue:*

All in-scope contracts

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0

### [N-60]<a name="n-60"></a> Interface imports should be declared first

Amend the ordering of imports to import interfaces first followed by other imports

*There are 5 instance(s) of this issue:*

```solidity

File: WiseLendingDeclaration.sol

7: import "./InterfaceHub/IAaveHubLite.sol";

8: import "./InterfaceHub/IPositionNFTs.sol";

9: import "./InterfaceHub/IWiseSecurity.sol";

10: import "./InterfaceHub/IWiseOracleHub.sol";

11: import "./InterfaceHub/IFeeManagerLight.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L7-L11

```solidity

File: PendleChildLpOracle.sol

5: import "../InterfaceHub/IPendle.sol";

6: import "../InterfaceHub/IPriceFeed.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L5-L6

```solidity

File: PendlePowerFarmControllerBase.sol

10: import "../../InterfaceHub/IPendle.sol";

11: import "../../InterfaceHub/IArbRewardsClaimer.sol";

12: import "../../InterfaceHub/IWiseOracleHub.sol";

13: import "../../InterfaceHub/IPendlePowerFarmToken.sol";

14: import "../../InterfaceHub/IPendlePowerFarmTokenFactory.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L10-L14

```solidity

File: PendlePowerFarmToken.sol

7: import "../../InterfaceHub/IPendle.sol";

8: import "../../InterfaceHub/IPendleController.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L7-L8

```solidity

File: Declarations.sol

7: import "../InterfaceHub/IAave.sol";

8: import "../InterfaceHub/IWiseLending.sol";

9: import "../InterfaceHub/IWiseSecurity.sol";

10: import "../InterfaceHub/IPositionNFTs.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L7-L10

### [N-61]<a name="n-61"></a> Invalid NatSpec comment style

NatSpec must begin with `///`, or use `/* ... */` syntax

*There are 3 instance(s) of this issue:*

```solidity

File: OracleHelper.sol

563: // @TODO: Add a check for TWAP comparison on 2.5%

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L563

```solidity

File: WiseOracleHub.sol

95: // @TODO: Delete later, keep for backward compatibility

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L95

```solidity

File: WiseOracleHub.sol

170: // @TODO: Delete later, keep for backward compatibility

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L170

### [N-62]<a name="n-62"></a> It is best practice to use linear inheritance

In Solidity, complex inheritance structures can obfuscate code understanding, introducing potential security risks. Multiple inheritance, especially with overlapping function names or state variables, can cause unintentional overrides or ambiguous behavior. 

Resolution: Strive for linear and simple inheritance chains. Avoid diamond or circular inheritance patterns. Clearly document the purpose and relationships of base contracts, ensuring that overrides are intentional. Tools like Remix or Hardhat can visualize inheritance chains, assisting in verification. Keeping inheritance streamlined aids in better code readability, reduces potential errors, and ensures smoother audits and upgrades.

*There are 4 instance(s) of this issue:*

```solidity

File: FeeManager.sol

25: contract FeeManager is FeeManagerHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L25

```solidity

File: PendlePowerFarm.sol

7: abstract contract PendlePowerFarm is PendlePowerFarmLeverageLogic {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L7

```solidity

File: PendlePowerFarmController.sol

8: contract PendlePowerFarmController is PendlePowerFarmControllerHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L8

```solidity

File: WiseSecurity.sol

24: contract WiseSecurity is WiseSecurityHelper, ApprovalHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L24

### [N-63]<a name="n-63"></a> Lack Of brace spacing

Lack of brace spacing in coding refers to the absence of spaces around braces, which can hinder code readability. In Solidity, as in many programming languages, spacing can enhance the visual distinction between different parts of the code, making it easier to follow. A lack of spacing can lead to a dense, confusing appearance. The resolution to this issue is to follow a consistent style guide that defines rules for brace spacing. By including spaces around braces, such as `{ statement }` instead of `{statement}`, developers can ensure that the code is more legible and maintainable, especially in larger codebases.

*There are 2 instance(s) of this issue:*

```solidity

File: WiseSecurity.sol

208: ) = curvePool.call{value: 0} (

225: ) = curveMeta.call{value: 0} (



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L225, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L208

### [N-64]<a name="n-64"></a> Assembly blocks should have extensive comments

Assembly blocks are take a lot more time to audit than normal Solidity code, and often have gotchas and side-effects that the Solidity versions of the same code do not. Consider adding more comments explaining what is being done in every step of the assembly code

*There are 2 instance(s) of this issue:*

```solidity

File: PendlePowerFarmTokenFactory.sol

56: function _clone(
        address _underlyingPendleMarket,
        string memory _tokenName,
        string memory _symbolName,
        uint16 _maxCardinality
    )
        private
        returns (address pendlePowerFarmTokenAddress)
    {
        bytes32 salt = keccak256(
            abi.encodePacked(
                _underlyingPendleMarket
            )
        );

        bytes20 targetBytes = bytes20(
            IMPLEMENTATION_TARGET
        );

        assembly {

            let clone := mload(0x40)

            mstore(
                clone,
                0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000
            )

            mstore(
                add(clone, 0x14),
                targetBytes
            )

            mstore(
                add(clone, 0x28),
                0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000
            )

            pendlePowerFarmTokenAddress := create2(
                0,
                clone,
                0x37,
                salt
            )
        }

        PendlePowerFarmToken(pendlePowerFarmTokenAddress).initialize(
            _underlyingPendleMarket,
            PENDLE_POWER_FARM_CONTROLLER,
            _tokenName,
            _symbolName,
            _maxCardinality
        );
    }
}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L56

```solidity

File: OracleHelper.sol

60: function _checkFunctionExistence(
        address _tokenAggregator
    )
        internal
        returns (bool)
    {
        uint256 size;

        assembly {
            size := extcodesize(
                _tokenAggregator
            )
        }

        if (size == 0) {
            return false;
        }

        (bool success, ) = _tokenAggregator.call(
            abi.encodeWithSignature(
                "maxAnswer()"
            )
        );

        return success;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L60

### [N-65]<a name="n-65"></a> Large or complicated code bases should implement invariant tests

This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts. Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.

*There are 1 instance(s) of this issue:*

All in-scope contracts

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0

### [N-66]<a name="n-66"></a> Long functions should be refactored into multiple, smaller, functions




*There are 53 instance(s) of this issue:*

```solidity

File: MainHelper.sol

298: function _cleanUp(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L299

```solidity

File: MainHelper.sol

500: function _updatePseudoTotalAmounts(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L501

```solidity

File: MainHelper.sol

667: function _removePositionData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L668

```solidity

File: PoolManager.sol

25: function setParamsLASA(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26

```solidity

File: PoolManager.sol

164: function _createPool(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L165

```solidity

File: WiseCore.sol

44: function _coreWithdrawToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L45

```solidity

File: WiseCore.sol

106: function _handleDeposit(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L107

```solidity

File: WiseCore.sol

349: function _coreBorrowTokens(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L350

```solidity

File: WiseCore.sol

460: function _withdrawOrAllocateSharesLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L461

```solidity

File: WiseCore.sol

543: function _calculateReceiveAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L544

```solidity

File: WiseCore.sol

625: function _coreLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L626

```solidity

File: WiseLending.sol

1088: function paybackExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1089

```solidity

File: WiseLending.sol

1250: function liquidatePartiallyFromTokens(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1251

```solidity

File: WiseLending.sol

1314: function coreLiquidationIsolationPools(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1315

```solidity

File: WiseLendingDeclaration.sol

140: function setSecurity(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141

```solidity

File: WiseLendingDeclaration.sol

257: function _onlyAaveHub(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L257

```solidity

File: PtOracleDerivative.sol

81: function latestAnswer(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L81

```solidity

File: FeeManager.sol

438: function removePoolTokenManual(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L439

```solidity

File: FeeManager.sol

628: function claimWiseFees(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L629

```solidity

File: FeeManager.sol

730: function paybackBadDebtForToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L731

```solidity

File: FeeManager.sol

816: function paybackBadDebtNoReward(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L817

```solidity

File: FeeManagerHelper.sol

134: function _updateUserBadDebt(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L135

```solidity

File: FeeManagerHelper.sol

330: function _gatherIncentives(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L331

```solidity

File: PendlePowerFarm.sol

230: function _closingPosition(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L231

```solidity

File: PendlePowerFarmDeclarations.sol

274: function _doApprovals(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L275

```solidity

File: PendlePowerFarmLeverageLogic.sol

59: function receiveFlashLoan(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L60

```solidity

File: PendlePowerFarmLeverageLogic.sol

134: function _logicClosePosition(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L135

```solidity

File: PendlePowerFarmLeverageLogic.sol

414: function _logicOpenPosition(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L415

```solidity

File: PendlePowerFarmLeverageLogic.sol

560: function _coreLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L561

```solidity

File: PendlePowerFarmMathLogic.sol

174: function getPositionBorrowETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L175

```solidity

File: PendlePowerFarmMathLogic.sol

289: function _getApproxNetAPY(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L290

```solidity

File: PendlePowerFarmController.sol

53: function exchangeRewardsForCompoundingWithIncentive(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L54

```solidity

File: PendlePowerFarmController.sol

113: function exchangeLpFeesForPendleWithIncentive(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L114

```solidity

File: PendlePowerFarmController.sol

211: function addPendleMarket(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L212

```solidity

File: PendlePowerFarmController.sol

364: function lockPendle(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L365

```solidity

File: PendlePowerFarmToken.sol

218: function _calculateRewardsClaimedOutside(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L218

```solidity

File: PendlePowerFarmToken.sol

529: function depositExactAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L530

```solidity

File: PendlePowerFarmToken.sol

682: function initialize(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L683

```solidity

File: PendlePowerFarmTokenFactory.sol

56: function _clone(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L57

```solidity

File: OracleHelper.sol

131: function _validateAnswer(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L132

```solidity

File: OracleHelper.sol

460: function _getTwapDerivatePrice(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L461

```solidity

File: OracleHelper.sol

592: function _recalibratePreview(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L593

```solidity

File: WiseOracleHub.sol

266: function addTwapOracleDerivative(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L267

```solidity

File: WiseSecurity.sol

142: function prepareCurvePools(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L143

```solidity

File: WiseSecurity.sol

442: function overallLendingAPY(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L443

```solidity

File: WiseSecurity.sol

499: function overallBorrowAPY(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L500

```solidity

File: WiseSecurity.sol

556: function overallNetAPY(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L557

```solidity

File: WiseSecurity.sol

641: function safeLimitPosition(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L642

```solidity

File: WiseSecurity.sol

695: function positionBlackListToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L696

```solidity

File: WiseSecurity.sol

764: function maximumWithdrawToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L765

```solidity

File: WiseSecurityDeclarations.sol

118: function _setLiquidationSettings(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L119

```solidity

File: AaveHub.sol

482: function paybackExactAmountETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L483

```solidity

File: AaveHub.sol

556: function paybackExactShares(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L557

### [N-67]<a name="n-67"></a> Make use of Solidity's `using` keyword

The directive `using A for B` can be used to attach functions (`A`) as operators to user-defined value types or as member functions to any type (`B`). The member functions receive the object they are called on as their first parameter (like the `self` variable in Python). The operator functions receive operands as parameters.  Doing so improves readability, makes debugging easier, and promotes modularity and reusability in the code.

*There are 5 instance(s) of this issue:*

```solidity

File: PowerFarmNFTs.sol

116: IFarmContract farm = IFarmContract(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L116

```solidity

File: Declarations.sol

124: IPriceFeed internal constant ZERO_FEED = IPriceFeed(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L124

```solidity

File: Declarations.sol

129: IAggregator internal constant ZERO_AGGREGATOR = IAggregator(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L129

```solidity

File: OracleHelper.sol

37: IAggregator tokenAggregator = IAggregator(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L37

```solidity

File: AaveHelper.sol

173: IERC20 token = IERC20(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L173

### [N-68]<a name="n-68"></a> Missing Contract-existence Checks Before Low-level Calls

Low-level calls return success if there is no code present at the specified address. 

*There are 8 instance(s) of this issue:*

```solidity

File: WiseCore.sol

676: _data.caller,

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L676

```solidity

File: WiseLending.sol

1267: data.caller = msg.sender;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1267

```solidity

File: WiseLending.sol

1333: data.caller = _caller;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1333

```solidity

File: SendValueHelper.sol

27: ) = payable(_recipient).call{

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L27

```solidity

File: OracleHelper.sol

78: (bool success, ) = _tokenAggregator.call(

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L78

```solidity

File: WiseSecurity.sol

208: ) = curvePool.call{value: 0} (

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L208

```solidity

File: WiseSecurity.sol

225: ) = curveMeta.call{value: 0} (

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L225

```solidity

File: AaveHelper.sol

208: (bool success, ) = payable(_recipient).call{

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L208

### [N-69]<a name="n-69"></a> Missing event for critical parameter change

When changing state variables events are not emitted. Emitting events allows monitoring activities with off-chain monitoring tools.

*There are 22 instance(s) of this issue:*

```solidity

File: PoolManager.sol

25: function setParamsLASA(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L26

```solidity

File: PoolManager.sol

100: function setPoolParameters(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L101

```solidity

File: PoolManager.sol

125: function setVerifiedIsolationPool(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L126

```solidity

File: PositionNFTs.sol

319: function setBaseURI(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L320

```solidity

File: PositionNFTs.sol

328: function setBaseExtension(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L329

```solidity

File: WiseLending.sol

1386: function setRegistrationIsolationPool(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1387

```solidity

File: WiseLendingDeclaration.sol

140: function setSecurity(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L141

```solidity

File: WiseLowLevelHelper.sol

424: function setPoolFee(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L425

```solidity

File: CustomOracleSetup.sol

33: function setLastUpdateGlobal(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L34

```solidity

File: CustomOracleSetup.sol

42: function setRoundData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L43

```solidity

File: CustomOracleSetup.sol

52: function setGlobalAggregatorRoundId(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L53

```solidity

File: FeeManager.sol

49: function setRepayBadDebtIncentive(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L50

```solidity

File: FeeManager.sol

82: function setAaveFlagBulk(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L83

```solidity

File: PendlePowerFarmToken.sol

592: function changeMintFee(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L593

```solidity

File: PowerFarmNFTs.sol

51: function setFarmContract(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L52

```solidity

File: PowerFarmNFTs.sol

161: function setBaseURI(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L162

```solidity

File: PowerFarmNFTs.sol

170: function setBaseExtension(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L171

```solidity

File: WiseSecurity.sol

980: function setBlacklistToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L981

```solidity

File: WiseSecurity.sol

995: function setSecurityWorker(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L996

```solidity

File: WiseSecurity.sol

1111: function changeMinDepositValue(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1112

```solidity

File: AaveHub.sol

64: function setAaveTokenAddressBulk(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L65

```solidity

File: Declarations.sol

105: function setWiseSecurity(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L106

### [N-70]<a name="n-70"></a> Missing/malformed underscores for large numeric literals

Large hardcoded numbers in code can be difficult to read. Consider using underscores for number literals to improve readability (e.g `1234567` -> `1_234_567`). Consider using an underscore for every third digit from the right.

*There are 1 instance(s) of this issue:*

```solidity

File: WiseLendingDeclaration.sol

307: uint256 internal constant NORMALISATION_FACTOR = 4838400;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L307

### [N-71]<a name="n-71"></a> Missing NatSpec `@dev` from event declaration

Some events have an incomplete NatSpec: add a @notice notation to describe the event to improve the code documentation.

*There are 63 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

48: event MasterProposed(

53: event RenouncedOwnership(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L48, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L53

```solidity

File: WiseLendingDeclaration.sol

35: event FundsDeposited(

44: event FundsSolelyDeposited(

52: event FundsWithdrawn(

61: event FundsWithdrawnOnBehalf(

70: event FundsSolelyWithdrawn(

78: event FundsBorrowed(

87: event FundsBorrowedOnBehalf(

96: event FundsReturned(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L96, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L87, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L78, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L70, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L52, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L61, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L44, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L35

```solidity

File: FeeManagerEvents.sol

7: event ClaimedFeesWiseBulk(

11: event PoolTokenRemoved(

16: event PoolTokenAdded(

21: event IncentiveOwnerBChanged(

26: event IncentiveOwnerAChanged(

31: event ClaimedOwnershipIncentiveMaster(

36: event IncentiveMasterProposed(

41: event PoolFeeChanged(

47: event ClaimedIncentives(

54: event ClaimedIncentivesBulk(

58: event IncentiveIncreasedB(

63: event IncentiveIncreasedA(

68: event BadDebtIncreasedLiquidation(

73: event TotalBadDebtIncreased(

78: event TotalBadDebtDecreased(

83: event SetBadDebtPosition(

89: event UpdateBadDebtPosition(

95: event SetBeneficial(

101: event RevokeBeneficial(

107: event ClaimedFeesWise(

113: event ClaimedFeesBeneficial(

120: event PayedBackBadDebt(

129: event PayedBackBadDebtFree(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L83, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L129, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L120, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L113, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L107, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L101, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L95, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L54, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L58, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L63, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L68, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L73, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L78, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L89, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L16, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L21, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L26, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L31, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L36, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L41

```solidity

File: PendlePowerFarmDeclarations.sol

110: event FarmEntry(

118: event FarmExit(

125: event FarmStatus(

130: event ManualPaybackShares(

137: event ManualWithdrawShares(

144: event MinDepositChange(

149: event ETHReceived(

154: event RegistrationFarm(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L110, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L118, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L125, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L130, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L137, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L149, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L154

```solidity

File: PendlePowerFarmControllerBase.sol

135: event ETHReceived(

140: event ChangeExchangeIncentive(

144: event WithdrawLp(

150: event ExchangeRewardsForCompounding(

157: event ExchangeLpFeesForPendle(

164: event AddPendleMarket(

169: event UpdateRewardTokens(

174: event ChangeMintFee(

179: event LockPendle(

188: event ClaimArb(

194: event IncreaseReservedForCompound(

199: event ClaimVoteRewards(

205: event WithdrawLock(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L140, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L135, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L150, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L157, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L164, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L169, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L174, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L179, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L188, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L194, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L199, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L205

```solidity

File: MinterReserver.sol

153: event ERC721Received(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L153

```solidity

File: WiseSecurityDeclarations.sol

47: event SecurityShutdown(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L47

```solidity

File: AaveEvents.sol

7: event SetAaveTokenAddress(

13: event IsDepositAave(

18: event IsWithdrawAave(

23: event IsBorrowAave(

28: event IsPaybackAave(

33: event IsSolelyDepositAave(

38: event IsSolelyWithdrawAave(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L18, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L23, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L28, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L13

### [N-72]<a name="n-72"></a> Missing NatSpec `@dev` from function declaration

Some functions have an incomplete NatSpec: add a `@dev` notation to describe the function to improve the code documentation.

*There are 516 instance(s) of this issue:*

```solidity

File: MainHelper.sol

17: function calculateLendingShares(

33: function _calculateShares(

55: function calculateBorrowShares(

79: function cashoutAmount(

93: function _cashoutAmount(

114: function paybackAmount(

135: function _preparationsWithdraw(

163: function _getValueUtilization(

187: function _updateUtilization(

202: function _checkCleanUp(

232: function _validateIsolationPoolLiquidation(

258: function _checkLiquidatorNft(

278: function _getBalance(

298: function _cleanUp(

350: function _getAllowedDifference(

372: function _preparePool(

391: function _preparationTokens(

417: function _prepareTokens(

454: function _curveSecurityChecks(

473: function _whileLoopCurveSecurity(

500: function _updatePseudoTotalAmounts(

584: function _increasePositionLendingDeposit(

599: function _decreaseLendingShares(

614: function _addPositionTokenData(

647: function _getHash(

667: function _removePositionData(

733: function _deleteLastPositionLendingData(

752: function _corePayback(

794: function _deleteLastPositionBorrowData(

814: function isUncollateralized(

830: function _checkLendingDataEmpty(

851: function _calculateNewBorrowRate(

877: function _newBorrowRate(

896: function _aboveThreshold(

911: function _scalingAlgorithm(

947: function _newMaxPoolShares(

969: function _saveUp(

987: function _resonanceOutcome(

1006: function _resetResonanceFactor(

1045: function _updateResonanceFactor(

1094: function _increaseResonanceFactor(

1125: function _decreaseResonanceFactor(

1155: function _removeEmptyLendingData(

1184: function _updatePoolStorage(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L947, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L911, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L896, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L877, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L851, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L830, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L17, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L33, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L55, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L79, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L93, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L114, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L135, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L163, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L187, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L202, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L232, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L258, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L278, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L298, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L350, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L372, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L391, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L417, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L454, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L473, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L500, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L584, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L599, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L614, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L647, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L667, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L733, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L752, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L814, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L794, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1094, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1045, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1006, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L987, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1155, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1125, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1184, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L969

```solidity

File: OwnableMaster.sol

21: function _onlyMaster()

37: function _onlyProposed()

70: function proposeOwner(

92: function claimOwnership()

103: function renounceOwnership()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L103, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L21, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L37, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L70, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L92

```solidity

File: PoolManager.sol

25: function setParamsLASA(

100: function setPoolParameters(

135: function createPool(

146: function createCurvePool(

164: function _createPool(

277: function _getPoleValue(

293: function _getDeltaPole(

304: function _getStartValue(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L100, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L135, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L146, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L164, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L304, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L277, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L293, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L25

```solidity

File: PositionNFTs.sol

54: function assignReserveRole(

64: function blockReservePublic()

71: function forwardFeeManagerNFT(

90: function reservePosition()

99: function reservePositionForUser(

111: function _reservePositionForUser(

130: function getNextExpectedId()

142: function mintPosition()

174: function mintPositionForUser(

193: function _mintPositionForUser(

222: function isOwner(

245: function approveMint(

328: function setBaseExtension(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L64, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L130, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L142, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L174, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L222, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L193, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L245, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L328, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L111, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L99, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L90, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L71, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L54

```solidity

File: WiseCore.sol

15: function _prepareAssociatedTokens(

44: function _coreWithdrawToken(

106: function _handleDeposit(

173: function checkPositionLocked(

193: function _checkPositionLocked(

215: function checkDeposit(

236: function _checkDeposit(

271: function _checkAllowDeposit(

294: function _checkMaxDepositValue(

316: function _coreWithdrawBare(

349: function _coreBorrowTokens(

428: function _withdrawPureCollateralLiquidation(

460: function _withdrawOrAllocateSharesLiquidation(

543: function _calculateReceiveAmount(

604: function _calculatePotentialPureExtraCashout(

625: function _coreLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L316, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L460, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L543, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L604, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L625, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L15, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L44, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L106, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L173, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L193, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L215, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L236, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L271, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L294, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L349, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L428

```solidity

File: WiseLending.sol

77: function _healthStateCheck(

128: function _emitFundsSolelyWithdrawn(

145: function _emitFundsSolelyDeposited(

192: function _checkHealthState(

210: function _compareSharePrices(

255: function _getCurrentSharePriceMax(

275: function _syncPoolBeforeCodeExecution(

308: function _syncPoolAfterCodeExecution(

388: function depositExactAmountETH(

401: function _depositExactAmountETH(

426: function depositExactAmountETHMint()

442: function depositExactAmountMint(

460: function depositExactAmount(

493: function solelyDepositETHMint()

508: function solelyDepositETH(

539: function _handleSolelyDeposit(

581: function solelyDepositMint(

600: function solelyDeposit(

636: function withdrawExactAmountETH(

675: function withdrawExactSharesETH(

714: function withdrawExactAmount(

751: function solelyWithdrawETH(

780: function solelyWithdraw(

808: function _coreSolelyWithdraw(

859: function withdrawOnBehalfExactAmount(

902: function withdrawExactShares(

939: function withdrawOnBehalfExactShares(

975: function borrowExactAmountETH(

1016: function borrowExactAmount(

1055: function borrowOnBehalfExactAmount(

1088: function paybackExactAmountETH(

1161: function paybackExactAmount(

1204: function paybackExactShares(

1250: function liquidatePartiallyFromTokens(

1367: function syncManually(

1386: function setRegistrationIsolationPool(

1412: function corePaybackFeeManager(

1434: function _handlePayback(

1460: function _handleWithdrawAmount(

1489: function _handleSolelyWithdraw(

1517: function _handleWithdrawShares(

1553: function _handleBorrowExactAmount(

1588: function _reservePosition()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L751, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L675, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L77, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L808, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L780, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L714, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L975, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L939, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L902, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L308, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L275, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L255, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L210, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L192, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L145, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L128, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L859, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L426, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L442, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L460, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L493, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L508, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L539, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L581, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L600, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L636, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1016, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L388, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1055, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1088, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1161, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1204, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L401, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1250, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1367, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1386, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1412, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1434, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1460, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1489, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1517, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1553, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1588

```solidity

File: WiseLendingDeclaration.sol

140: function setSecurity(

257: function _onlyAaveHub()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L140, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L257

```solidity

File: WiseLowLevelHelper.sol

14: function _onlyFeeManager()

25: function _validateParameter(

39: function getTotalPool(

49: function getPseudoTotalPool(

59: function getTotalBareToken(

69: function getPseudoTotalBorrowAmount(

79: function getTotalDepositShares(

89: function getTotalBorrowShares(

99: function getPositionLendingShares(

110: function getPositionBorrowShares(

121: function getPureCollateralAmount(

134: function getTimeStamp(

144: function getPositionLendingTokenByIndex(

155: function getPositionLendingTokenLength(

165: function getPositionBorrowTokenByIndex(

176: function getPositionBorrowTokenLength(

188: function _setMaxValue(

197: function _setBestPole(

206: function _setIncreasePole(

215: function _setPole(

224: function _increaseTotalPool(

233: function _decreaseTotalPool(

242: function _increaseTotalDepositShares(

251: function _decreaseTotalDepositShares(

260: function _increasePseudoTotalBorrowAmount(

269: function _decreasePseudoTotalBorrowAmount(

278: function _increaseTotalBorrowShares(

287: function _decreaseTotalBorrowShares(

296: function _increasePseudoTotalPool(

305: function _decreasePseudoTotalPool(

314: function _setTimeStamp(

323: function _setTimeStampScaling(

332: function _increaseTotalBareToken(

341: function _decreaseTotalBareToken(

350: function _checkReentrancy()

363: function _sendingProgressAaveHub()

371: function _decreasePositionMappingValue(

382: function _increaseMappingValue(

393: function _byPassCase(

407: function _increaseTotalAndPseudoTotalPool(

424: function setPoolFee(

434: function _checkOwnerPosition(

447: function _validateNonZero(

458: function _validateZero(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L14, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L25, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L39, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L49, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L59, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L69, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L79, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L89, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L99, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L110, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L121, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L134, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L155, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L165, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L176, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L188, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L197, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L206, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L215, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L224, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L233, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L242, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L251, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L260, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L269, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L278, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L287, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L296, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L305, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L314, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L323, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L332, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L341, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L350, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L363, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L371, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L382, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L393, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L407, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L424, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L434, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L447, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L458

```solidity

File: CustomOracleSetup.sol

26: function renounceOwnership()

33: function setLastUpdateGlobal(

42: function setRoundData(

52: function setGlobalAggregatorRoundId(

61: function getTimeStamp()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L26, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L33, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L42, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L52, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L61

```solidity

File: PendleChildLpOracle.sol

35: function latestAnswer()

47: function decimals()

55: function latestRoundData()

78: function getRoundData(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L35, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L55, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L78

```solidity

File: PendleLpOracle.sol

83: function latestAnswer()

122: function _getLpToAssetRateWrapper(

151: function latestRoundData()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L83, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L122, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L151

```solidity

File: PtOracleDerivative.sol

81: function latestAnswer()

146: function latestRoundData()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L81, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L146

```solidity

File: PtOraclePure.sol

68: function latestAnswer()

125: function latestRoundData()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L68, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L125

```solidity

File: DeclarationsFeeManager.sol

191: function _onlyIncentiveMaster()

202: function _onlyWiseSecurity()

213: function _onlyWiseLending()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L191, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L202, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L213

```solidity

File: FeeManager.sol

49: function setRepayBadDebtIncentive(

66: function setAaveFlag(

108: function setPoolFee(

135: function setPoolFeeBulk(

173: function proposeIncentiveMaster(

214: function increaseIncentiveA(

232: function increaseIncentiveB(

315: function changeIncentiveUSDA(

352: function changeIncentiveUSDB(

390: function addPoolTokenAddress(

412: function addPoolTokenAddressManual(

438: function removePoolTokenManual(

494: function increaseTotalBadDebtLiquidation(

514: function setBadDebtUserLiquidation(

538: function setBeneficial(

571: function revokeBeneficial(

628: function claimWiseFees(

689: function claimFeesBeneficial(

730: function paybackBadDebtForToken(

816: function paybackBadDebtNoReward(

872: function getPoolTokenAddressesLength()

884: function getPoolTokenAdressesByIndex(

898: function syncAllPools()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L49, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L66, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L108, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L135, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L173, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L214, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L232, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L315, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L352, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L390, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L412, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L438, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L494, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L514, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L538, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L571, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L628, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L689, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L730, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L816, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L872, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L884, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L898

```solidity

File: FeeManagerHelper.sol

15: function _prepareBorrows(

47: function _prepareCollaterals(

134: function _updateUserBadDebt(

195: function _increaseFeeTokens(

208: function _decreaseFeeTokens(

230: function _setAaveFlag(

244: function getReceivingToken(

270: function updatePositionCurrentBadDebt(

292: function _distributeIncentives(

330: function _gatherIncentives(

383: function _checkValue(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L15, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L134, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L195, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L208, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L230, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L244, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L270, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L292, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L330, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L383

```solidity

File: PendlePowerFarm.sol

15: function getApproxNetAPY(

41: function getNewBorrowRate(

57: function getLiveDebtRatio(

93: function liquidatePartiallyFromToken(

119: function _manuallyPaybackShares(

157: function _manuallyWithdrawShares(

185: function _openPosition(

230: function _closingPosition(

274: function _registrationFarm(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L15, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L41, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L57, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L93, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L119, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L157, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L185, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L230, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L274

```solidity

File: PendlePowerFarmDeclarations.sol

266: function doApprovals()

274: function _doApprovals(

361: function _isActive()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L266, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L274, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L361

```solidity

File: PendlePowerFarmLeverageLogic.sol

15: function _executeBalancerFlashLoan(

59: function receiveFlashLoan(

232: function _getEthBack(

264: function _getTokensUniV3(

293: function _swapStETHintoETH(

310: function _withdrawPendleLPs(

326: function _paybackExactShares(

354: function _closingRouteToken(

383: function _closingRouteETH(

414: function _logicOpenPosition(

531: function _borrowExactAmount(

560: function _coreLiquidation(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L15, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L59, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L232, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L264, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L293, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L310, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L326, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L354, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L383, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L414, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L531, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L560

```solidity

File: PendlePowerFarmMathLogic.sol

19: function _updatePools()

35: function _checkReentrancy()

57: function _getPositionBorrowShares(

75: function _getPositionBorrowSharesAave(

92: function _getPositionBorrowTokenAmount(

111: function _getPositionBorrowTokenAmountAave(

136: function _getPositionLendingShares(

153: function _getPostionCollateralTokenAmount(

174: function getPositionBorrowETH(

229: function getTotalWeightedCollateralETH(

244: function _getTokensInETH(

258: function _getEthInTokens(

272: function getLeverageAmount(

289: function _getApproxNetAPY(

344: function _getNewBorrowRate(

389: function _checkDebtRatio(

416: function _notBelowMinDepositAmount(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L19, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L35, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L57, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L75, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L92, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L111, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L136, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L153, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L174, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L229, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L244, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L258, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L272, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L289, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L344, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L389, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L416

```solidity

File: PendlePowerManager.sol

63: function changeMinDeposit(

82: function shutDownFarm(

96: function enterFarm(

142: function enterFarmETH(

185: function _getWiseLendingNFT()

210: function exitFarm(

254: function manuallyPaybackShares(

274: function manuallyWithdrawShares(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L63, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L82, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L96, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L142, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L185, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L210, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L254, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L274

```solidity

File: PendlePowerFarmController.sol

32: function withdrawLp(

53: function exchangeRewardsForCompoundingWithIncentive(

113: function exchangeLpFeesForPendleWithIncentive(

172: function skim(

211: function addPendleMarket(

293: function updateRewardTokens(

321: function changeExchangeIncentive(

334: function changeMintFee(

431: function claimArb(

451: function withdrawLock()

497: function increaseReservedForCompound(

526: function overWriteIndex(

544: function overWriteIndexAll(

566: function overWriteAmounts(

581: function claimVoteRewards(

600: function forwardETH(

612: function vote(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L600, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L32, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L53, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L113, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L172, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L211, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L293, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L321, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L334, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L431, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L451, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L497, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L526, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L544, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L566, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L581, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L612

```solidity

File: PendlePowerFarmControllerBase.sol

236: function _onlyArbitrum()

245: function _onlyChildContract(

256: function _syncSupply(

272: function syncAllSupply()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L245, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L236, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L256, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L272

```solidity

File: PendlePowerFarmControllerHelper.sol

9: function _findIndex(

32: function _calcExpiry(

45: function _getExpiry()

53: function _getLockAmount()

61: function _getPositionData(

73: function _getAmountToSend(

95: function pendleChildCompoundInfoReservedForCompound(

105: function pendleChildCompoundInfoLastIndex(

115: function pendleChildCompoundInfoRewardTokens(

125: function activePendleMarketsLength()

133: function _checkFeed(

144: function _getRewardTokens(

156: function _getUserReward(

173: function _getUserRewardIndex(

189: function _getTokensInETH(

203: function _getTokensFromETH(

217: function _compareHashes(

236: function _setRewardTokens(

245: function getExpiry()

253: function getLockAmount()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L53, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L61, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L73, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L95, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L105, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L115, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L125, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L133, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L156, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L173, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L189, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L203, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L217, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L236, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L253, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L245, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L32, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L45

```solidity

File: PendlePowerFarmToken.sol

72: function _onlyController()

98: function _validateSharePrice(

114: function _validateSharePriceGrowth(

132: function _overWriteCheck()

140: function _triggerIndexUpdate()

149: function _wrapOverWrites(

160: function _updateRewardTokens()

169: function _overWriteIndexAll()

177: function _overWriteIndex(

188: function _overWriteAmounts()

196: function _updateRewards()

218: function _calculateRewardsClaimedOutside()

305: function _getBalanceLpBalanceController()

315: function _getActiveBalance()

325: function _getSharePrice()

334: function _syncSupply()

347: function _increaseCardinalityNext()

359: function _withdrawLp(

372: function _getUserReward(

386: function previewDistribution()

416: function _setLastInteraction()

422: function _applyMintFee(

434: function totalLpAssets()

443: function previewUnderlyingLpAssets()

452: function previewMintShares(

465: function previewAmountWithdrawShares(

478: function previewBurnShares(

494: function manualSync()

502: function addCompoundRewards(

592: function changeMintFee(

647: function withdrawExactAmount(

682: function initialize(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L434, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L72, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L98, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L114, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L132, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L140, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L149, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L160, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L169, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L177, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L188, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L196, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L218, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L305, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L315, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L325, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L334, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L347, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L359, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L372, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L386, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L416, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L422, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L443, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L452, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L465, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L478, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L494, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L502, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L592, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L647, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L682

```solidity

File: PendlePowerFarmTokenFactory.sol

35: function deploy(

56: function _clone(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L35, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L56

```solidity

File: MinterReserver.sol

41: function _onlyKeyOwner(

63: function _incrementReserved()

70: function _getNextReserveKey()

77: function _reserveKey(

96: function isOwner(

115: function _mintKeyForUser(

141: function mintReserved()

160: function onERC721Received(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L141, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L41, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L63, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L70, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L77, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L96, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L115, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L160

```solidity

File: PowerFarmNFTs.sol

16: function reservedKeys(

51: function setFarmContract(

66: function mintKey(

93: function checkOwner(

170: function setBaseExtension(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L93, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L16, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L51, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L66, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L170

```solidity

File: ApprovalHelper.sol

13: function _safeApprove(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L13

```solidity

File: SendValueHelper.sol

12: function _sendValue(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L12

```solidity

File: TransferHelper.sol

13: function _safeTransfer(

34: function _safeTransferFrom(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L34

```solidity

File: WrapperHelper.sol

24: function _wrapETH(

38: function _unwrapETH(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L24, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L38

```solidity

File: OracleHelper.sol

32: function _addAggregator(

60: function _checkFunctionExistence(

87: function _compareMinMax(

106: function latestResolverTwap(

131: function _validateAnswer(

216: function _getRelativeDifference(

235: function _compareDifference(

246: function _getChainlinkAnswer(

265: function getETHPriceInUSD()

283: function _getPool(

303: function _validateTokenAddress(

324: function _validatePoolAddress(

344: function _validatePriceFeed(

359: function _validateTwapOracle(

374: function _getTwapPrice(

394: function _getOneUnit(

406: function _getAverageTick(

450: function decimals(

460: function _getTwapDerivatePrice(

507: function _recalibrate(

521: function sequencerIsDead()

556: function _chainLinkIsDead(

592: function _recalibratePreview(

658: function _getIterationCount(

674: function _getRoundTimestamp(

699: function getLatestRoundId(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L450, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L32, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L60, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L87, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L106, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L131, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L216, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L235, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L246, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L265, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L283, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L303, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L324, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L344, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L359, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L374, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L394, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L406, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L460, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L507, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L521, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L556, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L592, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L658, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L674, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L699

```solidity

File: WiseOracleHub.sol

24: * mandatory to wrap its answer into a function mimicking {latestRoundData}

69: function latestResolver(

85: function getTokenDecimals(

96: function getTokensInUSD(

123: function getTokensPriceInUSD(

143: function getTokensInETH(

171: function getTokensFromUSD(

198: function getTokensPriceFromUSD(

218: function addTwapOracle(

266: function addTwapOracleDerivative(

327: function getTokensFromETH(

359: function addOracle(

379: function addOracleBulk(

403: function addAggregator(

419: function recalibratePreview(

439: function chainLinkIsDead(

487: function recalibrate(

501: function recalibrateBulk(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L24, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L69, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L85, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L96, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L123, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L143, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L171, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L198, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L218, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L266, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L327, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L359, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L379, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L403, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L419, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L439, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L487, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L501

```solidity

File: WiseSecurity.sol

31: function _onlyWiseLending()

59: function getLiveDebtRatio(

85: function setLiquidationSettings(

193: function curveSecurityCheck(

388: function checkHealthState(

405: function checkBadDebtLiquidation(

442: function overallLendingAPY(

499: function overallBorrowAPY(

556: function overallNetAPY(

641: function safeLimitPosition(

695: function positionBlackListToken(

764: function maximumWithdrawToken(

826: function maximumWithdrawTokenSolely(

868: function maximumBorrowToken(

906: function getExpectedPaybackAmount(

943: function getExpectedLendingAmount(

980: function setBlacklistToken(

995: function setSecurityWorker(

1006: * Safety function to perform a security

1011: function securityShutdown()

1032: function revokeShutdown()

1045: function checkPoolCondition(

1060: function checkPoolWithMinDeposit(

1078: function checkMinDepositValue(

1092: function _checkMinDepositValue(

1111: function changeMinDepositValue(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L31, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L59, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L85, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L193, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L388, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L405, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L442, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L499, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L556, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L641, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L695, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L764, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L826, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L868, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L906, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L943, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L980, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L995, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1006, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1011, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1032, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1045, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1060, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1078, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1092, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1111

```solidity

File: WiseSecurityDeclarations.sol

118: function _setLiquidationSettings(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L118

```solidity

File: WiseSecurityHelper.sol

15: function overallETHCollateralsBoth(

65: function overallETHCollateralsWeighted(

107: function overallETHCollateralsBare(

145: function _overallETHCollateralsWeighted(

190: function getFullCollateralETH(

224: function _isUncollateralized(

246: function _getCollateralOfTokenETHUpdated(

281: function getETHCollateralUpdated(

323: function getETHCollateral(

340: function _getTokensInEth(

360: function overallETHBorrowBare(

394: function overallETHBorrowHeartbeat(

430: function overallETHBorrow(

470: function _checkBlacklisted(

486: function _overallETHBorrow(

530: function _getUpdatedPseudoBorrow(

554: function _getUpdatedPseudoPool(

578: function _getInterest(

610: function _getETHBorrowUpdated(

651: function getETHBorrow(

672: function checkTokenAllowed(

687: function checkHeartbeat(

701: function _checkPositionLocked(

716: function checkMaxFee(

736: function _checkMaxFee(

760: function calculateWishPercentage(

794: function _checkHealthState(

806: function _getState(

837: function checksRegister(

859: function canLiquidate(

876: function checkMaxShares(

906: function checkBadDebtThreshold(

922: function getPositionLendingAmount(

945: function getPositionBorrowAmount(

966: function checkOwnerPosition(

985: function getBorrowRate(

999: function getLendingRate(

1029: function _getPossibleWithdrawAmount(

1057: function _setPoolState(

1096: function _checkSuccess(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L15, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L65, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L107, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L145, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L190, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L224, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L246, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L281, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L323, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L340, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L360, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L394, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L430, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L470, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L486, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L530, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L554, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L578, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L610, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L651, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L672, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L687, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L701, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L716, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L736, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L760, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L794, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L806, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L837, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L859, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L876, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L906, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L922, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L945, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L966, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L985, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L999, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1029, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1057, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1096

```solidity

File: AaveHelper.sol

23: function _validToken(

34: function _nonReentrantCheck()

47: function _reservePosition()

56: function _wrapDepositExactAmount(

83: function _wrapWithdrawExactAmount(

113: function _wrapWithdrawExactShares(

141: function _wrapBorrowExactAmount(

165: function _wrapAaveReturnValueDeposit(

196: function _sendValue(

219: function _getInfoPayback(

243: function _prepareCollaterals(

279: function _prepareBorrows(

315: function getAavePoolAPY(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L279, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L23, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L34, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L56, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L83, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L113, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L141, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L165, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L196, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L219, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L243, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L315

```solidity

File: AaveHub.sol

44: function setAaveTokenAddress(

64: function setAaveTokenAddressBulk(

103: function depositExactAmountMint(

122: function depositExactAmount(

158: function depositExactAmountETHMint()

172: function depositExactAmountETH(

202: function withdrawExactAmount(

238: function withdrawExactAmountETH(

281: function withdrawExactShares(

314: function withdrawExactSharesETH(

357: function borrowExactAmount(

393: function borrowExactAmountETH(

433: function paybackExactAmount(

482: function paybackExactAmountETH(

556: function paybackExactShares(

611: function skimAave(

635: function getLendingRate(

664: function _setAaveTokenAddress(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L44, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L64, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L103, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L122, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L158, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L172, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L202, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L238, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L281, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L314, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L357, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L393, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L433, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L482, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L556, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L611, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L635, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L664

```solidity

File: Declarations.sol

81: function _checkOwner(

93: function _checkPositionLocked(

105: function setWiseSecurity(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L81, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L93, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L105

### [N-73]<a name="n-73"></a> Missing NatSpec `@dev` from modifier declaration

Some modifiers have an incomplete NatSpec: add a `@dev` notation to describe the modifier to improve the code documentation.

*There are 23 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

16: modifier onlyProposed() {

32: modifier onlyMaster() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L16, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L32

```solidity

File: PositionNFTs.sol

45: modifier onlyReserveRole() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L45

```solidity

File: WiseLending.sol

67: modifier healthStateCheck(

97: modifier syncPool(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L67, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L97

```solidity

File: WiseLendingDeclaration.sol

252: modifier onlyAaveHub() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L252

```solidity

File: WiseLowLevelHelper.sol

9: modifier onlyFeeManager() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L9

```solidity

File: CustomOracleSetup.sol

14: modifier onlyOwner() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L14

```solidity

File: DeclarationsFeeManager.sol

176: modifier onlyWiseSecurity() {

181: modifier onlyWiseLending() {

186: modifier onlyIncentiveMaster() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L176, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L181, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L186

```solidity

File: PendlePowerFarmDeclarations.sol

356: modifier isActive() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L356

```solidity

File: PendlePowerFarmMathLogic.sol

9: modifier updatePools() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L9

```solidity

File: PendlePowerFarmControllerBase.sol

210: modifier syncSupply(

220: modifier onlyChildContract(

230: modifier onlyArbitrum()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L210, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L220, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L230

```solidity

File: PendlePowerFarmToken.sol

67: modifier onlyController() {

81: modifier syncSupply()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L67, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L81

```solidity

File: MinterReserver.sol

32: modifier onlyKeyOwner(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L32

```solidity

File: PowerFarmNFTs.sol

30: modifier onlyFarmContract() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L30

```solidity

File: WiseSecurity.sol

26: modifier onlyWiseLending() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L26

```solidity

File: AaveHelper.sol

9: modifier nonReentrant() {

14: modifier validToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L14

### [N-74]<a name="n-74"></a> Missing NatSpec `@notice` from event declaration

Some events have an incomplete NatSpec: add a `@dev` notation to describe the event to improve the code documentation.

*There are 64 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

48: event MasterProposed(

53: event RenouncedOwnership(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L48, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L53

```solidity

File: WiseCore.sol

104: * logic, security checks and event emit.



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L104

```solidity

File: WiseLendingDeclaration.sol

35: event FundsDeposited(

44: event FundsSolelyDeposited(

52: event FundsWithdrawn(

61: event FundsWithdrawnOnBehalf(

70: event FundsSolelyWithdrawn(

78: event FundsBorrowed(

87: event FundsBorrowedOnBehalf(

96: event FundsReturned(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L35, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L44, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L52, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L61, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L70, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L78, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L87, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L96

```solidity

File: FeeManagerEvents.sol

7: event ClaimedFeesWiseBulk(

11: event PoolTokenRemoved(

16: event PoolTokenAdded(

21: event IncentiveOwnerBChanged(

26: event IncentiveOwnerAChanged(

31: event ClaimedOwnershipIncentiveMaster(

36: event IncentiveMasterProposed(

41: event PoolFeeChanged(

47: event ClaimedIncentives(

54: event ClaimedIncentivesBulk(

58: event IncentiveIncreasedB(

63: event IncentiveIncreasedA(

68: event BadDebtIncreasedLiquidation(

73: event TotalBadDebtIncreased(

78: event TotalBadDebtDecreased(

83: event SetBadDebtPosition(

89: event UpdateBadDebtPosition(

95: event SetBeneficial(

101: event RevokeBeneficial(

107: event ClaimedFeesWise(

113: event ClaimedFeesBeneficial(

120: event PayedBackBadDebt(

129: event PayedBackBadDebtFree(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L16, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L21, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L26, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L31, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L36, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L41, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L54, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L58, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L63, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L68, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L73, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L78, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L83, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L89, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L95, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L101, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L107, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L113, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L120, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L129

```solidity

File: PendlePowerFarmDeclarations.sol

110: event FarmEntry(

118: event FarmExit(

125: event FarmStatus(

130: event ManualPaybackShares(

137: event ManualWithdrawShares(

144: event MinDepositChange(

149: event ETHReceived(

154: event RegistrationFarm(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L110, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L118, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L125, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L130, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L137, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L149, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L154

```solidity

File: PendlePowerFarmControllerBase.sol

135: event ETHReceived(

140: event ChangeExchangeIncentive(

144: event WithdrawLp(

150: event ExchangeRewardsForCompounding(

157: event ExchangeLpFeesForPendle(

164: event AddPendleMarket(

169: event UpdateRewardTokens(

174: event ChangeMintFee(

179: event LockPendle(

188: event ClaimArb(

194: event IncreaseReservedForCompound(

199: event ClaimVoteRewards(

205: event WithdrawLock(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L135, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L140, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L144, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L150, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L157, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L164, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L169, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L174, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L179, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L188, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L194, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L199, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L205

```solidity

File: MinterReserver.sol

153: event ERC721Received(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L153

```solidity

File: WiseSecurityDeclarations.sol

47: event SecurityShutdown(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L47

```solidity

File: AaveEvents.sol

7: event SetAaveTokenAddress(

13: event IsDepositAave(

18: event IsWithdrawAave(

23: event IsBorrowAave(

28: event IsPaybackAave(

33: event IsSolelyDepositAave(

38: event IsSolelyWithdrawAave(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L18, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L23, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L28, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38

### [N-75]<a name="n-75"></a> Missing NatSpec `@notice` from modifier declaration

Some modifiers have an incomplete NatSpec: add a `@notice` notation to describe the modifier to improve the code documentation.

*There are 23 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

16: modifier onlyProposed() {

32: modifier onlyMaster() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L16, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L32

```solidity

File: PositionNFTs.sol

45: modifier onlyReserveRole() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L45

```solidity

File: WiseLending.sol

67: modifier healthStateCheck(

97: modifier syncPool(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L67, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L97

```solidity

File: WiseLendingDeclaration.sol

252: modifier onlyAaveHub() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L252

```solidity

File: WiseLowLevelHelper.sol

9: modifier onlyFeeManager() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L9

```solidity

File: CustomOracleSetup.sol

14: modifier onlyOwner() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L14

```solidity

File: DeclarationsFeeManager.sol

176: modifier onlyWiseSecurity() {

181: modifier onlyWiseLending() {

186: modifier onlyIncentiveMaster() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L176, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L181, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L186

```solidity

File: PendlePowerFarmDeclarations.sol

356: modifier isActive() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L356

```solidity

File: PendlePowerFarmMathLogic.sol

9: modifier updatePools() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L9

```solidity

File: PendlePowerFarmControllerBase.sol

210: modifier syncSupply(

220: modifier onlyChildContract(

230: modifier onlyArbitrum()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L210, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L220, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L230

```solidity

File: PendlePowerFarmToken.sol

67: modifier onlyController() {

81: modifier syncSupply()



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L67, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L81

```solidity

File: MinterReserver.sol

32: modifier onlyKeyOwner(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L32

```solidity

File: PowerFarmNFTs.sol

30: modifier onlyFarmContract() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L30

```solidity

File: WiseSecurity.sol

26: modifier onlyWiseLending() {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L26

```solidity

File: AaveHelper.sol

9: modifier nonReentrant() {

14: modifier validToken(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L14

### [N-76]<a name="n-76"></a> Consider using modifiers for address control

Modifiers in Solidity can improve code readability and modularity by encapsulating repetitive checks, such as address validity checks, into a reusable construct. For example, an `onlyOwner` modifier can be used to replace repetitive `require(msg.sender == owner)` checks across several functions, reducing code redundancy and enhancing maintainability. To implement, define a modifier with the check, then apply the modifier to relevant functions.

*There are 10 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

25: if (msg.sender == master) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L25

```solidity

File: OwnableMaster.sol

41: if (msg.sender == proposedMaster) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L41

```solidity

File: WiseLowLevelHelper.sol

18: if (msg.sender == address(FEE_MANAGER)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L18

```solidity

File: DeclarationsFeeManager.sol

195: if (msg.sender == incentiveMaster) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L195

```solidity

File: DeclarationsFeeManager.sol

206: if (msg.sender == address(WISE_SECURITY)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L206

```solidity

File: DeclarationsFeeManager.sol

217: if (msg.sender == address(WISE_LENDING)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L217

```solidity

File: PendlePowerFarmToken.sol

514: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L514

```solidity

File: PendlePowerFarmToken.sol

635: if (msg.sender == PENDLE_POWER_FARM_CONTROLLER) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L635

```solidity

File: WiseSecurity.sol

35: if (msg.sender == address(WISE_LENDING)) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L35

```solidity

File: AaveHub.sol

87: if (msg.sender == WETH_ADDRESS) {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L87

### [N-77]<a name="n-77"></a> Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability

Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related

*There are 37 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

20: mapping(address => uint256) public reserved;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L20

```solidity

File: PositionNFTs.sol

21: mapping(address => bool) public reserveRole;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L21

```solidity

File: WiseLendingDeclaration.sol

267: mapping(address => uint256) internal bufferIncrease;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L267

```solidity

File: WiseLendingDeclaration.sol

268: mapping(address => uint256) public maxDepositValueToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L268

```solidity

File: WiseLendingDeclaration.sol

273: mapping(uint256 => mapping(address => uint256)) public userBorrowShares;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L273

```solidity

File: WiseLendingDeclaration.sol

274: mapping(uint256 => mapping(address => uint256)) public pureCollateralAmount;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L274

```solidity

File: WiseLendingDeclaration.sol

275: mapping(uint256 => mapping(address => LendingEntry)) public userLendingData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L275

```solidity

File: WiseLendingDeclaration.sol

278: mapping(address => BorrowRatesEntry) public borrowRatesData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L278

```solidity

File: WiseLendingDeclaration.sol

279: mapping(address => AlgorithmEntry) public algorithmData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L279

```solidity

File: WiseLendingDeclaration.sol

280: mapping(address => GlobalPoolEntry) public globalPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L280

```solidity

File: WiseLendingDeclaration.sol

281: mapping(address => LendingPoolEntry) public lendingPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L281

```solidity

File: WiseLendingDeclaration.sol

282: mapping(address => BorrowPoolEntry) public borrowPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L282

```solidity

File: WiseLendingDeclaration.sol

283: mapping(address => TimestampsPoolEntry) public timestampsPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L283

```solidity

File: WiseLendingDeclaration.sol

287: mapping(address => bool) internal parametersLocked;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287

```solidity

File: WiseLendingDeclaration.sol

288: mapping(address => bool) public verifiedIsolationPool;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288

```solidity

File: WiseLowLevelHelper.sol

372: mapping(uint256 => mapping(address => uint256)) storage userMapping,

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L372

```solidity

File: WiseLowLevelHelper.sol

383: mapping(uint256 => mapping(address => uint256)) storage userMapping,

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L383

```solidity

File: DeclarationsFeeManager.sol

143: mapping(address => uint256) public feeTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L143

```solidity

File: DeclarationsFeeManager.sol

146: mapping(address => uint256) public incentiveUSD;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L146

```solidity

File: DeclarationsFeeManager.sol

149: mapping(address => bool) public poolTokenAdded;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149

```solidity

File: DeclarationsFeeManager.sol

152: mapping(address => bool) public isAaveToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152

```solidity

File: DeclarationsFeeManager.sol

155: mapping(address => address) public underlyingToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L155

```solidity

File: DeclarationsFeeManager.sol

158: mapping(address => mapping(address => bool)) public allowedTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158

```solidity

File: DeclarationsFeeManager.sol

161: mapping(address => mapping(address => uint256)) public gatheredIncentiveToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L161

```solidity

File: PendlePowerFarmControllerBase.sol

58: mapping(address => address) public pendleChildAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L58

```solidity

File: PendlePowerFarmControllerBase.sol

59: mapping(address => CompoundStruct) pendleChildCompoundInfo;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L59

```solidity

File: Declarations.sol

139: mapping(address => uint8) _tokenDecimals;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L139

```solidity

File: Declarations.sol

142: mapping(address => IPriceFeed) public priceFeed;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L142

```solidity

File: Declarations.sol

145: mapping(address => uint256) public heartBeat;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L145

```solidity

File: Declarations.sol

148: mapping(address => IAggregator) public tokenAggregatorFromTokenAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L148

```solidity

File: Declarations.sol

151: mapping(address => address[]) public underlyingFeedTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L151

```solidity

File: Declarations.sol

154: mapping(address => UniTwapPoolInfo) public uniTwapPoolInfo;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L154

```solidity

File: Declarations.sol

157: mapping(address => DerivativePartnerInfo) public derivativePartnerTwap;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L157

```solidity

File: WiseSecurityDeclarations.sol

238: mapping(address => bool) public wasBlacklisted;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238

```solidity

File: WiseSecurityDeclarations.sol

241: mapping(address => CurveSwapStructData) public curveSwapInfoData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L241

```solidity

File: WiseSecurityDeclarations.sol

244: mapping(address => CurveSwapStructToken) public curveSwapInfoToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L244

```solidity

File: WiseSecurityDeclarations.sol

247: mapping(address => bool) public securityWorker;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247

### [N-78]<a name="n-78"></a> Multiple mappings can be replaced with a single struct mapping

Using a single struct mapping in place of multiple defined mappings in a Solidity contract can lead to improved code organization, better readability, and easier maintainability. By consolidating related data into a single struct, developers can create a more cohesive data structure that logically groups together relevant pieces of information, thus reducing redundancy and clutter. This approach simplifies the codebase, making it easier to understand, navigate, and modify. Additionally, it can result in more efficient gas usage when accessing or updating multiple related data points simultaneously.

*There are 37 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

20: mapping(address => uint256) public reserved;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L20

```solidity

File: PositionNFTs.sol

21: mapping(address => bool) public reserveRole;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L21

```solidity

File: WiseLendingDeclaration.sol

267: mapping(address => uint256) internal bufferIncrease;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L267

```solidity

File: WiseLendingDeclaration.sol

268: mapping(address => uint256) public maxDepositValueToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L268

```solidity

File: WiseLendingDeclaration.sol

273: mapping(uint256 => mapping(address => uint256)) public userBorrowShares;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L273

```solidity

File: WiseLendingDeclaration.sol

274: mapping(uint256 => mapping(address => uint256)) public pureCollateralAmount;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L274

```solidity

File: WiseLendingDeclaration.sol

275: mapping(uint256 => mapping(address => LendingEntry)) public userLendingData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L275

```solidity

File: WiseLendingDeclaration.sol

278: mapping(address => BorrowRatesEntry) public borrowRatesData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L278

```solidity

File: WiseLendingDeclaration.sol

279: mapping(address => AlgorithmEntry) public algorithmData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L279

```solidity

File: WiseLendingDeclaration.sol

280: mapping(address => GlobalPoolEntry) public globalPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L280

```solidity

File: WiseLendingDeclaration.sol

281: mapping(address => LendingPoolEntry) public lendingPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L281

```solidity

File: WiseLendingDeclaration.sol

282: mapping(address => BorrowPoolEntry) public borrowPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L282

```solidity

File: WiseLendingDeclaration.sol

283: mapping(address => TimestampsPoolEntry) public timestampsPoolData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L283

```solidity

File: WiseLendingDeclaration.sol

287: mapping(address => bool) internal parametersLocked;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287

```solidity

File: WiseLendingDeclaration.sol

288: mapping(address => bool) public verifiedIsolationPool;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L288

```solidity

File: WiseLowLevelHelper.sol

372: mapping(uint256 => mapping(address => uint256)) storage userMapping,

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L372

```solidity

File: WiseLowLevelHelper.sol

383: mapping(uint256 => mapping(address => uint256)) storage userMapping,

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L383

```solidity

File: DeclarationsFeeManager.sol

143: mapping(address => uint256) public feeTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L143

```solidity

File: DeclarationsFeeManager.sol

146: mapping(address => uint256) public incentiveUSD;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L146

```solidity

File: DeclarationsFeeManager.sol

149: mapping(address => bool) public poolTokenAdded;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L149

```solidity

File: DeclarationsFeeManager.sol

152: mapping(address => bool) public isAaveToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L152

```solidity

File: DeclarationsFeeManager.sol

155: mapping(address => address) public underlyingToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L155

```solidity

File: DeclarationsFeeManager.sol

158: mapping(address => mapping(address => bool)) public allowedTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L158

```solidity

File: DeclarationsFeeManager.sol

161: mapping(address => mapping(address => uint256)) public gatheredIncentiveToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L161

```solidity

File: PendlePowerFarmControllerBase.sol

58: mapping(address => address) public pendleChildAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L58

```solidity

File: PendlePowerFarmControllerBase.sol

59: mapping(address => CompoundStruct) pendleChildCompoundInfo;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L59

```solidity

File: Declarations.sol

139: mapping(address => uint8) _tokenDecimals;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L139

```solidity

File: Declarations.sol

142: mapping(address => IPriceFeed) public priceFeed;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L142

```solidity

File: Declarations.sol

145: mapping(address => uint256) public heartBeat;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L145

```solidity

File: Declarations.sol

148: mapping(address => IAggregator) public tokenAggregatorFromTokenAddress;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L148

```solidity

File: Declarations.sol

151: mapping(address => address[]) public underlyingFeedTokens;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L151

```solidity

File: Declarations.sol

154: mapping(address => UniTwapPoolInfo) public uniTwapPoolInfo;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L154

```solidity

File: Declarations.sol

157: mapping(address => DerivativePartnerInfo) public derivativePartnerTwap;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L157

```solidity

File: WiseSecurityDeclarations.sol

238: mapping(address => bool) public wasBlacklisted;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L238

```solidity

File: WiseSecurityDeclarations.sol

241: mapping(address => CurveSwapStructData) public curveSwapInfoData;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L241

```solidity

File: WiseSecurityDeclarations.sol

244: mapping(address => CurveSwapStructToken) public curveSwapInfoToken;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L244

```solidity

File: WiseSecurityDeclarations.sol

247: mapping(address => bool) public securityWorker;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L247

### [N-79]<a name="n-79"></a> NatSpec comments should be increased in contracts

It is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as Defi, the interpretation of all functions and their arguments and returns is important for code readability and auditability. https://docs.soliditylang.org/en/v0.8.23/natspec-format.html

*There are 1 instance(s) of this issue:*

All in-scope contracts

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/#L0-L0

### [N-80]<a name="n-80"></a> NatSpec `@param` is missing




*There are 139 instance(s) of this issue:*

```solidity

File: MainHelper.sol

130: /**
     * @dev Internal helper combining one
     * security check with lending share
     * calculation for withdraw.
     */
    function _preparationsWithdraw(
        uint256 _nftId,
        address _caller,
        address _poolToken,
        uint256 _amount
    )
        internal
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L130

```solidity

File: MainHelper.sol

159: /**
     * @dev Internal helper calculating {_poolToken}
     * utilization. Includes math underflow check.
     */
    function _getValueUtilization(
        address _poolToken
    )
        private
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L159

```solidity

File: MainHelper.sol

214: /**
     * @dev Wrapper for isolation pool check.
     */
    function _onlyIsolationPool(
        address _poolAddress
    )
        internal
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L214

```solidity

File: MainHelper.sol

493: /**
     * @dev Internal helper function
     * updating pseudo amounts and
     * printing fee shares for the
     * feeManager proportional to the
     * fee percentage of the pool.
     */
    function _updatePseudoTotalAmounts(
        address _poolToken
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L493

```solidity

File: MainHelper.sol

642: /**
     * @dev Internal helper calculating
     * a hash out of {_nftId} and {_poolToken}
     * using keccak256.
     */
    function _getHash(
        uint256 _nftId,
        address _poolToken
    )
        private
        pure
        returns (bytes32)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L642

```solidity

File: MainHelper.sol

729: /**
     * @dev Internal helper deleting last entry
     * of postion lending data.
     */
    function _deleteLastPositionLendingData(
        uint256 _nftId,
        address _poolToken
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L729

```solidity

File: MainHelper.sol

790: /**
     * @dev Internal helper deleting last entry
     * of postion borrow data.
     */
    function _deleteLastPositionBorrowData(
        uint256 _nftId,
        address _poolToken
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L790

```solidity

File: MainHelper.sol

891: /**
     * @dev Internal helper function
     * checking if time interval for
     * next LASA call has passed.
     */
    function _aboveThreshold(
        address _poolToken
    )
        internal
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L891

```solidity

File: MainHelper.sol

943: /**
     * @dev Sets the new max value in shares
     * and saves the corresponding resonance factor.
     */
    function _newMaxPoolShares(
        address _poolToken,
        uint256 _shareValue
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L943

```solidity

File: MainHelper.sol

983: /**
     * @dev Returns bool to determine if resonance
     * factor needs to be reset to last best value.
     */
    function _resonanceOutcome(
        address _poolToken,
        uint256 _shareValue
    )
        private
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L983

```solidity

File: MainHelper.sol

1000: /**
     * @dev Resets resonance factor to old best value when system
     * evolves into too bad state and sets current totalDepositShares
     * amount to new maxPoolShares to exclude eternal loops and that
     * unorganic peaks do not set maxPoolShares forever.
     */
    function _resetResonanceFactor(
        address _poolToken,
        uint256 _shareValue
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1000

```solidity

File: MainHelper.sol

1027: /**
     * @dev Reverts the flag for stepping direction from LASA.
     */
    function _revertDirectionState(
        address _poolToken
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1027

```solidity

File: MainHelper.sol

1058: /**
     * @dev Does a revert stepping and swaps stepping state in opposite flag.
     */
    function _reversedResonanceFactor(
        address _poolToken
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1058

```solidity

File: MainHelper.sol

1075: /**
     * @dev Increasing or decresing resonance factor depending on flag value.
     */
    function _changingResonanceFactor(
        address _poolToken
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1075

```solidity

File: OwnableMaster.sol

66: /**
     * @dev Allows to propose next master.
     * Must be claimed by proposer.
     */
    function proposeOwner(
        address _proposedOwner
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L66

```solidity

File: PoolManager.sol

122: /**
     * @dev Allow to verify isolation pool.
     */
    function setVerifiedIsolationPool(
        address _isolationPool,
        bool _state
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L122

```solidity

File: PositionNFTs.sol

151: /**
     * @dev See {IERC721-getApproved}.
     */
    function getApprovedSoft(
        uint256 tokenId
    )
        external
        view
        returns (address)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L151

```solidity

File: PositionNFTs.sol

170: /**
     * @dev Mints NFT for _user, without it
     * user can not use WiseLending protocol
     */
    function mintPositionForUser(
        address _user
    )
        external
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L170

```solidity

File: PositionNFTs.sol

268: /**
     * @dev Returns positions of owner
     */
    function walletOfOwner(
        address _owner
    )
        external
        view
        returns (uint256[] memory)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L268

```solidity

File: PositionNFTs.sol

316: /**
     * @dev Allows to update base target for MetaData.
     */
    function setBaseURI(
        string memory _newBaseURI
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L316

```solidity

File: PositionNFTs.sol

337: /**
     * @dev Returns path to MetaData URI
     */
    function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L337

```solidity

File: PositionNFTs.sol

368: /**
     * @dev Converts tokenId uint to string.
     */
    function _toString(
        uint256 _tokenId
    )
        internal
        pure
        returns (string memory str)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L368

```solidity

File: WiseCore.sol

168: /**
     * @dev External wrapper for
     * {_checkPositionLocked}.
     */

    function checkPositionLocked(
        uint256 _nftId,
        address _caller
    )
        external
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L168

```solidity

File: WiseCore.sol

186: /**
     * @dev Checks if a postion is locked
     * for powerFarms. Get skipped when
     * aaveHub or a powerFarm itself is
     * the {msg.sender}.
     */

    function _checkPositionLocked(
        uint256 _nftId,
        address _caller
    )
        internal
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L186

```solidity

File: WiseCore.sol

211: /**
     * @dev External wrapper for
     * {_checkDeposit}.
     */
    function checkDeposit(
        uint256 _nftId,
        address _caller,
        address _poolToken,
        uint256 _amount
    )
        external
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L211

```solidity

File: WiseLending.sol

63: /**
     * @dev Checks if position is healthy
     * after all state changes are done.
     */
    modifier healthStateCheck(
        uint256 _nftId
    ) {
        _;

        _healthStateCheck(
            _nftId
        );
    }

    function _healthStateCheck(
        uint256 _nftId
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L63

```solidity

File: WiseLending.sol

162: /**
     * @dev Fetches share price of lending shares.
     */
    function _getSharePrice(
        address _poolToken
    )
        private
        view
        returns (
            uint256,
            uint256
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L162

```solidity

File: WiseLending.sol

205: /**
     * @dev Compares share prices before and after
     * execution. If borrow share price increased
     * or lending share price decreased, revert.
     */
    function _compareSharePrices(
        address _poolToken,
        uint256 _lendSharePriceBefore,
        uint256 _borrowSharePriceBefore
    )
        private
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L205

```solidity

File: WiseLending.sol

250: /**
    * @dev Since pool inception share price
    * increase for both lending and borrow shares
    * is capped at 500% apr max in between a transaction.
    */
    function _getCurrentSharePriceMax(
        address _poolToken
    )
        private
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L250

```solidity

File: WiseLending.sol

270: /**
     * @dev First part of pool sync updating pseudo
     * amounts. Is skipped when powerFarms or aaveHub
     * is calling the function.
     */
    function _syncPoolBeforeCodeExecution(
        address _poolToken
    )
        private
        returns (
            uint256 lendSharePrice,
            uint256 borrowSharePrice
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L270

```solidity

File: WiseLending.sol

304: /**
     * @dev Second part of pool sync updating
     * the borrow pool rate and share price.
     */
    function _syncPoolAfterCodeExecution(
        address _poolToken,
        uint256 _lendSharePriceBefore,
        uint256 _borrowSharePriceBefore
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L304

```solidity

File: WiseLending.sol

326: /**
     * @dev Enables _poolToken to be used as a collateral.
     */
    function collateralizeDeposit(
        uint256 _nftId,
        address _poolToken
    )
        external
        syncPool(_poolToken)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L326

```solidity

File: WiseLending.sol

345: /**
     * @dev Disables _poolToken to be used as a collateral.
     */
    function unCollateralizeDeposit(
        uint256 _nftId,
        address _poolToken
    )
        external
        syncPool(_poolToken)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L345

```solidity

File: WiseLending.sol

384: /**
     * @dev Allows to supply funds using ETH.
     * Without converting to WETH, use ETH directly.
     */
    function depositExactAmountETH(
        uint256 _nftId
    )
        external
        payable
        syncPool(WETH_ADDRESS)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L384

```solidity

File: WiseLending.sol

437: /**
     * @dev Allows to supply _poolToken and user
     * can decide if _poolToken should be collateralized,
     * also mints position to avoid extra transaction.
     */
    function depositExactAmountMint(
        address _poolToken,
        uint256 _amount
    )
        external
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L437

```solidity

File: WiseLending.sol

456: /**
     * @dev Allows to supply _poolToken and user
     * can decide if _poolToken should be collateralized.
     */
    function depositExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        public
        syncPool(_poolToken)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L456

```solidity

File: WiseLending.sol

502: /**
     * @dev Allows to supply funds using ETH in solely mode,
     * which does not earn APY, but keeps the funds private.
     * Other users are restricted from borrowing these funds,
     * owner can always withdraw even if all funds are borrowed.
     */
    function solelyDepositETH(
        uint256 _nftId
    )
        public
        payable
        syncPool(WETH_ADDRESS)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L502

```solidity

File: WiseLending.sol

574: /**
     * @dev Allows to supply funds using ERC20 in solely mode,
     * which does not earn APY, but keeps the funds private.
     * Other users are restricted from borrowing these funds,
     * owner can always withdraw even if all funds are borrowed.
     * Also mints position to avoid extra transaction.
     */
    function solelyDepositMint(
        address _poolToken,
        uint256 _amount
    )
        external
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L574

```solidity

File: WiseLending.sol

594: /**
     * @dev Allows to supply funds using ERC20 in solely mode,
     * which does not earn APY, but keeps the funds private.
     * Other users are restricted from borrowing these funds,
     * owner can always withdraw even if all funds are borrowed.
     */
    function solelyDeposit(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        public
        syncPool(_poolToken)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L594

```solidity

File: WiseLending.sol

632: /**
     * @dev Allows to withdraw publicly
     * deposited ETH funds using exact amount.
     */
    function withdrawExactAmountETH(
        uint256 _nftId,
        uint256 _amount
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L632

```solidity

File: WiseLending.sol

671: /**
     * @dev Allows to withdraw publicly
     * deposited ETH funds using exact shares.
     */
    function withdrawExactSharesETH(
        uint256 _nftId,
        uint256 _shares
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L671

```solidity

File: WiseLending.sol

710: /**
     * @dev Allows to withdraw publicly
     * deposited ERC20 funds using exact amount.
     */
    function withdrawExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _withdrawAmount
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L710

```solidity

File: WiseLending.sol

747: /**
     * @dev Allows to withdraw privately
     * deposited ETH funds using input amount.
     */
    function solelyWithdrawETH(
        uint256 _nftId,
        uint256 _withdrawAmount
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L747

```solidity

File: WiseLending.sol

776: /**
     * @dev Allows to withdraw privately
     * deposited ERC20 funds using input amount.
     */
    function solelyWithdraw(
        uint256 _nftId,
        address _poolToken,
        uint256 _withdrawAmount
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L776

```solidity

File: WiseLending.sol

854: /**
     * @dev Allows to withdraw privately
     * deposited ERC20 on behalf of owner.
     * Requires approval by _nftId owner.
     */
    function withdrawOnBehalfExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _withdrawAmount
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L854

```solidity

File: WiseLending.sol

898: /**
     * @dev Allows to withdraw ERC20
     * funds using shares as input value
     */
    function withdrawExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L898

```solidity

File: WiseLending.sol

935: /**
     * @dev Withdraws ERC20 funds on behalf
     * of _nftId owner, requires approval.
     */
    function withdrawOnBehalfExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L935

```solidity

File: WiseLending.sol

971: /**
     * @dev Allows to borrow ETH funds
     * Requires user to have collateral.
     */
    function borrowExactAmountETH(
        uint256 _nftId,
        uint256 _amount
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L971

```solidity

File: WiseLending.sol

1012: /**
     * @dev Allows to borrow ERC20 funds
     * Requires user to have collateral.
     */
    function borrowExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1012

```solidity

File: WiseLending.sol

1051: /**
     * @dev Allows to borrow ERC20 funds
     * on behalf of _nftId owner, if approved.
     */
    function borrowOnBehalfExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1051

```solidity

File: WiseLending.sol

1084: /**
     * @dev Ability to payback ETH loans
     * by providing exact payback amount.
     */
    function paybackExactAmountETH(
        uint256 _nftId
    )
        external
        payable
        syncPool(WETH_ADDRESS)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1084

```solidity

File: WiseLending.sol

1157: /**
     * @dev Ability to payback ERC20 loans
     * by providing exact payback amount.
     */
    function paybackExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        external
        syncPool(_poolToken)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1157

```solidity

File: WiseLending.sol

1200: /**
     * @dev Ability to payback ERC20 loans
     * by providing exact payback shares.
     */
    function paybackExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        syncPool(_poolToken)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1200

```solidity

File: WiseLending.sol

1363: /**
     * @dev Allows to sync pool manually
     * so that the pool is up to date.
     */
    function syncManually(
        address _poolToken
    )
        external
        syncPool(_poolToken)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1363

```solidity

File: WiseLending.sol

1382: /**
     * @dev Registers position _nftId
     * for isolation pool functionality
     */
    function setRegistrationIsolationPool(
        uint256 _nftId,
        bool _registerState
    )
        external
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1382

```solidity

File: WiseLending.sol

1407: /**
    * @dev External wrapper for
    * {_corePayback} logic callable
    * by feeMananger.
    */
    function corePaybackFeeManager(
        address _poolToken,
        uint256 _nftId,
        uint256 _amount,
        uint256 _shares
    )
        external
        onlyFeeManager
        syncPool(_poolToken)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1407

```solidity

File: FeeManager.sol

62: /**
     * @dev Maps underlying token with corresponding aToken.
     * Sets bool to identify pool token as aToken.
     */
    function setAaveFlag(
        address _poolToken,
        address _underlyingToken
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L62

```solidity

File: FeeManager.sol

281: /**
     * @dev Claims gathered incentives for a specific token.
     */
    function claimIncentives(
        address _feeToken
    )
        public
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L281

```solidity

File: FeeManager.sol

624: /**
     * @dev Claim fees from wiseLending and send them to feeManager for
     * a specific pool.
     */
    function claimWiseFees(
        address _poolToken
    )
        public
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L624

```solidity

File: FeeManager.sol

880: /**
     * @dev Returns the pool token address
     * at the _index postion of the array.
     */
    function getPoolTokenAdressesByIndex(
        uint256 _index
    )
        external
        view
        returns (address)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L880

```solidity

File: FeeManagerHelper.sol

266: /**
     * @dev Updates bad debt of a postion. Combines preparation of all
     * collaterals and borrows for passed _nftId with _updateUserBadDebt().
     */
    function updatePositionCurrentBadDebt(
        uint256 _nftId
    )
        public
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L266

```solidity

File: PendlePowerFarm.sol

270: /**
     * @dev Makes a call to WISE_LENDING to
     * register {_nftId} for specific farm use.
     */
    function _registrationFarm(
        uint256 _nftId
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L270

```solidity

File: PendlePowerFarmLeverageLogic.sol

131: /**
     * @dev Closes position using balancer flashloans.
     */
    function _logicClosePosition(
        uint256 _nftId,
        uint256 _borrowShares,
        uint256 _lendingShares,
        uint256 _totalDebtBalancer,
        uint256 _allowedSpread,
        address _caller,
        bool _ethBack,
        bool _isAave
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L131

```solidity

File: PendlePowerFarmController.sol

361: /**
     * @dev Can also be used to extend existing lock.
     */
    function lockPendle(
        uint256 _amount,
        uint128 _weeks,
        bool _fromInside,
        bool _sameExpiry
    )
        external
        onlyMaster
        returns (uint256 newVeBalance)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L361

```solidity

File: PendlePowerFarmToken.sol

526: /**
     * @dev External wrapper for mint function.
     */
    function depositExactAmount(
        uint256 _underlyingLpAssetAmount
    )
        external
        syncSupply
        returns (
            uint256,
            uint256
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L526

```solidity

File: PendlePowerFarmToken.sol

605: /**
     * @dev External wrapper for burn function.
     */
    function withdrawExactShares(
        uint256 _shares
    )
        external
        syncSupply
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L605

```solidity

File: PowerFarmNFTs.sol

62: /**
     * @dev Mints farming NFT, later to be sent
     * to the user representing his farming position
     */
    function mintKey(
        address _keyOwner,
        uint256 _keyId
    )
        external
        onlyFarmContract
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L62

```solidity

File: PowerFarmNFTs.sol

79: /**
     * @dev Burns farming NFT
     */
    function burnKey(
        uint256 _keyId
    )
        external
        onlyFarmContract
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L79

```solidity

File: PowerFarmNFTs.sol

106: /**
     * @dev Returns positions of owner
     */
    function walletOfOwner(
        address _owner
    )
        external
        view
        returns (uint256[] memory)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L106

```solidity

File: PowerFarmNFTs.sol

158: /**
     * @dev Allows to update base target for MetaData.
     */
    function setBaseURI(
        string calldata _newBaseURI
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L158

```solidity

File: PowerFarmNFTs.sol

179: /**
     * @dev Returns path to MetaData URI
     */
    function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L179

```solidity

File: PowerFarmNFTs.sol

210: /**
     * @dev Converts tokenId uint to string.
     */
    function _toString(
        uint256 _tokenId
    )
        internal
        pure
        returns (string memory str)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L210

```solidity

File: ApprovalHelper.sol

9: /**
     * @dev
     * Allows to execute safe approve for a token
     */
    function _safeApprove(
        address _token,
        address _spender,
        uint256 _value
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L9

```solidity

File: TransferHelper.sol

9: /**
     * @dev
     * Allows to execute safe transfer for a token
     */
    function _safeTransfer(
        address _token,
        address _to,
        uint256 _value
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L9

```solidity

File: TransferHelper.sol

30: /**
     * @dev
     * Allows to execute safe transferFrom for a token
     */
    function _safeTransferFrom(
        address _token,
        address _from,
        address _to,
        uint256 _value
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L30

```solidity

File: WrapperHelper.sol

20: /**
     * @dev Wrapper for wrapping
     * ETH call.
     */
    function _wrapETH(
        uint256 _value
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L20

```solidity

File: WrapperHelper.sol

34: /**
     * @dev Wrapper for unwrapping
     * ETH call.
     */
    function _unwrapETH(
        uint256 _value
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L34

```solidity

File: OracleHelper.sol

9: /**
     * @dev Adds priceFeed for a given token.
     */
    function _addOracle(
        address _tokenAddress,
        IPriceFeed _priceFeedAddress,
        address[] calldata _underlyingFeedTokens
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L9

```solidity

File: OracleHelper.sol

102: /**
     * @dev Returns Twaps latest USD value
     * by passing the underlying token address.
     */
    function latestResolverTwap(
        address _tokenAddress
    )
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L102

```solidity

File: OracleHelper.sol

176: /**
     * @dev Adds uniTwapPoolInfo for a given token.
     */
    function _writeUniTwapPoolInfoStruct(
        address _tokenAddress,
        address _oracle,
        bool _isUniPool
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L176

```solidity

File: OracleHelper.sol

192: /**
     * @dev Adds uniTwapPoolInfo for a given token and its derivative.
     */
    function _writeUniTwapPoolInfoStructDerivative(
        address _tokenAddress,
        address _partnerTokenAddress,
        address _oracleAddress,
        address _partnerOracleAddress,
        bool _isUniPool
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L192

```solidity

File: OracleHelper.sol

279: /**
    * @dev Retrieves the pool address for given
    * tokens and fee from Uniswap V3 Factory.
    */
    function _getPool(
        address _token0,
        address _token1,
        uint24 _fee
    )
        internal
        view
        returns (address pool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L279

```solidity

File: OracleHelper.sol

299: /**
    * @dev Validates if the given token address
    * is one of the two specified token addresses.
    */
    function _validateTokenAddress(
        address _tokenAddress,
        address _token0,
        address _token1
    )
        internal
        pure
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L299

```solidity

File: OracleHelper.sol

320: /**
    * @dev Validates if the given pool
    * address matches the expected pool address.
    */
    function _validatePoolAddress(
        address _pool,
        address _expectedPool
    )
        internal
        pure
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L320

```solidity

File: OracleHelper.sol

340: /**
    * @dev Validates if the price feed for
    * a given token address is set.
    */
    function _validatePriceFeed(
        address _tokenAddress
    )
        internal
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L340

```solidity

File: OracleHelper.sol

355: /**
    * @dev Validates if the TWAP oracle for
    * a given token address is already set.
    */
    function _validateTwapOracle(
        address _tokenAddress
    )
        internal
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L355

```solidity

File: OracleHelper.sol

370: /**
     * @dev Returns twapPrice by passing
     * the underlying token address.
     */
    function _getTwapPrice(
        address _tokenAddress,
        address _oracle
    )
        internal
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L370

```solidity

File: OracleHelper.sol

446: /**
     * @dev Returns priceFeed decimals by
     * passing the underlying token address.
     */
    function decimals(
        address _tokenAddress
    )
        public
        view
        returns (uint8)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L446

```solidity

File: OracleHelper.sol

503: /**
     * @dev Stores expected heartbeat
     * value for a pricing feed token.
     */
    function _recalibrate(
        address _tokenAddress
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L503

```solidity

File: OracleHelper.sol

551: /**
     * @dev Check if chainLink feed was
     * updated within expected timeFrame
     * for single {_tokenAddress}.
     */
    function _chainLinkIsDead(
        address _tokenAddress
    )
        internal
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L551

```solidity

File: OracleHelper.sol

588: /**
     * @dev Recalibrates expected
     * heartbeat for a pricing feed.
     */
    function _recalibratePreview(
        address _tokenAddress
    )
        internal
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L588

```solidity

File: OracleHelper.sol

654: /**
     * @dev Determines number of iterations
     * needed during heartbeat recalibration.
     */
    function _getIterationCount(
        uint80 _latestAggregatorRoundId
    )
        internal
        pure
        returns (uint80 res)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L654

```solidity

File: OracleHelper.sol

670: /**
     * @dev Fetches timestamp of a byteshifted
     * aggregatorRound with specific _roundId.
     */
    function _getRoundTimestamp(
        address _tokenAddress,
        uint80 _roundId
    )
        internal
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L670

```solidity

File: OracleHelper.sol

695: /**
     * @dev Routing latest round data from chainLink.
     * Returns latestRoundData by passing underlying token address.
     */
    function getLatestRoundId(
        address _tokenAddress
    )
        public
        view
        returns (
            uint80 roundId
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L695

```solidity

File: WiseOracleHub.sol

65: /**
     * @dev Returns priceFeed latest ETH value
     * by passing the underlying token address.
     */
    function latestResolver(
        address _tokenAddress
    )
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L65

```solidity

File: WiseOracleHub.sol

119: /**
     * @dev Returns USD value of a given token
     * amount in order of 1E18 decimal precision.
     */
    function getTokensPriceInUSD(
        address _tokenAddress,
        uint256 _tokenAmount
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L119

```solidity

File: WiseOracleHub.sol

139: /**
     * @dev Returns ETH value of a given token
     * amount in order of 1E18 decimal precision.
     */
    function getTokensInETH(
        address _tokenAddress,
        uint256 _tokenAmount
    )
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L139

```solidity

File: WiseOracleHub.sol

194: /**
     * @dev Converts USD value of a token into token amount with a
     * current price. The order of the argument _usdValue is 1E18.
     */
    function getTokensPriceFromUSD(
        address _tokenAddress,
        uint256 _usdValue
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L194

```solidity

File: WiseOracleHub.sol

214: /**
     * @dev Adds a new token address to the oracleHub Twap.
     * Can't overwrite existing mappings.
     */
    function addTwapOracle(
        address _tokenAddress,
        address _uniPoolAddress,
        address _token0,
        address _token1,
        uint24 _fee
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L214

```solidity

File: WiseOracleHub.sol

262: /**
     * @dev Adds a new token address to TWAP as derivative.
     * Not permitted to overwrite existing mappings.
     */
    function addTwapOracleDerivative(
        address _tokenAddress,
        address _partnerTokenAddress,
        address[2] calldata _uniPools,
        address[2] calldata _token0Array,
        address[2] calldata _token1Array,
        uint24[2] calldata _feeArray
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L262

```solidity

File: WiseOracleHub.sol

323: /**
     * @dev Converts ETH value of a token into token amount with a
     * current price. The order of the argument _ethAmount is 1E18.
     */
    function getTokensFromETH(
        address _tokenAddress,
        uint256 _ethAmount
    )
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L323

```solidity

File: WiseOracleHub.sol

354: /**
     * @dev Adds priceFeed for a token.
     * Can't overwrite existing mappings.
     * Master is a timelock contract.
     */
    function addOracle(
        address _tokenAddress,
        IPriceFeed _priceFeedAddress,
        address[] calldata _underlyingFeedTokens
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L354

```solidity

File: WiseOracleHub.sol

374: /**
     * @dev Adds priceFeeds for tokens.
     * Can't overwrite existing mappings.
     * Master is a timelock contract.
     */
    function addOracleBulk(
        address[] calldata _tokenAddresses,
        IPriceFeed[] calldata _priceFeedAddresses,
        address[][] calldata _underlyingFeedTokens
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L374

```solidity

File: WiseOracleHub.sol

414: /**
     * @dev Looks at the maximal last 50 rounds and
     * takes second highest value to avoid counting
     * offline time of chainlink as valid heartbeat.
     */
    function recalibratePreview(
        address _tokenAddress
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L414

```solidity

File: WiseOracleHub.sol

431: /**
     * @dev Check if chainLink feed was
     * updated within expected timeFrame.
     * If length of {underlyingFeedTokens}
     * is greater than zero it checks the
     * heartbeat of all base feeds of the
     * derivate oracle.
     */
    function chainLinkIsDead(
        address _tokenAddress
    )
        public
        view
        returns (bool state)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L431

```solidity

File: WiseOracleHub.sol

483: /**
     * @dev Recalibrates expected
     * heartbeat for a pricing feed.
     */
    function recalibrate(
        address _tokenAddress
    )
        external
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L483

```solidity

File: WiseSecurity.sol

54: /**
     * @dev View functions returning current
     * debt ratio of a postion in normal mode.
     * 1% <=> 1E16
     */
    function getLiveDebtRatio(
        uint256 _nftId
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L54

```solidity

File: WiseSecurity.sol

79: /**
     * @dev Set Liquidation incentives and boundaries
     * for liquidation. Only callable by the master.
     * Assures liquidation cascade cannot be self imposed
     * by limiting incentives.
     */
    function setLiquidationSettings(
        uint256 _baseReward,
        uint256 _baseRewardFarm,
        uint256 _newMaxFeeETH,
        uint256 _newMaxFeeFarmETH
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L79

```solidity

File: WiseSecurity.sol

102: /**
     * @dev Checks for liquidation logic.
     */
    function checksLiquidation(
        uint256 _nftIdLiquidate,
        address _tokenToPayback,
        uint256 _shareAmountToPay
    )
        external
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L102

```solidity

File: WiseSecurity.sol

189: /**
     * @dev Reentrency guard for curve pools. Forces
     * a swap to update internal curve values.
     */
    function curveSecurityCheck(
        address _poolToken
    )
        external
        onlyWiseLending
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L189

```solidity

File: WiseSecurity.sol

234: /**
     * @dev Checks for withdraw logic.
     */
    function checksWithdraw(
        uint256 _nftId,
        address _caller,
        address _poolToken
    )
        external
        view
        returns (bool specialCase)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L234

```solidity

File: WiseSecurity.sol

272: /**
     * @dev Checks for solely withdraw logic.
     */
    function checksSolelyWithdraw(
        uint256 _nftId,
        address _caller,
        address _poolToken
    )
        external
        view
        returns (bool specialCase)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L272

```solidity

File: WiseSecurity.sol

303: /**
     * @dev Checks for borrow logic.
     */
    function checksBorrow(
        uint256 _nftId,
        address _caller,
        address _poolToken
    )
        external
        view
        returns (bool specialCase)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L303

```solidity

File: WiseSecurity.sol

332: /**
     * @dev Checks for collateralize deposit logic.
     */
    function checksCollateralizeDeposit(
        uint256 _nftId,
        address _caller,
        address _poolAddress
    )
        external
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L332

```solidity

File: WiseSecurity.sol

357: /**
     * @dev Checks for uncollateralized deposit logic.
     */
    function checkUncollateralizedDeposit(
        uint256 _nftId,
        address _poolToken
    )
        external
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L357

```solidity

File: WiseSecurity.sol

384: /**
     * @dev Checks if user has healthy position.
     */

    function checkHealthState(
        uint256 _nftId,
        bool _isPowerFarm
    )
        external
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L384

```solidity

File: WiseSecurity.sol

401: /**
     * @dev Checks for bad debt logic. Compares
     * total ETH of borrow and collateral.
     */
    function checkBadDebtLiquidation(
        uint256 _nftId
    )
        external
        onlyWiseLending
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L401

```solidity

File: WiseSecurity.sol

1041: /**
     * @dev External wrapper for pool condition
     * check.
     */
    function checkPoolCondition(
        address _token
    )
        external
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1041

```solidity

File: WiseSecurity.sol

1056: /**
     * @dev External wrapper for pool condition
     * check.
     */
    function checkPoolWithMinDeposit(
        address _token,
        uint256 _amount
    )
        external
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1056

```solidity

File: WiseSecurityHelper.sol

683: /**
     * @dev Check if chainLink feed was
     * updated within expected timeframe
     */
    function checkHeartbeat(
        address _poolToken
    )
        public
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L683

```solidity

File: WiseSecurityHelper.sol

697: /**
     * @dev Check if the postion with
     * {_nftId} is locked for interactions.
     */
    function _checkPositionLocked(
        uint256 _nftId
    )
        internal
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L697

```solidity

File: WiseSecurityHelper.sol

732: /**
     * @dev Returning the possible fee
     * for liquidation.
     */
    function _checkMaxFee(
        uint256 _paybackETH,
        uint256 _liquidationFee,
        uint256 _maxFeeETH
    )
        internal
        pure
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L732

```solidity

File: WiseSecurityHelper.sol

1052: /**
     * Locking or unlocking all pools for borrow
     * and deposit actions. Performs action for
     * all pools.
     */
    function _setPoolState(
        bool _state
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1052

```solidity

File: WiseSecurityHelper.sol

1077: /**
     * @dev Wrapper for {_checkBlacklisted}.
     */
    function _checkPoolCondition(
        address _poolToken
    )
        internal
        view
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1077

```solidity

File: AaveHub.sol

39: /**
     * @dev Adds new mapping to aaveHub. Needed
     * to link underlying assets with corresponding
     * aTokens. Can only be called by master.
     */
    function setAaveTokenAddress(
        address _underlyingAsset,
        address _aaveToken
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L39

```solidity

File: AaveHub.sol

58: /**
     * @dev Adds new mapping to aaveHub in bulk.
     * Needed to link underlying assets with
     * corresponding aTokens. Can only be called by master.
     */

    function setAaveTokenAddressBulk(
        address[] calldata _underlyingAssets,
        address[] calldata _aaveTokens
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L58

```solidity

File: AaveHub.sol

97: /**
     * @dev Allows deposit ERC20 token to
     * wiseLending and takes token amount
     * as arguement. Also mints position
     * NFT to reduce needed transactions.
     */
    function depositExactAmountMint(
        address _underlyingAsset,
        uint256 _amount
    )
        external
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L97

```solidity

File: AaveHub.sol

117: /**
     * @dev Allows deposit ERC20 token to
     * wiseLending and takes token amount as
     * argument.
     */
    function depositExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _amount
    )
        public
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L117

```solidity

File: AaveHub.sol

168: /**
     * @dev Allows to deposit ETH token directly to
     * wiseLending and takes token amount as argument.
     */
    function depositExactAmountETH(
        uint256 _nftId
    )
        public
        payable
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L168

```solidity

File: AaveHub.sol

198: /**
     * @dev Allows to withdraw deposited ERC20 token.
     * Takes _withdrawAmount as argument.
     */
    function withdrawExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _withdrawAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L198

```solidity

File: AaveHub.sol

234: /**
     * @dev Allows to withdraw deposited ETH token.
     * Takes token amount as argument.
     */
    function withdrawExactAmountETH(
        uint256 _nftId,
        uint256 _withdrawAmount
    )
        external
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L234

```solidity

File: AaveHub.sol

277: /**
     * @dev Allows to withdraw deposited ERC20 token.
     * Takes _shareAmount as argument.
     */
    function withdrawExactShares(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _shareAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L277

```solidity

File: AaveHub.sol

310: /**
     * @dev Allows to withdraw deposited ETH token.
     * Takes _shareAmount as argument.
     */
    function withdrawExactSharesETH(
        uint256 _nftId,
        uint256 _shareAmount
    )
        external
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L310

```solidity

File: AaveHub.sol

350: /**
     * @dev Allows to borrow ERC20 token from a
     * wiseLending pool. Needs supplied collateral
     * inside the same position and to approve
     * aaveHub to borrow onBehalf for the caller.
     * Takes token amount as argument.
     */
    function borrowExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _borrowAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L350

```solidity

File: AaveHub.sol

386: /**
     * @dev Allows to borrow ETH token from
     * wiseLending. Needs supplied collateral
     * inside the same position and to approve
     * aaveHub to borrow onBehalf for the caller.
     * Takes token amount as argument.
     */
    function borrowExactAmountETH(
        uint256 _nftId,
        uint256 _borrowAmount
    )
        external
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L386

```solidity

File: AaveHub.sol

429: /**
     * @dev Allows to payback ERC20 token for
     * any postion. Takes _paybackAmount as argument.
     */
    function paybackExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _paybackAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L429

```solidity

File: AaveHub.sol

478: /**
     * @dev Allows to payback ETH token for
     * any postion. Takes token amount as argument.
     */
    function paybackExactAmountETH(
        uint256 _nftId
    )
        external
        payable
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L478

```solidity

File: AaveHub.sol

552: /**
     * @dev Allows to payback ERC20 token for
     * any postion. Takes shares as argument.
     */
    function paybackExactShares(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _shares
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L552

```solidity

File: AaveHub.sol

630: /**
     * @dev View functions returning the combined rate
     * from aave supply APY and wiseLending borrow APY
     * of a pool.
     */
    function getLendingRate(
        address _underlyingAsset
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L630

### [N-81]<a name="n-81"></a> NatSpec `@return` argument is missing




*There are 71 instance(s) of this issue:*

```solidity

File: MainHelper.sol

130: /**
     * @dev Internal helper combining one
     * security check with lending share
     * calculation for withdraw.
     */
    function _preparationsWithdraw(
        uint256 _nftId,
        address _caller,
        address _poolToken,
        uint256 _amount
    )
        internal
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L130

```solidity

File: MainHelper.sol

159: /**
     * @dev Internal helper calculating {_poolToken}
     * utilization. Includes math underflow check.
     */
    function _getValueUtilization(
        address _poolToken
    )
        private
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L159

```solidity

File: MainHelper.sol

642: /**
     * @dev Internal helper calculating
     * a hash out of {_nftId} and {_poolToken}
     * using keccak256.
     */
    function _getHash(
        uint256 _nftId,
        address _poolToken
    )
        private
        pure
        returns (bytes32)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L642

```solidity

File: MainHelper.sol

891: /**
     * @dev Internal helper function
     * checking if time interval for
     * next LASA call has passed.
     */
    function _aboveThreshold(
        address _poolToken
    )
        internal
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L891

```solidity

File: MainHelper.sol

983: /**
     * @dev Returns bool to determine if resonance
     * factor needs to be reset to last best value.
     */
    function _resonanceOutcome(
        address _poolToken,
        uint256 _shareValue
    )
        private
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L983

```solidity

File: PositionNFTs.sol

151: /**
     * @dev See {IERC721-getApproved}.
     */
    function getApprovedSoft(
        uint256 tokenId
    )
        external
        view
        returns (address)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L151

```solidity

File: PositionNFTs.sol

170: /**
     * @dev Mints NFT for _user, without it
     * user can not use WiseLending protocol
     */
    function mintPositionForUser(
        address _user
    )
        external
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L170

```solidity

File: PositionNFTs.sol

268: /**
     * @dev Returns positions of owner
     */
    function walletOfOwner(
        address _owner
    )
        external
        view
        returns (uint256[] memory)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L268

```solidity

File: PositionNFTs.sol

337: /**
     * @dev Returns path to MetaData URI
     */
    function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L337

```solidity

File: PositionNFTs.sol

368: /**
     * @dev Converts tokenId uint to string.
     */
    function _toString(
        uint256 _tokenId
    )
        internal
        pure
        returns (string memory str)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L368

```solidity

File: WiseLending.sol

162: /**
     * @dev Fetches share price of lending shares.
     */
    function _getSharePrice(
        address _poolToken
    )
        private
        view
        returns (
            uint256,
            uint256
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L162

```solidity

File: WiseLending.sol

250: /**
    * @dev Since pool inception share price
    * increase for both lending and borrow shares
    * is capped at 500% apr max in between a transaction.
    */
    function _getCurrentSharePriceMax(
        address _poolToken
    )
        private
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L250

```solidity

File: WiseLending.sol

270: /**
     * @dev First part of pool sync updating pseudo
     * amounts. Is skipped when powerFarms or aaveHub
     * is calling the function.
     */
    function _syncPoolBeforeCodeExecution(
        address _poolToken
    )
        private
        returns (
            uint256 lendSharePrice,
            uint256 borrowSharePrice
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L270

```solidity

File: WiseLending.sol

384: /**
     * @dev Allows to supply funds using ETH.
     * Without converting to WETH, use ETH directly.
     */
    function depositExactAmountETH(
        uint256 _nftId
    )
        external
        payable
        syncPool(WETH_ADDRESS)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L384

```solidity

File: WiseLending.sol

437: /**
     * @dev Allows to supply _poolToken and user
     * can decide if _poolToken should be collateralized,
     * also mints position to avoid extra transaction.
     */
    function depositExactAmountMint(
        address _poolToken,
        uint256 _amount
    )
        external
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L437

```solidity

File: WiseLending.sol

456: /**
     * @dev Allows to supply _poolToken and user
     * can decide if _poolToken should be collateralized.
     */
    function depositExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        public
        syncPool(_poolToken)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L456

```solidity

File: WiseLending.sol

632: /**
     * @dev Allows to withdraw publicly
     * deposited ETH funds using exact amount.
     */
    function withdrawExactAmountETH(
        uint256 _nftId,
        uint256 _amount
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L632

```solidity

File: WiseLending.sol

671: /**
     * @dev Allows to withdraw publicly
     * deposited ETH funds using exact shares.
     */
    function withdrawExactSharesETH(
        uint256 _nftId,
        uint256 _shares
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L671

```solidity

File: WiseLending.sol

710: /**
     * @dev Allows to withdraw publicly
     * deposited ERC20 funds using exact amount.
     */
    function withdrawExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _withdrawAmount
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L710

```solidity

File: WiseLending.sol

854: /**
     * @dev Allows to withdraw privately
     * deposited ERC20 on behalf of owner.
     * Requires approval by _nftId owner.
     */
    function withdrawOnBehalfExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _withdrawAmount
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L854

```solidity

File: WiseLending.sol

898: /**
     * @dev Allows to withdraw ERC20
     * funds using shares as input value
     */
    function withdrawExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L898

```solidity

File: WiseLending.sol

935: /**
     * @dev Withdraws ERC20 funds on behalf
     * of _nftId owner, requires approval.
     */
    function withdrawOnBehalfExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L935

```solidity

File: WiseLending.sol

971: /**
     * @dev Allows to borrow ETH funds
     * Requires user to have collateral.
     */
    function borrowExactAmountETH(
        uint256 _nftId,
        uint256 _amount
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L971

```solidity

File: WiseLending.sol

1012: /**
     * @dev Allows to borrow ERC20 funds
     * Requires user to have collateral.
     */
    function borrowExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1012

```solidity

File: WiseLending.sol

1051: /**
     * @dev Allows to borrow ERC20 funds
     * on behalf of _nftId owner, if approved.
     */
    function borrowOnBehalfExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1051

```solidity

File: WiseLending.sol

1084: /**
     * @dev Ability to payback ETH loans
     * by providing exact payback amount.
     */
    function paybackExactAmountETH(
        uint256 _nftId
    )
        external
        payable
        syncPool(WETH_ADDRESS)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1084

```solidity

File: WiseLending.sol

1157: /**
     * @dev Ability to payback ERC20 loans
     * by providing exact payback amount.
     */
    function paybackExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        external
        syncPool(_poolToken)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1157

```solidity

File: WiseLending.sol

1200: /**
     * @dev Ability to payback ERC20 loans
     * by providing exact payback shares.
     */
    function paybackExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        syncPool(_poolToken)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1200

```solidity

File: FeeManager.sol

880: /**
     * @dev Returns the pool token address
     * at the _index postion of the array.
     */
    function getPoolTokenAdressesByIndex(
        uint256 _index
    )
        external
        view
        returns (address)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L880

```solidity

File: PendlePowerFarmController.sol

361: /**
     * @dev Can also be used to extend existing lock.
     */
    function lockPendle(
        uint256 _amount,
        uint128 _weeks,
        bool _fromInside,
        bool _sameExpiry
    )
        external
        onlyMaster
        returns (uint256 newVeBalance)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L361

```solidity

File: PendlePowerFarmToken.sol

526: /**
     * @dev External wrapper for mint function.
     */
    function depositExactAmount(
        uint256 _underlyingLpAssetAmount
    )
        external
        syncSupply
        returns (
            uint256,
            uint256
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L526

```solidity

File: PendlePowerFarmToken.sol

605: /**
     * @dev External wrapper for burn function.
     */
    function withdrawExactShares(
        uint256 _shares
    )
        external
        syncSupply
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L605

```solidity

File: PowerFarmNFTs.sol

106: /**
     * @dev Returns positions of owner
     */
    function walletOfOwner(
        address _owner
    )
        external
        view
        returns (uint256[] memory)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L106

```solidity

File: PowerFarmNFTs.sol

179: /**
     * @dev Returns path to MetaData URI
     */
    function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L179

```solidity

File: PowerFarmNFTs.sol

210: /**
     * @dev Converts tokenId uint to string.
     */
    function _toString(
        uint256 _tokenId
    )
        internal
        pure
        returns (string memory str)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L210

```solidity

File: OracleHelper.sol

102: /**
     * @dev Returns Twaps latest USD value
     * by passing the underlying token address.
     */
    function latestResolverTwap(
        address _tokenAddress
    )
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L102

```solidity

File: OracleHelper.sol

279: /**
    * @dev Retrieves the pool address for given
    * tokens and fee from Uniswap V3 Factory.
    */
    function _getPool(
        address _token0,
        address _token1,
        uint24 _fee
    )
        internal
        view
        returns (address pool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L279

```solidity

File: OracleHelper.sol

370: /**
     * @dev Returns twapPrice by passing
     * the underlying token address.
     */
    function _getTwapPrice(
        address _tokenAddress,
        address _oracle
    )
        internal
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L370

```solidity

File: OracleHelper.sol

446: /**
     * @dev Returns priceFeed decimals by
     * passing the underlying token address.
     */
    function decimals(
        address _tokenAddress
    )
        public
        view
        returns (uint8)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L446

```solidity

File: OracleHelper.sol

551: /**
     * @dev Check if chainLink feed was
     * updated within expected timeFrame
     * for single {_tokenAddress}.
     */
    function _chainLinkIsDead(
        address _tokenAddress
    )
        internal
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L551

```solidity

File: OracleHelper.sol

588: /**
     * @dev Recalibrates expected
     * heartbeat for a pricing feed.
     */
    function _recalibratePreview(
        address _tokenAddress
    )
        internal
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L588

```solidity

File: OracleHelper.sol

654: /**
     * @dev Determines number of iterations
     * needed during heartbeat recalibration.
     */
    function _getIterationCount(
        uint80 _latestAggregatorRoundId
    )
        internal
        pure
        returns (uint80 res)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L654

```solidity

File: OracleHelper.sol

670: /**
     * @dev Fetches timestamp of a byteshifted
     * aggregatorRound with specific _roundId.
     */
    function _getRoundTimestamp(
        address _tokenAddress,
        uint80 _roundId
    )
        internal
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L670

```solidity

File: OracleHelper.sol

695: /**
     * @dev Routing latest round data from chainLink.
     * Returns latestRoundData by passing underlying token address.
     */
    function getLatestRoundId(
        address _tokenAddress
    )
        public
        view
        returns (
            uint80 roundId
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L695

```solidity

File: WiseOracleHub.sol

65: /**
     * @dev Returns priceFeed latest ETH value
     * by passing the underlying token address.
     */
    function latestResolver(
        address _tokenAddress
    )
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L65

```solidity

File: WiseOracleHub.sol

119: /**
     * @dev Returns USD value of a given token
     * amount in order of 1E18 decimal precision.
     */
    function getTokensPriceInUSD(
        address _tokenAddress,
        uint256 _tokenAmount
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L119

```solidity

File: WiseOracleHub.sol

139: /**
     * @dev Returns ETH value of a given token
     * amount in order of 1E18 decimal precision.
     */
    function getTokensInETH(
        address _tokenAddress,
        uint256 _tokenAmount
    )
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L139

```solidity

File: WiseOracleHub.sol

194: /**
     * @dev Converts USD value of a token into token amount with a
     * current price. The order of the argument _usdValue is 1E18.
     */
    function getTokensPriceFromUSD(
        address _tokenAddress,
        uint256 _usdValue
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L194

```solidity

File: WiseOracleHub.sol

323: /**
     * @dev Converts ETH value of a token into token amount with a
     * current price. The order of the argument _ethAmount is 1E18.
     */
    function getTokensFromETH(
        address _tokenAddress,
        uint256 _ethAmount
    )
        public
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L323

```solidity

File: WiseOracleHub.sol

414: /**
     * @dev Looks at the maximal last 50 rounds and
     * takes second highest value to avoid counting
     * offline time of chainlink as valid heartbeat.
     */
    function recalibratePreview(
        address _tokenAddress
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L414

```solidity

File: WiseOracleHub.sol

431: /**
     * @dev Check if chainLink feed was
     * updated within expected timeFrame.
     * If length of {underlyingFeedTokens}
     * is greater than zero it checks the
     * heartbeat of all base feeds of the
     * derivate oracle.
     */
    function chainLinkIsDead(
        address _tokenAddress
    )
        public
        view
        returns (bool state)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L431

```solidity

File: WiseSecurity.sol

54: /**
     * @dev View functions returning current
     * debt ratio of a postion in normal mode.
     * 1% <=> 1E16
     */
    function getLiveDebtRatio(
        uint256 _nftId
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L54

```solidity

File: WiseSecurity.sol

234: /**
     * @dev Checks for withdraw logic.
     */
    function checksWithdraw(
        uint256 _nftId,
        address _caller,
        address _poolToken
    )
        external
        view
        returns (bool specialCase)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L234

```solidity

File: WiseSecurity.sol

272: /**
     * @dev Checks for solely withdraw logic.
     */
    function checksSolelyWithdraw(
        uint256 _nftId,
        address _caller,
        address _poolToken
    )
        external
        view
        returns (bool specialCase)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L272

```solidity

File: WiseSecurity.sol

303: /**
     * @dev Checks for borrow logic.
     */
    function checksBorrow(
        uint256 _nftId,
        address _caller,
        address _poolToken
    )
        external
        view
        returns (bool specialCase)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L303

```solidity

File: WiseSecurity.sol

1056: /**
     * @dev External wrapper for pool condition
     * check.
     */
    function checkPoolWithMinDeposit(
        address _token,
        uint256 _amount
    )
        external
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1056

```solidity

File: WiseSecurityHelper.sol

683: /**
     * @dev Check if chainLink feed was
     * updated within expected timeframe
     */
    function checkHeartbeat(
        address _poolToken
    )
        public
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L683

```solidity

File: WiseSecurityHelper.sol

732: /**
     * @dev Returning the possible fee
     * for liquidation.
     */
    function _checkMaxFee(
        uint256 _paybackETH,
        uint256 _liquidationFee,
        uint256 _maxFeeETH
    )
        internal
        pure
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L732

```solidity

File: AaveHub.sol

97: /**
     * @dev Allows deposit ERC20 token to
     * wiseLending and takes token amount
     * as arguement. Also mints position
     * NFT to reduce needed transactions.
     */
    function depositExactAmountMint(
        address _underlyingAsset,
        uint256 _amount
    )
        external
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L97

```solidity

File: AaveHub.sol

117: /**
     * @dev Allows deposit ERC20 token to
     * wiseLending and takes token amount as
     * argument.
     */
    function depositExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _amount
    )
        public
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L117

```solidity

File: AaveHub.sol

168: /**
     * @dev Allows to deposit ETH token directly to
     * wiseLending and takes token amount as argument.
     */
    function depositExactAmountETH(
        uint256 _nftId
    )
        public
        payable
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L168

```solidity

File: AaveHub.sol

198: /**
     * @dev Allows to withdraw deposited ERC20 token.
     * Takes _withdrawAmount as argument.
     */
    function withdrawExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _withdrawAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L198

```solidity

File: AaveHub.sol

234: /**
     * @dev Allows to withdraw deposited ETH token.
     * Takes token amount as argument.
     */
    function withdrawExactAmountETH(
        uint256 _nftId,
        uint256 _withdrawAmount
    )
        external
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L234

```solidity

File: AaveHub.sol

277: /**
     * @dev Allows to withdraw deposited ERC20 token.
     * Takes _shareAmount as argument.
     */
    function withdrawExactShares(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _shareAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L277

```solidity

File: AaveHub.sol

310: /**
     * @dev Allows to withdraw deposited ETH token.
     * Takes _shareAmount as argument.
     */
    function withdrawExactSharesETH(
        uint256 _nftId,
        uint256 _shareAmount
    )
        external
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L310

```solidity

File: AaveHub.sol

350: /**
     * @dev Allows to borrow ERC20 token from a
     * wiseLending pool. Needs supplied collateral
     * inside the same position and to approve
     * aaveHub to borrow onBehalf for the caller.
     * Takes token amount as argument.
     */
    function borrowExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _borrowAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L350

```solidity

File: AaveHub.sol

386: /**
     * @dev Allows to borrow ETH token from
     * wiseLending. Needs supplied collateral
     * inside the same position and to approve
     * aaveHub to borrow onBehalf for the caller.
     * Takes token amount as argument.
     */
    function borrowExactAmountETH(
        uint256 _nftId,
        uint256 _borrowAmount
    )
        external
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L386

```solidity

File: AaveHub.sol

429: /**
     * @dev Allows to payback ERC20 token for
     * any postion. Takes _paybackAmount as argument.
     */
    function paybackExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _paybackAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L429

```solidity

File: AaveHub.sol

478: /**
     * @dev Allows to payback ETH token for
     * any postion. Takes token amount as argument.
     */
    function paybackExactAmountETH(
        uint256 _nftId
    )
        external
        payable
        nonReentrant
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L478

```solidity

File: AaveHub.sol

552: /**
     * @dev Allows to payback ERC20 token for
     * any postion. Takes shares as argument.
     */
    function paybackExactShares(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _shares
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L552

```solidity

File: AaveHub.sol

630: /**
     * @dev View functions returning the combined rate
     * from aave supply APY and wiseLending borrow APY
     * of a pool.
     */
    function getLendingRate(
        address _underlyingAsset
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L630

### [N-82]<a name="n-82"></a> Non-assembly method available

There are some automated tools that will flag a project as having higher complexity if there is inline-assembly, so it's best to avoid using it where it's not necessary. In addition, most assembly methods can be replaced by non-assembly methods, for example:
- `assembly{ g := gas() }` => `uint256 g = gasleft()`
- `assembly{ id := chainid() }` => `uint256 id = block.chainid`
- `assembly { r := mulmod(a, b, d) }` => `uint256 m = mulmod(x, y, k)`
- `assembly { size := extcodesize() }` => `uint256 size = address(a).code.length`
- etc.

*There are 1 instance(s) of this issue:*

```solidity

File: OracleHelper.sol

69: size := extcodesize(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L69

### [N-83]<a name="n-83"></a> Non `constant`/`immutable` state variables are missing a setter post deployment

Non-constant or non-immutable state variables lacking a setter function can create inflexibility in contract operations. If there's no way to update these variables post-deployment, the contract might not adapt to changing conditions or requirements, which can be a significant drawback, especially in upgradable or long-lived contracts. To resolve this, implement setter functions guarded by appropriate access controls, like `onlyOwner` or similar modifiers, so that these variables can be updated as required while maintaining security. This enables smoother contract maintenance and feature upgrades.

*There are 13 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

17: uint256 public totalReserved;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L17

```solidity

File: DeclarationsFeeManager.sol

117: uint256 public totalBadDebtETH;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L117

```solidity

File: DeclarationsFeeManager.sol

123: address[] public poolTokenAddresses;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L123

```solidity

File: DeclarationsFeeManager.sol

129: address public proposedIncentiveMaster;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L129

```solidity

File: PendlePowerFarmDeclarations.sol

43: bool public isShutdown;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L43

```solidity

File: PendlePowerFarmDeclarations.sol

46: bool public allowEnter;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L46

```solidity

File: PendlePowerFarmControllerBase.sol

56: uint256 public reservedPendleForLocking;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L56

```solidity

File: PendlePowerFarmControllerBase.sol

61: address[] public activePendleMarkets;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L61

```solidity

File: PendlePowerFarmToken.sol

35: uint256 public totalLpAssetsToDistribute;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L35

```solidity

File: MinterReserver.sol

15: uint256 public totalMinted;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L15

```solidity

File: MinterReserver.sol

18: uint256 public totalReserved;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L18

```solidity

File: MinterReserver.sol

21: uint256 public availableNFTCount;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L21

```solidity

File: Declarations.sol

25: bool public sendingProgressAaveHub;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L25

### [N-84]<a name="n-84"></a> Non-usage of specific imports

The current form of relative path import is not recommended for use because it can unpredictably pollute the namespace.
Instead, the Solidity docs recommend specifying imported symbols explicitly.
https://docs.soliditylang.org/en/v0.8.23/layout-of-source-files.html#importing-other-source-files

A good example:
```solidity
import {OwnableUpgradeable} from "openzeppelin-contracts-upgradeable/contracts/access/OwnableUpgradeable.sol";
import {SafeTransferLib} from "solmate/utils/SafeTransferLib.sol";
import {SafeCastLib} from "solmate/utils/SafeCastLib.sol";
import {ERC20} from "solmate/tokens/ERC20.sol";
import {IProducer} from "src/interfaces/IProducer.sol";
import {GlobalState, UserState} from "src/Common.sol";
```

*There are 101 instance(s) of this issue:*

```solidity

File: MainHelper.sol

5: import "./WiseLowLevelHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L5

```solidity

File: PoolManager.sol

5: import "./WiseCore.sol";

6: import "./Babylonian.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L5-L6

```solidity

File: PositionNFTs.sol

5: import "@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol";

7: import "./OwnableMaster.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L7

```solidity

File: WiseCore.sol

5: import "./MainHelper.sol";

6: import "./TransferHub/TransferHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L5-L6

```solidity

File: WiseLending.sol

11: import "./PoolManager.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L11

```solidity

File: WiseLendingDeclaration.sol

5: import "./OwnableMaster.sol";

7: import "./InterfaceHub/IAaveHubLite.sol";

8: import "./InterfaceHub/IPositionNFTs.sol";

9: import "./InterfaceHub/IWiseSecurity.sol";

10: import "./InterfaceHub/IWiseOracleHub.sol";

11: import "./InterfaceHub/IFeeManagerLight.sol";

13: import "./TransferHub/WrapperHelper.sol";

14: import "./TransferHub/SendValueHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L8, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L14

```solidity

File: WiseLowLevelHelper.sol

5: import "./WiseLendingDeclaration.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L5

```solidity

File: PendleChildLpOracle.sol

3: import "./CustomOracleSetup.sol";

5: import "../InterfaceHub/IPendle.sol";

6: import "../InterfaceHub/IPriceFeed.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L3, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L6

```solidity

File: PendleLpOracle.sol

16: import "../InterfaceHub/IPendle.sol";

17: import "../InterfaceHub/IPriceFeed.sol";

18: import "../InterfaceHub/IOraclePendle.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L16-L18

```solidity

File: PtOracleDerivative.sol

16: import "../InterfaceHub/IPriceFeed.sol";

17: import "../InterfaceHub/IOraclePendle.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L16-L17

```solidity

File: PtOraclePure.sol

16: import "../InterfaceHub/IPriceFeed.sol";

17: import "../InterfaceHub/IOraclePendle.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L16-L17

```solidity

File: DeclarationsFeeManager.sol

5: import "../InterfaceHub/IAave.sol";

6: import "../InterfaceHub/IERC20.sol";

7: import "../InterfaceHub/IWiseLending.sol";

8: import "../InterfaceHub/IFeeManager.sol";

9: import "../InterfaceHub/IWiseSecurity.sol";

10: import "../InterfaceHub/IPositionNFTs.sol";

11: import "../InterfaceHub/IWiseOracleHub.sol";

13: import "../OwnableMaster.sol";

14: import "./FeeManagerEvents.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L6, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L8, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L14

```solidity

File: FeeManager.sol

11: import "./FeeManagerHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L11

```solidity

File: FeeManagerHelper.sol

5: import "./DeclarationsFeeManager.sol";

6: import "../TransferHub/TransferHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L5-L6

```solidity

File: PendlePowerFarm.sol

5: import "./PendlePowerFarmLeverageLogic.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L5

```solidity

File: PendlePowerFarmDeclarations.sol

5: import "../../InterfaceHub/IERC20.sol";

6: import "../../InterfaceHub/IAave.sol";

7: import "../../InterfaceHub/IPendle.sol";

8: import "../../InterfaceHub/IAaveHub.sol";

9: import "../../InterfaceHub/IWiseLending.sol";

10: import "../../InterfaceHub/IStETH.sol";

11: import "../../InterfaceHub/IWiseSecurity.sol";

12: import "../../InterfaceHub/IPositionNFTs.sol";

13: import "../../InterfaceHub/IWiseOracleHub.sol";

14: import "../../InterfaceHub/IBalancerFlashloan.sol";

15: import "../../InterfaceHub/ICurve.sol";

16: import "../../InterfaceHub/IUniswapV3.sol";

18: import "../../TransferHub/WrapperHelper.sol";

19: import "../../TransferHub/TransferHelper.sol";

20: import "../../TransferHub/ApprovalHelper.sol";

21: import "../../TransferHub/SendValueHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L14, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L6, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L8, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L12, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L15, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L16, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L18, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L19, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L20, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L21

```solidity

File: PendlePowerFarmLeverageLogic.sol

5: import "./PendlePowerFarmMathLogic.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L5

```solidity

File: PendlePowerFarmMathLogic.sol

5: import "./PendlePowerFarmDeclarations.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L5

```solidity

File: PendlePowerManager.sol

11: import "./PendlePowerFarm.sol";

12: import "../../OwnableMaster.sol";

13: import "../PowerFarmNFTs/MinterReserver.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L11-L13

```solidity

File: PendlePowerFarmController.sol

5: import "./PendlePowerFarmTokenFactory.sol";

6: import "./PendlePowerFarmControllerHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L5-L6

```solidity

File: PendlePowerFarmControllerBase.sol

5: import "../../OwnableMaster.sol";

7: import "../../TransferHub/TransferHelper.sol";

8: import "../../TransferHub/ApprovalHelper.sol";

10: import "../../InterfaceHub/IPendle.sol";

11: import "../../InterfaceHub/IArbRewardsClaimer.sol";

12: import "../../InterfaceHub/IWiseOracleHub.sol";

13: import "../../InterfaceHub/IPendlePowerFarmToken.sol";

14: import "../../InterfaceHub/IPendlePowerFarmTokenFactory.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L12, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L14, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L8, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L10

```solidity

File: PendlePowerFarmControllerHelper.sol

5: import "./PendlePowerFarmControllerBase.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L5

```solidity

File: PendlePowerFarmToken.sol

5: import "./SimpleERC20Clone.sol";

7: import "../../InterfaceHub/IPendle.sol";

8: import "../../InterfaceHub/IPendleController.sol";

10: import "../../TransferHub/TransferHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L8

```solidity

File: PendlePowerFarmTokenFactory.sol

5: import "./PendlePowerFarmToken.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L5

```solidity

File: MinterReserver.sol

5: import "../../InterfaceHub/IPowerFarmsNFTs.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L5

```solidity

File: PowerFarmNFTs.sol

11: import "../../OwnableMaster.sol";

12: import "@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L11-L12

```solidity

File: ApprovalHelper.sol

5: import "./CallOptionalReturn.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L5

```solidity

File: CallOptionalReturn.sol

5: import "../InterfaceHub/IERC20.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L5

```solidity

File: TransferHelper.sol

5: import "./CallOptionalReturn.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L5

```solidity

File: WrapperHelper.sol

5: import "../InterfaceHub/IWETH.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L5

```solidity

File: Declarations.sol

5: import "../InterfaceHub/IERC20.sol";

6: import "../InterfaceHub/IPriceFeed.sol";

7: import "../InterfaceHub/IAggregator.sol";

9: import "./Libraries/IUniswapV3Factory.sol";

10: import "./Libraries/OracleLibrary.sol";

12: import "../OwnableMaster.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L12, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L6, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L10

```solidity

File: OracleHelper.sol

5: import "./Declarations.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L5

```solidity

File: WiseOracleHub.sol

11: import "./OracleHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L11

```solidity

File: WiseSecurity.sol

11: import "./WiseSecurityHelper.sol";

12: import "../TransferHub/ApprovalHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L11-L12

```solidity

File: WiseSecurityDeclarations.sol

5: import "../InterfaceHub/IERC20.sol";

6: import "../InterfaceHub/ICurve.sol";

7: import "../InterfaceHub/IPositionNFTs.sol";

8: import "../InterfaceHub/IWiseOracleHub.sol";

9: import "../InterfaceHub/IFeeManager.sol";

10: import "../InterfaceHub/IWiseLending.sol";

11: import "../InterfaceHub/IWiseLiquidation.sol";

16: import "../FeeManager/FeeManager.sol";

17: import "../OwnableMaster.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L17, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L6, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L8, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L16

```solidity

File: WiseSecurityHelper.sol

5: import "./WiseSecurityDeclarations.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L5

```solidity

File: AaveHelper.sol

5: import "./Declarations.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L5

```solidity

File: AaveHub.sol

11: import "./AaveHelper.sol";

12: import "../TransferHub/TransferHelper.sol";

13: import "../TransferHub/ApprovalHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L11-L13

```solidity

File: Declarations.sol

5: import "./AaveEvents.sol";

7: import "../InterfaceHub/IAave.sol";

8: import "../InterfaceHub/IWiseLending.sol";

9: import "../InterfaceHub/IWiseSecurity.sol";

10: import "../InterfaceHub/IPositionNFTs.sol";

12: import "../OwnableMaster.sol";

13: import "../TransferHub/WrapperHelper.sol";



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L8, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L12, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L7

### [N-85]<a name="n-85"></a> Open TODOs

An open TODO is present. It is recommended to avoid open TODOs as they may indicate programming errors that still need to be fixed.

*There are 3 instance(s) of this issue:*

```solidity

File: OracleHelper.sol

563: // @TODO: Add a check for TWAP comparison on 2.5%

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L563

```solidity

File: WiseOracleHub.sol

95: // @TODO: Delete later, keep for backward compatibility

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L95

```solidity

File: WiseOracleHub.sol

170: // @TODO: Delete later, keep for backward compatibility

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L170

### [N-86]<a name="n-86"></a> Operations such as the changing of the owner should be behind a timelock

From the point of view of a user, the changing of the owner of a contract is a high risk operation that may have outcomes ranging from an attacker gaining control over the protocol, to the function no longer functioning due to a typo in the destination address. To give users plenty of warning so that they can validate any ownership changes, changes of ownership should be behind a timelock.

*There are 2 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

103: function renounceOwnership(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L103

```solidity

File: CustomOracleSetup.sol

26: function renounceOwnership(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L26

### [N-87]<a name="n-87"></a> `private` and `internal` variables should have a preceding `_` in their name

Add a preceding underscore `_` to the variable name, take care to refactor where there variables are read/write

*There are 8 instance(s) of this issue:*

```solidity

File: WiseLendingDeclaration.sol

186: bool internal powerFarmCheck;

267: mapping(address => uint256) internal bufferIncrease;

287: mapping(address => bool) internal parametersLocked;

291: mapping(bytes32 => bool) internal hashMapPositionBorrow;

292: mapping(bytes32 => bool) internal hashMapPositionLending;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L291, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L186, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L267, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L287, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L292

```solidity

File: PendlePowerFarmControllerBase.sol

65: uint128 internal constant WEEK = 7 days;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L65

```solidity

File: WrapperHelper.sol

9: IWETH internal immutable WETH;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L9

```solidity

File: Declarations.sol

23: IAave internal immutable AAVE;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L23

### [N-88]<a name="n-88"></a> Project should include an `EmergencyStop` pattern

Adding a way to quickly halt protocol functionality in an emergency, rather than having to pause individual contracts one-by-one, will make in-progress hack mitigation faster and much less stressful.

*There are 29 instance(s) of this issue:*

```solidity

File: MainHelper.sol

7: abstract contract MainHelper is WiseLowLevelHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L7

```solidity

File: PoolManager.sol

8: abstract contract PoolManager is WiseCore {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L8

```solidity

File: WiseCore.sol

8: abstract contract WiseCore is MainHelper, TransferHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L8

```solidity

File: WiseLending.sol

43: contract WiseLending is PoolManager {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L43

```solidity

File: WiseLowLevelHelper.sol

7: abstract contract WiseLowLevelHelper is WiseLendingDeclaration {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L7

```solidity

File: CustomOracleSetup.sol

5: contract CustomOracleSetup {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L5

```solidity

File: PendleChildLpOracle.sol

13: contract PendleChildLpOracle is CustomOracleSetup  {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L13

```solidity

File: PendleLpOracle.sol

28: contract PendleLpOracle {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L28

```solidity

File: FeeManagerEvents.sol

5: contract FeeManagerEvents {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerEvents.sol#L5

```solidity

File: FeeManagerHelper.sol

8: abstract contract FeeManagerHelper is DeclarationsFeeManager, TransferHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L8

```solidity

File: PendlePowerFarm.sol

7: abstract contract PendlePowerFarm is PendlePowerFarmLeverageLogic {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L7

```solidity

File: PendlePowerFarmDeclarations.sol

36: contract PendlePowerFarmDeclarations is
    WrapperHelper,
    TransferHelper,
    ApprovalHelper,
    SendValueHelper
{



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L36

```solidity

File: PendlePowerFarmLeverageLogic.sol

7: abstract contract PendlePowerFarmLeverageLogic is
    PendlePowerFarmMathLogic,
    IFlashLoanRecipient
{



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L7

```solidity

File: PendlePowerFarmMathLogic.sol

7: abstract contract PendlePowerFarmMathLogic is PendlePowerFarmDeclarations {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L7

```solidity

File: PendlePowerFarmController.sol

8: contract PendlePowerFarmController is PendlePowerFarmControllerHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L8

```solidity

File: PendlePowerFarmControllerHelper.sol

7: abstract contract PendlePowerFarmControllerHelper is PendlePowerFarmControllerBase {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L7

```solidity

File: PendlePowerFarmToken.sol

25: contract PendlePowerFarmToken is SimpleERC20, TransferHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L25

```solidity

File: PendlePowerFarmTokenFactory.sol

9: contract PendlePowerFarmTokenFactory {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L9

```solidity

File: MinterReserver.sol

10: contract MinterReserver {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L10

```solidity

File: ApprovalHelper.sol

7: contract ApprovalHelper is CallOptionalReturn {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L7

```solidity

File: CallOptionalReturn.sol

7: contract CallOptionalReturn {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L7

```solidity

File: SendValueHelper.sol

8: contract SendValueHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/SendValueHelper.sol#L8

```solidity

File: TransferHelper.sol

7: contract TransferHelper is CallOptionalReturn {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L7

```solidity

File: WrapperHelper.sol

7: contract WrapperHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L7

```solidity

File: OracleHelper.sol

7: abstract contract OracleHelper is Declarations {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L7

```solidity

File: WiseOracleHub.sol

31: contract WiseOracleHub is OracleHelper {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L31

```solidity

File: WiseSecurityHelper.sol

7: abstract contract WiseSecurityHelper is WiseSecurityDeclarations {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L7

```solidity

File: AaveEvents.sol

5: contract AaveEvents {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L5

```solidity

File: AaveHelper.sol

7: abstract contract AaveHelper is Declarations {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L7

### [N-89]<a name="n-89"></a> `public` functions not called internally by the contract should be declared `external` instead

Those functions should be declared as `external` instead of `public`, as they are never called internally by the contract.
Contracts are allowed to override their parents' functions and change the visibility from `external` to `public`.

*There are 5 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L340

```solidity

File: PtOracleDerivative.sol

function latestRoundData()
        public
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L146

```solidity

File: PtOraclePure.sol

function latestRoundData()
        public
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L125

```solidity

File: PendlePowerFarmControllerBase.sol

function syncAllSupply()
        public
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L272

```solidity

File: PowerFarmNFTs.sol

function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L182

### [N-90]<a name="n-90"></a> Public state arrays should have a getter to return all elements

In Solidity, public state variables automatically generate a getter function. For non-array types, this is straightforward: it simply returns the value. However, for arrays, the automatically generated getter only allows retrieval of an element at a specific index, not the entire array. This is mainly to prevent unintentional high gas costs, as returning the entire array can be expensive if it's large. If developers want to retrieve the whole array, they must explicitly define a function, as auto-generation could inadvertently expose contracts to gas-related vulnerabilities or lead to unwanted behavior for larger arrays.

*There are 2 instance(s) of this issue:*

```solidity

File: DeclarationsFeeManager.sol

123: address[] public poolTokenAddresses;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L123

```solidity

File: PendlePowerFarmControllerBase.sol

61: address[] public activePendleMarkets;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L61

### [N-91]<a name="n-91"></a> Public variable declarations should have NatSpec descriptions

e.g. `@dev` or `@notice`

*There are 31 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

17: uint256 public totalReserved;

18: uint256 public immutable FEE_MANAGER_NFT;

20: mapping(address => uint256) public reserved;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L17, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L18, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L20

```solidity

File: CustomOracleSetup.sol

8: uint256 public lastUpdateGlobal;

12: mapping(uint80 => uint256) public timeStampByRoundId;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L8, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/CustomOracleSetup.sol#L12

```solidity

File: PendleLpOracle.sol

58: address public immutable PENDLE_MARKET_ADDRESS;

59: IPendleMarket public immutable PENDLE_MARKET;

64: IOraclePendle public immutable ORACLE_PENDLE_PT;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L58, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L59, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L64

```solidity

File: PendlePowerFarmDeclarations.sol

54: address public immutable aaveTokenAddresses;

55: address public immutable borrowTokenAddresses;

57: address public immutable ENTRY_ASSET;

58: address public immutable PENDLE_CHILD;

67: IAaveHub public immutable AAVE_HUB;

68: IWiseLending public immutable WISE_LENDING;

69: IWiseOracleHub public immutable ORACLE_HUB;

70: IWiseSecurity public immutable WISE_SECURITY;

71: IBalancerVault public immutable BALANCER_VAULT;

72: IPositionNFTs public immutable POSITION_NFT;

73: IStETH public immutable ST_ETH;

74: ICurve public immutable CURVE;

75: IUniswapV3 public immutable UNISWAP_V3_ROUTER;

77: IPendleSy public immutable PENDLE_SY;

78: IPendleRouter public immutable PENDLE_ROUTER;

79: IPendleMarket public immutable PENDLE_MARKET;

80: IPendleRouterStatic public immutable PENDLE_ROUTER_STATIC;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L54, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L55, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L57, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L58, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L67, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L68, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L69, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L70, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L71, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L72, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L73, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L74, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L75, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L77, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L78, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L79, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L80

```solidity

File: PendlePowerFarmController.sol

10: PendlePowerFarmTokenFactory public immutable PENDLE_POWER_FARM_TOKEN_FACTORY;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L10

```solidity

File: PendlePowerFarmControllerBase.sol

56: uint256 public reservedPendleForLocking;

66: uint256 public exchangeIncentive;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L56, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L66

```solidity

File: PendlePowerFarmToken.sol

49: uint256 public mintFee;

50: uint256 public lastInteraction;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L49-L50

```solidity

File: PendlePowerFarmTokenFactory.sol

13: address public immutable IMPLEMENTATION_TARGET;

14: address public immutable PENDLE_POWER_FARM_CONTROLLER;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L13-L14

```solidity

File: WiseSecurityDeclarations.sol

186: address public immutable AAVE_HUB;



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L186

### [N-92]<a name="n-92"></a> Empty blocks should be removed or emit something or at least add some comments to the body




*There are 6 instance(s) of this issue:*

```solidity

File: WiseLending.sol

126: {}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L126

```solidity

File: FeeManager.sol

43: {}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L43

```solidity

File: PendlePowerManager.sol

60: {
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L60

```solidity

File: PowerFarmNFTs.sol

49: {}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L49

```solidity

File: WiseSecurity.sol

52: {}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L52

```solidity

File: AaveHub.sol

37: {}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L37

### [N-93]<a name="n-93"></a> Adding A Return Statement When The Function Defines A Named Return Variable, Is Redundant




*There are 6 instance(s) of this issue:*

```solidity

File: WiseCore.sol

585: return receiveAmount

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L585

```solidity

File: PendlePowerFarmController.sol

414: return newVeBalance

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L414

```solidity

File: PendlePowerFarmController.sol

472: return amount

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L472

```solidity

File: WiseOracleHub.sol

480: return state

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L480

```solidity

File: WiseSecurityHelper.sol

207: return ethCollateral

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L207

```solidity

File: WiseSecurityHelper.sol

264: return ethCollateral

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L264

### [N-94]<a name="n-94"></a> Remove unused `error` definition

Note that there may be cases where an error superficially appears to be used, but this is only because there are multiple definitions of the error in different files. In such cases, the error definition should be moved into a separate file. The instances below are the unused definitions.

*There are 1 instance(s) of this issue:*

```solidity

File: WiseSecurityDeclarations.sol

error PositionHasCollateral
error PositionHasBorrow
error Reentered
error NotEnoughCollateral
error NonVerifiedPool
error NotRegistered


```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L0-L0

### [N-95]<a name="n-95"></a> `require()` / `revert()` Statements Should Have Descriptive Reason Strings




*There are 1 instance(s) of this issue:*

```solidity

File: CallOptionalReturn.sol

32: revert();

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L32

### [N-96]<a name="n-96"></a> Returning a struct instead of a bunch of variables is better

If a function returns [too many variables](https://docs.soliditylang.org/en/v0.8.23/contracts.html#returning-multiple-values), replacing them with a struct can improve code readability, maintainability and reusability.

*There are 5 instance(s) of this issue:*

```solidity

File: PendleChildLpOracle.sol

55: function latestRoundData()
        external
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answerdInRound
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L55

```solidity

File: PendleChildLpOracle.sol

78: function getRoundData(
        uint80 _roundId
    )
        external
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleChildLpOracle.sol#L78

```solidity

File: PendleLpOracle.sol

151: function latestRoundData()
        external
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L151

```solidity

File: PtOracleDerivative.sol

146: function latestRoundData()
        public
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L146

```solidity

File: PtOraclePure.sol

125: function latestRoundData()
        public
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L125

### [N-97]<a name="n-97"></a> Revert statements within external and public functions can be used to perform DOS attacks

In Solidity, 'revert' statements are used to undo changes and throw an exception when certain conditions are not met. However, in public and external functions, improper use of `revert` can be exploited for Denial of Service (DoS) attacks. An attacker can intentionally trigger these 'revert' conditions, causing legitimate transactions to consistently fail. For example, if a function relies on specific conditions from user input or contract state, an attacker could manipulate these to continually force reverts, blocking the function's execution. Therefore, it's crucial to design contract logic to handle exceptions properly and avoid scenarios where `revert` can be predictably triggered by malicious actors. This includes careful input validation and considering alternative design patterns that are less susceptible to such abuses.

*There are 63 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

77: revert NoValue();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L77

```solidity

File: PoolManager.sol

37: revert InvalidAction();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L37

```solidity

File: PositionNFTs.sol

78: revert NotPermitted();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L78

```solidity

File: PositionNFTs.sol

185: revert NotPermitted();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L185

```solidity

File: WiseLendingDeclaration.sol

147: revert InvalidAction();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L147

```solidity

File: PendleLpOracle.sol

105: revert CardinalityNotSatisfied();

109: revert OldestObservationNotSatisfied();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L105, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L109

```solidity

File: PtOracleDerivative.sol

110: revert CardinalityNotSatisfied();

114: revert OldestObservationNotSatisfied();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L110, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L114

```solidity

File: PtOraclePure.sol

91: revert CardinalityNotSatisfied();

95: revert OldestObservationNotSatisfied();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L91, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L95

```solidity

File: FeeManager.sol

180: revert ZeroAddress();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L180

```solidity

File: FeeManager.sol

198: revert NotAllowed();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L198

```solidity

File: FeeManager.sol

292: revert NoIncentive();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L292

```solidity

File: FeeManager.sol

321: revert NotAllowed();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L321

```solidity

File: FeeManager.sol

358: revert NotAllowed();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L358

```solidity

File: FeeManager.sol

419: revert PoolAlreadyAdded();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L419

```solidity

File: FeeManager.sol

450: revert PoolNotPresent();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L450

```solidity

File: FeeManager.sol

698: revert ExistingBadDebt();

702: revert NotAllowed();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L698, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L702

```solidity

File: FeeManager.sol

754: revert PoolNotActive();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L754

```solidity

File: FeeManager.sol

833: revert PoolNotActive();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L833

```solidity

File: PendlePowerFarmLeverageLogic.sol

68: revert AccessDenied();

74: revert InvalidParam();

78: revert NotBalancerVault();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L68, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L74, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L78

```solidity

File: PendlePowerManager.sol

292: revert DebtRatioTooHigh();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L292

```solidity

File: PendlePowerFarmController.sol

72: revert NotEnoughCompound();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L72

```solidity

File: PendlePowerFarmController.sol

125: revert ZeroShares();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L125

```solidity

File: PendlePowerFarmController.sol

183: revert WrongAddress();

195: revert NothingToSkim();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L183, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L195

```solidity

File: PendlePowerFarmController.sol

221: revert AlreadySet();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L221

```solidity

File: PendlePowerFarmController.sol

346: revert WrongAddress();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L346

```solidity

File: PendlePowerFarmController.sol

385: revert LockTimeTooShort();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L385

```solidity

File: PendlePowerFarmController.sol

476: revert NotExpired();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L476

```solidity

File: PendlePowerFarmController.sol

620: revert InvalidLength();

636: revert InvalidWeightSum();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L620, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L636

```solidity

File: PendlePowerFarmToken.sol

509: revert ZeroAmount();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L509

```solidity

File: PendlePowerFarmToken.sol

540: revert ZeroAmount();

549: revert NotEnoughLpAssetsTransferred();

560: revert ZeroFee();

564: revert TooMuchFee();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L540, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L549, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L560, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L564

```solidity

File: PendlePowerFarmToken.sol

599: revert FeeTooHigh();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L599

```solidity

File: PendlePowerFarmToken.sol

616: revert ZeroAmount();

620: revert InsufficientShares();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L616, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L620

```solidity

File: PendlePowerFarmToken.sol

655: revert ZeroAmount();

664: revert NotEnoughShares();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L655, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L664

```solidity

File: PendlePowerFarmToken.sol

692: revert AlreadyInitialized();

700: revert MarketExpired();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L692, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L700

```solidity

File: PendlePowerFarmTokenFactory.sol

45: revert DeployForbidden();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L45

```solidity

File: OracleHelper.sol

271: revert OracleIsDead();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L271

```solidity

File: WiseOracleHub.sol

77: revert OracleIsDead();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L77

```solidity

File: WiseSecurity.sol

249: revert OpenBorrowPosition();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L249

```solidity

File: WiseSecurity.sol

287: revert OpenBorrowPosition();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L287

```solidity

File: WiseSecurity.sol

344: revert ChainlinkDead();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L344

```solidity

File: WiseSecurity.sol

370: revert OpenBorrowPosition();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L370

```solidity

File: WiseSecurity.sol

1015: revert NotAllowedEntity();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1015

```solidity

File: WiseSecurity.sol

1118: revert NoValue();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1118

```solidity

File: WiseSecurityHelper.sol

679: revert NotAllowedToBorrow();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L679

```solidity

File: WiseSecurityHelper.sol

850: revert NotAllowedWiseSecurity();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L850

```solidity

File: WiseSecurityHelper.sol

867: revert LiquidationDenied();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L867

```solidity

File: WiseSecurityHelper.sol

899: revert TooManyShares();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L899

```solidity

File: WiseSecurityHelper.sol

977: revert NotOwner();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L977

```solidity

File: Declarations.sol

112: revert AlreadySet();



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L112

### [N-98]<a name="n-98"></a> Top-level declarations should be separated by at least two lines




*There are 31 instance(s) of this issue:*

```solidity

File: MainHelper.sol

3: pragma solidity =0.8.24;

import "./WiseLowLevelHelper.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L3

```solidity

File: PoolManager.sol

3: pragma solidity =0.8.24;

import "./WiseCore.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L3

```solidity

File: PositionNFTs.sol

3: pragma solidity =0.8.24;

import "@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L3

```solidity

File: WiseCore.sol

3: pragma solidity =0.8.24;

import "./MainHelper.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L3

```solidity

File: WiseLendingDeclaration.sol

3: pragma solidity =0.8.24;

import "./OwnableMaster.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L3

```solidity

File: WiseLowLevelHelper.sol

3: pragma solidity =0.8.24;

import "./WiseLendingDeclaration.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLowLevelHelper.sol#L3

```solidity

File: DeclarationsFeeManager.sol

3: pragma solidity =0.8.24;

import "../InterfaceHub/IAave.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L3

```solidity

File: FeeManagerHelper.sol

3: pragma solidity =0.8.24;

import "./DeclarationsFeeManager.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L3

```solidity

File: PendlePowerFarm.sol

3: pragma solidity =0.8.24;

import "./PendlePowerFarmLeverageLogic.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L3

```solidity

File: PendlePowerFarmDeclarations.sol

3: pragma solidity =0.8.24;

import "../../InterfaceHub/IERC20.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmDeclarations.sol#L3

```solidity

File: PendlePowerFarmLeverageLogic.sol

3: pragma solidity =0.8.24;

import "./PendlePowerFarmMathLogic.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L3

```solidity

File: PendlePowerFarmMathLogic.sol

3: pragma solidity =0.8.24;

import "./PendlePowerFarmDeclarations.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L3

```solidity

File: PendlePowerManager.sol

13: import "../PowerFarmNFTs/MinterReserver.sol";

contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L13

```solidity

File: PendlePowerFarmController.sol

3: pragma solidity =0.8.24;

import "./PendlePowerFarmTokenFactory.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L3

```solidity

File: PendlePowerFarmController.sol

6: import "./PendlePowerFarmControllerHelper.sol";

contract PendlePowerFarmController is PendlePowerFarmControllerHelper {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L6

```solidity

File: PendlePowerFarmControllerBase.sol

3: pragma solidity =0.8.24;

import "../../OwnableMaster.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L3

```solidity

File: PendlePowerFarmControllerHelper.sol

3: pragma solidity =0.8.24;

import "./PendlePowerFarmControllerBase.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L3

```solidity

File: PendlePowerFarmToken.sol

3: pragma solidity =0.8.24;

import "./SimpleERC20Clone.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L3

```solidity

File: PendlePowerFarmTokenFactory.sol

3: pragma solidity =0.8.24;

import "./PendlePowerFarmToken.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmTokenFactory.sol#L3

```solidity

File: MinterReserver.sol

3: pragma solidity =0.8.24;

import "../../InterfaceHub/IPowerFarmsNFTs.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/MinterReserver.sol#L3

```solidity

File: PowerFarmNFTs.sol

12: import "@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol";

interface IFarmContract {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L12

```solidity

File: ApprovalHelper.sol

3: pragma solidity =0.8.24;

import "./CallOptionalReturn.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L3

```solidity

File: CallOptionalReturn.sol

3: pragma solidity =0.8.24;

import "../InterfaceHub/IERC20.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L3

```solidity

File: TransferHelper.sol

3: pragma solidity =0.8.24;

import "./CallOptionalReturn.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L3

```solidity

File: WrapperHelper.sol

3: pragma solidity =0.8.24;

import "../InterfaceHub/IWETH.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L3

```solidity

File: Declarations.sol

3: pragma solidity =0.8.24;

import "../InterfaceHub/IERC20.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L3

```solidity

File: OracleHelper.sol

3: pragma solidity =0.8.24;

import "./Declarations.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L3

```solidity

File: WiseSecurityDeclarations.sol

3: pragma solidity =0.8.24;

import "../InterfaceHub/IERC20.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L3

```solidity

File: WiseSecurityHelper.sol

3: pragma solidity =0.8.24;

import "./WiseSecurityDeclarations.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L3

```solidity

File: AaveHelper.sol

3: pragma solidity =0.8.24;

import "./Declarations.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHelper.sol#L3

```solidity

File: Declarations.sol

3: pragma solidity =0.8.24;

import "./AaveEvents.sol";

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L3

### [N-99]<a name="n-99"></a> Arrays can grow in size without a way to shrink them

New items are pushed into the following arrays but there is no option to `pop` them out. Currently, the array can grow indefinitely. E.g. there's no maximum limit and there's no functionality to remove array values.
If the array grows too large, calling relevant functions might run out of gas and revert. Calling these functions could result in a DOS condition.

*There are 2 instance(s) of this issue:*

```solidity

File: MainHelper.sol

633: userTokenData[_nftId].push(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L633

```solidity

File: PendlePowerFarmController.sol

283: activePendleMarkets.push(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L283

### [N-100]<a name="n-100"></a> Uncommented fields in a struct

Consider adding comments for all the fields in a struct to improve the readability of the codebase.

*There are 13 instance(s) of this issue:*

```solidity

File: PoolManager.sol

12: struct CreatePool {
        bool allowBorrow;
        address poolToken;
        uint256 poolMulFactor;
        uint256 poolCollFactor;
        uint256 maxDepositAmount;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L12

```solidity

File: PoolManager.sol

20: struct CurvePoolSettings {
        CurveSwapStructData curveSecuritySwapsData;
        CurveSwapStructToken curveSecuritySwapsToken;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L20

```solidity

File: WiseLendingDeclaration.sol

192: struct LendingEntry {
        bool unCollateralized;
        uint256 shares;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L192

```solidity

File: WiseLendingDeclaration.sol

197: struct BorrowRatesEntry {
        uint256 pole;
        uint256 deltaPole;
        uint256 minPole;
        uint256 maxPole;
        uint256 multiplicativeFactor;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L197

```solidity

File: WiseLendingDeclaration.sol

205: struct AlgorithmEntry {
        bool increasePole;
        uint256 bestPole;
        uint256 maxValue;
        uint256 previousValue;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L205

```solidity

File: WiseLendingDeclaration.sol

212: struct GlobalPoolEntry {
        uint256 totalPool;
        uint256 utilization;
        uint256 totalBareToken;
        uint256 poolFee;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L212

```solidity

File: WiseLendingDeclaration.sol

219: struct LendingPoolEntry {
        uint256 pseudoTotalPool;
        uint256 totalDepositShares;
        uint256 collateralFactor;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L219

```solidity

File: WiseLendingDeclaration.sol

225: struct BorrowPoolEntry {
        bool allowBorrow;
        uint256 pseudoTotalBorrowAmount;
        uint256 totalBorrowShares;
        uint256 borrowRate;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L225

```solidity

File: WiseLendingDeclaration.sol

232: struct TimestampsPoolEntry {
        uint256 timeStamp;
        uint256 timeStampScaling;
        uint256 initialTimeStamp;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L232

```solidity

File: WiseLendingDeclaration.sol

238: struct CoreLiquidationStruct {
        uint256 nftId;
        uint256 nftIdLiquidator;
        address caller;
        address tokenToPayback;
        address tokenToRecieve;
        uint256 paybackAmount;
        uint256 shareAmountToPay;
        uint256 maxFeeETH;
        uint256 baseRewardLiquidation;
        address[] lendTokens;
        address[] borrowTokens;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L238

```solidity

File: PendlePowerFarmControllerBase.sol

35: struct CompoundStruct {
        uint256[] reservedForCompound;
        uint128[] lastIndex;
        address[] rewardTokens;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L35

```solidity

File: Declarations.sol

35: struct UniTwapPoolInfo {
        bool isUniPool;
        address oracle;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L35

```solidity

File: Declarations.sol

40: struct DerivativePartnerInfo {
        address partnerTokenAddress;
        address partnerOracleAddress;
    }

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L40

### [N-101]<a name="n-101"></a> Unused event may be unused code or indicative of missed emit/logic

Events that are declared but not used may be indicative of unused declarations where it makes sense to remove them for better readability/maintainability/auditability, or worse indicative of a missing emit which is bad for monitoring or missing logic that would have emitted that event.

*There are 2 instance(s) of this issue:*

```solidity

File: AaveEvents.sol

33: event IsSolelyDepositAave

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L33

```solidity

File: AaveEvents.sol

38: event IsSolelyWithdrawAave

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveEvents.sol#L38

### [N-102]<a name="n-102"></a> Unused `struct` definition

Note that there may be cases where a struct superficially appears to be used, but this is only because there are multiple definitions of the struct in different files. In such cases, the struct definition should be moved into a separate file. The instances below are the unused definitions.

*There are 1 instance(s) of this issue:*

```solidity

File: WiseLendingDeclaration.sol

238: struct CoreLiquidationStruct {
        uint256 nftId;
        uint256 nftIdLiquidator;
        address caller;
        address tokenToPayback;
        address tokenToRecieve;
        uint256 paybackAmount;
        uint256 shareAmountToPay;
        uint256 maxFeeETH;
        uint256 baseRewardLiquidation;
        address[] lendTokens;
        address[] borrowTokens;
    }



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L238

### [N-103]<a name="n-103"></a> Upgrade OpenZeppelin Contract Dependency

An outdated OZ version is used (which has known vulnerabilities, see: https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories).
Release: https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v5.0.0

*There are 1 instance(s) of this issue:*

```solidity

File: package.json

        "@openzeppelin/contracts": "^4.9.3"

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/package.json#L82

### [N-104]<a name="n-104"></a> Large multiples of ten should use scientific notation

Use (e.g. 1e6) rather than decimal literals (e.g. 100000), for better code readability.

*There are 1 instance(s) of this issue:*

```solidity

File: PendlePowerFarmToken.sol

54: uint256 private constant MAX_MINT_FEE = 10000;

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L54

### [N-105]<a name="n-105"></a> Use a struct to encapsulate multiple function parameters

If a function has too many parameters, replacing them with a struct can improve code readability and maintainability, increase reusability, and reduce the likelihood of errors when passing the parameters.

*There are 3 instance(s) of this issue:*

```solidity

File: WiseLending.sol

1314: function coreLiquidationIsolationPools(
        uint256 _nftId,
        uint256 _nftIdLiquidator,
        address _caller,
        address _paybackToken,
        address _receiveToken,
        uint256 _paybackAmount,
        uint256 _shareAmountToPay
    )
        external
        syncPool(_paybackToken)
        syncPool(_receiveToken)
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1314

```solidity

File: PendlePowerFarmLeverageLogic.sol

15: function _executeBalancerFlashLoan(
        uint256 _nftId,
        uint256 _flashAmount,
        uint256 _initialAmount,
        uint256 _lendingShares,
        uint256 _borrowShares,
        uint256 _allowedSpread,
        bool _ethBack,
        bool _isAave
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L15

```solidity

File: PendlePowerFarmLeverageLogic.sol

134: function _logicClosePosition(
        uint256 _nftId,
        uint256 _borrowShares,
        uint256 _lendingShares,
        uint256 _totalDebtBalancer,
        uint256 _allowedSpread,
        address _caller,
        bool _ethBack,
        bool _isAave
    )
        private
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L134

### [N-106]<a name="n-106"></a> Use `@inheritdoc` for overridden functions

It is recommended to use `@inheritdoc` for overridden functions.

*There are 2 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

340: function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L340

```solidity

File: PowerFarmNFTs.sol

182: function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L182

### [N-107]<a name="n-107"></a> Use @inheritdoc rather than using a non-standard annotation




*There are 345 instance(s) of this issue:*

```solidity

File: MainHelper.sol

9: /**
     * @dev Helper function to convert {

47: /**
     * @dev Helper function to convert {

71: /**
     * @dev Helper function to convert {

106: /**
     * @dev Helper function to convert {

9: /**
     * @dev Helper function to convert {

47: /**
     * @dev Helper function to convert {

71: /**
     * @dev Helper function to convert {

106: /**
     * @dev Helper function to convert {

9: /**
     * @dev Helper function to convert {

47: /**
     * @dev Helper function to convert {

71: /**
     * @dev Helper function to convert {

106: /**
     * @dev Helper function to convert {

9: /**
     * @dev Helper function to convert {

47: /**
     * @dev Helper function to convert {

71: /**
     * @dev Helper function to convert {

106: /**
     * @dev Helper function to convert {

130: /**
     * @dev Internal helper combining one
     * security check with lending share
     * calculation for withdraw.
     */
    function _preparationsWithdraw(
        uint256 _nftId,
        address _caller,
        address _poolToken,
        uint256 _amount
    )
        internal
        view
        returns (uint256)
    {

159: /**
     * @dev Internal helper calculating {_poolToken}
     * utilization. Includes math underflow check.
     */
    function _getValueUtilization(
        address _poolToken
    )
        private
        view
        returns (uint256)
    {

183: /**
     * @dev Internal helper function setting new pool
     * utilization by calling {

197: /**
     * @dev Internal helper function checking if
     * cleanup gathered new token to save into
     * pool variables.
     */
    function _checkCleanUp(
        uint256 _amountContract,
        uint256 _totalPool,
        uint256 _bareAmount
    )
        private
        pure
        returns (bool)
    {

214: /**
     * @dev Wrapper for isolation pool check.
     */
    function _onlyIsolationPool(
        address _poolAddress
    )
        internal
        view
    {

228: /**
     * @dev Internal helper function checking if
     * user inputs are safe.
     */
    function _validateIsolationPoolLiquidation(
        address _caller,
        uint256 _nftId,
        uint256 _nftIdLiquidator
    )
        internal
        view
    {

290: /**
     * @dev Internal helper function checking if falsely
     * sent token are inside the contract for the pool with
     * {

345: /**
     * @dev Internal helper function calculating
     * allowed increase of pseudoTotalPool to
     * contain shareprice increase reasoanbly.
    */
    function _getAllowedDifference(
        address _poolToken
    )
        private
        view
        returns (uint256)
    {

366: /**
     * @dev Internal helper function for
     * updating pools and calling {

386: /**
     * @dev Internal helper function for
     * updating all lending tokens of a
     * position.
     */
    function _preparationTokens(
        mapping(uint256 => address[]) storage _userTokenData,
        uint256 _nftId,
        address _poolToken
    )
        internal
        returns (address[] memory)
    {

411: /**
     * @dev Internal helper function for
     * updating pseudo amounts of a pool
     * inside {

450: /**
     * @dev Internal helper function for iterating
     * over all tokens which may contain curvePools.
     */
    function _curveSecurityChecks(
        address[] memory _lendTokens,
        address[] memory _borrowTokens
    )
        internal
    {

469: /**
     * @dev Internal helper function for executing while loops
     * iterating over all tokens which may contain curvePools.
     */
    function _whileLoopCurveSecurity(
        address[] memory _tokens
    )
        private
    {

493: /**
     * @dev Internal helper function
     * updating pseudo amounts and
     * printing fee shares for the
     * feeManager proportional to the
     * fee percentage of the pool.
     */
    function _updatePseudoTotalAmounts(
        address _poolToken
    )
        private
    {

579: /**
     * @dev Internal increas function for
     * lending shares of a postion {

594: /**
     * @dev Internal decrease function for
     * lending shares of a postion {

609: /**
     * @dev Internal helper function adding a new
     * {

642: /**
     * @dev Internal helper calculating
     * a hash out of {_nftId} and {_poolToken}
     * using keccak256.
     */
    function _getHash(
        uint256 _nftId,
        address _poolToken
    )
        private
        pure
        returns (bytes32)
    {

663: /**
     * @dev Internal helper function deleting an
     * entry in {

729: /**
     * @dev Internal helper deleting last entry
     * of postion lending data.
     */
    function _deleteLastPositionLendingData(
        uint256 _nftId,
        address _poolToken
    )
        private
    {

748: /**
     * @dev Core function combining payback
     * logic with security checks.
     */
    function _corePayback(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount,
        uint256 _shares
    )
        internal
    {

790: /**
     * @dev Internal helper deleting last entry
     * of postion borrow data.
     */
    function _deleteLastPositionBorrowData(
        uint256 _nftId,
        address _poolToken
    )
        private
    {

809: /**
     * @dev Internal helper function calculating
     * returning if a {

825: /**
     * @dev Internal helper function
     * checking if {

842: /**
     * @dev Internal helper function
     * calculating new borrow rates
     * for {

869: /**
     * @dev Internal helper function
     * updating utilization of the pool
     * with {

891: /**
     * @dev Internal helper function
     * checking if time interval for
     * next LASA call has passed.
     */
    function _aboveThreshold(
        address _poolToken
    )
        internal
        view
        returns (bool)
    {

906: /**
     * @dev function that tries to maximise totalDepositShares of the pool.
     * Reacting to negative and positive feedback by changing the resonance
     * factor of the pool. Method similar to one parameter monte-carlo methods
     */
    function _scalingAlgorithm(
        address _poolToken
    )
        internal
    {

943: /**
     * @dev Sets the new max value in shares
     * and saves the corresponding resonance factor.
     */
    function _newMaxPoolShares(
        address _poolToken,
        uint256 _shareValue
    )
        private
    {

964: /**
     * @dev Internal function setting {

983: /**
     * @dev Returns bool to determine if resonance
     * factor needs to be reset to last best value.
     */
    function _resonanceOutcome(
        address _poolToken,
        uint256 _shareValue
    )
        private
        view
        returns (bool)
    {

1000: /**
     * @dev Resets resonance factor to old best value when system
     * evolves into too bad state and sets current totalDepositShares
     * amount to new maxPoolShares to exclude eternal loops and that
     * unorganic peaks do not set maxPoolShares forever.
     */
    function _resetResonanceFactor(
        address _poolToken,
        uint256 _shareValue
    )
        private
    {

1027: /**
     * @dev Reverts the flag for stepping direction from LASA.
     */
    function _revertDirectionState(
        address _poolToken
    )
        private
    {

1041: /**
     * @dev Function combining all possible stepping scenarios.
     * Depending how share values has changed compared to last time.
     */
    function _updateResonanceFactor(
        address _poolToken,
        uint256 _shareValues
    )
        private
    {

1058: /**
     * @dev Does a revert stepping and swaps stepping state in opposite flag.
     */
    function _reversedResonanceFactor(
        address _poolToken
    )
        private
    {

1075: /**
     * @dev Increasing or decresing resonance factor depending on flag value.
     */
    function _changingResonanceFactor(
        address _poolToken
    )
        private
    {

1088: /**
     * @dev stepping function increasing the resonance factor
     * depending on the time past in the last time interval.
     * Checks if current resonance factor is bigger than max value.
     * If this is the case sets current value to maximal value
     */
    function _increaseResonanceFactor(
        address _poolToken
    )
        private
    {

1119: /**
     * @dev Stepping function decresing the resonance factor
     * depending on the time past in the last time interval.
     * Checks if current resonance factor undergoes the min value,
     * if this is the case sets current value to minimal value.
     */
    function _decreaseResonanceFactor(
        address _poolToken
    )
        private
    {

1149: /**
     * @dev Internal helper function for removing token address
     * from lending data array if all shares are removed. When
     * feeManager (nftId = 0) is calling this function is skipped
     * to save gas for continues fee accounting.
     */
    function _removeEmptyLendingData(
        uint256 _nftId,
        address _poolToken
    )
        internal
    {

1179: /**
     * @dev Internal helper function grouping several function
     * calls into one function for refactoring and code size
     * reduction.
     */
    function _updatePoolStorage(
        address _poolToken,
        uint256 _amount,
        uint256 _shares,
        function(address, uint256) functionAmountA,
        function(address, uint256) functionAmountB,
        function(address, uint256) functionSharesA
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L366, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L71, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L106, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L71, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L106, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L71, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L106, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L47, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L71, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L106, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L130, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L159, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L183, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L197, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L214, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L228, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L290, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L345, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L386, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L411, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L450, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L469, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L493, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L579, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L594, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L609, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L642, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L663, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L729, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L748, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L790, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L809, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L825, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L842, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L869, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L891, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L906, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L943, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L964, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L983, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1000, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1027, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1041, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1058, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1075, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1088, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1119, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1149, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L1179

```solidity

File: OwnableMaster.sol

66: /**
     * @dev Allows to propose next master.
     * Must be claimed by proposer.
     */
    function proposeOwner(
        address _proposedOwner
    )
        external
        onlyMaster
    {

88: /**
     * @dev Allows to claim master role.
     * Must be called by proposer.
     */
    function claimOwnership()
        external
        onlyProposed
    {

99: /**
     * @dev Removes master role.
     * No ability to be in control.
     */
    function renounceOwnership()
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L66, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L88, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L99

```solidity

File: PoolManager.sol

122: /**
     * @dev Allow to verify isolation pool.
     */
    function setVerifiedIsolationPool(
        address _isolationPool,
        bool _state
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PoolManager.sol#L122

```solidity

File: PositionNFTs.sol

138: /**
     * @dev Mints NFT for sender, without it
     * user can not use WiseLending protocol
     */
    function mintPosition()
        external
        returns (uint256)
    {

151: /**
     * @dev See {IERC721-getApproved}.
     */
    function getApprovedSoft(
        uint256 tokenId
    )
        external
        view
        returns (address)
    {

170: /**
     * @dev Mints NFT for _user, without it
     * user can not use WiseLending protocol
     */
    function mintPositionForUser(
        address _user
    )
        external
        returns (uint256)
    {

268: /**
     * @dev Returns positions of owner
     */
    function walletOfOwner(
        address _owner
    )
        external
        view
        returns (uint256[] memory)
    {

316: /**
     * @dev Allows to update base target for MetaData.
     */
    function setBaseURI(
        string memory _newBaseURI
    )
        external
        onlyMaster
    {

337: /**
     * @dev Returns path to MetaData URI
     */
    function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {

368: /**
     * @dev Converts tokenId uint to string.
     */
    function _toString(
        uint256 _tokenId
    )
        internal
        pure
        returns (string memory str)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L138, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L151, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L170, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L268, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L316, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L337, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L368

```solidity

File: WiseCore.sol

10: /**
     * @dev Wrapper function combining pool
     * preparations for borrow and collaterals.
     * Bypassed when called by powerFarms.
     */
    function _prepareAssociatedTokens(
        uint256 _nftId,
        address _poolTokenLend,
        address _poolTokenBorrow
    )
        internal
        returns (
            address[] memory,
            address[] memory
        )
    {

40: /**
     * @dev Core function combining withdraw
     * logic and security checks.
     */
    function _coreWithdrawToken(
        address _caller,
        uint256 _nftId,
        address _poolToken,
        uint256 _amount,
        uint256 _shares,
        bool _onBehalf
    )
        internal
    {

102: /**
     * @dev Internal function combining deposit
     * logic, security checks and event emit.
     */
    function _handleDeposit(
        address _caller,
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        internal
        returns (uint256)
    {

168: /**
     * @dev External wrapper for
     * {_checkPositionLocked}.
     */

    function checkPositionLocked(
        uint256 _nftId,
        address _caller
    )
        external
        view
    {

186: /**
     * @dev Checks if a postion is locked
     * for powerFarms. Get skipped when
     * aaveHub or a powerFarm itself is
     * the {msg.sender}.
     */

    function _checkPositionLocked(
        uint256 _nftId,
        address _caller
    )
        internal
        view
    {

211: /**
     * @dev External wrapper for
     * {_checkDeposit}.
     */
    function checkDeposit(
        uint256 _nftId,
        address _caller,
        address _poolToken,
        uint256 _amount
    )
        external
        view
    {

232: /**
     * @dev Internal function including
     * security checks for deposit logic.
     */
    function _checkDeposit(
        uint256 _nftId,
        address _caller,
        address _poolToken,
        uint256 _amount
    )
        internal
        view
    {

289: /**
     * @dev Internal function checking
     * if the deposit amount for the
     * pool token is reached.
     */
    function _checkMaxDepositValue(
        address _poolToken,
        uint256 _amount
    )
        private
        view
    {

311: /**
     * @dev Low level core function combining
     * pure withdraw math (without security
     * checks).
     */
    function _coreWithdrawBare(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount,
        uint256 _shares
    )
        private
    {

345: /**
     * @dev Core function combining borrow
     * logic with security checks.
     */
    function _coreBorrowTokens(
        address _caller,
        uint256 _nftId,
        address _poolToken,
        uint256 _amount,
        uint256 _shares,
        bool _onBehalf
    )
        internal
    {

423: /**
     * @dev Internal math function for liquidation logic
     * caluclating amount to withdraw from pure
     * collateral for liquidation.
     */
    function _withdrawPureCollateralLiquidation(
        uint256 _nftId,
        address _poolToken,
        uint256 _percentLiquidation
    )
        private
        returns (uint256 transferAmount)
    {

454: /**
     * @dev Internal math function for liquidation logic
     * which checks if pool has enough token to pay out
     * liquidator. If not, liquidator get corresponding
     * shares for later withdraw.
     */
    function _withdrawOrAllocateSharesLiquidation(
        uint256 _nftId,
        uint256 _nftIdLiquidator,
        address _poolToken,
        uint256 _percentWishCollateral
    )
        private
        returns (uint256)
    {

538: /**
     * @dev Internal math function combining functionallity
     * of {

621: /**
     * @dev Core liquidation function for
     * security checks and liquidation math.
     */
    function _coreLiquidation(
        CoreLiquidationStruct memory _data
    )
        internal
        returns (uint256 receiveAmount)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L40, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L102, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L168, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L186, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L211, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L232, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L289, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L311, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L345, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L423, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L454, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L538, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseCore.sol#L621

```solidity

File: WiseLending.sol

5: /**
 * @author René Hochmuth
 * @author Christoph Krpoun
 * @author Vitally Marinchenko
 */

import "./PoolManager.sol";

/**
 * @dev WISE lending is an automated lending platform on which users can collateralize
 * their assets and borrow tokens against them.
 *
 * Users need to pay borrow rates for debt tokens, which are reflected in a borrow APY for
 * each asset type (pool). This borrow rate is variable over time and determined through the
 * utilization of the pool. The bounding curve is a family of different bonding curves adjusted
 * automatically by LASA (Lending Automated Scaling Algorithm). For more information, see:
 * [https://wisesoft.gitbook.io/wise/wise-lending-protocol/lasa-ai]
 *
 * In addition to normal deposit, withdraw, borrow, and payback functions, there are other
 * interacting modes:
 *
 * - Solely deposit and withdraw allows the user to keep their funds private, enabling
 *    them to withdraw even when the pools are borrowed empty.
 *
 * - Aave pools  allow for maximal capital efficiency by earning aave supply APY for not
 *   borrowed funds.
 *
 * - Special curve pools nside beefy farms can be used as collateral, opening up new usage
 *   possibilities for these asset types.
 *
 * - Users can pay back their borrow with lending shares of the same asset type, making it
 *   easier to manage their positions.
 *
 * - Users save their collaterals and borrows inside a position NFT, making it possible
 *   to trade their whole positions or use them in second-layer contracts
 *   (e.g., spot trading with PTP NFT trading platforms).
 */

contract WiseLending is PoolManager {

45: /**
     * @dev Standard receive functions forwarding
     * directly send ETH to the master address.
     */
    receive()
        external
        payable
    {

63: /**
     * @dev Checks if position is healthy
     * after all state changes are done.
     */
    modifier healthStateCheck(
        uint256 _nftId
    ) {
        _;

        _healthStateCheck(
            _nftId
        );
    }

    function _healthStateCheck(
        uint256 _nftId
    )
        private
    {

92: /**
     * @dev Runs the LASA algorithm known as
     * Lending Automated Scaling Algorithm
     * and updates pool data based on token
     */
    modifier syncPool(
        address _poolToken
    ) {
        (
            uint256 lendSharePrice,
            uint256 borrowSharePrice
        ) = _syncPoolBeforeCodeExecution(
            _poolToken
        );

        _;

        _syncPoolAfterCodeExecution(
            _poolToken,
            lendSharePrice,
            borrowSharePrice
        );
    }

    constructor(
        address _master,
        address _wiseOracleHubAddress,
        address _nftContract
    )
        WiseLendingDeclaration(
            _master,
            _wiseOracleHubAddress,
            _nftContract
        )
    {}

    function _emitFundsSolelyWithdrawn(
        address _caller,
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        private
    {

162: /**
     * @dev Fetches share price of lending shares.
     */
    function _getSharePrice(
        address _poolToken
    )
        private
        view
        returns (
            uint256,
            uint256
        )
    {

205: /**
     * @dev Compares share prices before and after
     * execution. If borrow share price increased
     * or lending share price decreased, revert.
     */
    function _compareSharePrices(
        address _poolToken,
        uint256 _lendSharePriceBefore,
        uint256 _borrowSharePriceBefore
    )
        private
        view
    {

250: /**
    * @dev Since pool inception share price
    * increase for both lending and borrow shares
    * is capped at 500% apr max in between a transaction.
    */
    function _getCurrentSharePriceMax(
        address _poolToken
    )
        private
        view
        returns (uint256)
    {

270: /**
     * @dev First part of pool sync updating pseudo
     * amounts. Is skipped when powerFarms or aaveHub
     * is calling the function.
     */
    function _syncPoolBeforeCodeExecution(
        address _poolToken
    )
        private
        returns (
            uint256 lendSharePrice,
            uint256 borrowSharePrice
        )
    {

304: /**
     * @dev Second part of pool sync updating
     * the borrow pool rate and share price.
     */
    function _syncPoolAfterCodeExecution(
        address _poolToken,
        uint256 _lendSharePriceBefore,
        uint256 _borrowSharePriceBefore
    )
        private
    {

326: /**
     * @dev Enables _poolToken to be used as a collateral.
     */
    function collateralizeDeposit(
        uint256 _nftId,
        address _poolToken
    )
        external
        syncPool(_poolToken)
    {

345: /**
     * @dev Disables _poolToken to be used as a collateral.
     */
    function unCollateralizeDeposit(
        uint256 _nftId,
        address _poolToken
    )
        external
        syncPool(_poolToken)
    {

384: /**
     * @dev Allows to supply funds using ETH.
     * Without converting to WETH, use ETH directly.
     */
    function depositExactAmountETH(
        uint256 _nftId
    )
        external
        payable
        syncPool(WETH_ADDRESS)
        returns (uint256)
    {

421: /**
     * @dev Allows to supply funds using ETH.
     * Without converting to WETH, use ETH directly,
     * also mints position to avoid extra transaction.
     */
    function depositExactAmountETHMint()
        external
        payable
        syncPool(WETH_ADDRESS)
        returns (uint256)
    {

437: /**
     * @dev Allows to supply _poolToken and user
     * can decide if _poolToken should be collateralized,
     * also mints position to avoid extra transaction.
     */
    function depositExactAmountMint(
        address _poolToken,
        uint256 _amount
    )
        external
        returns (uint256)
    {

456: /**
     * @dev Allows to supply _poolToken and user
     * can decide if _poolToken should be collateralized.
     */
    function depositExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        public
        syncPool(_poolToken)
        returns (uint256)
    {

486: /**
     * @dev Allows to supply funds using ETH in solely mode,
     * which does not earn APY, but keeps the funds private.
     * Other users are restricted from borrowing these funds,
     * owner can always withdraw even if all funds are borrowed.
     * Also mints position to avoid extra transaction.
     */
    function solelyDepositETHMint()
        external
        payable
    {

502: /**
     * @dev Allows to supply funds using ETH in solely mode,
     * which does not earn APY, but keeps the funds private.
     * Other users are restricted from borrowing these funds,
     * owner can always withdraw even if all funds are borrowed.
     */
    function solelyDepositETH(
        uint256 _nftId
    )
        public
        payable
        syncPool(WETH_ADDRESS)
    {

534: /**
     * @dev Core function combining
     * supply logic with security
     * checks for solely deposit.
     */
    function _handleSolelyDeposit(
        address _caller,
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        private
    {

574: /**
     * @dev Allows to supply funds using ERC20 in solely mode,
     * which does not earn APY, but keeps the funds private.
     * Other users are restricted from borrowing these funds,
     * owner can always withdraw even if all funds are borrowed.
     * Also mints position to avoid extra transaction.
     */
    function solelyDepositMint(
        address _poolToken,
        uint256 _amount
    )
        external
    {

594: /**
     * @dev Allows to supply funds using ERC20 in solely mode,
     * which does not earn APY, but keeps the funds private.
     * Other users are restricted from borrowing these funds,
     * owner can always withdraw even if all funds are borrowed.
     */
    function solelyDeposit(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        public
        syncPool(_poolToken)
    {

632: /**
     * @dev Allows to withdraw publicly
     * deposited ETH funds using exact amount.
     */
    function withdrawExactAmountETH(
        uint256 _nftId,
        uint256 _amount
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {

671: /**
     * @dev Allows to withdraw publicly
     * deposited ETH funds using exact shares.
     */
    function withdrawExactSharesETH(
        uint256 _nftId,
        uint256 _shares
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {

710: /**
     * @dev Allows to withdraw publicly
     * deposited ERC20 funds using exact amount.
     */
    function withdrawExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _withdrawAmount
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {

747: /**
     * @dev Allows to withdraw privately
     * deposited ETH funds using input amount.
     */
    function solelyWithdrawETH(
        uint256 _nftId,
        uint256 _withdrawAmount
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
    {

776: /**
     * @dev Allows to withdraw privately
     * deposited ERC20 funds using input amount.
     */
    function solelyWithdraw(
        uint256 _nftId,
        address _poolToken,
        uint256 _withdrawAmount
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
    {

803: /**
     * @dev Core function combining
     * withdraw logic for solely
     * withdraw with security checks.
     */
    function _coreSolelyWithdraw(
        address _caller,
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        private
    {

854: /**
     * @dev Allows to withdraw privately
     * deposited ERC20 on behalf of owner.
     * Requires approval by _nftId owner.
     */
    function withdrawOnBehalfExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _withdrawAmount
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {

898: /**
     * @dev Allows to withdraw ERC20
     * funds using shares as input value
     */
    function withdrawExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {

935: /**
     * @dev Withdraws ERC20 funds on behalf
     * of _nftId owner, requires approval.
     */
    function withdrawOnBehalfExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {

971: /**
     * @dev Allows to borrow ETH funds
     * Requires user to have collateral.
     */
    function borrowExactAmountETH(
        uint256 _nftId,
        uint256 _amount
    )
        external
        syncPool(WETH_ADDRESS)
        healthStateCheck(_nftId)
        returns (uint256)
    {

1012: /**
     * @dev Allows to borrow ERC20 funds
     * Requires user to have collateral.
     */
    function borrowExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        external
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {

1051: /**
     * @dev Allows to borrow ERC20 funds
     * on behalf of _nftId owner, if approved.
     */
    function borrowOnBehalfExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        external
        onlyAaveHub
        syncPool(_poolToken)
        healthStateCheck(_nftId)
        returns (uint256)
    {

1084: /**
     * @dev Ability to payback ETH loans
     * by providing exact payback amount.
     */
    function paybackExactAmountETH(
        uint256 _nftId
    )
        external
        payable
        syncPool(WETH_ADDRESS)
        returns (uint256)
    {

1157: /**
     * @dev Ability to payback ERC20 loans
     * by providing exact payback amount.
     */
    function paybackExactAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _amount
    )
        external
        syncPool(_poolToken)
        returns (uint256)
    {

1200: /**
     * @dev Ability to payback ERC20 loans
     * by providing exact payback shares.
     */
    function paybackExactShares(
        uint256 _nftId,
        address _poolToken,
        uint256 _shares
    )
        external
        syncPool(_poolToken)
        returns (uint256)
    {

1242: /**
     * @dev Function to liquidate a postion which reaches
     * a debt ratio greater than 100%. The liquidator can choose
     * token to payback and receive. (Both can differ!). The
     * amount is in shares of the payback token. The liquidator
     * gets an incentive which is calculated inside the liquidation
     * logic.
     */
    function liquidatePartiallyFromTokens(
        uint256 _nftId,
        uint256 _nftIdLiquidator,
        address _paybackToken,
        address _receiveToken,
        uint256 _shareAmountToPay
    )
        external
        syncPool(_paybackToken)
        syncPool(_receiveToken)
        returns (uint256)
    {

1311: /**
     * @dev Wrapper function for liqudaiton flow
     */
    function coreLiquidationIsolationPools(
        uint256 _nftId,
        uint256 _nftIdLiquidator,
        address _caller,
        address _paybackToken,
        address _receiveToken,
        uint256 _paybackAmount,
        uint256 _shareAmountToPay
    )
        external
        syncPool(_paybackToken)
        syncPool(_receiveToken)
        returns (uint256)
    {

1363: /**
     * @dev Allows to sync pool manually
     * so that the pool is up to date.
     */
    function syncManually(
        address _poolToken
    )
        external
        syncPool(_poolToken)
    {

1382: /**
     * @dev Registers position _nftId
     * for isolation pool functionality
     */
    function setRegistrationIsolationPool(
        uint256 _nftId,
        bool _registerState
    )
        external
    {

1407: /**
    * @dev External wrapper for
    * {_corePayback} logic callable
    * by feeMananger.
    */
    function corePaybackFeeManager(
        address _poolToken,
        uint256 _nftId,
        uint256 _amount,
        uint256 _shares
    )
        external
        onlyFeeManager
        syncPool(_poolToken)
    {

1430: /**
     * @dev Internal function combining payback
     * logic and emit of an event.
     */
    function _handlePayback(
        address _caller,
        uint256 _nftId,
        address _poolToken,
        uint256 _amount,
        uint256 _shares
    )
        private
    {

1584: /**
     * @dev Internal helper function for reservating a
     * position NFT id.
     */
    function _reservePosition()
        private
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L45, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L63, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L92, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L162, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L205, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L250, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L270, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L304, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L326, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L345, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L384, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L421, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L437, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L456, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L486, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L502, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L534, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L574, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L594, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L632, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L671, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L710, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L747, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L776, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L803, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L854, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L898, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L935, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L971, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1012, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1051, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1084, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1157, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1200, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1242, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1311, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1363, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1382, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1407, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1430, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L1584

```solidity

File: PendleLpOracle.sol

5: /**
 * @author René Hochmuth
 */

/**
 * @dev PriceFeed contract for Lp-Token with USD
 * chainLink feed to get a feed measured in ETH.
 * Takes chainLink oracle value and multiplies it
 * with the corresponding TWAP and other chainLink oracles.
 */

import "../InterfaceHub/IPendle.sol";
import "../InterfaceHub/IPriceFeed.sol";
import "../InterfaceHub/IOraclePendle.sol";
import {
    PendleLpOracleLib,
    IPMarket
} from "@pendle/core-v2/contracts/oracles/PendleLpOracleLib.sol";

error InvalidDecimals();
error CardinalityNotSatisfied();
error OldestObservationNotSatisfied();

contract PendleLpOracle {

    uint256 internal constant DEFAULT_DECIMALS = 18;

    constructor(
        address _pendleMarketAddress,
        IPriceFeed _priceFeedChainLinkEth,
        IOraclePendle _oraclePendlePt,
        string memory _oracleName,
        uint32 _twapDuration
    )
    {
        PENDLE_MARKET_ADDRESS = _pendleMarketAddress;

        FEED_ASSET = _priceFeedChainLinkEth;

        if (FEED_ASSET.decimals() != DEFAULT_DECIMALS) {
            revert InvalidDecimals();
        }

        TWAP_DURATION = _twapDuration;
        ORACLE_PENDLE_PT = _oraclePendlePt;

        PENDLE_MARKET = IPendleMarket(
            _pendleMarketAddress
        );

        name = _oracleName;
    }

    address public immutable PENDLE_MARKET_ADDRESS;
    IPendleMarket public immutable PENDLE_MARKET;

    // Pricefeed for asset in ETH and TWAP for PtToken.
    IPendleSy public immutable PENDLE_SY;
    IPriceFeed public immutable FEED_ASSET;
    IOraclePendle public immutable ORACLE_PENDLE_PT;

    uint8 internal constant FEED_DECIMALS = 18;
    uint256 internal constant POW_FEED_DECIMALS = 10 ** 18;

    // Precision factor for computations.
    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;

    // -- Twap duration in seconds --
    uint32 public immutable TWAP_DURATION;

    // -- Farm description --
    string public name;

    /**
     * @dev Read function returning latest ETH value for PtToken.
     * Uses answer from USD chainLink pricefeed and combines it with
     * the result from ethInUsd for one token of PtToken.
     */
    function latestAnswer()
        public
        view
        returns (uint256)
    {

136: /**
     * @dev Returns priceFeed decimals.
     */
    function decimals()
        external
        pure
        returns (uint8)
    {

147: /**
     * @dev Read function returning the latest answer
     * so wise oracle hub can fetch it
     */
    function latestRoundData()
        external
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L136, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PendleLpOracle.sol#L147

```solidity

File: PtOracleDerivative.sol

5: /**
 * @author René Hochmuth
 */

/**
 * @dev Pricefeed contract for PtToken with USD
 * chainLink feed to get a feed measured in ETH.
 * Takes chainLink oracle value and multiplies it with
 * the corresponding TWAP and other chainLink oracles
 */

import "../InterfaceHub/IPriceFeed.sol";
import "../InterfaceHub/IOraclePendle.sol";

error CardinalityNotSatisfied();
error OldestObservationNotSatisfied();

contract PtOracleDerivative {

    constructor(
        address _pendleMarketAddress,
        IPriceFeed _priceFeedChainLinkUsd,
        IPriceFeed _priceFeedChainLinkEthUsd,
        IOraclePendle _oraclePendlePt,
        string memory _oracleName,
        uint32 _twapDuration
    )
    {
        PENDLE_MARKET_ADDRESS = _pendleMarketAddress;

        USD_FEED_ASSET = _priceFeedChainLinkUsd;
        ETH_FEED_ASSET = _priceFeedChainLinkEthUsd;

        POW_USD_FEED = 10 ** USD_FEED_ASSET.decimals();
        POW_ETH_USD_FEED = 10 ** ETH_FEED_ASSET.decimals();

        ORACLE_PENDLE_PT = _oraclePendlePt;
        TWAP_DURATION = _twapDuration;
        name = _oracleName;
    }

    // Token interface for the asset.
    address immutable PENDLE_MARKET_ADDRESS;

    // Pricefeed for Asset in USD.
    IPriceFeed public immutable USD_FEED_ASSET;

    // Pricefeed for ETH in USD.
    IPriceFeed public immutable ETH_FEED_ASSET;

    // Oracle for Pendle PtToken.
    IOraclePendle public immutable ORACLE_PENDLE_PT;

    // 10 ** Decimals of the feeds for AssetUSD.
    uint256 public immutable POW_USD_FEED;

    // 10 ** Decimals of the feeds for EthUSD.
    uint256 public immutable POW_ETH_USD_FEED;

    // Default decimals for the Feed.
    uint8 internal constant FEED_DECIMALS = 18;

    // Precision factor for computations.
    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;

    // -- Twap Duration --
    uint32 public immutable TWAP_DURATION;

    // -- Description --
    string public name;

    /**
     * @dev Read function returning latest ETH value for PtToken.
     * Uses answer from Usd chainLink pricefeed and combines it with
     * the result from ethInUsd for one token of PtToken.
     */
    function latestAnswer()
        public
        view
        returns (uint256)
    {

131: /**
     * @dev Returns priceFeed decimals.
     */
    function decimals()
        external
        pure
        returns (uint8)
    {

142: /**
     * @dev Read function returning the latest
     * answer so WiseOracleHub can fetch it properly.
     */
    function latestRoundData()
        public
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L131, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOracleDerivative.sol#L142

```solidity

File: PtOraclePure.sol

5: /**
 * @author René Hochmuth
 */

/**
 * @dev PriceFeed contract for Pt-Token with USD
 * chainLink feed to get a feed measured in ETH.
 * Takes chainLink oracle value and multiplies it
 * with the corresponding TWAP and other chainLink oracles.
 */

import "../InterfaceHub/IPriceFeed.sol";
import "../InterfaceHub/IOraclePendle.sol";

error CardinalityNotSatisfied();
error OldestObservationNotSatisfied();

contract PtOraclePure {

    constructor(
        address _pendleMarketAddress,
        IPriceFeed _priceFeedChainLinkEth,
        IOraclePendle _oraclePendlePt,
        string memory _oracleName,
        uint32 _twapDuration
    )
    {
        PENDLE_MARKET_ADDRESS = _pendleMarketAddress;

        FEED_ASSET = _priceFeedChainLinkEth;
        POW_FEED = 10 ** FEED_ASSET.decimals();

        DURATION = _twapDuration;
        ORACLE_PENDLE_PT = _oraclePendlePt;

        name = _oracleName;
    }

    // Token interface
    address public immutable PENDLE_MARKET_ADDRESS;

    // Pricefeed for asset in ETH and TWAP for PtToken.
    IPriceFeed public immutable FEED_ASSET;
    IOraclePendle public immutable ORACLE_PENDLE_PT;

    uint256 internal immutable POW_FEED;
    uint8 internal constant FEED_DECIMALS = 18;

    // Precision factor for computations.
    uint256 internal constant PRECISION_FACTOR_E18 = 1E18;

    // -- Twap Duration --
    uint32 public immutable DURATION;

    // -- Description --
    string public name;

    /**
     * @dev Read function returning latest ETH value for PtToken.
     * Uses answer from Usd chainLink pricefeed and combines it with
     * the result from ethInUsd for one token of PtToken.
     */

    function latestAnswer()
        public
        view
        returns (uint256)
    {

110: /**
     * @dev Returns priceFeed decimals.
     */
    function decimals()
        external
        pure
        returns (uint8)
    {

121: /**
     * @dev Read function returning the latest answer
     * so wise oracle hub can fetch it
     */
    function latestRoundData()
        public
        view
        returns (
            uint80 roundId,
            int256 answer,
            uint256 startedAt,
            uint256 updatedAt,
            uint80 answeredInRound
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L110, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/DerivativeOracles/PtOraclePure.sol#L121

```solidity

File: FeeManager.sol

5: /**
 * @author Christoph Krpoun
 * @author René Hochmuth
 * @author Vitally Marinchenko
 */

import "./FeeManagerHelper.sol";

/**
 * @dev Purpose of this contract is to organize fee distribution from wiseLending.
 * The feeManager aquires fee token in form of shares from each pool and can call them
 * with "claimWiseFees()" for each pool.
 *
 * Furthermore, this contracts has two different incentive
 * structures which can be used to bootstrap the WISE ecosystem (beneficial and incnetiveOwner roles).
 *
 * Additionally, this contract keeps track of the bad debt of each postion and has a simple mechanism
 * to pay them back via incentives. The incentive amount is funded by the gathered fees.
 */

contract FeeManager is FeeManagerHelper {

    constructor(
        address _master,
        address _aaveAddress,
        address _wiseLendingAddress,
        address _oracleHubAddress,
        address _wiseSecurityAddress,
        address _positionNFTAddress
    )
        DeclarationsFeeManager(
            _master,
            _aaveAddress,
            _wiseLendingAddress,
            _oracleHubAddress,
            _wiseSecurityAddress,
            _positionNFTAddress
        )
    {}

    /**
     * @dev Allows to adjust the paid out incentive
     * percentage for user to reduce bad debt.
     */
    function setRepayBadDebtIncentive(
        uint256 _percent
    )
        external
        onlyMaster
    {

62: /**
     * @dev Maps underlying token with corresponding aToken.
     * Sets bool to identify pool token as aToken.
     */
    function setAaveFlag(
        address _poolToken,
        address _underlyingToken
    )
        external
        onlyMaster
    {

79: /**
     * @dev Bulk function for setting aave flag for multiple pools.
     */
    function setAaveFlagBulk(
        address[] calldata _poolTokens,
        address[] calldata _underlyingTokens
    )
        external
        onlyMaster
    {

104: /**
     * @dev Function to adjust pool fee. Fee can not be greater than 100%
     * or lower than 1%. Can be adjusted for each pool individually.
     */
    function setPoolFee(
        address _poolToken,
        uint256 _newFee
    )
        external
        onlyMaster
    {

131: /**
    * @dev Function to adjust pool fees in bulk. Fee for each pool can not be
    * greater than 100% or lower than 1%. Can be adjusted for each pool individually.
    */
    function setPoolFeeBulk(
        address[] calldata _poolTokens,
        uint256[] calldata _newFees
    )
        external
        onlyMaster
    {

168: /**
     * @dev Function to propose new incentive master. This role can increase
     * the incentive amount for both incentive mappings. These are two roles
     * for incentivising external persons e.g. developers.
     */
    function proposeIncentiveMaster(
        address _proposedIncentiveMaster
    )
        external
        onlyIncentiveMaster
    {

191: /**
     * @dev Claim proposed incentive master by proposed entity.
     */
    function claimOwnershipIncentiveMaster()
        external
    {

210: /**
     * @dev Increase function for increasing incentive amount for entity A.
     * Only callable by incentive master.
     */
    function increaseIncentiveA(
        uint256 _value
    )
        external
        onlyIncentiveMaster
    {

228: /**
     * @dev Increase function for increasing incentive amount for entity B.
     * Only callable by incentive master.
     */
    function increaseIncentiveB(
        uint256 _value
    )
        external
        onlyIncentiveMaster
    {

246: /**
     * @dev Function to claim all gathered incetives.
     */
    function claimIncentivesBulk()
        external
    {

281: /**
     * @dev Claims gathered incentives for a specific token.
     */
    function claimIncentives(
        address _feeToken
    )
        public
    {

311: /**
     * @dev Function changing incentiveOwnerA! Only callable by
     * incentiveOwnerA.
     */
    function changeIncentiveUSDA(
        address _newOwner
    )
        external
    {

348: /**
     * @dev Function changing incentiveOwnerB! Only callable by
     * incentiveOwnerB.
     */
    function changeIncentiveUSDB(
        address _newOwner
    )
        external
    {

385: /**
     * @dev Function adding new pool token to pool token list.
     * Called during pool creation and only callable by wiseLending
     * contract.
     */
    function addPoolTokenAddress(
        address _poolToken
    )
        external
        onlyWiseLending
    {

408: /**
     * @dev Function to add pool token manualy. Only
     * callable by feeManager master.
     */
    function addPoolTokenAddressManual(
        address _poolToken
    )
        external
        onlyMaster
    {

434: /**
     * @dev Function to remove pool token manualy from pool
     * token list. Only callable by feeManager master.
     */
    function removePoolTokenManual(
        address _poolToken
    )
        external
        onlyMaster
    {

489: /**
     * @dev Increase function for total bad debt of
     * wiseLending. Only callable by wiseSecurity contract
     * during liquidation.
     */
    function increaseTotalBadDebtLiquidation(
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {

510: /**
     * @dev Increase function for bad debt of a position.
     * Only callable by wiseSecurity contract during liquidation.
     */
    function setBadDebtUserLiquidation(
        uint256 _nftId,
        uint256 _amount
    )
        external
        onlyWiseSecurity
    {

533: /**
     * @dev Set function to declare an address as beneficial for
     * a fee token. Address can claim gathered fee token as long as
     * it is declared as beneficial. Only setable by master.
     */
    function setBeneficial(
        address _user,
        address[] calldata _feeTokens
    )
        external
        onlyMaster
    {

567: /**
     * @dev Set function to remove an address as beneficial for
     * a fee token. Only setable by master.
     */
    function revokeBeneficial(
        address _user,
        address[] memory _feeTokens
    )
        external
        onlyMaster
    {

600: /**
     * @dev Claim all fees from wiseLending and send them to feeManager.
     */
    function claimWiseFeesBulk()
        external
    {

624: /**
     * @dev Claim fees from wiseLending and send them to feeManager for
     * a specific pool.
     */
    function claimWiseFees(
        address _poolToken
    )
        public
    {

684: /**
     * @dev Function for beneficial to claim gathered fees. Can only
     * claim fees for which the beneficial is allowed. Can only claim
     * token which are inside the feeManager.
     */
    function claimFeesBeneficial(
        address _feeToken,
        uint256 _amount
    )
        external
    {

724: /**
     * @dev Function for paying back bad debt of a position. Caller
     * chooses postion, token and receive token. Only gathered fee token
     * can be distributed as receive token. Caller gets 5% more
     * in ETH value as incentive.
     */
    function paybackBadDebtForToken(
        uint256 _nftId,
        address _paybackToken,
        address _receivingToken,
        uint256 _shares
    )
        external
        returns (
            uint256 paybackAmount,
            uint256 receivingAmount
        )
    {

811: /**
     * @dev Function for paying back bad debt of a position. Caller
     * chooses postion, token and receive token. Caller gets no
     * receive token!
     */
    function paybackBadDebtNoReward(
        uint256 _nftId,
        address _paybackToken,
        uint256 _shares
    )
        external
        returns (uint256 paybackAmount)
    {

868: /**
     * @dev Returning the number of pool token
     * addresses saved inside the feeManager.
     */
    function getPoolTokenAddressesLength()
        public
        view
        returns (uint256)
    {

880: /**
     * @dev Returns the pool token address
     * at the _index postion of the array.
     */
    function getPoolTokenAdressesByIndex(
        uint256 _index
    )
        external
        view
        returns (address)
    {

894: /**
     * @dev Bulk function for updating pools - loops through
     * all pools saved inside the poolTokenAddresses array.
     */
    function syncAllPools()
        external
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L62, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L79, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L104, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L131, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L168, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L191, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L210, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L228, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L246, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L281, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L311, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L348, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L385, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L408, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L434, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L489, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L510, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L533, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L567, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L600, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L624, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L684, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L724, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L811, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L868, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L880, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManager.sol#L894

```solidity

File: FeeManagerHelper.sol

10: /**
     * @dev Internal update function which adds latest aquired token from borrow rate
     * for all borrow tokens of the position. Idnetical implementation like in wiseSecurity
     * or wiseLending.
     */
    function _prepareBorrows(
        uint256 _nftId
    )
        internal
    {

42: /**
     * @dev Internal update function which adds latest aquired token from borrow rate
     * for all collateral tokens of the position. Idnetical implementation like in wiseSecurity
     * or wiseLending.
     */
    function _prepareCollaterals(
        uint256 _nftId
    )
        internal
    {

74: /**
     * @dev Internal set function for adjusting bad debt amount of a position.
     */
    function _setBadDebtPosition(
        uint256 _nftId,
        uint256 _amount
    )
        internal
    {

86: /**
     * @dev Internal increase function for global bad debt amount.
     */
    function _increaseTotalBadDebt(
        uint256 _amount
    )
        internal
    {

102: /**
     * @dev Internal decrease function for global bad debt amount.
     */
    function _decreaseTotalBadDebt(
        uint256 _amount
    )
        internal
    {

118: /**
     * @dev Internal erease function to delete bad debt amount of a postion.
     */
    function _eraseBadDebtUser(
        uint256 _nftId
    )
        internal
    {

129: /**
     * @dev Internal function updating bad debt amount of a position and global one (in ETH).
     * Compares totalBorrow and totalCollateral of the postion in ETH and adjustes bad debt
     * variables. Pseudo pool amounts needed to be updated before this function is called.
     */
    function _updateUserBadDebt(
        uint256 _nftId
    )
        internal
    {

191: /**
     * @dev Internal increase function for tracking gathered fee token. No need for
     * balanceOf() checks.
     */
    function _increaseFeeTokens(
        address _feeToken,
        uint256 _amount
    )
        internal
    {

204: /**
     * @dev Internal decrease function for tracking gathered fee token. No need for
     * balanceOf() checks.
     */
    function _decreaseFeeTokens(
        address _feeToken,
        uint256 _amount
    )
        internal
    {

217: /**
     * @dev Internal function to set benefical mapping for a certain token.
     */
    function _setAllowedTokens(
        address _user,
        address _feeToken,
        bool _state
    )
        internal
    {

240: /**
     * @dev Internal function calculating receive amount for the caller.
     * paybackIncentive is set to 5E16 => 5% incentive for paying back bad debt.
     */
    function getReceivingToken(
        address _paybackToken,
        address _receivingToken,
        uint256 _paybackAmount
    )
        public
        view
        returns (uint256 receivingAmount)
    {

266: /**
     * @dev Updates bad debt of a postion. Combines preparation of all
     * collaterals and borrows for passed _nftId with _updateUserBadDebt().
     */
    function updatePositionCurrentBadDebt(
        uint256 _nftId
    )
        public
    {

288: /**
     * @dev Internal function for distributing incentives to incentiveOwnerA
     * and incentiveOwnerB.
     */
    function _distributeIncentives(
        uint256 _amount,
        address _poolToken,
        address _underlyingToken
    )
        internal
        returns (uint256)
    {

325: /**
     * @dev Internal function computing the incentive amount for an incentiveOwner
     * depending of the amount per fee token. Reduces the open incentive amount for
     * the owner.
     */
    function _gatherIncentives(
        address _poolToken,
        address _underlyingToken,
        address _incentiveOwner,
        uint256 _amount
    )
        internal
        returns (uint256)
    {

379: /**
     * @dev Internal function checking if the
     * passed value is smaller 100% and bigger 1%.
     */
    function _checkValue(
        uint256 _value
    )
        internal
        pure
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L10, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L42, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L74, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L86, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L102, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L118, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L129, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L191, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L204, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L217, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L240, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L266, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L288, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L325, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/FeeManagerHelper.sol#L379

```solidity

File: PendlePowerFarm.sol

9: /**
     * @dev External view function approximating the
     * new resulting net APY for a position setup.
     *
     * Note: Not 100% accurate because no syncPool is performed.
     */
    function getApproxNetAPY(
        uint256 _initialAmount,
        uint256 _leverage,
        uint256 _pendleChildApy
    )
        external
        view
        returns (
            uint256,
            bool
        )
    {

34: /**
     * @dev External view function approximating the
     * new borrow amount for the pool when {

53: /**
     * @dev View functions returning the current
     * debt ratio of the postion with {

89: /**
     * @dev Liquidation function for open power farm
     * postions which have a debtratio greater than 100%.
     */
    function liquidatePartiallyFromToken(
        uint256 _nftId,
        uint256 _nftIdLiquidator,
        uint256 _shareAmountToPay
    )
        external
        updatePools
        returns (
            uint256 paybackAmount,
            uint256 receivingAmount
        )
    {

112: /**
     * @dev Manually payback function for users. Takes
     * {

150: /**
     * @dev Manually withdraw function for users. Takes
     * {

181: /**
     * @dev Internal function combining the core
     * logic for {

221: /**
     * @dev Internal function combining the core
     * logic for {

181: /**
     * @dev Internal function combining the core
     * logic for {

221: /**
     * @dev Internal function combining the core
     * logic for {

270: /**
     * @dev Makes a call to WISE_LENDING to
     * register {_nftId} for specific farm use.
     */
    function _registrationFarm(
        uint256 _nftId
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L34, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L53, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L89, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L112, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L150, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L181, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L221, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L181, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L221, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarm.sol#L270

```solidity

File: PendlePowerFarmLeverageLogic.sol

11: /**
     * @dev Wrapper function preparing balancer flashloan and
     * loading data to pass into receiver.
     */
    function _executeBalancerFlashLoan(
        uint256 _nftId,
        uint256 _flashAmount,
        uint256 _initialAmount,
        uint256 _lendingShares,
        uint256 _borrowShares,
        uint256 _allowedSpread,
        bool _ethBack,
        bool _isAave
    )
        internal
    {

54: /**
     * @dev Receive function from balancer flashloan. Body
     * is called from balancer at the end of their {

131: /**
     * @dev Closes position using balancer flashloans.
     */
    function _logicClosePosition(
        uint256 _nftId,
        uint256 _borrowShares,
        uint256 _lendingShares,
        uint256 _totalDebtBalancer,
        uint256 _allowedSpread,
        address _caller,
        bool _ethBack,
        bool _isAave
    )
        private
    {

289: /**
     * @dev Internal wrapper function for curve swap
     * of stETH into ETH.
     */
    function _swapStETHintoETH(
        uint256 _swapAmount,
        uint256 _minOutAmount
    )
        internal
        returns (uint256)
    {

350: /**
     * @dev Internal wrapper function for a closing route
     * which returns {

379: /**
     * @dev Internal wrapper function for a closing route
     * which returns ETH to the owner in the end.
     */
    function _closingRouteETH(
        uint256 _ethAmount,
        uint256 _totalDebtBalancer,
        address _caller
    )
        internal
    {

407: /**
     * @dev Internal function executing the
     * collateral deposit by converting ETH
     * into {

555: /**
     * @dev Internal function summarizing liquidation
     * checks and interface call for core liquidation
     * from wise lending.
     */
    function _coreLiquidation(
        uint256 _nftId,
        uint256 _nftIdLiquidator,
        uint256 _shareAmountToPay
    )
        internal
        returns (
            uint256 paybackAmount,
            uint256 receivingAmount
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L54, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L131, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L289, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L350, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L379, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L407, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmLeverageLogic.sol#L555

```solidity

File: PendlePowerFarmMathLogic.sol

15: /**
     * @dev Update logic for pools via wise lending
     * interfaces
     */
    function _updatePools()
        private
    {

52: /**
     * @dev Internal function getting the
     * borrow shares from position {

70: /**
     * @dev Internal function getting the
     * borrow shares of aave from position {

88: /**
     * @dev Internal function converting
     * borrow shares into tokens.
     */
    function _getPositionBorrowTokenAmount(
        uint256 _nftId
    )
        internal
        view
        returns (uint256 tokenAmount)
    {

131: /**
     * @dev Internal function getting the
     * lending shares from position {

149: /**
     * @dev Internal function converting
     * lending shares into tokens.
     */
    function _getPostionCollateralTokenAmount(
        uint256 _nftId
    )
        internal
        view
        returns (uint256)
    {

170: /**
     * @dev Read function returning the total
     * borrow amount in ETH from postion {

225: /**
     * @dev Read function returning the total
     * lending amount in ETH from postion {

285: /**
     * @dev Internal function with math logic for approximating
     * the net APY for the postion aftrer creation.
     */
    function _getApproxNetAPY(
        uint256 _initialAmount,
        uint256 _leverage,
        uint256 _wstETHAPY
    )
        internal
        view
        returns (
            uint256,
            bool
        )
    {

340: /**
     * @dev Internal function with math logic for approximating
     * the new borrow APY.
     */
    function _getNewBorrowRate(
        uint256 _borrowAmount
    )
        internal
        view
        returns (uint256)
    {

385: /**
     * @dev Internal function checking if a position
     * with {

412: /**
     * @dev Internal function checking if the leveraged
     * amount not below {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L15, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L52, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L70, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L88, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L131, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L149, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L170, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L225, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L285, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L340, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L385, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerFarmMathLogic.sol#L412

```solidity

File: PendlePowerManager.sol

5: /**
 * @author René Hochmuth
 * @author Christoph Krpoun
 * @author Vitally Marinchenko
 */

import "./PendlePowerFarm.sol";
import "../../OwnableMaster.sol";
import "../PowerFarmNFTs/MinterReserver.sol";

contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {

    /**
     * @dev Standard receive functions forwarding
     * directly send ETH to the master address.
     */
    receive()
        external
        payable
    {

77: /**
     * @dev External function deactivating the power farm by
     * disableing the openPosition function. Allowing user
     * to manualy payback and withdraw.
     */
    function shutDownFarm(
        bool _state
    )
        external
        onlyMaster
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L77

```solidity

File: PendlePowerFarmController.sol

361: /**
     * @dev Can also be used to extend existing lock.
     */
    function lockPendle(
        uint256 _amount,
        uint128 _weeks,
        bool _fromInside,
        bool _sameExpiry
    )
        external
        onlyMaster
        returns (uint256 newVeBalance)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L361

```solidity

File: PendlePowerFarmToken.sol

526: /**
     * @dev External wrapper for mint function.
     */
    function depositExactAmount(
        uint256 _underlyingLpAssetAmount
    )
        external
        syncSupply
        returns (
            uint256,
            uint256
        )
    {

605: /**
     * @dev External wrapper for burn function.
     */
    function withdrawExactShares(
        uint256 _shares
    )
        external
        syncSupply
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L526, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L605

```solidity

File: PowerFarmNFTs.sol

62: /**
     * @dev Mints farming NFT, later to be sent
     * to the user representing his farming position
     */
    function mintKey(
        address _keyOwner,
        uint256 _keyId
    )
        external
        onlyFarmContract
    {

79: /**
     * @dev Burns farming NFT
     */
    function burnKey(
        uint256 _keyId
    )
        external
        onlyFarmContract
    {

106: /**
     * @dev Returns positions of owner
     */
    function walletOfOwner(
        address _owner
    )
        external
        view
        returns (uint256[] memory)
    {

158: /**
     * @dev Allows to update base target for MetaData.
     */
    function setBaseURI(
        string calldata _newBaseURI
    )
        external
        onlyMaster
    {

179: /**
     * @dev Returns path to MetaData URI
     */
    function tokenURI(
        uint256 _tokenId
    )
        public
        view
        override
        returns (string memory)
    {

210: /**
     * @dev Converts tokenId uint to string.
     */
    function _toString(
        uint256 _tokenId
    )
        internal
        pure
        returns (string memory str)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L62, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L79, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L106, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L158, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L179, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L210

```solidity

File: ApprovalHelper.sol

9: /**
     * @dev
     * Allows to execute safe approve for a token
     */
    function _safeApprove(
        address _token,
        address _spender,
        uint256 _value
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/ApprovalHelper.sol#L9

```solidity

File: CallOptionalReturn.sol

9: /**
     * @dev Helper function to do low-level call
     */
    function _callOptionalReturn(
        address token,
        bytes memory data
    )
        internal
        returns (bool call)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/CallOptionalReturn.sol#L9

```solidity

File: TransferHelper.sol

9: /**
     * @dev
     * Allows to execute safe transfer for a token
     */
    function _safeTransfer(
        address _token,
        address _to,
        uint256 _value
    )
        internal
    {

30: /**
     * @dev
     * Allows to execute safe transferFrom for a token
     */
    function _safeTransferFrom(
        address _token,
        address _from,
        address _to,
        uint256 _value
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/TransferHelper.sol#L30

```solidity

File: WrapperHelper.sol

20: /**
     * @dev Wrapper for wrapping
     * ETH call.
     */
    function _wrapETH(
        uint256 _value
    )
        internal
    {

34: /**
     * @dev Wrapper for unwrapping
     * ETH call.
     */
    function _unwrapETH(
        uint256 _value
    )
        internal
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L20, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/TransferHub/WrapperHelper.sol#L34

```solidity

File: OracleHelper.sol

9: /**
     * @dev Adds priceFeed for a given token.
     */
    function _addOracle(
        address _tokenAddress,
        IPriceFeed _priceFeedAddress,
        address[] calldata _underlyingFeedTokens
    )
        internal
    {

102: /**
     * @dev Returns Twaps latest USD value
     * by passing the underlying token address.
     */
    function latestResolverTwap(
        address _tokenAddress
    )
        public
        view
        returns (uint256)
    {

176: /**
     * @dev Adds uniTwapPoolInfo for a given token.
     */
    function _writeUniTwapPoolInfoStruct(
        address _tokenAddress,
        address _oracle,
        bool _isUniPool
    )
        internal
    {

192: /**
     * @dev Adds uniTwapPoolInfo for a given token and its derivative.
     */
    function _writeUniTwapPoolInfoStructDerivative(
        address _tokenAddress,
        address _partnerTokenAddress,
        address _oracleAddress,
        address _partnerOracleAddress,
        bool _isUniPool
    )
        internal
    {

279: /**
    * @dev Retrieves the pool address for given
    * tokens and fee from Uniswap V3 Factory.
    */
    function _getPool(
        address _token0,
        address _token1,
        uint24 _fee
    )
        internal
        view
        returns (address pool)
    {

299: /**
    * @dev Validates if the given token address
    * is one of the two specified token addresses.
    */
    function _validateTokenAddress(
        address _tokenAddress,
        address _token0,
        address _token1
    )
        internal
        pure
    {

320: /**
    * @dev Validates if the given pool
    * address matches the expected pool address.
    */
    function _validatePoolAddress(
        address _pool,
        address _expectedPool
    )
        internal
        pure
    {

340: /**
    * @dev Validates if the price feed for
    * a given token address is set.
    */
    function _validatePriceFeed(
        address _tokenAddress
    )
        internal
        view
    {

355: /**
    * @dev Validates if the TWAP oracle for
    * a given token address is already set.
    */
    function _validateTwapOracle(
        address _tokenAddress
    )
        internal
        view
    {

370: /**
     * @dev Returns twapPrice by passing
     * the underlying token address.
     */
    function _getTwapPrice(
        address _tokenAddress,
        address _oracle
    )
        internal
        view
        returns (uint256)
    {

446: /**
     * @dev Returns priceFeed decimals by
     * passing the underlying token address.
     */
    function decimals(
        address _tokenAddress
    )
        public
        view
        returns (uint8)
    {

503: /**
     * @dev Stores expected heartbeat
     * value for a pricing feed token.
     */
    function _recalibrate(
        address _tokenAddress
    )
        internal
    {

517: /**
     * @dev Check if chainLink
     * squencer is wroking.
     */
    function sequencerIsDead()
        public
        view
        returns (bool)
    {

551: /**
     * @dev Check if chainLink feed was
     * updated within expected timeFrame
     * for single {_tokenAddress}.
     */
    function _chainLinkIsDead(
        address _tokenAddress
    )
        internal
        view
        returns (bool)
    {

588: /**
     * @dev Recalibrates expected
     * heartbeat for a pricing feed.
     */
    function _recalibratePreview(
        address _tokenAddress
    )
        internal
        view
        returns (uint256)
    {

654: /**
     * @dev Determines number of iterations
     * needed during heartbeat recalibration.
     */
    function _getIterationCount(
        uint80 _latestAggregatorRoundId
    )
        internal
        pure
        returns (uint80 res)
    {

670: /**
     * @dev Fetches timestamp of a byteshifted
     * aggregatorRound with specific _roundId.
     */
    function _getRoundTimestamp(
        address _tokenAddress,
        uint80 _roundId
    )
        internal
        view
        returns (uint256)
    {

695: /**
     * @dev Routing latest round data from chainLink.
     * Returns latestRoundData by passing underlying token address.
     */
    function getLatestRoundId(
        address _tokenAddress
    )
        public
        view
        returns (
            uint80 roundId
        )
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L102, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L176, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L192, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L279, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L299, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L320, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L340, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L355, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L370, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L446, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L503, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L517, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L551, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L588, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L654, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L670, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L695

```solidity

File: WiseOracleHub.sol

5: /**
 * @author René Hochmuth
 * @author Christoph Krpoun
 * @author Vitally Marinchenko
 */

import "./OracleHelper.sol";

/**
 * @dev WiseOracleHub is an onchain extension for price feeds (chainLink or others).
 * The master address is owned by a timelock contract which itself is secured by a
 * multisig. Only the master can add new price feed <-> address pairs to the contract.
 *
 * One advantage is the linking of price feeds to their underlying token address.
 * Therefore, users can get the current ETH value of a token by just knowing the token
 * address when calling {latestResolver}. It takes the answer from {latestRoundData}
 * for chainLink oracles as recommended from chainLink.
 *
 * NOTE: If you want to propose adding an own developed price feed it is
 * mandatory to wrap its answer into a function mimicking {

65: /**
     * @dev Returns priceFeed latest ETH value
     * by passing the underlying token address.
     */
    function latestResolver(
        address _tokenAddress
    )
        public
        view
        returns (uint256)
    {

119: /**
     * @dev Returns USD value of a given token
     * amount in order of 1E18 decimal precision.
     */
    function getTokensPriceInUSD(
        address _tokenAddress,
        uint256 _tokenAmount
    )
        external
        view
        returns (uint256)
    {

139: /**
     * @dev Returns ETH value of a given token
     * amount in order of 1E18 decimal precision.
     */
    function getTokensInETH(
        address _tokenAddress,
        uint256 _tokenAmount
    )
        public
        view
        returns (uint256)
    {

194: /**
     * @dev Converts USD value of a token into token amount with a
     * current price. The order of the argument _usdValue is 1E18.
     */
    function getTokensPriceFromUSD(
        address _tokenAddress,
        uint256 _usdValue
    )
        external
        view
        returns (uint256)
    {

214: /**
     * @dev Adds a new token address to the oracleHub Twap.
     * Can't overwrite existing mappings.
     */
    function addTwapOracle(
        address _tokenAddress,
        address _uniPoolAddress,
        address _token0,
        address _token1,
        uint24 _fee
    )
        external
        onlyMaster
    {

262: /**
     * @dev Adds a new token address to TWAP as derivative.
     * Not permitted to overwrite existing mappings.
     */
    function addTwapOracleDerivative(
        address _tokenAddress,
        address _partnerTokenAddress,
        address[2] calldata _uniPools,
        address[2] calldata _token0Array,
        address[2] calldata _token1Array,
        uint24[2] calldata _feeArray
    )
        external
        onlyMaster
    {

323: /**
     * @dev Converts ETH value of a token into token amount with a
     * current price. The order of the argument _ethAmount is 1E18.
     */
    function getTokensFromETH(
        address _tokenAddress,
        uint256 _ethAmount
    )
        public
        view
        returns (uint256)
    {

354: /**
     * @dev Adds priceFeed for a token.
     * Can't overwrite existing mappings.
     * Master is a timelock contract.
     */
    function addOracle(
        address _tokenAddress,
        IPriceFeed _priceFeedAddress,
        address[] calldata _underlyingFeedTokens
    )
        external
        onlyMaster
    {

374: /**
     * @dev Adds priceFeeds for tokens.
     * Can't overwrite existing mappings.
     * Master is a timelock contract.
     */
    function addOracleBulk(
        address[] calldata _tokenAddresses,
        IPriceFeed[] calldata _priceFeedAddresses,
        address[][] calldata _underlyingFeedTokens
    )
        external
        onlyMaster
    {

414: /**
     * @dev Looks at the maximal last 50 rounds and
     * takes second highest value to avoid counting
     * offline time of chainlink as valid heartbeat.
     */
    function recalibratePreview(
        address _tokenAddress
    )
        external
        view
        returns (uint256)
    {

431: /**
     * @dev Check if chainLink feed was
     * updated within expected timeFrame.
     * If length of {underlyingFeedTokens}
     * is greater than zero it checks the
     * heartbeat of all base feeds of the
     * derivate oracle.
     */
    function chainLinkIsDead(
        address _tokenAddress
    )
        public
        view
        returns (bool state)
    {

483: /**
     * @dev Recalibrates expected
     * heartbeat for a pricing feed.
     */
    function recalibrate(
        address _tokenAddress
    )
        external
    {

497: /**
     * @dev Bulk function to recalibrate
     * the heartbeat for several tokens.
     */
    function recalibrateBulk(
        address[] calldata _tokenAddresses
    )
        external
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L65, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L119, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L139, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L194, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L214, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L262, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L323, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L354, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L374, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L414, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L431, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L483, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/WiseOracleHub.sol#L497

```solidity

File: WiseSecurity.sol

5: /**
 * @author Christoph Krpoun
 * @author René Hochmuth
 * @author Vitally Marinchenko
 */

import "./WiseSecurityHelper.sol";
import "../TransferHub/ApprovalHelper.sol";

/**
 * @dev WiseSecurity is a core contract for wiseLending including most of
 * the performed security checks for withdraws, borrows, paybacks and liquidations.
 * It also has several read only functions providing UI data for a better user
 * experiencne.
 *
 */

error NotWiseLendingSecurity();

contract WiseSecurity is WiseSecurityHelper, ApprovalHelper {

54: /**
     * @dev View functions returning current
     * debt ratio of a postion in normal mode.
     * 1% <=> 1E16
     */
    function getLiveDebtRatio(
        uint256 _nftId
    )
        external
        view
        returns (uint256)
    {

79: /**
     * @dev Set Liquidation incentives and boundaries
     * for liquidation. Only callable by the master.
     * Assures liquidation cascade cannot be self imposed
     * by limiting incentives.
     */
    function setLiquidationSettings(
        uint256 _baseReward,
        uint256 _baseRewardFarm,
        uint256 _newMaxFeeETH,
        uint256 _newMaxFeeFarmETH
    )
        external
        onlyMaster
    {

102: /**
     * @dev Checks for liquidation logic.
     */
    function checksLiquidation(
        uint256 _nftIdLiquidate,
        address _tokenToPayback,
        uint256 _shareAmountToPay
    )
        external
        view
    {

139: /**
     * @dev Set function for preparing curve pools.
     */
    function prepareCurvePools(
        address _poolToken,
        CurveSwapStructData calldata _curveSwapStructData,
        CurveSwapStructToken calldata _curveSwapStructToken
    )
        external
        onlyWiseLending
    {

189: /**
     * @dev Reentrency guard for curve pools. Forces
     * a swap to update internal curve values.
     */
    function curveSecurityCheck(
        address _poolToken
    )
        external
        onlyWiseLending
    {

234: /**
     * @dev Checks for withdraw logic.
     */
    function checksWithdraw(
        uint256 _nftId,
        address _caller,
        address _poolToken
    )
        external
        view
        returns (bool specialCase)
    {

272: /**
     * @dev Checks for solely withdraw logic.
     */
    function checksSolelyWithdraw(
        uint256 _nftId,
        address _caller,
        address _poolToken
    )
        external
        view
        returns (bool specialCase)
    {

303: /**
     * @dev Checks for borrow logic.
     */
    function checksBorrow(
        uint256 _nftId,
        address _caller,
        address _poolToken
    )
        external
        view
        returns (bool specialCase)
    {

332: /**
     * @dev Checks for collateralize deposit logic.
     */
    function checksCollateralizeDeposit(
        uint256 _nftId,
        address _caller,
        address _poolAddress
    )
        external
        view
    {

357: /**
     * @dev Checks for uncollateralized deposit logic.
     */
    function checkUncollateralizedDeposit(
        uint256 _nftId,
        address _poolToken
    )
        external
        view
    {

384: /**
     * @dev Checks if user has healthy position.
     */

    function checkHealthState(
        uint256 _nftId,
        bool _isPowerFarm
    )
        external
        view
    {

401: /**
     * @dev Checks for bad debt logic. Compares
     * total ETH of borrow and collateral.
     */
    function checkBadDebtLiquidation(
        uint256 _nftId
    )
        external
        onlyWiseLending
    {

438: /**
     * @dev View function returning weighted
     * supply APY of a postion. 1% <=> 1E16
     */
    function overallLendingAPY(
        uint256 _nftId
    )
        external
        view
        returns (uint256)
    {

495: /**
     * @dev View function returning weighted
     * borrow APY of a postion. 1% <=> 1E16
     */
    function overallBorrowAPY(
        uint256 _nftId
    )
        external
        view
        returns (uint256)
    {

552: /**
     * @dev View function returning the total
     * net APY of a postion. 1% <=> 1E16
     */
    function overallNetAPY(
        uint256 _nftId
    )
        external
        view
        returns (uint256, bool)
    {

637: /**
     * @dev View function claculating the open
     * amount a postion is allowed to borrow.
     */
    function safeLimitPosition(
        uint256 _nftId
    )
        external
        view
        returns (uint256)
    {

691: /**
     * @dev View function checking if the postion is
     * locked due to blacklisted token.
     */
    function positionBlackListToken(
        uint256 _nftId
    )
        external
        view
        returns (bool, address)
    {

759: /**
     * @dev View function extrapolating the
     * possible withdraw amount of a postion
     * for a specific _poolToken.
     */
    function maximumWithdrawToken(
        uint256 _nftId,
        address _poolToken,
        uint256 _interval,
        uint256 _solelyWithdrawAmount
    )
        external
        view
        returns (uint256)
    {

821: /**
     * @dev View function extrapolating the
     * possible withdraw amount of a private
     * postion for a specific _poolToken.
     */
    function maximumWithdrawTokenSolely(
        uint256 _nftId,
        address _poolToken,
        uint256 _interval,
        uint256 _poolWithdrawAmount
    )
        external
        view
        returns (uint256)
    {

863: /**
     * @dev View function extrapolating the
     * possible borrow amount of postion for
     * a specific _poolToken.
     */
    function maximumBorrowToken(
        uint256 _nftId,
        address _poolToken,
        uint256 _interval
    )
        external
        view
        returns (uint256 tokenAmount)
    {

901: /**
     * @dev View function extrapolating the
     * possible payback amount of a position
     * for a specific _poolToken.
     */
    function getExpectedPaybackAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _interval
    )
        external
        view
        returns (uint256)
    {

938: /**
     * @dev View function extrapolating the
     * possible lending amount of a position
     * for a specific _poolToken.
     */
    function getExpectedLendingAmount(
        uint256 _nftId,
        address _poolToken,
        uint256 _interval
    )
        public
        view
        returns (uint256)
    {

975: /**
     * @dev Set function for blacklisting token.
     * Those token can not be borrowed or used as
     * collateral anymore. Only callable by master.
     */
    function setBlacklistToken(
        address _tokenAddress,
        bool _state
    )
        external
        onlyMaster()
    {

990: /**
     * @dev Set function for adding or removing
     * workers to perform a security shutdown.
     * Only callable by the master.
     */
    function setSecurityWorker(
        address _entitiy,
        bool _state
    )
        external
        onlyMaster
    {

1028: /**
     * @dev Master function to revoke all locks,
     * only callable by the master.
     */
    function revokeShutdown()
        external
        onlyMaster
    {

1041: /**
     * @dev External wrapper for pool condition
     * check.
     */
    function checkPoolCondition(
        address _token
    )
        external
        view
    {

1056: /**
     * @dev External wrapper for pool condition
     * check.
     */
    function checkPoolWithMinDeposit(
        address _token,
        uint256 _amount
    )
        external
        view
        returns (bool)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L54, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L79, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L102, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L139, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L189, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L234, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L272, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L303, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L332, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L357, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L384, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L401, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L438, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L495, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L552, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L637, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L691, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L759, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L821, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L863, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L901, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L938, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L975, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L990, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1028, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1041, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L1056

```solidity

File: WiseSecurityHelper.sol

9: /**
     * @dev Read function returning weighted and
     * and unweighted total collateral of a
     * postion with {

61: /**
     * @dev Read function returning weighted
     *  total collateral of a postion with {

102: /**
     * @dev Read function returning unweighted
     *  total collateral of a postion with {

139: /**
     * @dev Internal calculation function returning
     * the updated weighted collateral amount of a
     * postion with {

184: /**
     * @dev Read function returning the full bare
     * collateral amount of a {

220: /**
     * @dev Wrapper function checking if a supplied
     * fund is uncollateralized.
     */
    function _isUncollateralized(
        uint256 _nftId,
        address _poolToken
    )
        internal
        view
        returns (bool)
    {

238: /**
     * @dev Read function returning the full
     * collateral amount of a {

274: /**
     * @dev Read function returning the full
     * (private and public) collateral amount
     * of a {

318: /**
     * @dev Read function returning the public
     * collateral amount of a {

354: /**
     * @dev Read function returning the total
     * borrow amount of a postion with {

388: /**
     * @dev Read function returning the total
     * borrow amount of a postion with {

426: /**
     * @dev Read function returning the total
     * borrow amount of a postion with {

354: /**
     * @dev Read function returning the total
     * borrow amount of a postion with {

388: /**
     * @dev Read function returning the total
     * borrow amount of a postion with {

426: /**
     * @dev Read function returning the total
     * borrow amount of a postion with {

354: /**
     * @dev Read function returning the total
     * borrow amount of a postion with {

388: /**
     * @dev Read function returning the total
     * borrow amount of a postion with {

426: /**
     * @dev Read function returning the total
     * borrow amount of a postion with {

466: /**
     * @dev Internal function combining hearbeat
     * and blacklisted checks.
     */
    function _checkBlacklisted(
        address _poolToken
    )
        internal
        view
        returns (bool)
    {

480: /**
     * @dev Read function returning the total
     * updated current borrow amount of a
     * postion with {

524: /**
     * @dev Internal function calculating
     * the updated pseudo borrow amount of
     * {

548: /**
     * @dev Internal function calculating
     * the updated pseudo lending amount of
     * {

572: /**
     * @dev Internal math function calculating
     * the accumulated interest amount for
     * {

603: /**
     * @dev Read function returning the full
     * borrow amount of a {

647: /**
     * @dev Read function returning the borow
     * amount of a {

668: /**
     * @dev Read function checking if
     * {

683: /**
     * @dev Check if chainLink feed was
     * updated within expected timeframe
     */
    function checkHeartbeat(
        address _poolToken
    )
        public
        view
        returns (bool)
    {

697: /**
     * @dev Check if the postion with
     * {_nftId} is locked for interactions.
     */
    function _checkPositionLocked(
        uint256 _nftId
    )
        internal
        view
    {

712: /**
     * @dev Wrapper function for external
     * {

732: /**
     * @dev Returning the possible fee
     * for liquidation.
     */
    function _checkMaxFee(
        uint256 _paybackETH,
        uint256 _liquidationFee,
        uint256 _maxFeeETH
    )
        internal
        pure
        returns (uint256)
    {

754: /**
     * @dev Math function computing the
     * percentage of the receiving token
     * which the liquidator receivs for
     * liquidation.
     */
    function calculateWishPercentage(
        uint256 _nftId,
        address _receiveToken,
        uint256 _paybackETH,
        uint256 _maxFeeETH,
        uint256 _baseRewardLiquidation
    )
        external
        view
        returns (uint256)
    {

788: /**
     * @dev Check function for withdraw flow.
     * Tests if debt ratio is not greater than
     * 100% after withdraw of {

832: /**
     * @dev Check function for registration
     * of power farms. User can only register
     * when the postion is empty!
     */
    function checksRegister(
        uint256 _nftId,
        address _caller
    )
        public
        view
    {

854: /**
     * @dev Pure math function comparing
     * borrow and collateral amount for
     * liquidation.
     */
    function canLiquidate(
        uint256 _borrowETHTotal,
        uint256 _weightedCollateralETH
    )
        public
        pure
    {

871: /**
     * @dev Helper function for liquidation checking
     * return amount of receiving shares for liquidator.
     * Has to be smaller 50% when no bad debt occurs.
     */
    function checkMaxShares(
        uint256 _nftId,
        address _tokenToPayback,
        uint256 _borrowETHTotal,
        uint256 _unweightedCollateralETH,
        uint256 _shareAmountToPay
    )
        public
        view
    {

902: /**
     * @dev Helper function for liquidation checking
     * if postion has bad debt.
     */
    function checkBadDebtThreshold(
        uint256 _borrowETHTotal,
        uint256 _unweightedCollateral
    )
        public
        pure
        returns (bool)
    {

918: /**
     * @dev Helper function computing lending
     * token amount for {

941: /**
     * @dev Helper function computing borrow
     * token amount for {

962: /**
     * @dev Helper function checking the owner
     * of {

981: /**
     * @dev Wrapper function returning the borrow
     * rate from pool with token {

995: /**
     * @dev View function returning the lending
     * rate from pool with token {

1023: /**
     * @dev Internal helper function calculating
     * the possible withdraw amount of {

1077: /**
     * @dev Wrapper for {_checkBlacklisted}.
     */
    function _checkPoolCondition(
        address _poolToken
    )
        internal
        view
    {

1091: /**
     * @dev Internal helper checking of success
     * for a low level byte call of a function
     * with {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L9, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L61, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L102, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L139, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L184, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L220, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L238, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L274, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L318, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L354, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L388, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L426, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L354, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L388, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L426, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L354, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L388, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L426, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L466, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L480, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L524, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L548, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L572, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L603, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L647, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L668, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L683, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L697, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L712, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L732, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L754, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L788, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L832, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L854, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L871, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L902, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L918, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L941, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L962, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L981, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L995, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1023, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1077, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityHelper.sol#L1091

```solidity

File: AaveHub.sol

5: /**
 * @author Christoph Krpoun
 * @author René Hochmuth
 * @author Vitally Marinchenko
 */

import "./AaveHelper.sol";
import "../TransferHub/TransferHelper.sol";
import "../TransferHub/ApprovalHelper.sol";

/**
 * @dev Purpose of this contract is to optimize capital efficency by using
 * aave pools. Not borrowed funds are deposited into correspoding aave pools
 * to earn supply APY.
 *
 * The aToken are holded by the wiseLending contract but the accounting
 * is managed by the position NFTs. This is possible due to the included
 * onBehlaf functionallity inside wiseLending.
 */

contract AaveHub is AaveHelper, TransferHelper, ApprovalHelper {

39: /**
     * @dev Adds new mapping to aaveHub. Needed
     * to link underlying assets with corresponding
     * aTokens. Can only be called by master.
     */
    function setAaveTokenAddress(
        address _underlyingAsset,
        address _aaveToken
    )
        external
        onlyMaster
    {

58: /**
     * @dev Adds new mapping to aaveHub in bulk.
     * Needed to link underlying assets with
     * corresponding aTokens. Can only be called by master.
     */

    function setAaveTokenAddressBulk(
        address[] calldata _underlyingAssets,
        address[] calldata _aaveTokens
    )
        external
        onlyMaster
    {

79: /**
     * @dev Receive functions forwarding
     * sent ETH to the master address
     */
    receive()
        external
        payable
    {

97: /**
     * @dev Allows deposit ERC20 token to
     * wiseLending and takes token amount
     * as arguement. Also mints position
     * NFT to reduce needed transactions.
     */
    function depositExactAmountMint(
        address _underlyingAsset,
        uint256 _amount
    )
        external
        returns (uint256)
    {

117: /**
     * @dev Allows deposit ERC20 token to
     * wiseLending and takes token amount as
     * argument.
     */
    function depositExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _amount
    )
        public
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {

153: /**
     * @dev Allows to deposit ETH token directly to
     * wiseLending and takes token amount as argument.
     * Also mints position NFT to avoid extra transaction.
     */
    function depositExactAmountETHMint()
        external
        payable
        returns (uint256)
    {

168: /**
     * @dev Allows to deposit ETH token directly to
     * wiseLending and takes token amount as argument.
     */
    function depositExactAmountETH(
        uint256 _nftId
    )
        public
        payable
        nonReentrant
        returns (uint256)
    {

198: /**
     * @dev Allows to withdraw deposited ERC20 token.
     * Takes _withdrawAmount as argument.
     */
    function withdrawExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _withdrawAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {

234: /**
     * @dev Allows to withdraw deposited ETH token.
     * Takes token amount as argument.
     */
    function withdrawExactAmountETH(
        uint256 _nftId,
        uint256 _withdrawAmount
    )
        external
        nonReentrant
        returns (uint256)
    {

277: /**
     * @dev Allows to withdraw deposited ERC20 token.
     * Takes _shareAmount as argument.
     */
    function withdrawExactShares(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _shareAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {

310: /**
     * @dev Allows to withdraw deposited ETH token.
     * Takes _shareAmount as argument.
     */
    function withdrawExactSharesETH(
        uint256 _nftId,
        uint256 _shareAmount
    )
        external
        nonReentrant
        returns (uint256)
    {

350: /**
     * @dev Allows to borrow ERC20 token from a
     * wiseLending pool. Needs supplied collateral
     * inside the same position and to approve
     * aaveHub to borrow onBehalf for the caller.
     * Takes token amount as argument.
     */
    function borrowExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _borrowAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {

386: /**
     * @dev Allows to borrow ETH token from
     * wiseLending. Needs supplied collateral
     * inside the same position and to approve
     * aaveHub to borrow onBehalf for the caller.
     * Takes token amount as argument.
     */
    function borrowExactAmountETH(
        uint256 _nftId,
        uint256 _borrowAmount
    )
        external
        nonReentrant
        returns (uint256)
    {

429: /**
     * @dev Allows to payback ERC20 token for
     * any postion. Takes _paybackAmount as argument.
     */
    function paybackExactAmount(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _paybackAmount
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {

478: /**
     * @dev Allows to payback ETH token for
     * any postion. Takes token amount as argument.
     */
    function paybackExactAmountETH(
        uint256 _nftId
    )
        external
        payable
        nonReentrant
        returns (uint256)
    {

552: /**
     * @dev Allows to payback ERC20 token for
     * any postion. Takes shares as argument.
     */
    function paybackExactShares(
        uint256 _nftId,
        address _underlyingAsset,
        uint256 _shares
    )
        external
        nonReentrant
        validToken(_underlyingAsset)
        returns (uint256)
    {

630: /**
     * @dev View functions returning the combined rate
     * from aave supply APY and wiseLending borrow APY
     * of a pool.
     */
    function getLendingRate(
        address _underlyingAsset
    )
        external
        view
        returns (uint256)
    {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L39, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L58, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L79, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L97, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L117, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L153, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L168, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L198, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L234, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L277, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L310, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L350, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L386, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L429, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L478, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L552, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/AaveHub.sol#L630

### [N-108]<a name="n-108"></a> Ensure block.timestamp is only used in long time intervals

`block.timestamp` represents the current block's timestamp and can be influenced, within limits, by miners. For short time intervals, this malleability can be exploited, potentially allowing miners to manipulate contract behavior. For instance, they might fast-forward an expiration or delay an event. When designing smart contracts, if precise time checks are needed for short intervals, alternatives like block numbers can be considered. However, for longer durations where a few seconds of deviation is inconsequential, `block.timestamp` is generally safe and efficient. Always assess the implications of time manipulations for the specific use-case before utilizing `block.timestamp`. In practice, if you're using block.timestamp to measure intervals that are a matter of days, weeks, or longer, the potential manipulation by miners becomes less significant. Always prioritize the security and integrity of your smart contract operations when making these decisions.

*There are 5 instance(s) of this issue:*

```solidity

File: MainHelper.sol

357: uint256 timeDifference = block.timestamp

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/MainHelper.sol#L357

```solidity

File: WiseLending.sol

262: uint256 timeDifference = block.timestamp

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLending.sol#L262

```solidity

File: PendlePowerFarmController.sol

475: if (_getExpiry() > block.timestamp) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L475

```solidity

File: PendlePowerFarmToken.sol

120: uint256 timeDifference = block.timestamp

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L120

```solidity

File: PendlePowerFarmToken.sol

395: if (block.timestamp == lastInteraction) {

```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmToken.sol#L395

### [N-109]<a name="n-109"></a> Use `Ownable2Step` rather than `Ownable`

`Ownable2Step` and `Ownable2StepUpgradeable` prevent the contract ownership from mistakenly being transferred to an address that cannot handle it (e.g. due to a typo in the address), by requiring that the recipient of the owner permissions actively accept via a contract call of its own.

*There are 28 instance(s) of this issue:*

```solidity

File: OwnableMaster.sol

9: contract OwnableMaster {



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/OwnableMaster.sol#L9

```solidity

File: PositionNFTs.sol

7: import "./OwnableMaster.sol";

11: contract PositionNFTs is ERC721Enumerable, OwnableMaster {

34: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L7, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L34

```solidity

File: WiseLendingDeclaration.sol

5: import "./OwnableMaster.sol";

31: OwnableMaster,

110: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L31, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseLendingDeclaration.sol#L110

```solidity

File: DeclarationsFeeManager.sol

13: import "../OwnableMaster.sol";

31: contract DeclarationsFeeManager is FeeManagerEvents, OwnableMaster {

41: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L13, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L31, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/FeeManager/DeclarationsFeeManager.sol#L41

```solidity

File: PendlePowerManager.sol

12: import "../../OwnableMaster.sol";

15: contract PendlePowerManager is OwnableMaster, PendlePowerFarm, MinterReserver {

43: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L12, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L15, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarm/PendlePowerManager.sol#L43

```solidity

File: PendlePowerFarmControllerBase.sol

5: import "../../OwnableMaster.sol";

31: OwnableMaster,

86: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L5, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L31, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerBase.sol#L86

```solidity

File: PowerFarmNFTs.sol

11: import "../../OwnableMaster.sol";

24: contract PowerFarmNFTs is ERC721Enumerable, OwnableMaster {

46: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L11, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L24, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L46

```solidity

File: Declarations.sol

12: import "../OwnableMaster.sol";

33: abstract contract Declarations is OwnableMaster {

50: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L12, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L33, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/Declarations.sol#L50

```solidity

File: WiseSecurityDeclarations.sol

17: import "../OwnableMaster.sol";

45: contract WiseSecurityDeclarations is OwnableMaster {

57: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L17, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L45, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurityDeclarations.sol#L57

```solidity

File: Declarations.sol

12: import "../OwnableMaster.sol";

21: contract Declarations is OwnableMaster, AaveEvents, WrapperHelper {

48: OwnableMaster(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L12, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L21, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WrapperHub/Declarations.sol#L48

### [N-110]<a name="n-110"></a> Use SafeCast to safely downcast variables

Downcasting `int`/`uint`s in Solidity can be unsafe due to the potential for data loss and unintended behavior. When downcasting a larger integer type to a smaller one (e.g., `uint256` to `uint128`), the value may exceed the range of the target type, leading to truncation and loss of significant digits. This data loss can result in unexpected state changes, incorrect calculations, or other contract vulnerabilities, ultimately compromising the contracts functionality and reliability. To prevent these risks, developers should carefully consider the range of values their variables may hold and ensure that proper checks are in place to prevent out-of-range values before performing downcasting. Also consider using OZ SafeCast functionality.

*There are 10 instance(s) of this issue:*

```solidity

File: PositionNFTs.sol

399: uint8(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PositionNFTs.sol#L399

```solidity

File: PendlePowerFarmController.sol

379: ? uint128(currentExpiry)

407: uint128(_amount),



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L379, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmController.sol#L407

```solidity

File: PendlePowerFarmControllerHelper.sol

39: uint128 startTime = uint128((block.timestamp / WEEK)



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PendlePowerFarmController/PendlePowerFarmControllerHelper.sol#L39

```solidity

File: PowerFarmNFTs.sol

241: uint8(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/PowerFarms/PowerFarmNFTs/PowerFarmNFTs.sol#L241

```solidity

File: OracleHelper.sol

157: int192(uint192(answer))



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L157

```solidity

File: OracleHelper.sol

401: return uint128(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L401

```solidity

File: OracleHelper.sol

427: int56 twapPeriodInt56 = int56(

428: int32(TWAP_PERIOD)

434: int24 tick = int24(



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L427, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L428, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseOracleHub/OracleHelper.sol#L434

### [N-111]<a name="n-111"></a> Consider using `SafeTransferLib.safeTransferETH()` or `Address.sendValue()` for clearer semantic meaning

These Functions indicate their purpose with their name more clearly than using low-level calls.

*There are 2 instance(s) of this issue:*

```solidity

File: WiseSecurity.sol

208: ) = curvePool.call{value: 0}

225: ) = curveMeta.call{value: 0}



```

*GitHub* : https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L208, https://github.com/code-423n4/2024-02-wise-lending/tree/main/contracts/WiseSecurity/WiseSecurity.sol#L225